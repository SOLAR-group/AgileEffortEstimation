"issuekey","created","title","description","storypoint"
"CONFSERVER-5599","02/28/2006 16:45:08","Export news (blog posts) to PDF","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-5599].   {panel}  We write daily market summaries using the Confluence news posts feature.  It would be very useful to be able to email these daily summaries (that include tables and attached graphs from Excel) to people outside of the company. ",1
"CONFSERVER-5942","04/18/2006 01:18:06","Indexing with 'Other' analyzer removes numbers from search","When indexing language is set to ""other"", searches ignore numbers.    Example:    Page contains string ""foo""    Search for ""foo123"" returns string ""foo"" as matching    h5. Workaround:  Switch to a different Indexing Language besides 'Other' then rebuild the index  ",2
"CONFSERVER-14838","03/10/2009 05:24:54","Themes from plugins is still referenced by Confluence after plugin is uninstalled","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-14838].   {panel}  Confluence still uses an uninstalled theme's layout (eg. the font will still be the old plugin's font) as its site layout although the plugin has been uninstalled.    Steps to replicate:  # Install a theme plugin  # Set the theme as the Site Theme  # Uninstall the theme  # Confluence theme selection page (http://ConfluenceURL/admin/choosetheme.action) will report that the site is using the default theme. Warnings will be populating the log file:  {noformat}  2009-03-10 16:11:26,659 WARN [http-8080-3] [atlassian.confluence.themes.DefaultThemeManager] extractTheme Unable to find configured theme module: com.atlassian.confluence.themes.classic:classic   -- referer: http://localhost:8080/admin/console.action | url: /admin/choosetheme.action | userName: admin  {noformat}    Customers who used the Classic Theme as a site layout might encounter this warning after they have upgraded to Confluence 2.10.    The work around is to set Confluence site theme to other installed theme.",3
"CONFSERVER-21870","02/23/2011 17:46:38","""maximum number of expressions in a list is 1000"" error when user is in more than 1000 groups visits dashboard","In *Oracle*, if a user belongs to more than 1000 groups and visits the dashboard, the following error occurs:  {code}-- url: /confluence/pages/viewpage.action | page: 69468465 | userName: user | referer: Confluence URL | action: viewpage  org.springframework.jdbc.BadSqlGrammarException: Hibernate operation: Could not execute query; bad SQL grammar []; nested exception is java.sql.SQLException: ORA-01795: maximum number of expressions in a list is 1000    Caused by: java.sql.SQLException: ORA-01795: maximum number of expressions in a list is 1000     at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)   at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331)   at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288)   at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:745)   at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:219)   at oracle.jdbc.driver.T4CPreparedStatement.executeForDescribe(T4CPreparedStatement.java:813)   at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1049)   at oracle.jdbc.driver.T4CPreparedStatement.executeMaybeDescribe(T4CPreparedStatement.java:854)   at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1154)   at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3370)   at oracle.jdbc.driver.OraclePreparedStatement.executeQuery(OraclePreparedStatement.java:3415)   at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:93)   at net.sf.hibernate.impl.BatcherImpl.getResultSet(BatcherImpl.java:89)   at net.sf.hibernate.loader.Loader.getResultSet(Loader.java:880)   at net.sf.hibernate.loader.Loader.doQuery(Loader.java:273)   at net.sf.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:138)   at net.sf.hibernate.loader.Loader.doList(Loader.java:1063)   at net.sf.hibernate.loader.Loader.list(Loader.java:1048)   at net.sf.hibernate.hql.QueryTranslator.list(QueryTranslator.java:854)   at net.sf.hibernate.impl.SessionImpl.find(SessionImpl.java:1552)   at net.sf.hibernate.impl.QueryImpl.list(QueryImpl.java:49)   at net.sf.hibernate.impl.AbstractQueryImpl.uniqueResult(AbstractQueryImpl.java:550)   at com.atlassian.confluence.spaces.persistence.dao.hibernate.HibernateSpaceDao$7.doInHibernate(HibernateSpaceDao.java:455)   at org.springframework.orm.hibernate.HibernateTemplate.execute(HibernateTemplate.java:370)   at org.springframework.orm.hibernate.HibernateTemplate.execute(HibernateTemplate.java:337)   at com.atlassian.confluence.spaces.persistence.dao.hibernate.HibernateSpaceDao.countSpaces(HibernateSpaceDao.java:447)   at com.atlassian.confluence.spaces.DefaultSpaceManager$1.getAvailableSize(DefaultSpaceManager.java:799)   at com.atlassian.confluence.core.DefaultListBuilder.getAvailableSize(DefaultListBuilder.java:51)   at com.atlassian.confluence.plugins.macros.dashboard.DashboardMacroSupport.getLabelsForPermittedSpaces(DashboardMacroSupport.java:216)   at com.atlassian.confluence.plugins.macros.dashboard.DashboardMacroSupport.getViewableTeamLabels(DashboardMacroSupport.java:201)  {code}    The problem is that com.atlassian.confluence.spaces.persistence.dao.hibernate.HibernateSpacesQueryBuilder specifies the full list of groups the user is a member of in the ""in"" clause.  It's unexpected for a user to be in more than 1000 groups, but it can happen, particularly if Confluence is delegating user management to a large LDAP server.",3
"CONFSERVER-22154","03/31/2011 18:48:28","JIRA Issues Macro not following Confluence general configuration date/time format","It seems that the {jiraissues} macro for Confluence is not following the date format as set in the Confluence general configurations. The dates display in dd/MMM/yy format (with no timestamp), regardless of formatting of the ""Date Time Format"" or ""Date Format"" in general configs. Please see the attached screenshots for more detail.    FWIW I tested this in Confluence 3.3.3, 3.4.7, and 3.5.0, using {jiraissues} macro to retrieve issues from JAC.    There's an pretty old (fixed) ticket on this topic, but it's unclear whether it's the same bug:  http://jira.atlassian.com/browse/CONF-1403",2
"CONFSERVER-22287","04/10/2011 16:21:10","When Inserting Link Insert Button Not Clickable When Using Mouse Right-Click to Paste","h3. Summary  ""Insert"" button is greyed out when using right mouse click to paste    h3. Steps to Reproduce  # Copy a URL into your clipboard.  # Click Insert > Link  #* Alternatively, Press ⌘K / ctrl + K to create a hyperlink  # Click Web Link  # Right-click in URL field/ Address field with mouse and select Paste   !CONFSERVER-22287-replication steps.png|thumbnail!     h3. Expected Results  The ""Insert""button can clicked and link can be inserted    h3. Actual Results  The ""Insert"" button is greyed out.    h3. Workaround  * Press Enter/Return key after pasting the link  * Press Space bar after pasting the link   * Use Ctrl + V instead  * Type and then delete any character into the ""Address"" field; this enables the button.    h3. Additional notes  This most likely can be fixed by adding a JavaScript check for ""Right click > Paste"".",2
"CONFSERVER-22339","04/15/2011 18:39:26","JIRA Issues Macro isn't correctly displayed when exported, in PDF and Word, if the text inside columns is too wide.","h4.Problem  JIRA Issues Macro isn't correctly displayed when exported, in PDF and Word, if the text inside columns is too wide.  The problem lies directly with the export function.    h4.Fix  There is none yet.    h4.Workaround  Use as landscape with this PDF Stylesheet:  {code}@page  {  size: 297mm 210mm;  }{code}",5
"CONFSERVER-22575","05/24/2011 02:53:01","Support customisation of fields displayed by JIRA macro when showing a single issue","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-22575].   {panel}  In a Confluence instance with an applink set up to JIRA I would like to be able to use the ""shortcut"" version of the jira issue macro like this:    {noformat}  {jira:MAI-19|server=jira|columns=assignee,resolution,updated}  {noformat}    At the moment the columns attribute is ignored and the key/description/status is displayed (see attachment). I would prefer that only the specified columns are displayed, perhaps with a vertical or horizontal layout attribute.",5
"CONFSERVER-50755","08/24/2011 16:20:49","Cannot subscribe to iCal calendar","I'm trying to subscribe to a calendar but get the message that the calender doesn't seem to be in iCal format.  I tested the attached file with these validators: http://icalvalid.cloudapp.net/ http://severinghaus.org/projects/icv/  and the calendar validates fine, funnily, the last validator makes use of iCal4j which is implemented in Team Calendars as well. Please see the attached log and ics file for more info.   Thanks a lot, Peter  ",2
"CONFSERVER-23993","11/28/2011 22:51:15","Share button greyed out, not obvious that an email address needs to be 'selected' first","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-23993].   {panel}  Steps to reproduce:  * Click the share button to display the pop-up  * Type an email address  * Hit TAB  * The email is left in the text box. There is no error message yet the ""share"" button is greyed out (!)    !confluence share.png!",3
"CONFSERVER-24760","02/28/2012 00:46:20","Copy and Paste problems with list and macro selections.","h3. Summary    * Copy and pasting lists / sections with only partial selections does not behave in a reasonable manner.    To fix:    * Confirm desired behaviour is what we want  * Need to make sure we have good automated test cases for these selection and copy-paste scenarios  * Fix the underlying issues    [Copy and paste of original comments|http://confluence.atlassian.com/pages/viewpage.action?pageId=278070932]    h3. History from CAC    *Shannon GreyWalker*    ""EPIC"" BUG    The conversation thread that culminated in this specific comment up above has shed light on what I think is a ""super pattern"" that collectively describes various specific bugs that users have been reporting with the cut/copy/paste/dragMove behavior of the 4.x editor. The most concise way to describe this ""epic"" bug is as follows:    *4.x editor does not consistently preserve and reproduce the semantic/visual structure (order and nesting) of a diverse set of selected elements when cutting/copying > pasting, or when drag-moving, into a new location*    Note that I'm stressing the semantic and visual structure of the selection, because the new editor makes it truly impossible to understand how the start and end points of the selection correspond to the specific start and end tags of the underlying selection in the XML storage format of the page. Therefore, all your users can rely on is what they see in the rendered/styled text within the editor. And what they see is always clearly representative of a semantic structure that has a specific order and nesting of semantic elements.    I would very much like to see a single JIRA issue number assigned to this overarching ""epic"" bug so that I can track a single JIRA ticket instead of multiple more granular JIRA tickets. Why? Because IMO this is one more ""showstopper"" issue that will prevent my company from migrating from 3.5.x to 4.x. Now that I've been banging specifically on copy/cut/paste/dragMove mechanics and seeing how truly dysfunctional the overall behavior currently is even in 4.1.5, I cannot give a green light internally to migration until the meta-issue I describe above is fully resolved in the most typical use cases. Now that I understand that these problems are essentially all bugs and not ""behavior as designed, which can be managed correctly through some common conceptual workarounds"", I cannot force this confusing behavior on my user base.    It's worth noting that in the old wiki syntax, what you select is always 100% obvious, and is exactly what you paste, and the resulting behavior is always 100% predictable. So this is an entirely new problem introduced with the 4.x environment. Remember, moving things around in and between pages is at least 50% or more of what your heads-down users spend their time doing in the editor. Writing is mostly revision.    I strongly recommend that once you get this ""epic"" bug resolved, you create several functional tests based on several test pages that you always faithfully run during regression for every single point release of Confluence, and you do not release if any of those functional tests fail. Why, again because cut/copy/paste/dragMove is at least 50% of what your users spend every hour in Confluence actually doing. Your code for cut/copy/paste/dragMove needs to be 100% reliable and predictable based upon what your users can actually see and infer in the rendered WYSIsortaWYG text in the editor. It was 100% reliable before in wiki syntax mode, so it needs to be the same in 4.x or we have a net loss and lots of confused and pissed-off users.    Here are two specific and common functional tests I can think of off the top of my head. Both of these also serve to illustrate the meta pattern I describe above for this ""epic"" bug:    h5.Functional Test 1 - Cut and paste within an ordered list     h6. Test object    {noformat}      1. This is originally step 1         a. This is originally step 1.a         b. This is originally step 1.b      2. This is originally step 2         a. This is originally step 2.a         b. This is originally step 2.b         c. This is originally step 2.c      3. This is originally step 3         a. This is originally step 3.a         b. This is originally step 3.b         c. This is originally step 3.c      4. This is originally step 4  {noformat}     h6. Sub Test 1.1 - Select from start of semantic parent, paste before start of another semantic parent       # Select from the first character of the text within parent Step 3 through:  ## The last character of the text within child Step 3.b.  ## The last character of the text within child Step 3.b, and then press Shift + rightArrow one time to extend the selection highlight to the right margin of the editor frame.  ## Also select the entire scope of Step 3 > 3.a > 3.b by placing the selection point immediately before the first character of the text within parent Step 3, then using Shift + downArrow three times to extend the selection highlight to the right margin of the editor frame for Step 3.b.  ## The middle of the text within child Step 3.b (end just before the word ""originally"").  # Cut the selection.  # Place the selection point immediately before the first character of the text within Step 2.  # Paste the cut selection.    Selection types 1.a, 1.b, and 1.c should all yield the same expected semantic result when pasted, as follows:     {noformat}      1. This is originally step 1         a. This is originally step 1.a         b. This is originally step 1.b      2. This is originally step 3         a. This is originally step 3.a         b. This is originally step 3.b      3. This is originally step 2         a. This is originally step 2.a         b. This is originally step 2.b         c. This is originally step 2.c         d. This is originally step 3.c      4. This is originally step 4  {noformat}    Selection type 1.d should yield the following expected semantic result when pasted:     {noformat}      1. This is originally step 1         a. This is originally step 1.a         b. This is originally step 1.b      2. This is originally step 3         a. This is originally step 3.a         b. This is originally step 3.b         c. This is      3. This is originally step 2         a. This is originally step 2.a         b. This is originally step 2.b         c. This is originally step 2.c         d. originally step 3.c      4. This is originally step 4  {noformat}     h6. Sub Test 1.2 - Select from middle of semantic parent, paste before start of another semantic parent     #    Select from the middle of the text within parent Step 3 (start just before the word ""originally"") through:  ##        The last character of the text within child Step 3.b.  ##        The last character of the text within child Step 3.b, and then press Shift + rightArrow one time to extend the selection highlight to the right margin of the editor frame.  ##        Also select the entire scope of Step 3 > 3.a > 3.b by placing the selection point immediately before the first character of the text within parent Step 3, then using Shift + downArrow three times to extend the selection highlight to the right margin of the editor frame for Step 3.b.  ##        The middle of the text within child Step 3.b (end just before the word ""originally"").  #    Cut the selection.  #    Place the selection point immediately before the first character of the text within Step 2.  #    Paste the cut selection.    Selection types 1.a, 1.b, and 1.c should all yield the same expected semantic result when pasted, as follows:     {noformat}      1. This is originally step 1          a. This is originally step 1.a          b. This is originally step 1.b      2. originally step 3          a. This is originally step 3.a          b. This is originally step 3.b      3. This is originally step 2          a. This is originally step 2.a          b. This is originally step 2.b          c. This is originally step 2.c      4. This is          a. This is originally step 3.c      5. This is originally step 4  {noformat}    Selection type 1.d should yield the following expected semantic result when pasted:     {noformat}      1. This is originally step 1          a. This is originally step 1.a          b. This is originally step 1.b      2. originally step 3          a. This is originally step 3.a          b. This is originally step 3.b          c. This is      3. This is originally step 2          a. This is originally step 2.a          b. This is originally step 2.b          c. This is originally step 2.c      4. This is          a. originally step 3.c      5. This is originally step 4  {noformat}     h6. Sub Test 1.3 - Select from start of semantic parent, paste in middle of another semantic parent     #    Select from the first character of the text within parent Step 3 through:  ##        The last character of the text within child Step 3.b.  ##        The last character of the text within child Step 3.b, and then press Shift + rightArrow one time to extend the selection highlight to the right margin of the editor frame.  ##        Also select the entire scope of Step 3 > 3.a > 3.b by placing the selection point immediately before the first character of the text within parent Step 3, then using Shift + downArrow three times to extend the selection highlight to the right margin of the editor frame for Step 3.b.  ##        The middle of the text within child Step 3.b (end just before the word ""originally"").  #    Cut the selection.  #    Place the selection point in the middle of the text within Step 2 (just before the word ""originally"").  #    Paste the cut selection.    Selection types 1.a, 1.b, and 1.c should all yield the same expected semantic result when pasted, as follows:     {noformat}      1. This is originally step 1          a. This is originally step 1.a          b. This is originally step 1.b      2. This is       3. This is originally step 3          a. This is originally step 3.a          b. This is originally step 3.b      4. originally step 2          a. This is originally step 2.a          b. This is originally step 2.b          c. This is originally step 2.c          d. This is originally step 3.c      5. This is originally step 4  {noformat}    Selection type 1.d should yield the following expected semantic result when pasted:     {noformat}      1. This is originally step 1          a. This is originally step 1.a          b. This is originally step 1.b      2. This is      3. This is originally step 3          a. This is originally step 3.a          b. This is originally step 3.b          c. This is      4. originally step 2          a. This is originally step 2.a          b. This is originally step 2.b          c. This is originally step 2.c          d. originally step 3.c      5. This is originally step 4  {noformat}     h6. Sub Test 1.4 - Select from middle of semantic parent, paste in middle of another semantic parent     #    Select from the middle of the text within parent Step 3 (start just before the word ""originally"") through:  ##        The last character of the text within child Step 3.b.  ##        The last character of the text within child Step 3.b, and then press Shift + rightArrow one time to extend the selection highlight to the right margin of the editor frame.  ##        Also select the entire scope of Step 3 > 3.a > 3.b by placing the selection point immediately before the first character of the text within parent Step 3, then using Shift + downArrow three times to extend the selection highlight to the right margin of the editor frame for Step 3.b.  ##        The middle of the text within child Step 3.b (end just before the word ""originally"").  #    Cut the selection.  #    Place the selection point in the middle of the text within Step 2 (just before the word ""originally"").  #    Paste the cut selection.    Selection types 1.a, 1.b, and 1.c should all yield the same expected semantic result when pasted, as follows:     {noformat}      1. This is originally step 1          a. This is originally step 1.a          b. This is originally step 1.b      2. This is       3. originally step 3          a. This is originally step 3.a          b. This is originally step 3.b      4. originally step 2          a. This is originally step 2.a          b. This is originally step 2.b          c. This is originally step 2.c      5. This is          a. This is originally step 3.c      6. This is originally step 4  {noformat}    Selection type 1.d should yield the following expected semantic result when pasted:     {noformat}      1. This is originally step 1          a. This is originally step 1.a          b. This is originally step 1.b      2. This is      3. originally step 3          a. This is originally step 3.a          b. This is originally step 3.b          c. This is      4. originally step 2          a. This is originally step 2.a          b. This is originally step 2.b          c. This is originally step 2.c      5. This is          a. originally step 3.c      6. This is originally step 4  {noformat}    h5.Functional Test 2 - Cut and paste within a mixed set of nested macros, sections, and paragraphs     h6. Test object    _This is hard to simulate in JIRA, so see_    !section-copy-paste-screenshot.jpg|thumbnail!    ----  h4. Section 1    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah       * blah blah      * blah blah     * blah blah    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah    {panel}  h4. Section 2    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah     <warning macro>  lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah    *    blah blah  *    blah blah  <warning macro>    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah    *    blah blah  *    blah blah    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah  {panel}    h4. Section 3    lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah lorem ipsum blah blah  ----     h5. Sub Tests    Okay I'm not going to make another long vertical wall of specific tests and expected results here, because hopefully you see how the same testing pattern enumerated for the ordered list test object would be applied to this new test object comprising a semantic mixed content model for common combinations of paragraph and list block elements plus some nested macro objects (each of which contains a mixture of typical paragraph and list block elements.    The basic idea is to apply the same four tests here to this new test object, ideally within *Section 2* because it contains the most complex mixture of semantic objects.    * Sub Test 2.1 - Select from start of one semantic parent, paste before start of another semantic parent. For example, what would you intuitively expect to happen if you selected the entire panel macro in *Section 2* and then pasted the selection with your insertion point immediately before the first character of the first bullet in the bullet list of *Section 1*. Yeah, you see where I'm going here, right? Do you get this intuitively expected result right now? Nope.  * Sub Test 2.2 - Select from start of one semantic parent, paste in middle of another semantic parent. I won't bore you with examples. I hope you get it by now.  * Sub Test 2.3 - Select from middle of one semantic parent, paste before start of another semantic parent. Yada yada.  * Sub Test 2.4 - Select from middle of one semantic parent, paste in middle of another semantic parent. Yada yada.    *The bottom line with all these functional test objects and the four typical semantic cut/copy/paste/dragMove sub tests to perform on each one boils down to one intuitively expected UX pattern:*    * Structurally speaking, the clipped/pasted result of a selection should be the exact same whether the selection's end-point is at the end of a visible text line in the editor or the end-point is at the right margin. Yes, under the covers this subtle distinction makes for a different range in the tinyMCE's information it gets from the browser, but for a user looking at the screen, there is no distinction; it's the same exact thing. Your code should reflect this user perception and should not reflect the actual technical distinction under the covers in the DOM.    * The complete visual and semantic structure of the clipped selection should be preserved and reproduced exactly the same in the new, pasted context, AND    * The visual and semantic structure into which you pasted the clipped selection should ""split"" around the inserted paste and that split structure should be maintained with the same exact structure in both halves of the split.    * When you have to make a decision between acting upon what's really selected (or where the insertion point is) based on the underlying DOM of the selection range reported by the browser versus what the user sees visually in the editor and thinks of as being ""the semantic objects I've selected"", you should always decide in favor of what the user visually and conceptually sees with their own eyes.    * Good luck with this. I'm sure it can be done. The question is: how soon? And what JIRA issue number do I track to watch for completion of this?    ----    *Paul Curren*    Hi Shannon. I apologise for the delay in responding to this comment. I've been in contact with our bug-fixing team to go through the issues you have described here. We will get one or more issues raised soon, as appropriate and let you know the numbers for tracking purposes.    Thanks.    ----    *Shannon Greywalker*    Thanks Paul. I know it was a lot to chew on and spec out. No worries; thanks for the update.  ",5
"CONFSERVER-25111","04/03/2012 10:29:58","Removing formatting from a bullet point or numbered list item moves the cursor to a new line","see this video: http://screencast.com/t/C9pYDRqwApnb    Same thing happens with itlaics and underline",1
"CONFSERVER-25278","04/19/2012 12:42:42","Page margin CSS in PDF Stylesheet can OOME and cause high load on Confluence during space export to pdf","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-25278].   {panel}  h5. Steps to reproduce:  # Add the following CSS in your Space PDF Stylesheet:  {code}  @page   {      margin: 5.5in;  }  {code}  # Export a Page to PDF and will ended up at System Error page with the following stacktrace:  {code}  2012-04-19 17:22:06,698 ERROR [http-8080-3] [[Standalone].[localhost].[/confluence].[action]] log Servlet.service() for servlet action threw exception  java.lang.OutOfMemoryError: Java heap space      at java.util.LinkedList.addBefore(LinkedList.java:778)      at java.util.LinkedList.add(LinkedList.java:198)      at org.xhtmlrenderer.css.newmatch.CascadedStyle.addProperties(CascadedStyle.java:148)      at org.xhtmlrenderer.css.newmatch.CascadedStyle.<init>(CascadedStyle.java:135)      at org.xhtmlrenderer.css.newmatch.Matcher.getPageCascadedStyle(Matcher.java:121)      at org.xhtmlrenderer.context.StyleReference.getPageStyle(StyleReference.java:203)      at org.xhtmlrenderer.layout.Layer.createPageBox(Layer.java:794)      at org.xhtmlrenderer.layout.Layer.addPage(Layer.java:764)      at org.xhtmlrenderer.layout.Layer.addPagesUntilPosition(Layer.java:875)      at org.xhtmlrenderer.layout.Layer.getPage(Layer.java:861)      at org.xhtmlrenderer.layout.Layer.getFirstPage(Layer.java:805)      at org.xhtmlrenderer.render.BlockBox.layout(BlockBox.java:774)      at org.xhtmlrenderer.render.BlockBox.layout(BlockBox.java:735)      at org.xhtmlrenderer.pdf.ITextRenderer.layout(ITextRenderer.java:209)      at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerXmlToPdfConverter.convertXhtmlToPdf(FlyingSaucerXmlToPdfConverter.java:92)      at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerXmlToPdfConverter.convertXhtmlToPdf(FlyingSaucerXmlToPdfConverter.java:38)      at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerPdfExporterService.createPdfForPage(FlyingSaucerPdfExporterService.java:78)      at com.atlassian.confluence.extra.flyingpdf.ExportPageAsPdfAction.execute(ExportPageAsPdfAction.java:28)      at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:168)      at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)      at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)      at com.opensymphony.xwork.interceptor.DefaultWorkflowInterceptor.intercept(DefaultWorkflowInterceptor.java:55)      at com.atlassian.confluence.core.ConfluenceWorkflowInterceptor.intercept(ConfluenceWorkflowInterceptor.java:37)      at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)      at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)      at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)      at com.atlassian.xwork.interceptors.XsrfTokenInterceptor.intercept(XsrfTokenInterceptor.java:100)      at com.atlassian.confluence.xwork.ConfluenceXsrfTokenInterceptor.intercept(ConfluenceXsrfTokenInterceptor.java:25)      at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)      at com.atlassian.confluence.security.interceptors.CaptchaInterceptor.intercept(CaptchaInterceptor.java:49)      at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)      at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   {code}  # Export the Space to PDF and it will take forever and throw the following in the stacktrace:  {code}  2012-04-19 17:02:40,878 ERROR [Long running task: PDF Space Export] [content.render.xhtml.DefaultRenderer] render Error rendering content for view: RuntimeException occurred while performing an XHTML storage transformation (null)   -- referer: http://localhost:8080/confluence/spaces/flyingpdf/flyingpdf.action?key=SBX | url: /confluence/spaces/flyingpdf/doflyingpdf.action | userName: admin | action: doflyingpdf  com.atlassian.confluence.content.render.xhtml.XhtmlException: RuntimeException occurred while performing an XHTML storage transformation (null)      at com.atlassian.confluence.content.render.xhtml.storage.StorageXhtmlTransformer.transform(StorageXhtmlTransformer.java:60)      at com.atlassian.confluence.content.render.xhtml.TransformerChain.transform(TransformerChain.java:41)      at com.atlassian.confluence.content.render.xhtml.PluggableTransformerChain.transform(PluggableTransformerChain.java:53)      at com.atlassian.confluence.content.render.xhtml.DefaultRenderer.render(DefaultRenderer.java:63)      at com.atlassian.confluence.content.render.xhtml.DefaultRenderer.render(DefaultRenderer.java:51)      at com.atlassian.confluence.extra.flyingpdf.html.RenderedXhtmlBuilder.renderToHtml(RenderedXhtmlBuilder.java:377)      at com.atlassian.confluence.extra.flyingpdf.html.RenderedXhtmlBuilder.renderContentTreeNodes(RenderedXhtmlBuilder.java:346)      at com.atlassian.confluence.extra.flyingpdf.html.RenderedXhtmlBuilder.buildHtml(RenderedXhtmlBuilder.java:134)      at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerPdfExporterService.createPdfForSpace(FlyingSaucerPdfExporterService.java:50)      at com.atlassian.confluence.extra.flyingpdf.PdfExportLongRunningTask$1.doInTransactionWithoutResult(PdfExportLongRunningTask.java:70)      at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:33)      at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:128)      at com.atlassian.confluence.extra.flyingpdf.PdfExportLongRunningTask.runInternal(PdfExportLongRunningTask.java:52)      at com.atlassian.confluence.util.longrunning.ConfluenceAbstractLongRunningTask.run(ConfluenceAbstractLongRunningTask.java:21)      at com.atlassian.confluence.util.longrunning.ManagedTask.run(ManagedTask.java:35)      at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)      at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)      at java.util.concurrent.FutureTask.run(FutureTask.java:138)      at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)      at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)      at java.lang.Thread.run(Thread.java:662)  Caused by: java.lang.NullPointerException      at com.atlassian.confluence.content.render.xhtml.editor.macro.DefaultPlaceholderUrlFactory.getUrlForErrorPlaceholder(DefaultPlaceholderUrlFactory.java:73)      at com.atlassian.confluence.content.render.xhtml.transformers.TransformErrorToHtmlPlaceholder.handle(TransformErrorToHtmlPlaceholder.java:54)      at com.atlassian.confluence.content.render.xhtml.transformers.DefaultFragmentTransformer.transform(DefaultFragmentTransformer.java:124)      at com.atlassian.confluence.content.render.xhtml.storage.StorageXhtmlTransformer.transform(StorageXhtmlTransformer.java:43)      ... 20 more  {code}    h5. Findings  It seems that this can only be reproduced if the value of the margin is bigger than 5in.    h5. Workaround  Follow the instructions from the following KB article:  http://confluence.atlassian.com/display/CONFKB/Exporting+Page+or+Space+to+PDF+Fails+and+Causes+High+Load+or+OutOfMemoryError",3
"CONFSERVER-25582","05/28/2012 03:12:32","Japanese (and possibly other 2 byte) characters are not properly displayed on Confluence Issue insert widget.","Component and Version are not displayed properly. See attached screenshots.    We've tested with the following combinations of JIRA and Confluence versions and we saw the reported problem shown by attached image of 'bandicam 2012-05-15...' in all of them.    ||JIRA||Confluence||  |4.4.1| 4.0.4|  |5.0.4| 4.1.9|  |5.0.5| 4.2.2|  We did the test you said and the results are attached. The JIRA-Confluence versions of this test is 5.0.4-4.1.9. As you can see in the screen shots, most of the language display works fine. This problem is, I guess, specific to the pop-up screen of Insert-JIRA-Issue.    The JIRA's Component and Version are not displayed properly. Project name and Task type are properly displayed. Concerning the screen shot, we defined two Components in JIRA for test purpose. One of the components have Japanese characters in its name and the other had no Japanese character.    It is sure that Versions, if name has Japanese characters, are not displayed properly in similar way as Components does not.",5
"CONFSERVER-26834","10/09/2012 20:52:18","Support for Microsoft SQL Server JDBC Driver","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-26834].   {panel}  Microsoft SQL Server drivers, provided by Microsoft, support features such as:  - Windows Authentication  - Automatic failover  - *Integrated Security parameter* (integratedSecurity=true) which Enterprise customers cannot work without!  - And others    These features are vital to enterprise level customers and also other users",8
"CONFSERVER-26897","10/15/2012 21:57:55","Not able to link text to an anchor on a template page.","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-26897].   {panel}  When creating a template page if you create an anchor and then try to link a text on the page with this anchor you get ""The markup provided is not valid link markup"" message.    A workaround for it would be first creating it on a normal page, copy the content and paste on the template page, so the link will work then.    ",5
"CONFSERVER-27259","11/15/2012 10:53:08","When using the Issuelinks field column in the JIRA macro, there are no hyperlinks like in the Issue Navigator in JIRA","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-27259].   {panel}  Customer requests that the Linked Issue field column, when added to the JIRA Macro in Confluence, contain hyperlinks like when you add the field in the Issue Navigator in JIRA.    ",3
"CONFSERVER-27594","12/19/2012 16:03:15","Deleting a Page does not Delete its Draft","h2. Summary of The Bug    When users deleting a page on Confluence, the draft won't be deleted with it at the same time. This cause a {{WARN}} stack trace on the log whenever a user editing another page which saved into a draft.    Here is the stack trace written on the logs:    {code}2012-12-19 23:44:56,278 WARN [http-8090-4] [confluence.pages.actions.AbstractCreateAndEditPageAction] getCancelResult Removing invalid draft: Draft = { id: 851971, type: page, title: X, pageId: 851970}, for user : EmbeddedCrowdUser{name='admin', displayName='Septa Cahyadiputra', directoryId=294913}    -- url: /pages/doeditpage.action | userName: admin | referer: http://localhost:8090/pages/editpage.action?pageId=524292  com.atlassian.confluence.core.service.NotValidException: Page not found with id 851970{code}    h2. How to Replicate The Issue    # Add a new page then save it  # Edit the newly created page, wait until a draft was saved, then cancel editing  # A draft version of the page is listed in *""username drop down option"" >> Drafts*  # Remove the page  # Purge it from trash  # Draft version of the page is *still* listed in *""username drop down option"" >> Drafts*  # Edit any other page, wait until a draft was saved, then cancel editing  # {{atlassian-confluence.log}} will record the previously mentioned stack trace    h3. Noted    Please note that the stack trace is a {{WARN}} message that does not affect Confluence usage as the draft of the new page is still saved    h2. Workaround  There is a workaround detailed in [this KB article|https://confluence.atlassian.com/display/CONFKB/Removing+Orphaned+Draft]. It involved finding and removing the orphans from the database.",3
"CONFSERVER-27618","12/21/2012 14:32:13","More cell highlight colors in Confluence","{panel:bgColor=#e7f4fa}  *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-27618].  {panel}  When using tables in Confluence we would like to have more options for colors in addition to the default colors options that can be used(grey, red, green, blue, yellow, white).         {panel:title=Atlassian Update - 18 May 2020|borderStyle=solid|borderColor=#6554c0|titleBGColor=#6554c0|bgColor=#eae6ff|titleColor=#ffffff}    Hi everyone    Thank you all for your patience on this one. Confluence 7.5 will ship with a new colour palette for table cells.    We have expanded the original six options to a range of *49 bright and subtle options*. The existing five colours have been tweaked slightly to align with the Atlassian Design Guidelines (ADG) colour palette. Any colours you have used on existing tables/pages won't be affected and you can choose to update these tables with the new colours.     Please see the full update [in my latest comment|https://jira.atlassian.com/browse/CONFSERVER-27618?focusedCommentId=2415844&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-2415844].    Thanks again!  Makisa | Senior Product Manager, Confluence Server and Data Center  {panel}",2
"CONFSERVER-31261","02/08/2013 05:54:46","restore data of setup screen does not look completely auified","[screenshot|http://screencast.com/t/YshL4w1mfyl]  In the upload and restore a site/space backup section # the checkbox for build index looks stock. Not like the grey checkbox for aui # the line containg the ""browse"" button shouldn't have an empty field # on the same line, the button should be on the left of whatever it shares that line with  In the restore a backup... section # the build index checkbox is stock # the box below it looks significantly different from the spec  spec = CONFDEV-14482 (attached as screenshot)",5
"CONFSERVER-28252","02/25/2013 16:46:33","Page break before and after Table of Contents macro are forced in PDF export","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-28252].   {panel}  When a Page is exported, a page break is forced before and after Table of Contents, resulting in an otherwise empty page. This behaviour is not related to PDF stylesheet settings, and occurs regardless of the place in the page where the macro is embedded (see example exports attached).",3
"CONFSERVER-28482","03/12/2013 09:17:07","Look & Feel Editor for Documentation Theme Space is Broken","h3. Steps to Reproduce:    # Access any space that use documentation theme as its theme  # Access the space administrator page of the space  # Under the ""Space Admin"" tab access the ""Stylesheet"" menu under the ""Look & Feel"" section  # Try to edit the ""Stylesheet"" which will redirect user to the ""Stylesheet Editor""  #* The save and cancel button is located at the top-left instead of under the editor. This occurred in release version 5.0, 5.0.1 and 5.0.2  !502layout.png|thumbnail!  # Try to edit the ""PDF Layout"" which will redirect user to the ""PDF Layout Editor""  #* ""PDF Space Export Header"" and ""PDF Space Export Footer"" is positioned on a different frame and looks broken. This issue only occurred in release version 5.0.1 and 5.0.2  !502pdflayout.png|thumbnail!  # Try to edit the ""PDF Stylesheet"" which will redirect user to the ""PDF Stylesheet Editor""  #* The save and cancel button is located at the top-left instead of under the editor. This occurred in release version 5.0.1 and 5.0.2  !502pdfstylesheet.png|thumbnail!    h3. Expected Results:    *Stylesheet Editor*    Here is the screenshot of what the editor look like in Confluence 4.3.x:    !435stylesheet.png|thumbnail!    In Confluence release version 4.3.x the ""Save and ""Cancel"" button is positioned in the same frame as the editor. Positioning ""Save and ""Cancel"" button in the same frame as the menu button might confuse the customer.    *PDF Layout Editor*    Here is the screenshot of what the editor look like in Confluence 5.0.0:    !500pdflayout.png|thumbnail!    In Confluence release version 5.0.0 the positioned of all the editor are in the same column and doesn't look broken compared with 5.0.1 and 5.0.2.    *PDF Stylesheet Editor*    Here is the screenshot of what the editor look like in Confluence 5.0.0:    !500stylesheet.png|thumbnail!    In Confluence release version 5.0.0 the ""Save and ""Cancel"" button is positioned in the same frame as the editor. Positioning ""Save and ""Cancel"" button in the same frame as the menu button might confuse the customer.  ",3
"CONFSERVER-28543","03/18/2013 08:33:16","Activity stream not respecting parent page restrictions","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-28543].   {panel}  The Confluence Activity stream will display all pages that the user has access to according to the restrictions. However, if the user is limited in viewing a page due to inherited restrictions from a parent page, the page in question will still show up in the activity stream, and when following the link, the user will be notified that due to inherited restrictions, they will be unable to view the page.    The activity stream should not display pages that are restricted for viewing due to inherited restrictions, or child pages should copy over parent page restrictions.",5
"CONFSERVER-28550","03/19/2013 00:04:21","People Directory displays 'profile: No user <username>' for users in external directories","*pls refer to ticket https://jira.atlassian.com/browse/CONFDEV-15625    See screenshots. Users in the Confluence Internal Directory display correctly, whereas all external users display an error.     h3. Steps to Reproduce  # Import the attached XML backup to 5.0.1 (this is my live SRDL instance with email and the JIRA directory disabled, and no attachments)  # Log in with admin:admin  # View the People Directory and confirm that users display correctly.  # Shut down Confluence 5.0.1  # Unzip the 5.1beta2 installation.   # Point confluence.cfg.xml to the home directory of the 5.0.1 instance  # Start the 5.1beta2 instance and allow the upgrade to complete  # View the People Directory and confirm the error occurs.    Site Back up can be located in linked issue -> https://jira.atlassian.com/browse/CONFDEV-15625    ",2
"CONFSERVER-28621","03/22/2013 11:06:36","User Loses all Local Group Memberships If LDAP Sync is Unable to find the User, but the User appears again in subsequent syncs","h3.Steps to Reproduce  # Add a connection to LDAP in {{Confluence Admin >> User Directories}} with the *Read Only, with Local Groups* option  # Sync the directory and make sure that LDAP users are returned  # Add 1 LDAP user to a local group (membership)  # Change the User Object Filter in the directory's configuration in {{Confluence Admin >> User Directories}} to a dummy filter, such as the following:  {code}  (&(objectclass=inetorgperson)(cn=dummynonexistentuser))  {code}  # Sync the directory again (Notice that the LDAP users are missing)  # Revert the User Object Filter to the previous working filter  # Sync the directory again (notice that the LDAP users are back, but their local group memberships are gone)    h3. Workaround  # Restore the instance's database backup to a new database (i.e. not production) prior to the point where memberships were lost.    # Follow the instructions in step 1 of [Migrating Local Group Memberships Between Directories|https://confluence.atlassian.com/display/CONFKB/Migrate+Local+Group+Memberships+Between+Directories] to generate a CSV file of users and their memberships.  # Run through the rest of the instructions in that KB article to populate the production instance's group memberships.",8
"CONFSERVER-29182","05/03/2013 14:03:44","JIRA Issues macro links to application URL rather than display URL - the search link uses the application URL.","Application links have both an application URL, the URL by which the app connects on the backend (eg. http://jira.localhost), and a ""display URL"", the link displayed to the user (eg. https://jira.company.com"").    Currently this doesn't work with the jiraissues macro, because:  - If I use the ""application URL"" parameter (eg. ""http://jira.localhost/sr/...""), I get results, but *the hyperlink of the search is then wrong*.  - If, as a workaround, I try to use the ""display URL"",  I get an message telling me ""This table displays contents from an external source. The contents will be displayed as HTML. If you trust the security of this source, you can display the original formatting and avoid this warning by creating an Application Link to this JIRA instance"".    As for fixing this, I suggest: when rendering the search link, examine the search XML URL, and if it begins with an applink URL, substitute the applink's display URL.",2
"CONFSERVER-49484","05/31/2013 00:39:51","Edit Time Zone for JIRA Team Calendars","We use JIRA Team Calendars in Confluence to track time-sensitive tasks (like promo start/end times/dates). It works really well, but it would be great if there were a way to set the time zone that data is displayed in.    Currently, the actual times shown in JIRA Team Calendars are taken from the JIRA server's system time and can't be adjusted. This causes some confusion and inconvenience.     Thanks,  -Roger",3
"CONFSERVER-29863","07/08/2013 10:30:17","JIRA Issues macro renders incorrectly when custom icons are used for issue types","*Steps to reproduce*  # Have a Confluence instance linked with a JIRA instance  # Place a custom icon at {{<JIRA-INSTALL>/atlassian-jira/icons/}}  # Navigate to *JIRA Administration > g g > Issue Types*  # Click Edit, specify the new icon  # Go to Confluence, in the editor: *Insert > JIRA Issue*  # Notice that the icon is already not displayed and is used as a background of the {{<span>}} instead    Tested with Confluence 5.1.4 hooked up with JIRA 5.2.11. (Sample file attached to this ticket)  ",2
"CONFSERVER-30071","07/23/2013 18:29:30","Excessive CPU usage with Firefox when viewing page with Attachments macro","When viewing a page containing the Attachments macro with Confluence 5.2-beta1 (which is running the recently-posted Attachments plugin 3.6.7 from CONF-22002), Firefox 22 consistently consumes 50-100% of CPU.    Navigating away from the page seems to cure the problem, as does removing the attachments macro. At least one other browser (Safari) does not seem to be impacted in the same way.",5
"CONFSERVER-30077","07/24/2013 02:34:11","JIRA issue macro aggressively caches, new issues take a while to appear in the issues macro ","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-30077].   {panel}  The new JIRA Issue macro, accessible via Insert > JIRA Issue, does not allow the user the configure caching. Currently it's always on. The problem here is that with caching always enabled, the information shown in Confluence is not always up-to-date.    h4. Steps to reproduce  # In JIRA, create a project with a key of TEST  # Create one issue under TEST  # On the Confluence editor, use Insert > JIRA Issue, and set the JQL to ""project=TEST"". Save the macro and page. One issue is shown  # Create another issue under TEST  # Refresh the Confluence page. The second issue does not appear until the cache is expired, or if it's flushed manually via Confluence Admin > Cache Statistics    A workaround solution, You can remove the cache by following steps:   # Go to the page ""Confluence Admin >> Cache Statistics >> Advanced""  # Search for the term ""JIRA Issues"".   # Change the value from ""100"" (default) to ""1""   # Click the button ""Adjust Size"" to enable the change.     h4. Other issues  This is a related but separate issue from CONF-22845, which addresses the original JIRA Issues macro.",0
"CONFSERVER-30079","07/24/2013 05:53:39","NullPointerException when attempting to render a JIRA issue where the resolution field has been hidden","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-30079].   {panel}  Steps to reproduce:  * Create an issue in JIRA (e.g. FOO-1).  * Change the field configuration of that issue to set ""Resolution"" to ""Hide"" (if using the default Field Configuration, this can be done at /secure/admin/ViewIssueFields.jspa).  * Edit a page in Confluence and insert a JIRA issue macro referencing FOO-1.  * Save or Preview the page.    *Expected result:* FOO-1 should be rendered by the macro as normal.    *Actual result:* The following error is displayed:  {quote}  Error rendering macro 'jira' : com.atlassian.confluence.macro.MacroExecutionException: java.lang.NullPointerException  {quote}    Full stack trace from the logs:  {noformat}  2013-07-24 14:49:30,853 ERROR [TP-Processor1] [confluence.extra.jira.JiraIssuesMacro] throwMacroExecutionException Macro execution exception:   -- referer: https://mknight.jira-dev.com/wiki/pages/createpage.action?spaceKey=NEW&fromPageId=4554754 | url: /wiki/display/NEW/Tester | userName: sysadmin | action: viewpage | page: 4554758  java.lang.NullPointerException   at com.atlassian.confluence.extra.jira.JiraIssuesMacro.setupContextMapForStaticSingleIssue(JiraIssuesMacro.java:739)   at com.atlassian.confluence.extra.jira.JiraIssuesMacro.populateContextMapForStaticSingleIssue(JiraIssuesMacro.java:686)   at com.atlassian.confluence.extra.jira.JiraIssuesMacro.createContextMapFromParams(JiraIssuesMacro.java:551)   at com.atlassian.confluence.extra.jira.JiraIssuesMacro.execute(JiraIssuesMacro.java:1385)   at com.atlassian.confluence.content.render.xhtml.view.macro.ViewMacroMarshaller.marshal(ViewMacroMarshaller.java:95)   at com.atlassian.confluence.content.render.xhtml.view.macro.ViewMacroMarshaller.marshal(ViewMacroMarshaller.java:27)   at com.atlassian.confluence.content.render.xhtml.UnmarshalMarshalFragmentTransformer.transform(UnmarshalMarshalFragmentTransformer.java:27)   at com.atlassian.confluence.content.render.xhtml.transformers.DefaultFragmentTransformer.transformFragment(DefaultFragmentTransformer.java:125)   at com.atlassian.confluence.content.render.xhtml.transformers.DefaultFragmentTransformer.transform(DefaultFragmentTransformer.java:101)   at com.atlassian.confluence.content.render.xhtml.storage.StorageXhtmlTransformer.transform(StorageXhtmlTransformer.java:44)   at com.atlassian.confluence.content.render.xhtml.TransformerChain.transform(TransformerChain.java:41)   at com.atlassian.confluence.content.render.xhtml.PluggableTransformerChain.transform(PluggableTransformerChain.java:53)   at com.atlassian.confluence.content.render.xhtml.DefaultRenderer.render(DefaultRenderer.java:80)   at com.atlassian.confluence.content.render.xhtml.DefaultRenderer.render(DefaultRenderer.java:68)   at com.atlassian.confluence.content.render.xhtml.DefaultRenderer.render(DefaultRenderer.java:58)   at com.atlassian.confluence.content.render.xhtml.DeviceTypeAwareRenderer.render(DeviceTypeAwareRenderer.java:42)   at com.atlassian.confluence.pages.actions.ViewPageAction.execute(ViewPageAction.java:261)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:168)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.ConfluenceWorkflowInterceptor.intercept(ConfluenceWorkflowInterceptor.java:64)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.xwork.interceptors.XsrfTokenInterceptor.intercept(XsrfTokenInterceptor.java:100)   at com.atlassian.confluence.xwork.ConfluenceXsrfTokenInterceptor.intercept(ConfluenceXsrfTokenInterceptor.java:26)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.interceptors.CaptchaInterceptor.intercept(CaptchaInterceptor.java:49)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.validation.MessageHolderInterceptor.intercept(MessageHolderInterceptor.java:42)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.util.LoggingContextInterceptor.intercept(LoggingContextInterceptor.java:49)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.CancellingInterceptor.intercept(CancellingInterceptor.java:23)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.xwork.HttpMethodValidationInterceptor.intercept(HttpMethodValidationInterceptor.java:72)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.websudo.WebSudoInterceptor.intercept(WebSudoInterceptor.java:36)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.themes.ThemeContextInterceptor.intercept(ThemeContextInterceptor.java:68)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.actions.PermissionCheckInterceptor.intercept(PermissionCheckInterceptor.java:57)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.setup.webwork.BootstrapAwareInterceptor.intercept(BootstrapAwareInterceptor.java:26)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.user.actions.UserAwareInterceptor.intercept(UserAwareInterceptor.java:58)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.pages.actions.CommentAwareInterceptor.intercept(CommentAwareInterceptor.java:50)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.pages.actions.PageAwareInterceptor.intercept(PageAwareInterceptor.java:151)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.spaces.actions.SpaceAwareInterceptor.intercept(SpaceAwareInterceptor.java:77)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.xwork.FlashScopeInterceptor.intercept(FlashScopeInterceptor.java:25)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.actions.LastModifiedInterceptor.intercept(LastModifiedInterceptor.java:31)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.ConfluenceAutowireInterceptor.intercept(ConfluenceAutowireInterceptor.java:49)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.xwork.interceptors.TransactionalInvocation.invokeAndHandleExceptions(TransactionalInvocation.java:76)   at com.atlassian.xwork.interceptors.TransactionalInvocation.invokeInTransaction(TransactionalInvocation.java:61)   at com.atlassian.xwork.interceptors.XWorkTransactionInterceptor.intercept(XWorkTransactionInterceptor.java:56)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.xwork.SetupIncompleteInterceptor.intercept(SetupIncompleteInterceptor.java:43)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.interceptors.XXSSSecurityHeaderInterceptor.intercept(XXSSSecurityHeaderInterceptor.java:21)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.DefaultActionProxy.execute(DefaultActionProxy.java:115)   at com.atlassian.confluence.servlet.ConfluenceServletDispatcher.serviceAction(ConfluenceServletDispatcher.java:57)   at com.opensymphony.webwork.dispatcher.ServletDispatcher.service(ServletDispatcher.java:199)   at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.labs.botkiller.BotKillerFilter.doFilter(BotKillerFilter.java:30)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:25)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsDispatcherFilter.doFilter(PrettyUrlsDispatcherFilter.java:60)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFilter.doFilter(PrettyUrlsSiteMeshFilter.java:70)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsMatcherFilter.doFilter(PrettyUrlsMatcherFilter.java:56)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.plugins.mobile.filter.ViewPageActionRedirectFilter.doFilter(ViewPageActionRedirectFilter.java:45)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.plugins.mobile.filter.CanUseFilter.doFilter(CanUseFilter.java:61)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.ServletContextThreadLocalFilter.doFilter(ServletContextThreadLocalFilter.java:21)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.UserNameHeaderFilter.doFilter(UserNameHeaderFilter.java:26)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.UserThreadLocalFilter.doFilter(UserThreadLocalFilter.java:41)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.seraph.filter.SecurityFilter.doFilter(SecurityFilter.java:211)   at com.atlassian.confluence.web.filter.ConfluenceSecurityFilter.doFilter(ConfluenceSecurityFilter.java:28)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.seraph.filter.BaseLoginFilter.doFilter(BaseLoginFilter.java:150)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.oauth.serviceprovider.internal.servlet.OAuthFilter.doFilter(OAuthFilter.java:55)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.johnson.filters.AbstractJohnsonFilter.doFilter(AbstractJohnsonFilter.java:41)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:646)   at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:436)   at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:374)   at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:302)   at com.atlassian.confluence.servlet.simpledisplay.SimpleDisplayServlet.service(SimpleDisplayServlet.java:63)   at com.atlassian.confluence.servlet.SpringManagedServlet.service(SpringManagedServlet.java:64)   at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.labs.botkiller.BotKillerFilter.doFilter(BotKillerFilter.java:36)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:25)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.agmp.gdata.servlet.GDataServiceErrorServletFilter.doFilter(GDataServiceErrorServletFilter.java:43)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.studio.core.servlet.filter.AlacarteLicenseEnforcer.doFilter(AlacarteLicenseEnforcer.java:71)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.mywork.client.filter.ServingRequestsFilter.doFilter(ServingRequestsFilter.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsDispatcherFilter.doFilter(PrettyUrlsDispatcherFilter.java:60)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFilter.doFilter(PrettyUrlsSiteMeshFilter.java:70)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsMatcherFilter.doFilter(PrettyUrlsMatcherFilter.java:56)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.security.websudo.MessagesDecoratorFilter.doFilter(MessagesDecoratorFilter.java:59)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)   at com.atlassian.confluence.util.profiling.ProfilingPageFilter.doFilter(ProfilingPageFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.plugin.remotable.plugin.module.permission.ApiScopingFilter.doFilter(ApiScopingFilter.java:62)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.jmx.JmxFilter.doFilter(JmxFilter.java:106)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.ServletContextThreadLocalFilter.doFilter(ServletContextThreadLocalFilter.java:21)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.LoggingContextFilter.doFilter(LoggingContextFilter.java:40)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.UserNameHeaderFilter.doFilter(UserNameHeaderFilter.java:26)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.UserThreadLocalFilter.doFilter(UserThreadLocalFilter.java:41)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.seraph.filter.SecurityFilter.doFilter(SecurityFilter.java:211)   at com.atlassian.confluence.web.filter.ConfluenceSecurityFilter.doFilter(ConfluenceSecurityFilter.java:28)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.ThreadLocalCacheFilter.doFilter(ThreadLocalCacheFilter.java:22)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.security.auth.trustedapps.filter.TrustedApplicationsFilter.doFilter(TrustedApplicationsFilter.java:98)   at com.atlassian.confluence.util.AbstractBootstrapHotSwappingFilter.doFilter(AbstractBootstrapHotSwappingFilter.java:30)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.seraph.filter.BaseLoginFilter.doFilter(BaseLoginFilter.java:150)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.oauth.serviceprovider.internal.servlet.OAuthFilter.doFilter(OAuthFilter.java:55)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.core.filters.ServletContextThreadLocalFilter.doFilter(ServletContextThreadLocalFilter.java:21)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.ClusterHeaderFilter.doFilter(ClusterHeaderFilter.java:37)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.johnson.filters.AbstractJohnsonFilter.doFilter(AbstractJohnsonFilter.java:72)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at org.springframework.orm.hibernate.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:170)   at com.atlassian.spring.filter.FlushingSpringSessionInViewFilter.doFilterInternal(FlushingSpringSessionInViewFilter.java:29)   at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.ConfluenceErrorFilter.doFilter(ConfluenceErrorFilter.java:22)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.util.profiling.filters.ProfilingFilter.doFilter(ProfilingFilter.java:99)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.core.datetime.RequestTimeThreadLocalFilter.doFilter(RequestTimeThreadLocalFilter.java:35)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.gzipfilter.GzipFilter.doFilterInternal(GzipFilter.java:80)   at com.atlassian.gzipfilter.GzipFilter.doFilter(GzipFilter.java:51)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.cache.AbstractCachingFilter.doFilter(AbstractCachingFilter.java:33)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.plugin.remotable.plugin.module.oauth.OAuth2LOFilter.doFilter(OAuth2LOFilter.java:70)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.plugin.remotable.host.common.service.http.bigpipe.BigPipeRequestIdFilter.doFilter(BigPipeRequestIdFilter.java:33)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.analytics.client.filter.AnalyticsFilter.doFilter(AnalyticsFilter.java:28)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.extra.webdav.servlet.filter.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:43)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.validateparam.RequestParamValidationFilter.doFilter(RequestParamValidationFilter.java:58)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.TranslationModeFilter.doFilter(TranslationModeFilter.java:43)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.plugin.servlet.filter.ActionContextCleanUp.doFilter(ActionContextCleanUp.java:71)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.LanguageExtractionFilter.doFilter(LanguageExtractionFilter.java:53)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.RequestCacheThreadLocalFilter.doFilter(RequestCacheThreadLocalFilter.java:25)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.encoding.AbstractEncodingFilter.doFilter(AbstractEncodingFilter.java:41)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.HeaderSanitisingFilter.doFilter(HeaderSanitisingFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.servlet.FourOhFourErrorLoggingFilter.doFilter(FourOhFourErrorLoggingFilter.java:65)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)   at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)   at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)   at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)   at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)   at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)   at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:291)   at org.apache.jk.common.ChannelSocket.invoke(ChannelSocket.java:776)   at org.apache.jk.common.ChannelSocket.processConnection(ChannelSocket.java:705)   at org.apache.jk.common.ChannelSocket$SocketConnection.runIt(ChannelSocket.java:898)   at org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:690)   at java.lang.Thread.run(Thread.java:662)  2013-07-24 14:49:30,859 ERROR [TP-Processor1] [xhtml.view.macro.ViewMacroMarshaller] marshal Exception executing macro: jira, with message: com.atlassian.confluence.macro.MacroExecutionException: java.lang.NullPointerException  {noformat}    If the Resolution field is set back to ""Show"", you will also need to flush Confluence's caches to get the macro working as expected (i.e. ""Flush All"" on /wiki/admin/cachestatistics.action).     h5. Workaround:  Uninstall JIRA Macros Plugin v5.0 and then download v4.0.29 from [Marketplace|https://marketplace.atlassian.com/plugins/confluence.extra.jira/versions] and manually upload it into Confluence from the Plugin manager (Manage Add-Ons > Upload Add-On).",0.5
"CONFSERVER-30114","07/26/2013 06:25:00","Ability to sort issues in the JIRA issues macro table","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-30114].   {panel}  In the new release of the JIRA issues macro, it is not possible to short the columns inside a table.    This feature request is to sort columns from viewpage for the JIRA issues macro. ",8
"CONFSERVER-30116","07/26/2013 06:29:55","Ability to configure the maximum number of issues displayed in the JIRA issues macro","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-30116].   {panel}  In earlier versions, the JIRA issue macro had a pagination feature. This feature was removed due to observed low feature usage, in addition with our strategic focus to simplify the Confluence user interface and to keep and complex JIRA operations in JIRA. My apologies for the may customers that were quickly impacted by this, we could have done a better job in communicating this and ensuring we had understood your needs with regards to this matter.     Since then we've received a lot of feedback to bring back pagination. Thank you for those of you who provided helpful comments below, and for those customers we have been able to speak to about this. With this in mind, we have concluded the following:    * It is very clear that the current issue limit we have is insufficient and does not meet most of your needs.   * It is important for you to be able to see _all_ the issues requested   * We still believe that the use case of navigating 100+ issues within inside Confluence is something that is extremely low and is something which should be done in JIRA.   * Some of you mentioned of the importance of seeing this also in PDF exports when you share the release notes or pages with customers.     With that in mind, what will we be doing to address this?  1. We will look at increasing the limit of the total number of visible issues  2. In addition, we will look at providing a parameter to configure this.  *Note:* You will always be limited by the total amount of issues JIRA provides, but [this setting can be changed|https://confluence.atlassian.com/display/ONDEMANDKB/Changing+maxResults+Parameter+for+JIRA+REST+API].  3. We will be looking at also implementing CONF-30114 (sorting) to assist with dealing with larger issue lists in Confluence.     Thank you all for your patience in this matter, we will update this issue as we make progress.     Sherif Mansour  Confluence Product Manager    Previous description:   {panel}  The new JIRA issues macro does not paginate. This feature request is to help us better understand why customers want this.   If you are going to comment on this ticket, please provide some understanding for why you want pagination. We removed this feature because we saw very low usage of it. Since then, we've had a few requests to bring it back.     One way we could solve the majority use case is to increase the default amount of search results displayed. We are a bit hesitant to bring this back as we want to understand what it is that we are missing. If you are embedding 50/100+ issues on a page and want pagination, you probably shouldn't be doing that in Confluence, but rather the JIRA issue navigator - that is why we tell you ""there are xxx more issues, open in JIRA"".     Please help us understand why you want this and some examples where you really do have lots of issues on a page that you want your end-users to read (if that is the use case)  {panel} ",0
"CONFSERVER-51714","07/31/2013 04:26:42","Accept an answer","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51714].   {panel}  As an employee, I want to mark an answer as the ""accepted"" answer.",13
"CONFSERVER-51736","07/31/2013 04:33:10","When asking a question notify users of similar questions","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51736].   {panel}  This is intended to reduce the number of duplicate questions on the system. ",5
"CONFSERVER-51737","08/08/2013 06:39:08","link a CQ topic to a Hipchat room","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51737].   {panel}  ",13
"CONFSERVER-51705","08/08/2013 07:17:00","As a space admin, I want to display a list of questions on my page","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51705].   {panel}  macro parameters include:  * (must have) restrict to these topics (and / or) - e.g. (design AND faq)  * (nice to have) sort by: newest (default), oldest, most popular  * (nice to have) maximum number of questions to display  * (nice to have) show only answered or unanswered questions  * (nice to have) display just questions or questions + answers",8
"CONFSERVER-30428","08/16/2013 06:24:27","JIRA Issues Macro filter behaviour has changed so that it no longer saves the filter, but rather hard-codes the results.","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-30428].   {panel}  h3. The problem  Inserting a URL to a saved filter, eg {{http://localhost:9604/browse/TEST-3?filter=10000}} autocompletes to the JQL content of the filter - 'description ~ ""description""' in my test case - so when filter 10000 changes, the JIRA Issues  will still be 'description ~ ""description""'. This is not the same as previous behaviour, where the filter would remain in the macro and changes to the filter would be reflected in Confluence.    h3. Steps to Reproduce  # Create and view a filter in JIRA  # Copy the URL  # Create a JIRA Issues Macro in Confluence 5.2.3  # Paste the URL into the macro  #- Observe that the URL is immediately changed to the JQL of the filter.  # Save the JIRA Issues Macro  # Change the filter in JIRA so that the results are different  # Reload the Confluence page  #- Observe that the results do not reflect the changes to the filter",1
"CONFSERVER-30575","08/27/2013 19:13:29","The confluence-space-ia plugin is missing from the Confluence source distribution","The {{confluence-space-ia}} plugin, new in Confluence 5.x, is not currently included in the Confluence source distribution.    Customers would like to be able to access the source code to this plugin in order to customize it and/or learn how to replicate certain aspects of its behaviour.    This will be a general problem for new plugins. We need to solve this in a generic way, or identify missing plugins automatically.  ",2
"CONFSERVER-51754","09/13/2013 02:04:19","I want to be able to get a notification for every new question created regardless of topic","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51754].   {panel}  - An option to get notifications for all questions that are created.  - The tricky thing is where to place the button/checkbox for that.  - Should not send duplicate emails if I am also watching the topic for that question",8
"CONFSERVER-30874","09/20/2013 01:24:05","Re-searching the same JQL will not update the macro contents.","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-30874].   {panel}  I once had a JIRA Macro displaying all JIRA issues with a label ""MYLABEL"" (JQL: labels = ""MYLABEL""). This returned seven results.    I raised another ticket, and applied the label ""MYLABEL"". This did not update the macro contents on view, but I believe that is expected.    I edited the page, and then the macro, and re-searched (the same search that was there). This second search returned eight results. I saved the macro and saved the page.    Upon viewing the page, the JIRA Macro still had seven results.",0
"CONFSERVER-51712","09/24/2013 01:17:40","Support anonymous users in CQ","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51712].   {panel}  Add an ""anonymous use question"" permission to the questions configuration screen.",13
"CONFSERVER-47675","10/03/2013 23:09:03","Don't scale the topic avatar up","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47675].   {panel}  {quote}  I select an 48x48 png image and get a scaled up version of this to select the range?  If I do this I get a bad looking version of my good looking image with similar resolution.  {quote}    We should scale down the avatar if it's too big but shouldn't scale up if it's too small.",5
"CONFSERVER-47613","10/08/2013 21:31:44","Unable to submit a question in IE.  I get an error stating that I must add at least one topic.","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47613].   {panel}  We just installed the Confluence Questions beta after updating to Confluence 5.3.  It is immediately unusable.  When I go to Ask a Question, I enter the summary and description and then add some topic tags at the bottom. As soon as I hit the submit button, I get a red error indicating that I must add at least one topic.  I have tried adding one and also two topics to no avail.",5
"CONFSERVER-48045","10/11/2013 00:27:36","Question items appear on the popular stream for anonymous users even with restrictions in place","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-48045].   {panel}  Steps to reproduce:     # Create a question  # Navigate to Administration > Confluence Questions Configuration and restrict access to questions to a group of users (say confluence-users)  # Grant anonymous users ""use"" permission  # Logout and then navigate to Confluence dashboard   ",5
"CONFSERVER-31148","10/11/2013 03:34:17","JIRA Issues macro doesn't use display name for time tracking fields","h5. Symptoms    When using a JIRA Issues macro including any time tracking fields as columns, the column header is not the correct display name, for example:    * ""Original Estimate"" shows as ""Timeoriginalestimate""  * ""Σ Time Spent"" shows as ""Aggregatetimespent""    h5. Steps to Reproduce    * Add a JIRA Issues macro to a page in Confluence, linked to JIRA via application links  * Specify at least one column as a time tracking field  * View the macro after saving the page",8
"CONFSERVER-47813","10/14/2013 00:33:24","No visual feedback for topic icon upload","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47813].   {panel}  We need a spinner/throbber/something to indicate that the topic logo is being uploaded.    https://support.atlassian.com/browse/CQS-60",3
"CONFSERVER-31200","10/15/2013 22:20:27","Jira Issues Not Working for Confluence 5.3 and Jira 4.4","Jira issues macro version 5.1.x doesn't work properly when you link Confluence 5.3 with Jira 4.4 version.     h4.What's Working?    If you try to *Create a New Issue* it will work properly and you will be able to see the Jira issues within your Confluence page.    h4.What's not Working?    # *Search* feature isn't working. When you tip a search method in the field, the issues will display properly. However, when you click on *Insert* nothing happens and the dialog is still displayed.  # *Recently Viewed* option just display an 400 HTTP error:  !issue.png!    h4.Steps to Reproduce:     *On JIRA side*    # Install Jira 4.4 version  # Create an issue in JIRA    *On Confluence side*    # Install Confluence 5.3 version with Jira macros 5.1.x version  # Create an Application Link between both instances  # Edit/create a page  # Go to Insert > Jira Issues  # Click on Search and tip any issue key, search URL, JIRA link, JQL or plain text in order to display the issue(s)  # Click on Insert and the same symptom will happen  # Then, click on Recently viewed and the second symptom is displayed.",0
"CONFSERVER-31209","10/16/2013 11:14:06","Column titles in the jira macro do not respect the global language configured at all, and remains English","h4.Steps to Reproduce:  # Set the language of Confluence and JIRA to German, or French.  # Set the browser first language to the same language that you set for your Confluence.  # Insert Jira macro into a page     h4.Expected Results:  Column titles must be translated accordingly.    h4.Actual Results:  Column titles remain in English, and do not get translated.  !column.jpg|width=600!  ",3
"CONFSERVER-31255","10/21/2013 03:26:06","Page Tree Macro with ""Include Excerpts"" option shows raw HTML for formatted text","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-31255].   {panel}  h5. Symptoms    When using the Page Tree Macro, with ""Include Excerpts in Page Tree"" option, and an excerpt macro on one of the pages includes some text formatting, then the Page Tree Macro shows the raw HTML codes, rather than formatted or stripped text.    h5. Steps to Reproduce    # Create a page with an except macro, containing formatted text  # Create a page with a page tree macro, including the page with the excerpt  # Observe the excerpt with raw HTML codes in it    h5. Workaround    Don't use formatting in the excerpt macro.",3
"CONFSERVER-47802","10/22/2013 05:19:59","CQ keyboard shortcuts interfere with regular Confluence shortcuts","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47802].   {panel}  [~dloeng@atlassian.com] has had a quick look at this and fixed the immediate issue on PUG, but the theory is that changing the context of our keyboard shortcuts will stop the clash from occurring.",1
"CONFSERVER-51725","10/27/2013 10:15:15","As a question viewer I want to turn an answer into a comment","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51725].   {panel}  some people are posting answers that really should comments. you should be allowed to turn answers into comments.    Note - there should probably be a ""turn answers into comments"" permission in the system",13
"CONFSERVER-31488","11/05/2013 23:45:31","JIRA issues macro throws exceptions when applinks are not configured correctly","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-31488].   {panel}  Scenario 1:  1. Create applink to from Confluence to JIRA (2LO should be configured by default)  2. Insert JIM on a confluence page - see that it's rendered correctly  3. Disable the OAuth outgoing authentication from Confluence (Do not untick the ""Enable outgoing 2-Legged OAuth requests"" option  4. View the JIM again - see that a MacroExecutionException is displayed    Scenario 2:  1. Create applink to from Confluence to JIRA (2LO should be configured by default)  2. Insert JIM on a confluence page - see that it's rendered correctly  3. Disabled ""Enable outgoing 2-Legged OAuth requests"" from the JIRA incoming OAuth authentication  4. View the JIM again - see that a MacroExecutionException is displayed    Ideally we would display message to the end user indicating that there is an applink misconfiguration",3
"CONFSERVER-47594","11/06/2013 03:35:20","Downvote emails are not really anonymous","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47594].   {panel}  !https://s3.amazonaws.com/uploads.hipchat.com/10804/157979/7Op4DM7Y2te9XKq/%5BConfluence%5D+New+vote+for+an+answer+on+%22can+I+accept+a+question%3F%22+-+jhoarau%40atlassian.com+-+Atlassian+Mail+2013-11-06+14-26-18.png!",3
"CONFSERVER-31534","11/07/2013 23:56:23","When Epic Link is chosen as a display field in the JIRA macro, it should show Epic Name.","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-31534].   {panel}  This was recently fixed in Jira, where in Issue Navigator issues now show their Epic's name rather than the Epic's Issue Key.    In Confluence, the Epic's Issue Key is still displayed when using the JIRA macro.",3
"CONFSERVER-31663","11/17/2013 04:32:58","JIRA Issues Macro does not work using Basic Access application link as described in documentation","h4. Symptoms    In the JIRA Issues Macro documentation, it says that you can use Basic Access application link authentication, so that the issues that get displayed are those that the user in the application link has access to. This is no longer working, the only issues that can be viewed by an anonymous user, for example, are the ones that are viewable by an anonymous user in JIRA.    Whilst this makes logical sense from a security standpoint, our [documentation|https://confluence.atlassian.com/display/DOC/JIRA+Issues+Macro] explicitly says that you should be able to see any issues that the Basic Access user can see. This was also working in older versions of Confluence/JIRA Issues Macro.    h4. Steps to Reproduce    # Create an application link between JIRA and Confluence using Basic Access  # Create a page in Confluence, and add some JIRA issues  # Make sure that page is anonymously accessible and the JIRA issues are not anonymously accessible  # Load that page as anonymous (e.g. in incognito mode) and see that no issues are listed if it should be a table, or that only the issue key and no other details are showing if a single issue.",1
"CONFSERVER-31695","11/20/2013 11:38:17","Emoticons disappear when inserted directly before a link","SUMMARY  Confluence: Adding a check mark before a hyper link would fail silently.  STEPS TO REPRODUCE  1. Edit a page.  2. Insert a link to another page on a new line, then save.  3. Edit the page again and move the cursor to just before the link, then insert emoticon. See attached screenshot 1. Save.  RESULTS  After save, the checkmark does not show up. See attached screenshot 2.  WORKAROUND  1. Insert a space after the emoticon (before the hyperlink) and then click save. Then the emoticon stays.   2. Edit the page again and delete the space you added in step 1. Then save. Then the emoticon stays again whereas before it vanished.    Additional testing has show that emoticons can not be part of the title of a link. When inserting one directly next to a link in edit mode, the emoticon gets rendered (ie {code}(/){code} for check mark).  Upon saving the page, the emoticon will disappear.   When clicking on the link in edit mode, navigate to the edit option of the link and adding the ( / ) to the title there, the short cut for the emoticon will not get rendered after page save, and the title of the link will simply display the 3 characters ( / )    In effect this appears to relate to CONF-26042    Besides that, another additional testing on Confluence 5.4.4 shows that this issue cannot be replicated if the link inserted to the page is a web link.",3
"CONFSERVER-31708","11/21/2013 05:40:50","JIRA Issues Macro doesn't show resolution date","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-31708].   {panel}  Steps to replicate:    # Link together a JIRA 6.2-OD-03, Confluence 5.3-OD-12 instance (or just use OnDemand) and JIRA Macros v 5.2 is installed.   # Create an issue in JIRA and resolve it  # Create a page in Confluence,  # Add the JIRA Issues Macro and perform a JQL search for the issue in step 2. Under display options add the Resolved field.  # Save the page    Result:    Resolutiondate (all one word for some reason) will be displayed, but it will be empty    Expected result:    Resolution date will appear in the resolutiondate field.    PS: This is affecting Confluence 5.3/5.3.4 and also JIRA issues macro version 5.1.1 and 5.1.3.",5
"CONFSERVER-47633","12/11/2013 04:49:09","Content type icon for Questions doesn't show up in user's profile activity stream","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47633].   {panel}  ",8
"CONFSERVER-31934","12/11/2013 11:54:22","Unable to create issues from Confluence when linked to EPICs","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-31934].   {panel}  Steps to reproduce:    - Highlight a text in a Confluence page and click on the popup to create JIRA issue.  - Make sure the ""Link to epic"" is available and tick it.  - You will be faced with this error:    !conf-3.png!    In the logs, I observed the following stack :    {code}  2013-12-11 16:14:42.974261500 com.atlassian.sal.api.net.ResponseStatusException: Unexpected response received. Status code: 400  2013-12-11 16:14:42.974271500  at com.atlassian.applinks.core.auth.ApplicationLinksStringReturningResponseHandler.handle(ApplicationLinksStringReturningResponseHandler.java:19)  2013-12-11 16:14:42.974273500  at com.atlassian.applinks.core.auth.ApplicationLinksStringReturningResponseHandler.handle(ApplicationLinksStringReturningResponseHandler.java:13)  2013-12-11 16:14:42.974274500  at com.atlassian.applinks.core.auth.trusted.TrustedApplinksReturningResponseHandler.handleNormally(TrustedApplinksReturningResponseHandler.java:40)  2013-12-11 16:14:42.974277500  at com.atlassian.applinks.core.auth.trusted.TrustedApplinksReturningResponseHandler.handle(TrustedApplinksReturningResponseHandler.java:28)  2013-12-11 16:14:42.974282500  at com.atlassian.plugins.rest.module.jersey.JerseyRequest$2.handle(JerseyRequest.java:166)  2013-12-11 16:14:42.974282500  at com.atlassian.sal.core.net.HttpClientRequest.executeAndReturn(HttpClientRequest.java:351)  2013-12-11 16:14:42.974283500  at com.atlassian.plugins.rest.module.jersey.JerseyRequest.executeAndReturn(JerseyRequest.java:161)  2013-12-11 16:14:42.974285500  at com.atlassian.applinks.core.auth.ApplicationLinkRequestAdaptor.executeAndReturn(ApplicationLinkRequestAdaptor.java:78)  2013-12-11 16:14:42.974286500  at com.atlassian.applinks.core.auth.trusted.TrustedRequest.executeAndReturn(TrustedRequest.java:51)  2013-12-11 16:14:42.974287500  at com.atlassian.applinks.core.auth.AbstractApplicationLinkRequest.execute(AbstractApplicationLinkRequest.java:159)  2013-12-11 16:14:42.974289500  at com.atlassian.confluence.extra.jira.DefaultJiraIssuesManager.createAndUpdateResultForJiraIssue(DefaultJiraIssuesManager.java:474)  2013-12-11 16:14:42.974290500  at com.atlassian.confluence.extra.jira.DefaultJiraIssuesManager.createIssuesInSingle(DefaultJiraIssuesManager.java:313)  2013-12-11 16:14:42.974291500  at com.atlassian.confluence.extra.jira.DefaultJiraIssuesManager.createIssues(DefaultJiraIssuesManager.java:297)  2013-12-11 16:14:42.974294500  at com.atlassian.confluence.plugins.jira.CreateJiraIssueResource.createJiraIssues(CreateJiraIssueResource.java:70)  2013-12-11 16:14:42.974295500  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  2013-12-11 16:14:42.974295500  at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)  2013-12-11 16:14:42.974296500  at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)  2013-12-11 16:14:42.974298500  at java.lang.reflect.Method.invoke(Method.java:597)  {code}      Reasons: This is a known limitation where issues cannot be created with Epic links if the ""Epic Links"" field is not enabled as a  field in a default screen in JIRA. Created with Epic links if the ""Epic Links"" field is not enabled as a default field in JIRA.  Workaround:   1. Not select an epic to link the issues to.   2. Add epic link as a field in default screen via secure/admin/ConfigureFieldScreen.jspa?id=1 with admin privileges.  ",3
"CONFSERVER-32067","12/22/2013 23:17:59","Too many JiraChannelResponseHandler objects cached on Confluence taking too much memory","While investigating the latest EAC outage I found that there were too many large objects consuming old gen memory.    One of the offenders is the JiraChannelResponseHandler. See screenshot -    !jira.png!    So 840 objects consuming an average of 70Kb each is not reasonable (for EAC anyway, especially in conjunction with some of our other heavy cache using plugins).    Regardless of any actual bug fix you might consider making could you please also get in touch with me and advise on what kind of tuning of caches etc I should be performing on EAC to avoid this much memory being consumed again.",5
"CONFSERVER-32187","01/10/2014 21:46:33","Confluence uses Display URL when rendering links to JIRA Pie Chart image","Confluence correctly uses the Display URL when rendering links to JIRA issues in Confluence.     However, it also uses the Display URL when rendering the url for pie chart images, even though those images are not interactive. It seems that since the chart image only provides information from JIRA, it should use the Application URL instead.     h3.STEPS TO REPRODUCE    * Install Confluence 5.4.1, JIRA 6.1.5  * Create application link, without changing the Display URL  * In Confluence, create a JIRA Status report  * Charts should display as expected  * In Confluence, re-configure the application link by changing the display URL to a fake url (e.g., http://www.fakehost.com/jira)  * Chart images are now broken (see screenshot)    Network information from Google Developer Toolbar shows the GET request and the resulting response (see screenshot).    ",1
"CONFSERVER-32234","01/15/2014 09:18:02","JIRA Issue Macro not Rendering HTML in custom fields ","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-32234].   {panel}  h5. Steps to reproduce:    # Create a custom field in JIRA that contains any HTML within the custom field.  # In Confluence, include a JIRA Issue Macro in a page, and retrieve a list of issues that contains the custom field above.  # HTML in those custom fields will not be rendered and it will show plain text exposing the HTML tags.    h5. Workaround    No workaround yet.    h5.Screen shot:    !htmlbroken.png|thumbnail!  ",3
"CONFSERVER-32258","01/17/2014 03:32:32","Chrome locks up when pasting URL into editor","I pasted https://jira.atlassian.com/issues/?jql=reporter%20%3D%20igrunert%20and%20project%20in%20(%22Confluence%20Team%20Calendars%22%2C%20Confluence%2C%20%22Confluence%20Development%22%2C%20%22Confluence%20Questions%22) into the comment editor, and it kills the page. I think this is an autoconvert infinite loop.",3
"CONFSERVER-32306","01/21/2014 02:35:01","If URL doesn't match baseURL, creating a inline actions JIRA issue results in ""Unable to get a list of linked JIRA servers from Confluence.""","*Steps to Reproduce:*  # Note your baseURL  # Create an application link to (for example) https://jira.atlassian.com  # access your instance via a URL that isn't what you've set in your baseURL. For example, I used http://127.0.0.1:10540/confluence  # Attempt to create a JIRA issue via the inline action popup    This results in the following:  !Screen Shot 2014-01-21 at 1.30.53 PM.png!  ",1
"CONFSERVER-32457","02/02/2014 22:31:56","Editor toolbar behaves incorrectly on quick edit","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-32457].   {panel}  There are strange behaviors with quickedit. Most of the issues revolve around using the editor toolbar in quick edit (not in full edit).  These have been confirmed in 5.4.1. (as long as quick-edit is enabled) and possibly go back to 5.1    Using options like bold now adds additional blank lines after the content  !bold.gif|width=100%!    When attempting to user the list toolbar buttons on quick-edit of a blank page I'm seeing the following in the logs, coming out of 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-extensions' 'jscripts/tiny_mce/plugins/lists/editor_plugin_src.js'. The button will not work again until the user clicks inside the body    !number.gif|width=100%!    {code}  Uncaught NotFoundError: An attempt was made to reference a Node in a context where it does not exist. VM1756:2720  ab VM1756:2720  (anonymous function) VM1756:2720  b.each VM1756:2115  V VM1756:2720  N VM1756:2720  y VM1756:2720  b.each VM1756:2115  tinymce.create.splitSafeEach VM1756:2720  tinymce.create.process VM1756:2720  tinymce.create.applyList VM1756:2720  (anonymous function) VM1756:2720  n.create.execCommand VM1756:2610  aspect batch.js:245  (anonymous function) VM1756:2698  tinymce.create.dispatch VM1756:2126  (anonymous function) VM1756:2885  d.event.dispatch batch.js:73  g.handle.i  {code}",3
"CONFSERVER-32523","02/05/2014 15:31:43","JIRA Links Button Missing when Create a Link to an Existing Page with JIRA Links","*Please note: this issue is marked as resolved in Confluence 5.5, but you will also need version 6.2 or later of JIRA (and if using JIRA Agile, 6.3.8 or later)*    In the meantime, it's possible to manually force the cached count to be updated by making an edit to the Confluence page.    -----    With JIRA 6.1.5    h6. Steps to Replicate  # Ensure the Application Links is configured correctly  # Ensure Remote API Calls is enabled in JIRA  # Create a new space with a new page (e.g: 'Page A') in Confluence, and insert a new issue using JIRA Issue Macro in the page  # The JIRA links button is displayed in this new page  # In JIRA, try to link an Agile Report/Board/Sprint to the newly created page ('Page A')  # Go back to Confluence, click on the JIRA links button in the 'Page A' and see if the JIRA Agile Report/Board/Sprint is shown  # Create another Agile Report/Board/Sprint and Link it to 'Page A' in Confluence  # The link is missing    Scenario 2:  # Make a page A in Confluence.  # Link to that page from JIRA.   # No links are shows on page A in Confluence",5
"CONFSERVER-32525","02/05/2014 22:06:38","Pages/Blogs timeout if they contain too many JIRA Issues Macros ","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-32525].   {panel}  When a page/blog has too many JIRA Issues Macros, the page times out as Confluence tries to make JIRA calls for all the macros.    The correct behaviour should be to call JIRA asynchronously and timeout the individual macros, not the page.    The number of calls that JIRA can handle should also be considered. We should avoid overloading JIRA.    h3. Workaround:    Split out the JIRA Issues Macro onto separate pages.    Also avoid using functionality that avoids loading multiple pages at once, such as viewing the blogs posts of a space, as this will trigger many calls to JIRA simultaneously.    h3. Fix  Upgrade to [JIRA Macros version 5.5.4|https://marketplace.atlassian.com/plugins/confluence.extra.jira]. This was bundled in Confluence 5.5.    h3. Important note:  This fix makes use of JIRA request batching which is only available since JIRA *6.0.29*. For the older version of JIRA (5+), this fix has no effect.",8
"CONFSERVER-32633","02/17/2014 01:21:55","Editing a link in link dialog shows all the breadcrumbs text and it spans multiple lines","Editing a link shows the full breadcrumb path even for very long breadcrumbs, instead of putting an ellipsis between the first and last breadcrumb elements.    http://cl.ly/image/2V2S1q262z2z    ",3
"CONFSERVER-50009","02/21/2014 01:42:32","Calendar with public and private filters shows no events","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-50009].   {panel}  A shared calendar that contains JIRA Issue events from both public and private filters will not show any events _at all_ for users if one of the private filters is restricted from them.     h3.Steps to Reproduce    * Create a new calendar and add JIRA Issue events from a filter shared with everyone  * Add JIRA Issue events from a filter that is restricted to the creator  * Add the calendar to a shared page  * Navigate to the page as a user who is restricted from the private filter. The calendar will be empty (screenshot: calendar_userview.png). The expected behavior is that the calendar would at least show the events from the public filter. Users who have permission to view the events from all filters will see all the events (screenshot: calendar_adminview.png)    h3.Log Errors    {code}  2014-02-20 17:20:58,994 ERROR [http-8541-7] [extra.calendar3.calendarstore.JiraCalendarDataStore] getSubCalendarJql Unable to get details of search filter 10004   -- url: /confluence/rest/calendar-services/1.0/calendar/subcalendars.json | userName: thing1 | referer: http://localhost:8541/confluence/display/CS/Calendar+Space+Home  com.atlassian.confluence.extra.calendar3.calendarstore.JiraAccessor$JiraPreConditionUnmetException   at com.atlassian.confluence.extra.calendar3.calendarstore.DefaultJiraAccessor$15.handle(DefaultJiraAccessor.java:1227)   at com.atlassian.confluence.extra.calendar3.calendarstore.DefaultJiraAccessor$15.handle(DefaultJiraAccessor.java:1195)   at com.atlassian.applinks.core.auth.oauth.OAuthApplinksResponseHandler.handle(OAuthApplinksResponseHandler.java:61)   at com.atlassian.applinks.core.auth.ApplicationLinkRequestAdaptor$1.handle(ApplicationLinkRequestAdaptor.java:87)   at com.atlassian.plugins.rest.module.jersey.JerseyRequest$2.handle(JerseyRequest.java:166)   at com.atlassian.sal.core.net.HttpClientRequest.executeAndReturn(HttpClientRequest.java:351)   at com.atlassian.plugins.rest.module.jersey.JerseyRequest.executeAndReturn(JerseyRequest.java:161)   at com.atlassian.applinks.core.auth.ApplicationLinkRequestAdaptor.execute(ApplicationLinkRequestAdaptor.java:84)   at com.atlassian.applinks.core.auth.oauth.OAuthRequest.execute(OAuthRequest.java:43)   at com.atlassian.confluence.extra.calendar3.calendarstore.DefaultJiraAccessor.getSearchFilterJql(DefaultJiraAccessor.java:1195)   at com.atlassian.confluence.extra.calendar3.calendarstore.AbstractJiraSubCalendarDataStore.getSubCalendarJql(AbstractJiraSubCalendarDataStore.java:968)   at com.atlassian.confluence.extra.calendar3.calendarstore.AbstractJiraSubCalendarDataStore.getSubCalendarWarnings(AbstractJiraSubCalendarDataStore.java:903)   at com.atlassian.confluence.extra.calendar3.calendarstore.AbstractJiraSubCalendarDataStore.getSubCalendarWarnings(AbstractJiraSubCalendarDataStore.java:70)   at com.atlassian.confluence.extra.calendar3.calendarstore.CalendarDataStoreCachingDecorator.getSubCalendarWarnings(CalendarDataStoreCachingDecorator.java:339)   at com.atlassian.confluence.extra.calendar3.calendarstore.DelegatingCalendarDataStore.getSubCalendarWarnings(DelegatingCalendarDataStore.java:172)   at com.atlassian.confluence.extra.calendar3.DefaultCalendarManager.getSubCalendarWarnings(DefaultCalendarManager.java:191)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.getSubCalendarWarnings(CalendarResource.java:297)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.toExtendedSubCalendar(CalendarResource.java:260)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.toExtendedSubCalendar(CalendarResource.java:255)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.access$100(CalendarResource.java:95)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource$2.apply(CalendarResource.java:217)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource$2.apply(CalendarResource.java:213)   at com.google.common.collect.Iterators$8.next(Iterators.java:782)   at com.google.common.collect.Iterators$7.computeNext(Iterators.java:644)   at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:141)   at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:136)   at com.google.common.collect.Lists.newArrayList(Lists.java:138)   at com.google.common.collect.Collections2$FilteredCollection.toArray(Collections2.java:228)   at java.util.ArrayList.<init>(ArrayList.java:151)   at com.google.common.collect.Lists.newArrayList(Lists.java:119)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.getSubcalendarsInternal(CalendarResource.java:208)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.getSubCalendarsResponse(CalendarResource.java:165)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.access$000(CalendarResource.java:95)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource$1.doInTransaction(CalendarResource.java:157)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource$1.doInTransaction(CalendarResource.java:154)   at com.atlassian.sal.core.transaction.HostContextTransactionTemplate$1.doInTransaction(HostContextTransactionTemplate.java:25)   at com.atlassian.sal.spring.component.SpringHostContextAccessor$1.doInTransaction(SpringHostContextAccessor.java:88)   at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:128)   at com.atlassian.sal.spring.component.SpringHostContextAccessor.doInTransaction(SpringHostContextAccessor.java:82)   at sun.reflect.GeneratedMethodAccessor95.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:601)   at com.atlassian.plugin.osgi.hostcomponents.impl.DefaultComponentRegistrar$ContextClassLoaderSettingInvocationHandler.invoke(DefaultComponentRegistrar.java:129)   at com.sun.proxy.$Proxy233.doInTransaction(Unknown Source)   at sun.reflect.GeneratedMethodAccessor95.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:601)   at com.atlassian.plugin.osgi.bridge.external.HostComponentFactoryBean$DynamicServiceInvocationHandler.invoke(HostComponentFactoryBean.java:154)   at com.sun.proxy.$Proxy233.doInTransaction(Unknown Source)   at com.atlassian.sal.core.transaction.HostContextTransactionTemplate.execute(HostContextTransactionTemplate.java:21)   at sun.reflect.GeneratedMethodAccessor147.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:601)   at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:307)   at org.springframework.osgi.service.importer.support.internal.aop.ServiceInvoker.doInvoke(ServiceInvoker.java:58)   at org.springframework.osgi.service.importer.support.internal.aop.ServiceInvoker.invoke(ServiceInvoker.java:62)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:131)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:119)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.osgi.service.util.internal.aop.ServiceTCCLInterceptor.invokeUnprivileged(ServiceTCCLInterceptor.java:56)   at org.springframework.osgi.service.util.internal.aop.ServiceTCCLInterceptor.invoke(ServiceTCCLInterceptor.java:39)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.osgi.service.importer.support.LocalBundleContextAdvice.invoke(LocalBundleContextAdvice.java:59)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:131)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:119)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)   at com.sun.proxy.$Proxy1885.execute(Unknown Source)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.getSubCalendars(CalendarResource.java:152)   at sun.reflect.GeneratedMethodAccessor1037.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:601)   at com.atlassian.plugins.rest.common.interceptor.impl.DispatchProviderHelper$ResponseOutInvoker$1.invoke(DispatchProviderHelper.java:234)   at com.atlassian.plugins.rest.common.interceptor.impl.DispatchProviderHelper$1.intercept(DispatchProviderHelper.java:100)   at com.atlassian.plugins.rest.common.interceptor.impl.DefaultMethodInvocation.invoke(DefaultMethodInvocation.java:61)   at com.atlassian.plugins.rest.common.expand.interceptor.ExpandInterceptor.intercept(ExpandInterceptor.java:38)   at com.atlassian.plugins.rest.common.interceptor.impl.DefaultMethodInvocation.invoke(DefaultMethodInvocation.java:61)   at com.atlassian.plugins.rest.common.interceptor.impl.DispatchProviderHelper.invokeMethodWithInterceptors(DispatchProviderHelper.java:132)   at com.atlassian.plugins.rest.common.interceptor.impl.DispatchProviderHelper$ResponseOutInvoker._dispatch(DispatchProviderHelper.java:230)   at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)   at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)   at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)   at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)   at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)   at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)   at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)   at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)   at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)   at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)   at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:416)   at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:537)   at com.atlassian.plugins.rest.module.RestDelegatingServletFilter$JerseyOsgiServletContainer.doFilter(RestDelegatingServletFilter.java:178)   at com.sun.jersey.spi.container.servlet.ServletContainer.doFilter(ServletContainer.java:795)   at com.atlassian.plugins.rest.module.RestDelegatingServletFilter.doFilter(RestDelegatingServletFilter.java:73)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.plugins.rest.module.servlet.RestServletUtilsUpdaterFilter.doFilterInternal(RestServletUtilsUpdaterFilter.java:26)   at com.atlassian.plugins.rest.module.servlet.RestServletUtilsUpdaterFilter.doFilter(RestServletUtilsUpdaterFilter.java:40)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:25)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.mywork.client.filter.ServingRequestsFilter.doFilter(ServingRequestsFilter.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.plugins.cors.CorsFilter.doFilter(CorsFilter.java:65)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsDispatcherFilter.doFilter(PrettyUrlsDispatcherFilter.java:60)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFilter.doFilter(PrettyUrlsSiteMeshFilter.java:70)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsMatcherFilter.doFilter(PrettyUrlsMatcherFilter.java:56)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)   at com.atlassian.confluence.util.profiling.ProfilingPageFilter.doFilter(ProfilingPageFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.ServletContextThreadLocalFilter.doFilter(ServletContextThreadLocalFilter.java:21)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.LoggingContextFilter.doFilter(LoggingContextFilter.java:40)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.UserNameHeaderFilter.doFilter(UserNameHeaderFilter.java:26)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.ConfluenceTimeoutFilter.doFilter(ConfluenceTimeoutFilter.java:63)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.seraph.filter.SecurityFilter.doFilter(SecurityFilter.java:211)   at com.atlassian.confluence.web.filter.ConfluenceSecurityFilter.doFilter(ConfluenceSecurityFilter.java:27)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.ThreadLocalCacheFilter.doFilter(ThreadLocalCacheFilter.java:28)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.security.auth.trustedapps.filter.TrustedApplicationsFilter.doFilter(TrustedApplicationsFilter.java:100)   at com.atlassian.confluence.util.AbstractBootstrapHotSwappingFilter.doFilter(AbstractBootstrapHotSwappingFilter.java:34)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.seraph.filter.BaseLoginFilter.doFilter(BaseLoginFilter.java:150)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.oauth.serviceprovider.internal.servlet.OAuthFilter.doFilter(OAuthFilter.java:55)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.plugins.rest.module.servlet.RestSeraphFilter.doFilter(RestSeraphFilter.java:44)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.ClusterHeaderFilter.doFilter(ClusterHeaderFilter.java:42)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at org.springframework.orm.hibernate.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:170)   at com.atlassian.spring.filter.FlushingSpringSessionInViewFilter.doFilterInternal(FlushingSpringSessionInViewFilter.java:29)   at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.util.profiling.filters.ProfilingFilter.doFilter(ProfilingFilter.java:99)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.gzipfilter.GzipFilter.doFilterInternal(GzipFilter.java:74)   at com.atlassian.gzipfilter.GzipFilter.doFilter(GzipFilter.java:51)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.cache.AbstractCachingFilter.doFilter(AbstractCachingFilter.java:33)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.web.filter.ConfluenceTimingFilter.doFilter(ConfluenceTimingFilter.java:75)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.extra.webdav.servlet.filter.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:43)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.validateparam.RequestParamValidationFilter.doFilter(RequestParamValidationFilter.java:58)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.TranslationModeFilter.doFilter(TranslationModeFilter.java:43)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.plugin.servlet.filter.ActionContextCleanUp.doFilter(ActionContextCleanUp.java:71)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.LanguageExtractionFilter.doFilter(LanguageExtractionFilter.java:53)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.RequestCacheThreadLocalFilter.doFilter(RequestCacheThreadLocalFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.HeaderSanitisingFilter.doFilter(HeaderSanitisingFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.servlet.FourOhFourErrorLoggingFilter.doFilter(FourOhFourErrorLoggingFilter.java:65)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)   at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)   at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)   at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)   at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)   at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)   at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)   at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)  {code}    {code}  2014-02-20 17:20:59,002 WARN [http-8541-7] [extra.calendar3.rest.CalendarResource] getSubcalendarsInternal Unable to retrieve information of sub-calendar with ID 4d9e3ea9-0d5c-4470-9562-82a9ee322f0d for user 2c9c8fe04451b287014451bfcc120004. Please ignore if the mycalendars page is appearing alright for the user.   -- url: /confluence/rest/calendar-services/1.0/calendar/subcalendars.json | userName: thing1 | referer: http://localhost:8541/confluence/display/CS/Calendar+Space+Home  java.lang.IllegalArgumentException: Arguments to addParameter(String, String) cannot be null   at org.apache.commons.httpclient.methods.PostMethod.addParameter(PostMethod.java:268)   at com.atlassian.sal.core.net.HttpClientRequest.processParameters(HttpClientRequest.java:629)   at com.atlassian.sal.core.net.HttpClientRequest.executeAndReturn(HttpClientRequest.java:338)   at com.atlassian.plugins.rest.module.jersey.JerseyRequest.executeAndReturn(JerseyRequest.java:161)   at com.atlassian.applinks.core.auth.ApplicationLinkRequestAdaptor.execute(ApplicationLinkRequestAdaptor.java:84)   at com.atlassian.applinks.core.auth.oauth.OAuthRequest.execute(OAuthRequest.java:43)   at com.atlassian.confluence.extra.calendar3.calendarstore.DefaultJiraAccessor.getIssuesReturnedByJql(DefaultJiraAccessor.java:1253)   at com.atlassian.confluence.extra.calendar3.calendarstore.AbstractJiraSubCalendarDataStore.isJqlReturningTooManyIssues(AbstractJiraSubCalendarDataStore.java:953)   at com.atlassian.confluence.extra.calendar3.calendarstore.AbstractJiraSubCalendarDataStore.getSubCalendarWarnings(AbstractJiraSubCalendarDataStore.java:903)   at com.atlassian.confluence.extra.calendar3.calendarstore.AbstractJiraSubCalendarDataStore.getSubCalendarWarnings(AbstractJiraSubCalendarDataStore.java:70)   at com.atlassian.confluence.extra.calendar3.calendarstore.CalendarDataStoreCachingDecorator.getSubCalendarWarnings(CalendarDataStoreCachingDecorator.java:339)   at com.atlassian.confluence.extra.calendar3.calendarstore.DelegatingCalendarDataStore.getSubCalendarWarnings(DelegatingCalendarDataStore.java:172)   at com.atlassian.confluence.extra.calendar3.DefaultCalendarManager.getSubCalendarWarnings(DefaultCalendarManager.java:191)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.getSubCalendarWarnings(CalendarResource.java:297)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.toExtendedSubCalendar(CalendarResource.java:260)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.toExtendedSubCalendar(CalendarResource.java:255)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.access$100(CalendarResource.java:95)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource$2.apply(CalendarResource.java:217)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource$2.apply(CalendarResource.java:213)   at com.google.common.collect.Iterators$8.next(Iterators.java:782)   at com.google.common.collect.Iterators$7.computeNext(Iterators.java:644)   at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:141)   at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:136)   at com.google.common.collect.Lists.newArrayList(Lists.java:138)   at com.google.common.collect.Collections2$FilteredCollection.toArray(Collections2.java:228)   at java.util.ArrayList.<init>(ArrayList.java:151)   at com.google.common.collect.Lists.newArrayList(Lists.java:119)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.getSubcalendarsInternal(CalendarResource.java:208)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.getSubCalendarsResponse(CalendarResource.java:165)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.access$000(CalendarResource.java:95)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource$1.doInTransaction(CalendarResource.java:157)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource$1.doInTransaction(CalendarResource.java:154)   at com.atlassian.sal.core.transaction.HostContextTransactionTemplate$1.doInTransaction(HostContextTransactionTemplate.java:25)   at com.atlassian.sal.spring.component.SpringHostContextAccessor$1.doInTransaction(SpringHostContextAccessor.java:88)   at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:128)   at com.atlassian.sal.spring.component.SpringHostContextAccessor.doInTransaction(SpringHostContextAccessor.java:82)   at sun.reflect.GeneratedMethodAccessor95.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:601)   at com.atlassian.plugin.osgi.hostcomponents.impl.DefaultComponentRegistrar$ContextClassLoaderSettingInvocationHandler.invoke(DefaultComponentRegistrar.java:129)   at com.sun.proxy.$Proxy233.doInTransaction(Unknown Source)   at sun.reflect.GeneratedMethodAccessor95.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:601)   at com.atlassian.plugin.osgi.bridge.external.HostComponentFactoryBean$DynamicServiceInvocationHandler.invoke(HostComponentFactoryBean.java:154)   at com.sun.proxy.$Proxy233.doInTransaction(Unknown Source)   at com.atlassian.sal.core.transaction.HostContextTransactionTemplate.execute(HostContextTransactionTemplate.java:21)   at sun.reflect.GeneratedMethodAccessor147.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:601)   at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:307)   at org.springframework.osgi.service.importer.support.internal.aop.ServiceInvoker.doInvoke(ServiceInvoker.java:58)   at org.springframework.osgi.service.importer.support.internal.aop.ServiceInvoker.invoke(ServiceInvoker.java:62)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:131)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:119)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.osgi.service.util.internal.aop.ServiceTCCLInterceptor.invokeUnprivileged(ServiceTCCLInterceptor.java:56)   at org.springframework.osgi.service.util.internal.aop.ServiceTCCLInterceptor.invoke(ServiceTCCLInterceptor.java:39)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.osgi.service.importer.support.LocalBundleContextAdvice.invoke(LocalBundleContextAdvice.java:59)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:131)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:119)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)   at com.sun.proxy.$Proxy1885.execute(Unknown Source)   at com.atlassian.confluence.extra.calendar3.rest.CalendarResource.getSubCalendars(CalendarResource.java:152)   at sun.reflect.GeneratedMethodAccessor1037.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:601)   at com.atlassian.plugins.rest.common.interceptor.impl.DispatchProviderHelper$ResponseOutInvoker$1.invoke(DispatchProviderHelper.java:234)   at com.atlassian.plugins.rest.common.interceptor.impl.DispatchProviderHelper$1.intercept(DispatchProviderHelper.java:100)   at com.atlassian.plugins.rest.common.interceptor.impl.DefaultMethodInvocation.invoke(DefaultMethodInvocation.java:61)   at com.atlassian.plugins.rest.common.expand.interceptor.ExpandInterceptor.intercept(ExpandInterceptor.java:38)   at com.atlassian.plugins.rest.common.interceptor.impl.DefaultMethodInvocation.invoke(DefaultMethodInvocation.java:61)   at com.atlassian.plugins.rest.common.interceptor.impl.DispatchProviderHelper.invokeMethodWithInterceptors(DispatchProviderHelper.java:132)   at com.atlassian.plugins.rest.common.interceptor.impl.DispatchProviderHelper$ResponseOutInvoker._dispatch(DispatchProviderHelper.java:230)   at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)   at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)   at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)   at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)   at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)   at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)   at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)   at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)   at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)   at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)   at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:416)   at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:537)   at com.atlassian.plugins.rest.module.RestDelegatingServletFilter$JerseyOsgiServletContainer.doFilter(RestDelegatingServletFilter.java:178)   at com.sun.jersey.spi.container.servlet.ServletContainer.doFilter(ServletContainer.java:795)   at com.atlassian.plugins.rest.module.RestDelegatingServletFilter.doFilter(RestDelegatingServletFilter.java:73)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.plugins.rest.module.servlet.RestServletUtilsUpdaterFilter.doFilterInternal(RestServletUtilsUpdaterFilter.java:26)   at com.atlassian.plugins.rest.module.servlet.RestServletUtilsUpdaterFilter.doFilter(RestServletUtilsUpdaterFilter.java:40)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:25)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.mywork.client.filter.ServingRequestsFilter.doFilter(ServingRequestsFilter.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.plugins.cors.CorsFilter.doFilter(CorsFilter.java:65)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsDispatcherFilter.doFilter(PrettyUrlsDispatcherFilter.java:60)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFilter.doFilter(PrettyUrlsSiteMeshFilter.java:70)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsMatcherFilter.doFilter(PrettyUrlsMatcherFilter.java:56)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)   at com.atlassian.confluence.util.profiling.ProfilingPageFilter.doFilter(ProfilingPageFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.ServletContextThreadLocalFilter.doFilter(ServletContextThreadLocalFilter.java:21)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.LoggingContextFilter.doFilter(LoggingContextFilter.java:40)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.UserNameHeaderFilter.doFilter(UserNameHeaderFilter.java:26)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.ConfluenceTimeoutFilter.doFilter(ConfluenceTimeoutFilter.java:63)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.seraph.filter.SecurityFilter.doFilter(SecurityFilter.java:211)   at com.atlassian.confluence.web.filter.ConfluenceSecurityFilter.doFilter(ConfluenceSecurityFilter.java:27)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.ThreadLocalCacheFilter.doFilter(ThreadLocalCacheFilter.java:28)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.security.auth.trustedapps.filter.TrustedApplicationsFilter.doFilter(TrustedApplicationsFilter.java:100)   at com.atlassian.confluence.util.AbstractBootstrapHotSwappingFilter.doFilter(AbstractBootstrapHotSwappingFilter.java:34)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.seraph.filter.BaseLoginFilter.doFilter(BaseLoginFilter.java:150)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.oauth.serviceprovider.internal.servlet.OAuthFilter.doFilter(OAuthFilter.java:55)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.plugins.rest.module.servlet.RestSeraphFilter.doFilter(RestSeraphFilter.java:44)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.ClusterHeaderFilter.doFilter(ClusterHeaderFilter.java:42)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at org.springframework.orm.hibernate.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:170)   at com.atlassian.spring.filter.FlushingSpringSessionInViewFilter.doFilterInternal(FlushingSpringSessionInViewFilter.java:29)   at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.util.profiling.filters.ProfilingFilter.doFilter(ProfilingFilter.java:99)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.gzipfilter.GzipFilter.doFilterInternal(GzipFilter.java:74)   at com.atlassian.gzipfilter.GzipFilter.doFilter(GzipFilter.java:51)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.cache.AbstractCachingFilter.doFilter(AbstractCachingFilter.java:33)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.web.filter.ConfluenceTimingFilter.doFilter(ConfluenceTimingFilter.java:75)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.extra.webdav.servlet.filter.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:43)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.validateparam.RequestParamValidationFilter.doFilter(RequestParamValidationFilter.java:58)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.TranslationModeFilter.doFilter(TranslationModeFilter.java:43)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.plugin.servlet.filter.ActionContextCleanUp.doFilter(ActionContextCleanUp.java:71)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.LanguageExtractionFilter.doFilter(LanguageExtractionFilter.java:53)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.util.RequestCacheThreadLocalFilter.doFilter(RequestCacheThreadLocalFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.core.filters.HeaderSanitisingFilter.doFilter(HeaderSanitisingFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at com.atlassian.confluence.servlet.FourOhFourErrorLoggingFilter.doFilter(FourOhFourErrorLoggingFilter.java:65)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)   at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)   at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)   at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)   at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)   at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)   at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)   at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)   at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)   at java.lang.Thread.run(Thread.java:722)  {code}",3
"CONFSERVER-32762","02/27/2014 12:52:48","Image rotation of imported photographs is wrong","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-32762].   {panel}  This may or may not be a duplicate of [#CONF-17621], about EXIF rotation, marked as ""won't fix"".  I understand from that issue that there is some debate about whether this is Confluence's issue or a browser issue.  Let me explain my experience.    # I take a picture with my iPhone, it displays it the correct way up  # I email it to myself, Gmail displays it the correct way up  # I accidentally import it into my Google Drive, it displays it the correct way up  # I download it to my Mac, it display it the correct way up  # I import it into Confluence, it displays it the wrong way round  # I start writing this ticket, and have an idea or two...  # I access it in Chrome using a file:// URI, it displays it the right way up  # I boot a Windows 7 VM and ping it over there, it displays it the right way up (perhaps a file:// URI in IE6 would be the nail in the coffin?)      {panel:title=Atlassian Status as of February 14, 2017|borderStyle=solid|borderColor=#3C78B5| titleBGColor=#3C78B5| bgColor=#E7F4FA}    Hi All,    Thank you for your feedback on this issue thus far. This is certainly an issue which has done its round on the internet over the years for many browser and application vendors alike, with each pointing the finger at each other as to whether the application or browser should observe the EXIF rotation metadata.    The obvious solution is for all browsers to support the 'image-orientation' CSS, however after many years this is still only supported by Firefox.  We have explored no less than 6 different solutions to this issue as each brings pros and cons in terms of performance, behaviour and complexity.  As a result of this exercise, it has been decided that image rotation would be done server side based on the EXIF rotation metadata.    The actual implementation is somewhat different for Server and Cloud deployments, and thus the rollout/delivery may occur at different times, however is high up in the queue right now.    Confluence Product Management  {panel}",3
"CONFSERVER-32777","02/28/2014 11:40:23","Mixed language in Confluence blueprints ","h3. Step to reproduce:  # Set the language setting in User profile as Deutsch   # Set language  in Confluence Admin > Languages as English.  # Create a Meeting Notes.    h3. Observed Result:  As you can see, some part of the meeting notes are in Deutsch  and some are in English.  !sample.png!      This issue affect other blueprint as well.    h3. Cause  The mismatch occurs when the user's language is different from the global language. In some places, the global language is preferred over the user's.    h3. Workaround  If it is feasible, ensure that the global language (Confluence Admin > Languages) is set to the same language as the end user's. The end user should also ensure that their browser language is set to their preferred language.",2
"CONFSERVER-32861","03/07/2014 00:57:38","Insert JIRA Issues dialog missing sidebar or displaying ""No Macro Metadata"" error","h2. Problem summary  Disabling in-app notifications (or the underlying Workbox plugins) will cause the JIRA Issue dialog to break in a few ways. This seems to be a regression of CONF-30822, originally fixed in 5.4.0    h2. Steps to reproduce  # Set up Confluence 5.4.2 with an application link to a JIRA instance  # {{Confluence Admin > In-App notifications}}, and choose to disable in-app notifications  # Add/edit a page and perform the following two tests:  ## Click the Insert (+) sign and select JIRA Issue. *Problem 1: Observe ""No Macro Metadata"" error*. Cancel out of this.  ## Start typing {jir and press enter to bring up the JIRA Issues panel. *Problem 2: Observe that the sidebar and insert buttons missing*     I was also able to reproduce this in 5.4.3.    h2. Workaround  https://confluence.atlassian.com/display/CONFKB/No+Macro+Metadata+When+Trying+To+Insert+JIRA+Issue+Macro    h2. Resolution  This issue is fixed in [JIRA Macros 5.5.2|https://marketplace.atlassian.com/plugins/confluence.extra.jira], which is compatible with Confluence 5.4 and above. The fix will be bundled in Confluence 5.5.",2
"CONFSERVER-32915","03/12/2014 13:41:11","JIRA Issue Macro shows wrong application link name, but searches in the correct application","I have two application links to two JIRA instances: my test JIRA (Localhost JIRA) and the company's JIRA. I created both application links, made the company's application link the primary one.    However, when I open the JIRA issue macro the wrong JIRA application link is selected, at least it seems so. However, when I excute a search, the search is triggered in the correct JIRA. I think the labels / names are not correctly set.",3
"CONFSERVER-32971","03/18/2014 02:49:44","Attachment table drop zone UI is not consistent between attachment macro and tool attachments page","Also can reproduced in PUG, version 5.5-DEV-4143  Create a page, add attachment macro. The attachment drop zone UI in attachment macro look like these pictures  https://jira.atlassian.com/secure/attachment/111970/5.3.1-1024x-ff-1.png  https://jira.atlassian.com/secure/attachment/111973/pug-1024x-chrome.png  https://jira.atlassian.com/secure/attachment/111974/pug-1024x-ie-1.png    The attachment drop zone UI when access from Tools>Attachments, it looks like this  https://jira.atlassian.com/secure/attachment/111975/Tool-Attachments.png    Expect the attachment drop zone in Tools>Attachments page follow UI of attachment macro.  ",1
"CONFSERVER-33068","03/26/2014 19:07:43","""Sort by"" function in ""Page Properties Report"" macro doesn't work ","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-33068].   {panel}  ""Sort by"" doesn't work at all when the column heading has a capital letter in it.  When you use lower-case characters sorting is doing something but the order isn't good.    This problem lower significantly the value of the ""Page Properties Report"" macro.",3
"CONFSERVER-49411","04/03/2014 19:21:47","Editing a calendar event series subtracts one day","*Description:*  Each time the user edit a Calendar Event in series, as soon as the edit form is opened, the ""Ends until"" date changes to one day before automatically.    *Steps to reproduce:*  1. Create an event in the calendar.  2. Set it to repeat daily (for example).  3. Select the ""until"" radio button.  4. Select a date to end.  5. Save it.  6. Edit the first occurrence (for example).  7. Uncheck the ""Edit this instance only"" check box.  8. See that ""Ends until"" date changed to one day before.  9. Save it.    Each time the event is edited, this behaviour occur.    Example:  Create a event:  - What: Test  - When: 03-Apr-2014 to 03-Apr-2014  - All day event checked  - Repeat: Daily  - Repeat every 1 day  - Ends until 24-Apr-2014  - Click on ""OK"" button.  (Attachment: create_event.png)    - Event successfully created.  (Attachment: event_created.png)    - Click on the first occurrence and select ""Edit"".  - The edit form will open showing the Ends until date 23-Apr-2014 automatically.  - Uncheck the ""Edit this instance only"" option.  (Attachment: edit_event.png)  - Click on OK.    - The event will end on 23-Apr-2014.  (Attachment: event_edited.png)",2
"CONFSERVER-33244","04/11/2014 01:51:36","User autocomplete not finding all users","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-33244].   {panel}  *Problem:*  Some usernames aren't autocompleted when mentioning or assigning a task to a user.    *Cause:*  When adding Confluence to a JIRA Cloud instance, users are not properly migrated over.  This also causes [Duplicates in the People Directory|https://confluence.atlassian.com/display/CONFKB/Duplicates+in+the+People+Directory] (covered by this bug [CONF-9857|https://jira.atlassian.com/browse/CONF-9857])    *Steps to reproduce:*  # create a JIRA only instance  # add users  # add Confluence to the instance  # grant access to the users  # try to mention a user that was created previously (before they access Confluence for the first time) accessing just JIRA won't update the 'content' table.  Created users won't be displayed in the People directory although they are Confluence users with access.  Once the user logs in to Confluence, the user is mentionable.    *Expected:* users are mentionable because they have Confluence access  *Actual:* users are not mentionable    *Temporary Workarounds:*  * Manually run a Content Reindex   (due to [CONF-33400 - Confluence Administrators unable to Reindex Manually|https://jira.atlassian.com/browse/CONF-33400] please contact support at http://support.atlassian.com to run the Content Reindex)  * Login the user to Confluence  * Visit their Profile page manually by changing the username on another Profile page.",5
"CONFSERVER-33440","04/25/2014 21:34:05","Custom date field data from JIRA displays in incorrect format in Confluence","See attached screengrabs. We're using a custom date field called ""start date"" in JIRA. We're feeding this field into Confluence pages and as you can see from the attachments, it's not following the admin preference we've set for date display. Instead of showing as MMM dd, yyyy it is showing as dd/MMM/yy. It displays properly in JIRA, however.",3
"CONFSERVER-51782","05/12/2014 04:33:04","Document the REST API by using Enunciate maven plugin","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51782].   {panel}  ",8
"CONFSERVER-33626","05/13/2014 11:03:34","JIRA Issues Macro broken for Single Issue Display","h5. Overview    When the *JIRA Issue Macro* is included in a page and there are more than a single issue (Table Display), the *Preview* and after *Saving* the page links to all the issues works fine. Eg. If you have set your JIRA Base URL to {{http://localhost:8623/jira_623}}, the issue will show the respective link:    {code}  http://localhost:8623/jira_623/browse/DEMO-3?src=confmacro  {code}    On the other hand, if you set to _Singe Issue_ Display (this is where it gets interesting):  h6. Situation 1 (4 or less JIRA Issue Macro): The links are still showing the correct URL    h6. Situation 2 (5 or more JIRA Issue Macro): The links are *broken*, whereby the _context path_ of JIRA is ignored totally.    !not_ok_1.JPG|thumbnail!    {code}  http://localhost:8623/browse/DEMO-3  {code}    !not_ok_2.JPG|thumbnail!    h5. Symptoms  The links are still shown correctly in *Preview* mode but after saving it, the links are all broken    ",3
"CONFSERVER-33768","05/26/2014 18:13:38","Jira macro insert button is disabled after naming a Jira custom field ""Length"" for any linked Confluence instance","{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-33768].    {panel}    h4. The problem:  The _Insert_ button in JIRA Issue Macro is greyed out and a Javascript error is thrown in the browser console:  {noformat}  Uncaught RangeError: Invalid array length batch.js:7545  e batch.js:7545  AJS.Editor.JiraConnector.Panel.Search.AJS.$.extend.prepareColumnInput batch.js:7545  AJS.Editor.JiraConnector.Panel.Search.AJS.$.extend.loadMacroParams batch.js:7545  (anonymous function) batch.js:7545  currentXhr.AppLinks.makeRequest.success batch.js:7534  fire batch.js:1077  self.fireWith batch.js:1195  done batch.js:7540  callback  {noformat}    The following appears on the screen:  !insert_button_not_working.png|thumbnail!    This error refers to the following JavaScript:  {noformat}  try {  /* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/searchpanel.js' */  AJS.Editor.JiraConnector.Panel.Search=function(){this.jql_operators=/=|!=|~|>|<|!~| is | in /i};AJS.Editor.JiraConnector.Select2=AJS.Editor.JiraConnector.Select2||{};AJS.Editor.JiraConnector.Select2.getKeyColumnsSelectedOptions=function(b){var a=[];var d=b.select2(""data"");for(var c=0;c<d.length;c++){a[c]=d[c].id}return a.join()};AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,AJS.Editor.JiraConnector.Panel.prototype);AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,{defaultColumns:""key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution"",DEFAULT_MAX_ISSUES_VAL:20,MAXIMUM_MAX_ISSUES_VAL:1000,MINIMUM_MAX_ISSUES_VAL:1,title:function(){return ""Search""},init:function(a){a.html('<div id=""my-jira-search""></div>');var f=this;var b=AJS.$(""#my-jira-search"");this.container=b;var h=function(){b.children("":not(div.jira-search-form)"").remove()};var e=function(){AJS.$(""input.text"",b).enable();AJS.$(""button"",b).enable()};var l=function(){AJS.$(""button"",b).disable();AJS.$(""input.text"",b).disable()};var i=function(n){h();f.disableInsert();if(n){f.selectedServer=n}if(f.selectedServer.authUrl){l();var m=f.createOauthForm(function(){h();e()});b.append(m)}else{e();AJS.$("".search-help"").show()}};this.authCheck=i;var g=function(x){var m=x&&x.searchValue;var o=x&&x.serverName;if(m){AJS.$(""input:text"",b).val(m)}if(o&&o!=this.selectedServer.name){var y=AJS.Editor.JiraConnector.servers;var q=false;for(var r=0;r<y.length;r++){if(y[r].name==o){AJS.$('option[value=""'+y[r].id+'""]',b).attr(""selected"",""selected"");AJS.$(""select"",b).change();q=trueBest Regards    Alisha Dash  Atlassian Cloud Support.eak}}if(!q){c(AJS.Meta.get(""is-admin""))_*Edit*: removed previous email thread (Amanda)_urn}}if(this.currentXhr&&this.currentXhr.readyState!=4){return}var p=m||AJS.$(""input"",b).val();if(AJS.Editor.JiraAnalytics){var w=AJS.JQLHelper.checkQueryType(p);if(w){AJS.Editor.JiraAnalytics.triggerSearchEvent({type:w,source:""dialog""})}}var s=function(C,E,D){var B=b.find(""#jiraIssueColumnSelector"");var A=B.val()&&B.val().join();AJS.$(""select"",b).disable();l();f.lastSearch=C;f.createIssueTableFromUrl(b,f.selectedServer.id,""/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery=""+encodeURIComponent(C)+""&returnMax=true&tempMax=20&field=summary&field=type&field=link"",f.selectHandler,f.insertLinkFromForm,function(){f.addDisplayOptionPanel();f.loadMacroParams(A);f.bindEventToDisplayOptionPanel(true,x);f.enableInsert()},function(F){f.addDisplayOptionPanel();f.loadMacroParams(A);f.bindEventToDisplayOptionPanel(false,x);f.updateTotalIssuesDisplay(F);f.checkAutoSelectColumns();x&&x.isAutoSearch&&f.focusForm()},function(F){f.disableInsert();if(F.status==400){if(D){D()}else{AJS.$(""div.data-table"",b).remove();f.warningMsg(b,AJS.format(""The JIRA server didn\'\'t understand your search query. If you entered JQL, please ensure that it\'\'s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}"",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))}}else{AJS.$(""div.data-table"",b).remove();f.ajaxError(F,i)}x&&x.isAutoSearch&&f.focusForm()},true)};if(AJS.JQLHelper.isFilterUrl(p)){var n=decodeURIComponent(p);var v=AJS.JQLHelper.findServerIndexFromUrl(n,AJS.Editor.JiraConnector.servers);if(v!=-1){var t=AJS.Editor.JiraConnector.servers[v].id;AJS.$('option[value=""'+t+'""]',b).attr(""selected"",""selected"");AJS.$(""select"",b).change();var z=AJS.JQLHelper.getFilterFromFilterUrl(n);if(z){AJS.$(""input"",b).val(z);s(z)}else{h();f.warningMsg(b,AJS.format(""The JIRA server didn\'\'t understand your search query. If you entered JQL, please ensure that it\'\'s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}"",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))}}else{h();f.disableInsert();c(AJS.Meta.get(""is-admin""))}}else{if(AJS.JQLHelper.isIssueUrlOrXmlUrl(p)){var n=decodeURIComponent(p);var u=AJS.JQLHelper.getJqlAndServerIndexFromUrl(n,AJS.Editor.JiraConnector.servers);if(d(u)){AJS.$(""input"",b).val(u.jqlQuery);s(u.jqlQuery,false,null)}}else{if(p.match(f.jql_operators)){s(p,false,null)}else{if(AJS.JQLHelper.isSingleKeyJQLExp(p)){s(""key = ""+p,true)}else{if(AJS.JQLHelper.isMultipleSingleKeyJQLExp(p)){s(""key in (""+p+"")"",true)}else{s('summary ~ ""'+p+'"" OR description ~ ""'+p+'""',false,null)}}}}}};this.doSearch=g;f.addSearchForm();var d=function(m){var n;if(m.serverIndex!=-1){AJS.$('option[value=""'+AJS.Editor.JiraConnector.servers[m.serverIndex].id+'""]',b).attr(""selected"",""selected"");AJS.$(""select"",b).change();if(m.jqlQuery.length==0){h();f.errorMsg(b,""The JIRA server didn\'t understand your search query. If you entered JQL, please ensure that it\'s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}"")}else{n=m.jqlQuery}}else{h();f.disableInsert();c(AJS.Meta.get(""is-admin""))}return n};f.processJiraParams=d;var c=function(m){var o=Confluence.Templates.ConfluenceJ...type""};var e=function(j){var p=[];var s=AJS.$(""#jiraIssueColumnSelector"");var l="""";var o="""";var r;for(var k=0;k<j.length;k++){var q=j[k];if(q.navigable){if(d[q.id]){q.id=d[q.id]}if(q.custom===true){r=q.name.toLowerCase()}else{r=q.id.toLowerCase()}var n=AJS.template(""<option value='{value}'>{displayValue}</option>"");p[r]=q.name;if(AJS.$.inArray(r,b)<0){l+=n.fill({value:r,displayValue:q.name})}}}p.key=""Key"";for(var k=0;k<b.length;k++){var h=AJS.template(""<option selected='true' value='{value}'>{displayValue}</option>"");r=b[k].toLowerCase();if(p[r]!=null){o+=h.fill({value:r,displayValue:p[r]})}}var m=o+l;s.html(m);s.auiSelect2({width:""415px"",containerCssClass:""select2-container-jira-issue-columns""});AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox=s};if(f.columns&&f.columns.length>0){e(f.columns)_*Edit*: removed previous email thread (Amanda)_urn}this.retrieveJson(f.id,""/rest/api/2/field"",function(h){if(h&&h.length){f.columns=h;e(f.columns)}})},expandDisplayOptPanel:function(){var b=AJS.$("".jql-display-opts-overlay"");var c=b.height();var d=40;b.css(""top"","""");var a=-(c-d);b.css(""bottom"",a+""px"");b.animate({bottom:0},500)},minimizeDisplayOptPanel:function(){var a=AJS.$("".jql-display-opts-overlay"");a.css(""top"",a.position().top+""px"");a.css(""bottom"","""");a.animate({top:420},500)},disableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2(""enable"",false)},enableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2(""enable"",true)},checkAutoSelectColumns:function(){if(AJS.$(""#opt-table"").prop(""checked"")){this.enableAutoSelectColumns()}else{this.disableAutoSelectColumns();this.enableInsert()}},bindEventToDisplayOptionPanel:function(f,h){var d=this;var b=AJS.$("".jql-display-opts-close, .jql-display-opts-open""),c=AJS.$("".jql-display-opts-overlay""),i=AJS.$("".jql-display-opts-inner .radio""),a=AJS.$(""#my-jira-search input:checkbox[name=jira-issue-all]""),e=AJS.$(""#my-jira-search input:checkbox[name=jira-issue]"");var g=AJS.$(""#jira-maximum-issues"");g.on(""blur keyup"",AJS.Editor.JiraConnector.Panel.Search.prototype.validateMaxIssues);c.css(""top"",""420px"");b.click(function(j){j.preventDefault();if(AJS.$(this).hasClass(""disabled"")){return}var k=AJS.$(this).hasClass(""jql-display-opts-open"");if(k){d.expandDisplayOptPanel();jQuery(this).addClass(""jql-display-opts-close"");jQuery(this).removeClass(""jql-display-opts-open"")}else{d.minimizeDisplayOptPanel();jQuery(this).removeClass(""jql-display-opts-close"");jQuery(this).addClass(""jql-display-opts-open"")}});i.change(function(){d.checkAutoSelectColumns();d.validateMaxIssues()});a.bind(""click"",function(){var j=AJS.$(this);if(j.prop(""checked"")){e.prop(""checked"",""checked"")}else{e.removeAttr(""checked"")}d.validate()});e.change(function(){var j=AJS.$(""#my-jira-search input:checkbox[name=jira-issue]:not(:checked)"").length;if(j>0){a.removeAttr(""checked"")}else{a.prop(""checked"",""checked"")}d.validate()});d.validate(f,h)},changeInsertOptionStatus:function(q,n,f){var r=this;var g=AJS.$(""#opt-single"");var d=AJS.$(""#opt-total"");var m=AJS.$(""#opt-table"");var j=AJS.$(""#my-jira-search input:checkbox[name=jira-issue]:checked"");var i=AJS.$(""#my-jira-search input:checkbox[name=jira-issue-all]"").attr(""checked"")===""checked"";var l=j.length===1;var p=j.length>1;var h=j.length===0;var b=AJS.JQLHelper.isSingleKeyJQLExp(AJS.$(""#my-jira-search input[name=jiraSearch]"").val());var c=function(){if(f&&f.isJqlQuery){m.click()}else{g.click()}};var k=function(){d.attr(""disabled"",""disabled"");m.removeAttr(""disabled"");g.removeAttr(""disabled"");c();setTimeout(function(){c()},100)};var e=function(){g.attr(""disabled"",""disabled"");d.removeAttr(""disabled"");if(AJS.$(""input[name=insert-advanced]:checked"").val()===""insert-single""){setTimeout(function(){m.removeAttr(""disabled"").click()},100)}};var o=function(){m.removeAttr(""disabled"",""disabled"");d.removeAttr(""disabled"",""disabled"");g.removeAttr(""disabled"",""disabled"");var s=AJS.$(""input:radio[name=insert-advanced]:checked"").val();if(s===""insert-single""){setTimeout(function(){m.click()},100)}};var a=function(){g.attr(""disabled"",""disabled"");d.attr(""disabled"",""disabled"");m.attr(""disabled"",""disabled"");AJS.$("".jql-display-opts-close"").click();AJS.$("".jql-display-opts-open"").addClass(""disabled"")};AJS.$("".jql-display-opts-open"").removeClass(""disabled"");g.removeAttr(""disabled"");d.removeAttr(""disabled"");m.removeAttr(""disabled"");if(i&&l&&b){k()}else{if(i&&l&&!b){o()}else{if(p){e()}else{if(l&&!i){k()}else{if(n){e()}else{if(h){a()}}}}}}},isInsertTableType:function(){return AJS.$(""input:radio[name=insert-advanced]:checked"").val()===""insert-table""},setInsertButtonState:function(){var a=AJS.$("".jql-display-opts-close, .jql-display-opts-open"");var b=AJS.$(""#jira-maximum-issues"");if(!a.length||(a.length&&this.isInsertTableType()&&!this.isValidMaxIssues(b.val()))){this.disableInsert()}else{this.enableInsert()}},analyticPanelActionName:""confluence.jira.plugin.searchadded""});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Search());  } catch (err) {  if (console && console.log && console.error) {  console.log(""Error running batched script."");  console.error(err);  }  }   {noformat}    h4. Steps to reproduce:  # Install a Confluence 5.5.2 instance;  # Install a JIRA instance 6.2.6, and add a single line text field with name *Length* and global context;  (i) This issue also occurs when defining name *Length* in the [customfield translation|https://confluence.atlassian.com/display/JIRA/Configuring+a+Custom+Field#ConfiguringaCustomField-Translatingacustomfield].  # Setup an application link between Confluence and JIRA;  # Create a page and open the JIRA Issues Macro, and try and run any sort of query.     The results will return, but attempting to click the ""Insert"" button won't do anything. Checking the JavaScript console in the browser should show the error above.     h4. Additional information:  After some debugging we narrowed it down to the fact that Confluence doesn't appear to escape some field names that can be misinterpreted as array method names. In this case, the Jira custom field was called *Length* and appears to be misinterpreted as a call to the {{array.length()}} method of a given array r[]    This didn't happen with Confluence 5.1.5, so the bug was introduced since then.    h4. Diagnosis:  Running this SQL Query on Jira Database should yield the easiest diagnosis if there is a custom field called *length*:  {code:title=Run on Jira Database}  select * from customfield where lower(cfname) = 'length'  {code}      h4. Workaround:   # Access the URL {{http://<JIRA_URL>/rest/api/2/field}} and use the search functionality in your browser to find the word *Length*, or execute the query bellow to identify the custom field that is causing this issue:   {code:sql}   select ps.propertyvalue as ""Translation"", cf.cfname as ""Custom field"" from propertystring ps join propertyentry pe on pe.id=ps.id join customfield cf on cf.id=pe.entity_id   where pe.property_key like'%jira.translation.custom.fieldcustomfield%' and lower(ps.propertyvalue)='length' or lower(cf.cfname)='length';   {code}   # Rename the custom field or custom field translation.",2
"CONFSERVER-33792","05/28/2014 10:30:02","Empty task item crashes Task report Macro","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-33792].   {panel}  When a page contains a Checkbox without any Text written next to it the Task report Macro crashes the site it is embedded in. Here is the Stacktrace:  {noformat}  Cause  java.lang.RuntimeException: Error rendering template for decorator root      at com.atlassian.confluence.setup.velocity.ApplyDecoratorDirective.render(ApplyDecoratorDirective.java:191)  caused by: java.lang.RuntimeException: Error rendering template for decorator page      at com.atlassian.confluence.setup.velocity.ApplyDecoratorDirective.render(ApplyDecoratorDirective.java:191)  caused by: org.apache.velocity.exception.MethodInvocationException: Invocation of method 'getWebInterfaceContext' in class com.atlassian.confluence.pages.actions.ViewPageAction threw exception net.sf.hibernate.LazyInitializationException: Failed to lazily initialize a collection at template/includes/menu-macros.vm[line 130, column 92]      at org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:223)  caused by: net.sf.hibernate.LazyInitializationException: Failed to lazily initialize a collection      at net.sf.hibernate.collection.PersistentCollection.initialize(PersistentCollection.java:201)  caused by: net.sf.hibernate.HibernateException: collection was evicted      at net.sf.hibernate.impl.SessionImpl.initializeCollection(SessionImpl.java:3320)  Stack Trace:[hide]  java.lang.RuntimeException: Error rendering template for decorator root   at com.atlassian.confluence.setup.velocity.ApplyDecoratorDirective.render(ApplyDecoratorDirective.java:191)   at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)   at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)   at org.apache.velocity.Template.merge(Template.java:328)   at org.apache.velocity.Template.merge(Template.java:235)   at com.opensymphony.webwork.dispatcher.VelocityResult.doExecute(VelocityResult.java:91)   at com.atlassian.xwork.results.ProfiledVelocityResult.doExecute(ProfiledVelocityResult.java:21)   at com.atlassian.confluence.setup.webwork.EncodingVelocityResult.doExecute(EncodingVelocityResult.java:48)   at com.opensymphony.webwork.dispatcher.WebWorkResultSupport.execute(WebWorkResultSupport.java:116)   at com.opensymphony.xwork.DefaultActionInvocation.executeResult(DefaultActionInvocation.java:263)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:187)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.ConfluenceWorkflowInterceptor.intercept(ConfluenceWorkflowInterceptor.java:64)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.xwork.interceptors.XsrfTokenInterceptor.intercept(XsrfTokenInterceptor.java:100)   at com.atlassian.confluence.xwork.ConfluenceXsrfTokenInterceptor.intercept(ConfluenceXsrfTokenInterceptor.java:26)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.interceptors.CaptchaInterceptor.intercept(CaptchaInterceptor.java:49)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.validation.MessageHolderInterceptor.intercept(MessageHolderInterceptor.java:43)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.util.LoggingContextInterceptor.intercept(LoggingContextInterceptor.java:49)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.CancellingInterceptor.intercept(CancellingInterceptor.java:23)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.xwork.HttpMethodValidationInterceptor.intercept(HttpMethodValidationInterceptor.java:72)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.websudo.WebSudoInterceptor.intercept(WebSudoInterceptor.java:63)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.themes.ThemeContextInterceptor.intercept(ThemeContextInterceptor.java:68)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.actions.PermissionCheckInterceptor.intercept(PermissionCheckInterceptor.java:63)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.setup.webwork.BootstrapAwareInterceptor.intercept(BootstrapAwareInterceptor.java:27)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.user.actions.UserAwareInterceptor.intercept(UserAwareInterceptor.java:58)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.pages.actions.CommentAwareInterceptor.intercept(CommentAwareInterceptor.java:50)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.pages.actions.PageAwareInterceptor.intercept(PageAwareInterceptor.java:151)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.spaces.actions.SpaceAwareInterceptor.intercept(SpaceAwareInterceptor.java:77)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.xwork.FlashScopeInterceptor.intercept(FlashScopeInterceptor.java:25)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.actions.LastModifiedInterceptor.intercept(LastModifiedInterceptor.java:31)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.ConfluenceAutowireInterceptor.intercept(ConfluenceAutowireInterceptor.java:49)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.xwork.interceptors.TransactionalInvocation.invokeAndHandleExceptions(TransactionalInvocation.java:76)   at com.atlassian.xwork.interceptors.TransactionalInvocation.invokeInTransaction(TransactionalInvocation.java:61)   at com.atlassian.xwork.interceptors.XWorkTransactionInterceptor.intercept(XWorkTransactionInterceptor.java:56)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.xwork.SetupIncompleteInterceptor.intercept(SetupIncompleteInterceptor.java:43)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.interceptors.NosniffSecurityHeaderInterceptor.intercept(NosniffSecurityHeaderInterceptor.java:21)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.interceptors.XXSSSecurityHeaderInterceptor.intercept(XXSSSecurityHeaderInterceptor.java:21)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.DefaultActionProxy.execute(DefaultActionProxy.java:115)   at com.atlassian.confluence.servlet.ConfluenceServletDispatcher.serviceAction(ConfluenceServletDispatcher.java:58)   at com.opensymphony.webwork.dispatcher.ServletDispatcher.service(ServletDispatcher.java:199)   at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.labs.botkiller.BotKillerFilter.doFilter(BotKillerFilter.java:30)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.extra.jira.filters.SingleJiraIssuesMapThreadLocalFilter.doFilter(SingleJiraIssuesMapThreadLocalFilter.java:45)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:25)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCommonFilter.preventDoubleInvocation(PrettyUrlsCommonFilter.java:38)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFixupFilter.doFilter(PrettyUrlsSiteMeshFixupFilter.java:24)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsDispatcherFilter.doFilter(PrettyUrlsDispatcherFilter.java:60)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCommonFilter.preventDoubleInvocation(PrettyUrlsCommonFilter.java:38)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFilter.doFilter(PrettyUrlsSiteMeshFilter.java:74)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsMatcherFilter.doFilter(PrettyUrlsMatcherFilter.java:56)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.plugins.mobile.filter.ViewPageActionRedirectFilter.doFilter(ViewPageActionRedirectFilter.java:45)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.plugins.mobile.filter.CanUseFilter.doFilter(CanUseFilter.java:61)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.core.filters.ServletContextThreadLocalFilter.doFilter(ServletContextThreadLocalFilter.java:21)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.UserNameHeaderFilter.doFilter(UserNameHeaderFilter.java:26)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.UserThreadLocalFilter.doFilter(UserThreadLocalFilter.java:41)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.seraph.filter.SecurityFilter.doFilter(SecurityFilter.java:211)   at com.atlassian.confluence.web.filter.ConfluenceSecurityFilter.doFilter(ConfluenceSecurityFilter.java:27)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.seraph.filter.BaseLoginFilter.doFilter(BaseLoginFilter.java:150)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.oauth.serviceprovider.internal.servlet.OAuthFilter.doFilter(OAuthFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.johnson.filters.AbstractJohnsonFilter.doFilter(AbstractJohnsonFilter.java:41)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:749)   at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:487)   at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:412)   at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:339)   at com.atlassian.confluence.servlet.simpledisplay.SimpleDisplayServlet.service(SimpleDisplayServlet.java:63)   at com.atlassian.confluence.servlet.SpringManagedServlet.service(SpringManagedServlet.java:73)   at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.labs.botkiller.BotKillerFilter.doFilter(BotKillerFilter.java:36)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:25)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.mywork.client.filter.ServingRequestsFilter.doFilter(ServingRequestsFilter.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFixupFilter.doFilter(PrettyUrlsSiteMeshFixupFilter.java:36)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsDispatcherFilter.doFilter(PrettyUrlsDispatcherFilter.java:60)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFilter.doFilter(PrettyUrlsSiteMeshFilter.java:92)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsMatcherFilter.doFilter(PrettyUrlsMatcherFilter.java:56)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.security.websudo.MessagesDecoratorFilter.doFilter(MessagesDecoratorFilter.java:59)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)   at com.atlassian.confluence.util.profiling.ProfilingPageFilter.doFilter(ProfilingPageFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.jmx.JmxFilter.doFilter(JmxFilter.java:113)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.cache.TransactionalCacheFactoryCleanupFilter.doFilter(TransactionalCacheFactoryCleanupFilter.java:68)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.core.filters.ServletContextThreadLocalFilter.doFilter(ServletContextThreadLocalFilter.java:21)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.LoggingContextFilter.doFilter(LoggingContextFilter.java:40)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.UserNameHeaderFilter.doFilter(UserNameHeaderFilter.java:26)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.UserThreadLocalFilter.doFilter(UserThreadLocalFilter.java:41)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.ConfluenceTimeoutFilter.doFilter(ConfluenceTimeoutFilter.java:63)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.seraph.filter.SecurityFilter.doFilter(SecurityFilter.java:211)   at com.atlassian.confluence.web.filter.ConfluenceSecurityFilter.doFilter(ConfluenceSecurityFilter.java:27)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.ThreadLocalCacheFilter.doFilter(ThreadLocalCacheFilter.java:28)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.security.auth.trustedapps.filter.TrustedApplicationsFilter.doFilter(TrustedApplicationsFilter.java:100)   at com.atlassian.confluence.util.AbstractBootstrapHotSwappingFilter.doFilter(AbstractBootstrapHotSwappingFilter.java:34)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.seraph.filter.BaseLoginFilter.doFilter(BaseLoginFilter.java:150)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.oauth.serviceprovider.internal.servlet.OAuthFilter.doFilter(OAuthFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.ClusterHeaderFilter.doFilter(ClusterHeaderFilter.java:42)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.johnson.filters.AbstractJohnsonFilter.doFilter(AbstractJohnsonFilter.java:72)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at org.springframework.orm.hibernate.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:170)   at com.atlassian.spring.filter.FlushingSpringSessionInViewFilter.doFilterInternal(FlushingSpringSessionInViewFilter.java:29)   at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.ConfluenceErrorFilter.doFilter(ConfluenceErrorFilter.java:27)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.util.profiling.filters.ProfilingFilter.doFilter(ProfilingFilter.java:99)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.core.datetime.RequestTimeThreadLocalFilter.doFilter(RequestTimeThreadLocalFilter.java:41)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.gzipfilter.GzipFilter.doFilterInternal(GzipFilter.java:74)   at com.atlassian.gzipfilter.GzipFilter.doFilter(GzipFilter.java:51)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.core.filters.cache.AbstractCachingFilter.doFilter(AbstractCachingFilter.java:33)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.web.filter.ConfluenceTimingFilter.doFilter(ConfluenceTimingFilter.java:79)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.extra.webdav.servlet.filter.ReverseProxyFilter.doFilter(ReverseProxyFilter.java:427)   at com.atlassian.confluence.extra.webdav.servlet.filter.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:34)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.validateparam.RequestParamValidationFilter.doFilter(RequestParamValidationFilter.java:58)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.TranslationModeFilter.doFilter(TranslationModeFilter.java:43)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.plugin.servlet.filter.ActionContextCleanUp.doFilter(ActionContextCleanUp.java:71)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.LanguageExtractionFilter.doFilter(LanguageExtractionFilter.java:53)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.RequestCacheThreadLocalFilter.doFilter(RequestCacheThreadLocalFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.ResponseOutputStreamFilter.doFilter(ResponseOutputStreamFilter.java:25)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.core.filters.encoding.AbstractEncodingFilter.doFilter(AbstractEncodingFilter.java:41)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.core.filters.HeaderSanitisingFilter.doFilter(HeaderSanitisingFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.servlet.FourOhFourErrorLoggingFilter.doFilter(FourOhFourErrorLoggingFilter.java:65)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)   at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)   at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)   at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)   at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)   at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)   at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1041)   at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:603)   at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)   at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)   at java.lang.Thread.run(Unknown Source)  Caused by: java.lang.RuntimeException: Error rendering template for decorator page   at com.atlassian.confluence.setup.velocity.ApplyDecoratorDirective.render(ApplyDecoratorDirective.java:191)   at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)   at org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)   at org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)   at org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)   at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)   at org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)   at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)   at org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:106)   at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)   at org.apache.velocity.Template.merge(Template.java:328)   at org.apache.velocity.Template.merge(Template.java:235)   at com.atlassian.confluence.util.velocity.VelocityUtils.renderTemplateWithoutSwallowingErrors(VelocityUtils.java:84)   at com.atlassian.confluence.util.velocity.VelocityUtils.renderTemplateWithoutSwallowingErrors(VelocityUtils.java:95)   at com.atlassian.confluence.util.velocity.VelocityUtils.getRenderedTemplateWithoutSwallowingErrors(VelocityUtils.java:73)   at com.atlassian.confluence.setup.velocity.ApplyDecoratorDirective.render(ApplyDecoratorDirective.java:187)   ... 405 more  Caused by: org.apache.velocity.exception.MethodInvocationException: Invocation of method 'getWebInterfaceContext' in  class com.atlassian.confluence.pages.actions.ViewPageAction threw exception net.sf.hibernate.LazyInitializationException: Failed to lazily initialize a collection at template/includes/menu-macros.vm[line 130, column 92]   at org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:223)   at org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:262)   at org.apache.velocity.runtime.parser.node.ASTReference.value(ASTReference.java:507)   at org.apache.velocity.runtime.parser.node.ASTMethod.execute(ASTMethod.java:155)   at org.apache.velocity.runtime.parser.node.ASTReference.execute(ASTReference.java:262)   at org.apache.velocity.runtime.parser.node.ASTReference.value(ASTReference.java:507)   at org.apache.velocity.runtime.directive.Foreach.render(Foreach.java:282)   at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)   at org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)   at org.apache.velocity.runtime.directive.VelocimacroProxy.render(VelocimacroProxy.java:212)   at org.apache.velocity.runtime.directive.RuntimeMacro.render(RuntimeMacro.java:247)   at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)   at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)   at org.apache.velocity.runtime.directive.Parse.render(Parse.java:263)   at com.atlassian.confluence.setup.velocity.ProfilingParseDirective.render(ProfilingParseDirective.java:24)   at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)   at org.apache.velocity.runtime.parser.node.ASTBlock.render(ASTBlock.java:72)   at org.apache.velocity.runtime.parser.node.ASTIfStatement.render(ASTIfStatement.java:87)   at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)   at org.apache.velocity.Template.merge(Template.java:328)   at org.apache.velocity.Template.merge(Template.java:235)   at com.atlassian.confluence.util.velocity.VelocityUtils.renderTemplateWithoutSwallowingErrors(VelocityUtils.java:84)   at com.atlassian.confluence.util.velocity.VelocityUtils.renderTemplateWithoutSwallowingErrors(VelocityUtils.java:95)   at com.atlassian.confluence.util.velocity.VelocityUtils.getRenderedTemplateWithoutSwallowingErrors(VelocityUtils.java:73)   at com.atlassian.confluence.setup.velocity.ApplyDecoratorDirective.render(ApplyDecoratorDirective.java:187)   ... 420 more  Caused by: net.sf.hibernate.LazyInitializationException: Failed to lazily initialize a collection   at net.sf.hibernate.collection.PersistentCollection.initialize(PersistentCollection.java:201)   at net.sf.hibernate.collection.PersistentCollection.read(PersistentCollection.java:71)   at net.sf.hibernate.collection.Bag.iterator(Bag.java:256)   at com.atlassian.confluence.util.LabelUtil.extractLabelsFromLabellings(LabelUtil.java:529)   at com.atlassian.confluence.core.AbstractLabelableEntityObject.getLabels(AbstractLabelableEntityObject.java:28)   at com.atlassian.confluence.labels.PermittedLabelView.getVisibleLabels(PermittedLabelView.java:66)   at com.atlassian.confluence.labels.PermittedLabelView.getLabels(PermittedLabelView.java:38)   at com.atlassian.confluence.core.AbstractLabelableEntityObject.getVisibleLabels(AbstractLabelableEntityObject.java:63)   at com.atlassian.confluence.pages.actions.AbstractPageAction.getLabels(AbstractPageAction.java:332)   at com.atlassian.confluence.pages.actions.AbstractPageAction.getNumberOfLabelsAsString(AbstractPageAction.java:342)   at com.atlassian.confluence.pages.actions.AbstractPageAction.getWebInterfaceContext(AbstractPageAction.java:317)   at com.atlassian.confluence.pages.actions.ViewPageAction.getWebInterfaceContext(ViewPageAction.java:734)   at sun.reflect.GeneratedMethodAccessor835.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)   at java.lang.reflect.Method.invoke(Unknown Source)   at org.apache.velocity.runtime.parser.node.PropertyExecutor.execute(PropertyExecutor.java:142)   at org.apache.velocity.util.introspection.UberspectImpl$VelGetterImpl.invoke(UberspectImpl.java:533)   at org.apache.velocity.runtime.parser.node.ASTIdentifier.execute(ASTIdentifier.java:198)   ... 444 more  Caused by: net.sf.hibernate.HibernateException: collection was evicted   at net.sf.hibernate.impl.SessionImpl.initializeCollection(SessionImpl.java:3320)   at net.sf.hibernate.collection.PersistentCollection.initialize(PersistentCollection.java:195)   ... 461 more  {noformat}",3
"CONFSERVER-33889","06/06/2014 14:43:12","JIRA issue description doesn't save when using Firefox","When you insert a JIRA issue into a Confluence page the JIRA issue description is not always saved.     We noticed that this was only happening for some of our employees but not others. The employees all have the same permissions so It wasn't until we did some browser testing that we found the problem.     The JIRA issue description gets saved when Confluence is open in a Chrome browser but not when open in Firefox.     ",3
"CONFSERVER-33990","06/18/2014 01:41:38","Missing web image causes PDF space export to fail repeatedly","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-33990].   {panel}  Steps to replicate:    # Create a page, and on that page paste in an image on the internet that will not load.  # Create a PDF space export of the space containing that page    Result:    Export will continue to run forever and the following error will be displayed in the logs:    {noformat}  WARN [Long running task: PDF Space Export] [confluence.extra.flyingpdf.ConfluenceExportUserAgent] getImageResource Could not retrieve image resource http://www.site.com/image.gif during Confluence export  {noformat}    Expected Result:    Either the export will fail, or it will produce an export that does not contain the image.",3
"CONFSERVER-34066","06/25/2014 10:00:10","Bullet list keep extra space line after merged","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34066].   {panel}  Step to reproduce:   # In add two bullet list in the page like  !before.png!   # Remove the line contain the string ""line 2"", and it keeps one extra empty line after merging two bullet list.   !after.png!    As a workaround solution, press the back space at the beginning of the second bullet list to remove the empty line.",1
"CONFSERVER-34149","07/02/2014 15:47:02","JIRA Issue Macro not showing value for Σ Remaining Estimate","{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34149].  {panel}  h3. Summary    Total Remaining Estimate values are not showing in Jira issue macro in Confluence.  h4. Steps to reproduce   # Configure applink between JIRA and Confluence   # Create a DEMO project in JIRA   # Create a sub-task to one of the issue   # Add Remaining Estimate value for the parent and sub-task issues   # Create a page, add JIRA Issue Macro with filter of {{project = DEMO}}   # Include {{Σ Remaining Estimate}} for the _Columns to Display_   # Search in JIRA using {{project = DEMO}} and compare the results    h3. Expected Results    The value should be showing correctly in Confluence as it is already in JIRA.  h3. Actual Results    The Σ Remaining Estimate values are missing.   !screenshot-1.png|thumbnail!  h3. Additional Information    Last reproduced on Confluence 6.15.6 and JIRA 8.2.4.  Issue can be seen on the following column as well:  * Σ Original Estimate  * Σ Time Spent     Screenshots of JIRA, Confluence, and XML data from JIRA search   !Selection_004.png|thumbnail! !Selection_005.png|thumbnail! !Selection_006.png|thumbnail!  h3. Workaround    No workaround.",2
"CONFSERVER-34204","07/08/2014 16:21:08","findspaceattachments.jsp fails","When attempting to run findspaceattachements.jsp with a valid space key the following error pops up in our log:  {code}   ERROR [http-bio-8090-exec-2096] [[Standalone].[localhost].[/].[jsp]] log Servlet.service() for servlet [jsp] in context with path [] threw exception [An exception occurred processing JSP page /admin/findspaceattachments.jsp at line 48  {code}    The full error:  {code}  2014-07-08 15:19:50,268 ERROR [http-bio-8090-exec-2097] [[Standalone].[localhost].[/].[jsp]] log Servlet.service() for servlet [jsp] in context with path [] threw exception [An exception occurred processing JSP page /admin/findspaceattachments.jsp at line 48  45:                 }  46:                 else  47:                 {  48:                     HierarchicalFileSystemAttachmentDataDao dao = (HierarchicalFileSystemAttachmentDataDao) ContainerManager.getComponent(""fileSystemAttachmentDataDao"");  49:                     File pageDir = dao.getDirectoryForAttachmentContainer(0, space.getId());  50:                       51:                     // now remove the made up (0) contentId part  Stacktrace:] with root cause  java.lang.ClassCastException: com.atlassian.confluence.pages.persistence.dao.filesystem.FileSystemAttachmentDataDao cannot be cast to com.atlassian.confluence.pages.persistence.dao.HierarchicalFileSystemAttachmentDataDao   at org.apache.jsp.admin.findspaceattachments_jsp._jspService(findspaceattachments_jsp.java:124)   at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)   at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)   at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)   at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)   at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)   at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.labs.botkiller.BotKillerFilter.doFilter(BotKillerFilter.java:36)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:25)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.arsenale.plugins.lockpoint.LifecycleFilter.doFilter(SourceFile:53)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.mywork.client.filter.ServingRequestsFilter.doFilter(ServingRequestsFilter.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFixupFilter.doFilter(PrettyUrlsSiteMeshFixupFilter.java:36)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsDispatcherFilter.doFilter(PrettyUrlsDispatcherFilter.java:60)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFilter.doFilter(PrettyUrlsSiteMeshFilter.java:92)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsMatcherFilter.doFilter(PrettyUrlsMatcherFilter.java:56)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)   at com.atlassian.confluence.util.profiling.ProfilingPageFilter.doFilter(ProfilingPageFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.LoggingContextFilter.doFilter(LoggingContextFilter.java:40)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.UserNameHeaderFilter.doFilter(UserNameHeaderFilter.java:26)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.ConfluenceTimeoutFilter.doFilter(ConfluenceTimeoutFilter.java:63)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.seraph.filter.SecurityFilter.doFilter(SecurityFilter.java:211)   at com.atlassian.confluence.web.filter.ConfluenceSecurityFilter.doFilter(ConfluenceSecurityFilter.java:27)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.ThreadLocalCacheFilter.doFilter(ThreadLocalCacheFilter.java:28)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.security.auth.trustedapps.filter.TrustedApplicationsFilter.doFilter(TrustedApplicationsFilter.java:100)   at com.atlassian.confluence.util.AbstractBootstrapHotSwappingFilter.doFilter(AbstractBootstrapHotSwappingFilter.java:34)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.seraph.filter.BaseLoginFilter.doFilter(BaseLoginFilter.java:150)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.oauth.serviceprovider.internal.servlet.OAuthFilter.doFilter(OAuthFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.ClusterHeaderFilter.doFilter(ClusterHeaderFilter.java:42)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.johnson.filters.AbstractJohnsonFilter.doFilter(AbstractJohnsonFilter.java:72)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.gzipfilter.GzipFilter.doFilterInternal(GzipFilter.java:80)   at com.atlassian.gzipfilter.GzipFilter.doFilter(GzipFilter.java:51)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.core.filters.cache.AbstractCachingFilter.doFilter(AbstractCachingFilter.java:33)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.web.filter.ConfluenceTimingFilter.doFilter(ConfluenceTimingFilter.java:79)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:66)   at com.atlassian.confluence.extra.webdav.servlet.filter.ReverseProxyFilter.doFilter(ReverseProxyFilter.java:427)   at com.atlassian.confluence.extra.webdav.servlet.filter.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:34)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:74)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:42)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:77)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:63)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.validateparam.RequestParamValidationFilter.doFilter(RequestParamValidationFilter.java:58)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.TranslationModeFilter.doFilter(TranslationModeFilter.java:43)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.plugin.servlet.filter.ActionContextCleanUp.doFilter(ActionContextCleanUp.java:71)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.LanguageExtractionFilter.doFilter(LanguageExtractionFilter.java:53)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.util.RequestCacheThreadLocalFilter.doFilter(RequestCacheThreadLocalFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.ResponseOutputStreamFilter.doFilter(ResponseOutputStreamFilter.java:25)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.core.filters.HeaderSanitisingFilter.doFilter(HeaderSanitisingFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.servlet.FourOhFourErrorLoggingFilter.doFilter(FourOhFourErrorLoggingFilter.java:65)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:50)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)   at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)   at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)   at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:502)   at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)   at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)   at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)   at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1041)   at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:603)   at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)   at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)   at java.lang.Thread.run(Unknown Source)  {code}",2
"CONFSERVER-34246","07/13/2014 01:47:53","JIRA Issues Macro contributes to performance problems and outages in OnDemand","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34246].   {panel}  JIRA Issues Macro contributes to performance problems and outages in for large cloud customers. This overloads Apache and JIRA, eventually causing [AOD-6539|https://jira.atlassian.com/browse/AOD-6539] in some cases.",8
"CONFSERVER-34264","07/14/2014 19:26:30","JIRA Chart Not Rendered when Inserting to Confluence page and throwing 504 Error ","h4. Summary  Trying to add JIRA Charts in Confluence page will render the chart properly in the screens before inserting it to the page, but clicking on _Insert_ will get the chart disssapear and the Confluence page is unable to be saved. Seems like Confluence renders JIRA Charts data using both Application URL and Display URL.    h4. Steps to reproduce  (*execute the test from machine1*)  # Set up JIRA on machine1 (sample IP: 10.60.5.193) and Confluence on machine2 (sample IP: 10.60.5.198)  # (Test scenario) Current Base URL of JIRA is *http://10.60.5.193:8630/jira* and Confluence is *http://10.60.5.198:10561/confluence*  # Set up /etc/hosts on machine1 with _127.0.0.1 jiraisawesome_  # Login to *http://10.60.5.193:8630/jira* from *machine1*  # Set up application link using IP and ports (e.g: connect to *http://10.60.5.198:10561/confluence*)  # Login to *http://10.60.5.198:10561/confluence* from *machine1*  # Create a new Confluence Page  # Insert JIRA Chart by searching any existing JIRA project and Save the page (_Chart is displayed successfully_)  # Login to *http://10.60.5.193:8630/jira* from *machine1*  # Change the base URL of JIRA to use *http://jiraisawesome:8630/jira*  # Login to *http://10.60.5.198:10561/confluence* from *machine1*  # Modify the application link of JIRA - Display URL in Confluence to use *http://jiraisawesome:8630/jira*  # Perform Step 7 and 8 again    Here are the results  * We can view the chart in the preview of the prompt, but when _insert_ the chart, its not showing in the page preview and unable to click on the save button.  * URLs of the problem can be seen in the browser's developer mode  {code}HTTP 200 http://jiraisawesome:8624/jira/charts?filename=jfreechart-onetime-2627007503907999135.png    HTTP 504 http://10.60.2.176:8553/553/plugins/servlet/image-generator?macro=jirachart&jql=project+%3D+DEMO&statType=assignees&appId=29d6aed3-a496-3929-a14b-c4653473b6b3&chartType=pie&authenticated=true{code}    h4. Logs information  * Confluence log  {noformat}2014-06-04 17:33:33,503 ERROR [http-bio-8090-exec-3] [confluence.plugins.jira.AbstractProxyServlet] requestByAnonymousUser Can not retrieve data from jira servers by anonymous user   -- url: /plugins/servlet/image-generator | userName: admin  com.atlassian.sal.api.net.ResponseException   at com.atlassian.confluence.plugins.jira.ImageGeneratorServlet.handleResponse(ImageGeneratorServlet.java:185)   at com.atlassian.confluence.plugins.jira.AbstractProxyServlet.requestByAnonymousUser(AbstractProxyServlet.java:176){noformat}  * JIRA logs  {noformat}2014-06-04 17:33:33,498 http-bio-8080-exec-6 ERROR anonymous 1053x2945x1 - 192.168.200.3 /rest/gadget/1.0/piechart/generate [common.error.jersey.ThrowableExceptionMapper] Uncaught exception thrown by REST service  com.atlassian.jira.util.dbc.Assertions$NullArgumentException: parameter should not be null!   at com.atlassian.jira.util.dbc.Assertions.notNull(Assertions.java:38)   at com.atlassian.jira.charts.piechart.PieChartUrlGeneratorFactory.<init>(PieChartUrlGeneratorFactory.java:41){noformat}    h4. Additional Information  JIRA 6.2.7  Confluence 5.5.3    h4. Use case  There are users who configures JIRA and Confluence integration to be using a different Application URL than the Display URL. This configuration is used when the two servers not able to be contacted between each other using the Display URL. At times this is the prefered configuration with communication between two internal servers to be using internal IP/hostnames instead of the external IP/hostnames.    h4. Expected behaviour  The charts to be rendered normally in Confluence when using configurations of Display URL different than Application URL. With Display URL not necessarily able to reach the other server, but Application URL can.",1
"CONFSERVER-34274","07/15/2014 08:35:08","Help tips wrongly formated in ""Page Level Permissions"" screen","The _Help Tips_ in the _Page Level Permissions_ are wrongly formatted and it is very difficult to read the permissions (check left side of the screenshot).    Reproduced in Google Chrome 35.0.1916.153 on Linux.",1
"CONFSERVER-34385","07/24/2014 13:12:18","Embedded images placed inside of a table are not displaying properly when page is exported to PDF","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34385].   {panel}  h3. Summary  Images in tables that are not manually sized increase in size or are missing when exported to PDF.    h3. Steps to Reproduce  # Create a table in a Confluence Page  # Insert an image in one of the cells  # Export page to PDF    h3. Expected Results  The exported PDF matches what is displayed in the page when viewed    h3. Actual Results  The small image is displayed much larger than its actual size or the image is missing in the table.    h3. Workaround  # Edit page with the image  # Click on image, resize to any size *use the _px_ value* . i.e. :  !Screen Shot 2015-04-17 at 3.03.42 AM.png|thumbnail!  # Press enter to apply the change to the image  # Click on image again, resize back to the desired size i.e. :  !Screen Shot 2015-04-17 at 3.03.59 AM.png|thumbnail!  # Press enter to apply the change and save page  # Export page to PDF",3
"CONFSERVER-34406","07/28/2014 06:48:02","Support batching for old wiki markup in the old format {jira:ABC-xyz}","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-34406].   {panel}  In [CONF-32525|https://jira.atlassian.com/browse/CONF-32525] batching was introduced for pages with multiple JIRA Issues Macros. This batching did not extend to JIRA Issues Macros which were entered in wiki markup, eg:  {code}  {jira:ABC-123}  {code}    Please support batching for wiki markup format as well.      h3. Resolution  This issue has been resolved in JIRA Issues Macro version 5.6.3. Please download this version from the Marketplace (https://marketplace.atlassian.com/plugins/confluence.extra.jira/versions)",3
"CONFSERVER-34628","07/31/2014 08:08:14","Empty page layout cells are excluded from storage format","Steps to reproduce:    1. Create a page with a 2 column layout  2. In the left column, add a heading  3. Save the page - observe that the heading is in the left column  4. Edit the page, select all the content in the left column, cut and paste into the right column  5. Save the page and observe that the content has not moved    Workaround is to ensure that the left column has some content (e.g. a space).    It turns out that empty page layout cells are excluded when the page is converted to storage format.    Storage format for two-column layout with an empty cell (storage format is the same regardless of which column has content):  {code}  <ac:layout><ac:layout-section ac:type=""two_equal""><ac:layout-cell>  <h1>Heading</h1>  <p>Some content.</p>  <p>&nbsp;</p></ac:layout-cell></ac:layout-section></ac:layout>  {code}    Storage format when both columns contain content:  {code}  <ac:layout><ac:layout-section ac:type=""two_equal""><ac:layout-cell>  <h1>Heading</h1>  <p>Some content.</p>  <p>&nbsp;</p></ac:layout-cell><ac:layout-cell>  <p>&nbsp;</p></ac:layout-cell></ac:layout-section></ac:layout>  {code}",1
"CONFSERVER-34529","08/08/2014 15:20:35","Unable to Search Office Open XML Files","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34529].   {panel}  # Create 2 duplicate documents, 1 .doc and 1 .docx  # Attach both in Confluence  # Perform search of text that is in file, results only return .doc file.  # Also both attachments do not appear in drop-down search window that comes up, you have to click the Search query to see it.",3
"CONFSERVER-34716","08/27/2014 21:33:10","REST API throws 500 with null pointer exception","I'm sending the following via PUT using the REST API browser  {code}  {    ""id"": ""2359303"",    ""type"": ""page"",    ""title"": ""NewZions"",    ""body"": {      ""editor"": {        ""representation"": ""editor"",        ""_expandable"": {          ""content"": ""/rest/api/content/2359303""        }      },      ""view"": {        ""representation"": ""view"",        ""_expandable"": {          ""content"": ""/rest/api/content/2359303""        }      },      ""export_view"": {        ""representation"": ""export_view"",        ""_expandable"": {          ""content"": ""/rest/api/content/2359303""        }      },      ""storage"": {        ""value"": ""<p>First delivery is&nbsp;@ 192.168.20.something</p><p>Second delivery is&nbsp;@ 192.168.20.something:20080</p><p>And this was added via REST</p>"",        ""representation"": ""storage"",        ""_expandable"": {          ""content"": ""/rest/api/content/2359303""        }      }    },    ""_links"": {      ""webui"": ""/display/WHERE/NewZions"",      ""tinyui"": ""/x/BwAk"",      ""collection"": ""/rest/api/content"",      ""base"": ""http://confluence.imagehawk.local:8090"",      ""self"": ""http://confluence.imagehawk.local:8090/rest/api/content/2359303""    },    ""_expandable"": {      ""history"": ""/rest/api/content/2359303/history"",      ""container"": """",      ""ancestors"": """",      ""children"": ""/rest/api/content/2359303/child"",      ""descendants"": ""/rest/api/content/2359303/descendant"",      ""space"": ""/rest/api/space/WHERE"",      ""version"": """",      ""metadata"": """"    }  }  {code}  The response looks like:    {panel}  Response  PUT http://confluence.imagehawk.local:8090/rest/api/content/2359303 (500)  Date: Wed, 27 Aug 2014 20:24:25 GMT  Content-Encoding: gzip  X-Content-Type-Options: nosniff  Server: Apache-Coyote/1.1  X-Seraph-LoginReason: OK  Vary: User-Agent  Content-Type: application/json  Access-Control-Allow-Origin: http://confluence.imagehawk.local:8090  Transfer-Encoding: chunked  Connection: close  Access-Control-Allow-Credentials: true  Access-Control-Allow-Headers: Content-Type  X-AUSERNAME: mjones  {panel}    {code}  {    ""statusCode"": 500,    ""message"": ""java.lang.NullPointerException: null""  }  {code}",1
"CONFSERVER-34751","09/01/2014 03:45:58","Importing an XML Export does not create inline tasks and comments correctly","{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34751].    {panel}    {panel:title=Fix description|borderStyle=solid|borderColor=#ebf2f9 | titleBGColor=#ebf2f9 | bgColor=#ffffff}  Hello everyone,    The fix for this issue will not fix the links for XML exports that are already imported, but will prevent the issue from happening on newer import jobs.  This applies to Space XML exports prior to Confluence 7.0.1 as well, and they will not hit into this issue if imported into Confluence 7.0.1 and later.  {panel}    h5.Steps to Reproduce  # Create a new Space  # Export the Space as XML  # Delete the Space you just created  # Import the Space Export  # On a page, create the Task Report Macro, and point it at the imported space.    h5.Expected Result  The Task Report Macro should show the tasks that are incomplete, or complete (depending on the settings). Using this example, the report should show 4 incomplete tasks (from the default home page)    h5.Actual Result  The Task Report Macro doesn't show the tasks that are incomplete. Marking a task as complete and then incomplete doesn't show the task either.    The task does not appear in the database.     h5.Workaround (not applicable to Confluence Cloud)  # Perform a full backup of the Confluence Database  # Shutdown Confluence  # Execute the following SQL Queries: {code:sql}  delete from ""AO_BAF3AA_AOINLINE_TASK"";  delete from bandana where bandanakey = 'com.atlassian.confluence.plugins.confluence-inline-tasks:build';  {code}  # Start Confluence    Confluence will re-migrate any inline tasks to the new inline task format, which will correctly re-add the tasks not handled when importing.    h3. Notes    It is possible to tweak the migration task thread number to speed up the process. To do so, add the following system property to the instance before starting the process:  {code}  CATALINA_OPTS=""-Dtasklist.storagetoaoupgradetask.numthreads=18 ${CATALINA_OPTS}""  {code}    To define the ideal number of threads for the process, we can use the following formula:  {code}  ideal_thread_number = availableProcessors() * 2 + 2;  {code}",3
"CONFSERVER-34793","09/03/2014 14:51:03","JIRA Issues Macro returns ""Data cannot be retrieved due to an unexpected error""","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-34793].   {panel}  h3. Note    This error message is the catch-all exception for the JIRA Issues Macro, so there are a number of possible causes for this. The below example is one way of triggering the problem. Another known cause is the response from JIRA taking too long and exceeding the timeouts in Confluence. If you suspect this is the case in your instance, please refer to [this KB article|https://confluence.atlassian.com/display/CONFKB/Timeouts+in+the+JIRA+Issues+Macro+or+Highlighting+Plugin] for more information.    If you run into this problem, please add the following packages to *Confluence Admin > Logging and Profiling* and set them to DEBUG level logging:  * com.atlassian.confluence.extra.jira  * com.atlassian.confluence.plugins.JIRA    Having done so, please create a ticket at http://support.atlassian.com/ and attach a Support Zip with this extra logging.     h3. Steps to reproduce    # Add many JIRA issue links on a Confluence page. Try 30.  # Save the page    h3. Expected Results    The JIRA issue links display fine with summary, status, etc.    h3. Actual Results    Confluence displays an error message for each JIRA issue link:    bq. JIRA Issues Macro: Data cannot be retrieved due to an unexpected error    h3. More info    Confluence logs show:    {code}  2014-09-03 06:42:40.601459500 2014-09-03 06:42:40,596 ERROR [TP-Processor127] [extra.jira.util.JiraUtil] checkForErrors Received HTTP 413 from server. Error message: Request Entity Too Large  2014-09-03 06:42:40.601462500  -- url: /wiki/display/KEY/My+Page | page: 1234567 | userName: myname | action: viewpage  {code}",5
"CONFSERVER-47583","09/13/2014 15:42:34","Fail create the question will cause you loosing the Files attached in the ""insert image dialog""","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-47583].   {panel}   Steps:  - Create a question, add some image on it. You can attach image on the question  - Before you click button ""save"", make sure you have no label. Click save. It will tell you that you need to select a topic  Error:  - Check the ""insert image dialog"" again, you will see there are no file attached.    This issue is found on version confluence-questions-1.0.618 which doesn't have to rework of insert dialog yet.",3
"CONFSERVER-34990","09/19/2014 15:18:48","Copy Page: Notifications are sent to receivers that cannot view the page","Don't use Copy Page function for copying restricted pages. If the space is watched (through Space watch and RSS); notifications are sent even if restrictions are set that should inhibit such notifications.    To reproduce:  1. Restrict viewing for a page to some individuals.    2. Log in with an account that is not allowed to see the page. Watch the space containing the page (through Space watch and RSS).    3. Log in with an account that has viewing access and editing permission for the page. Copy the page.    4.The watcher will be notified although the watcher has no viewing permission.    Expectation:  If a a page viewing restriction is set, it is also applied to page copies before notifications are sent.    Technical issue:   It seems that page restrictions are set or checked after (instead of before) the copy-page notification is generated.",2
"CONFSERVER-35080","09/25/2014 15:51:27","Adding a pptx into Confluence fails with ""There was a problem converting this attachment""","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-35080].   {panel}  If you upload a pptx file into a Confluence page you will get the following error:  !img.PNG|thumbnail!    Into the atlassian-confluence.log you will get below stack trace:  {code}   -- referer: http://confluence:8090/display/TEST/Test+pttx | url: /plugins/servlet/pptslide | userName: admin  2014-09-25 11:15:22,901 WARN [http-bio-8090-exec-3] [com.benryan.conversion.PPTSlideServlet] doGet Conversion task timed out for attachment : junk.pptx with page number 0, waited : 300, now executing in background.   -- referer: http://confluence:8090/display/TEST/Test+pttx | url: /plugins/servlet/pptslide | userName: admin  2014-09-25 11:15:23,216 ERROR [DefaultSlideCacheManager:thread-1] [com.benryan.conversion.AbstractSlideConversionTask] call problem while converting junk.pptx   -- referer: http://confluence:8090/display/TEST/Test+pttx | url: /plugins/servlet/pptslide | userName: admin  java.lang.NumberFormatException: For input string: ""f0""   at sun.misc.FloatingDecimal.readJavaFormatString(FloatingDecimal.java:1241)   at java.lang.Double.parseDouble(Double.java:540)   at com.benryan.escher.XmlCustomShapeRenderer.getDouble(XmlCustomShapeRenderer.java:170)   at com.benryan.escher.XmlCustomShapeRenderer.convertPoint(XmlCustomShapeRenderer.java:165)   at com.benryan.escher.XmlCustomShapeRenderer.renderCustomShape(XmlCustomShapeRenderer.java:83)   at com.benryan.escher.EscherRenderer.renderAutoshape(EscherRenderer.java:551)   at com.benryan.escher.EscherRenderer.walkShapes(EscherRenderer.java:233)   at com.benryan.ppt.PptRenderer.render(PptRenderer.java:125)   at com.benryan.conversion.PPtDocumentConversionTask.convertFile(PPtDocumentConversionTask.java:56)   at com.benryan.conversion.PPtDocumentConversionTask.convertFile(PPtDocumentConversionTask.java:27)   at com.benryan.conversion.AbstractSlideConversionTask.call(AbstractSlideConversionTask.java:50)   at java.util.concurrent.FutureTask.run(FutureTask.java:262)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)   at java.lang.Thread.run(Thread.java:745)  2014-09-25 11:15:26,274 WARN [http-bio-8090-exec-3] [jersey.spi.inject.Errors] processErrorMessages The following warnings have been detected with resource and/or provider classes:    WARNING: A HTTP GET method, public javax.ws.rs.core.Response com.atlassian.confluence.tinymceplugin.rest.DraftsResource.getDrafts(int,int), should not consume any entity.   -- referer: http://confluence:8090/display/TEST/Test+pttx | url: /rest/tinymce/1/content/2228226.json | userName: admin  {code}    h4. Steps to Reproduce:  # Setup a Confluence 5.6.3.  # Create a test page.  # Drag and drop the example attachment added in the restricted comment (it's for internal use only).  # Save the page.    h4. Notes:  * The power point file was created in Office 2013.  * Office Connector version 3.3.8 (latest on Confluence 5.6.3)  * We don't know which specific configuration causes this error.    h4. Additional information  The error occurs on this pptx ([link|https://support.atlassian.com/secure/attachment/1104238/1104238_WG_GlobalPres_template_del_001+%281%29.pptx]) as well.  However, once the pptx is modified by 'Save As' PowerPoint 97-2003 Presentation (.ppt) or PowerPoint Picture Presentation (.pptx), it can be displayed successfully.",5
"CONFSERVER-35114","09/29/2014 11:13:58","REST API documentation refers to children instead of child in its examples","In the examples for https://docs.atlassian.com/confluence/REST/latest/#d3e456, we see {{http://example.com/rest/api/content/1234/children/comment}}.",1
"CONFSERVER-35279","10/15/2014 15:04:38","Missing people from People Directory on Confluence","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-35279].   {panel}  *Steps to Reproduce:*  # Have JIRA + Confluence  # Add user just to JIRA (jira-users)  # Grant this user application access to Confluence. Let's say, update the same user and add him/her to Confluence (confluence-users)    *Expected Results:*  # This user should show up in the People Directory on Confluence.    *Actual Results:*  # This user is missing from People Directory on Confluence    *Workaround:*  # Access this URL:  {code}https://<yourInstance>.atlassian.net/wiki/display/~<username>{code}    *Notes:*  Documentation ([Searching the People Directory|https://confluence.atlassian.com/display/confcloud/Search+the+People+Directory]) states that  bq. The people directory includes anybody who has logged into Confluence or *who has had a user account created for them in Confluence*.",5
"CONFSERVER-35282","10/15/2014 18:57:48","SOAP Method addProfilePicture() no longer creates @mention thumbnails","This used to work in Confluence 5.4.3. Since upgrading to 5.5.6, I can no longer update a user's @mention thumbnail picture.    As there is no REST equivalent for this method, we'd really appreciate a fix or workaround.    h2. Reproduction:    1. Use the sample [Python script|https://answers.atlassian.com/questions/72487/how-do-i-use-addprofilepicture-in-python] to upload a 48x48 picture.   2. User's @mention picture will show the generic unset avatar  3. User's full profile picture in their homepage shows the correct avatar    h2. Workaround:  Trigger a reindex via Confluence Admin > Content Indexing    ",1
"CONFSERVER-35306","10/17/2014 19:57:40","Confluence does not respect the selected application when creating an issue through the JIRA Issues Macro.","When Confluence has Application Links created for more than one JIRA, if the user tries to create a new issue through JIRA Issues Macro on the JIRA that is not set to primary on the applinks list, Confluence actually creates the issue on the primary JIRA instead.    Also, if both projects (from Primary JIRA and the other JIRA) have different types for issues, the creation button won't work, keeping Confluence on the same screen.    *Steps to reproduce:*  # Install 2 JIRA 6.2.3 instances  *On JIRA 1*  # Create a new Software Development project called ""Project1""  *On JIRA 2*  # Create a new Simple Issue Tracking project called ""Project2""  (i) The Project Type does not matter, we just need to create a custom Issue Type  # On JIRA2. create a custom Issue Type called ""new"", for example  # Now, install a Confluence 5.6.3  # Create the application links between Confluence and those 2 JIRA instances  # Set *JIRA1* to primary on Confluence's applinks list  # Create a page on Confluence  # Insert the JIRA Issues Macro  # Create a new issue  # Server = JIRA1, Project = Project1, issue type = Bug, fill in summary and description  # Click insert  #* Issue is created and displayed on page  # Save the page  # Edit the page  # Insert the JIRA Issues Macro  # Create a new issue  # Server = JIRA2, Project = Project2, issue type = new, fill in summary  # Click on insert  #* No response - popup still open, nothing changed  # Change issue type to _New Feature_, fill in summary   # Click on insert  #* The issue is inserted, however, if you look at this just created issue, it was actually created on JIRA1 (Project1) instead of JIRA2 (Project2)    Also, another issue related to this bug is if the secondary JIRA (JIRA2) has 2 projects while the primary JIRA (JIRA1) has only one. If the user selects the second project, Confluence shows a red error text: ""Project is required""",3
"CONFSERVER-35516","11/06/2014 03:30:51","AttachmentResource.update incorrectly requires version+1","PUT to rest/api/content/<id>/child/attachment/<attachmentid> only updates attachment metadata - it doesn't change the attachment content nor create a new version, which is correct.    However it requires that the version in the post is <currentversion+1> (it rejects <currentversion> with a 409 Conflict error), which is incorrect, since the metadata on <currentversion> is updated, and no <currentversion+1> is created.",1
"CONFSERVER-35681","11/19/2014 00:41:31","Pages including own excerpt show error rendering macro 'excerpt-include' : null","Since recently upgrading Confluence to latest stable versions, pages with excerpt-include references to the page on which they are on no longer work correctly. Instead displaying the message...    Error rendering macro 'excerpt-include' : null    So, to clarify. Impacted pages have the ""Excerpt Include"" macro with the ""Page Containing the Excerpt"" parameter set to the current page, the very same page where the macro itself resides. Hope that makes sense.    Here's the source, looks like this could be an issue with the Macro Browser as the name parameter appears to be a null link. Hope this helps...    <ac:structured-macro ac:name=""excerpt-include""><ac:parameter ac:name=""""><ac:link /></ac:parameter></ac:structured-macro>",2
"CONFSERVER-35755","11/28/2014 00:00:40","REST API ""list pages"" does not return all pages","When I try to list all pages in a space using the REST API, I send HTTP GET to:  ""http://localhost:8090/rest/api/content?limit=1000'"". I get back 100 entries and a ""next"" link to the next 100 entries.  Following the links until there is no ""next"" in the result, Confluence returns only 300 entries from a space which contains 342 pages.    Using the JSON-RPC API returns all pages without a problem.    When I tried to repeat the queries ""manually"" using execution of multiple ""curl"" calls I got back more entries but many were duplicates.    I think this likely has something to do with restrictions and the PaginationService",3
"CONFSERVER-35780","12/02/2014 10:16:00","NPE when display single JIRA issue link with anonymous user","Here are the steps to reproduce:  # Install JIRA 6.1.x or later and Confluence 5.4.x or later.   # Set up the application links between JIRA and Confluence with trusted applications and Oauth using the option ""Allow user impersonation through 2-Legged OAuth"".  # Create project TEST with one issue TEST-1. JIRA and project do not have anonymous access.  # Create a new space on Confluence with anonymous access.  # Copy the issue link and parse the link to an empty page.   # Try to open the page with anonymous user. Then got the error:  {noformat}  com.atlassian.confluence.macro.MacroExecutionException: java.lang.NullPointerException  {noformat}    If switch the single issue link to a table view by change the JQL, the NullPointerException is gone.",5
"CONFSERVER-35945","12/17/2014 19:38:56","Export to PDF, Centered Images are not included in .pdf file","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-35945].   {panel}  PDF Exports of wiki page with centered images don't include images.    *Steps to reproduce:*  # Create a page and insert an image jpg, png etc...  # Export the page to PDF. You should see that the image(s) did export.  # Edit the page and align the image to the center.  # Export the page to PDF again.  *Expected result:* Image shows in the center.  *Actual result:* Image is not displayed.    *Cause:*  The alignment done using the image tags is not being exported:    This is the ""Storage Format"" of a centered image that is not exported to PDF:  {noformat}  <p><ac:image ac:align=""center""><ri:attachment ri:filename=""image.jpg""><ri:page ri:content-title=""Images Page"" ri:space-key=""KB"" /></ri:attachment></ac:image></p>  {noformat}  and this is the one of an image centered by using the workaround and is exported to PDF (without alignment)  {noformat}  <p style=""text-align: center;""><ac:image><ri:attachment ri:filename=""image.jpg""><ri:page ri:content-title=""Images Page"" ri:space-key=""KB"" /></ri:attachment></ac:image></p>  {noformat}      *Workaround:*  center-align the cursor +before+ including the image to the page.  The image will be added in the center and will be displayed in PDF exports.        ",3
"CONFSERVER-48944","01/30/2015 04:58:54","The event of Calendar creation is viewable at Activity even by users who are restricted","The event of calendar creation is viewable at Activity even by users who are restricted. Hence, users have to be careful not to describe sensitive information on the name of calendars.    This is how I reproduced:  # Install Confluence 5.6.6  # Install Team Calendar 5.1.21 addon  # Create two confluence-users - user1 and user2  # Login as user1 and:  ## create a calendar - ""User1's Calendar""  ## Give viewing restrict only to user1  # Login as user2 and:  ## Go to People Directory and choose user1  ## user2 can see the activity that ""User1's Calendar"" was created though user2 cannot view the calendar (See also the attached ActivityStream.jpg)    ",5
"CONFSERVER-36376","02/04/2015 15:05:01","PDF Export: Images on the beginning of a page have huge white space in front","Images in a pdf export, which doesn't fit on a page are moved to the next page. With Confluence 5.7 these images have exactly the same whitepace in front, which was left blank on the page before. For large images, that can be more than half of the page. In this case the image is split on the following 2 pages.    The attachment is from a fresh space with no css styling. Sadly I didn't find any workaround for that (margin/padding has no impact as well as setting a fixed size of the picture). This bug prevents proper exports of customer documentation.",3
"CONFSERVER-36424","02/08/2015 16:32:52","REST API to render content needs content id support","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-36424].   {panel}  See CONF-25086 which was marked as fixed, but was not complete.    Add a Content representation with embedded styles, similar to SOAP API.  ",3
"CONFSERVER-36547","02/16/2015 02:27:20","Jira Issues Macro slowdown when saving pages","When saving a page with Jira Issues Macro on it *and* you've authorized the connection, page saving gets very slow, and lots of DB and/or JIRA requests (not sure which ones) are made, making the node/instance very slow.    This impacts versions 5.8, 5.8-m13 and 5.8-m18 of the JIRA issues macro",8
"CONFSERVER-36560","02/17/2015 12:50:18","Task Report Macro Headers field from Confluence Inline Tasks plugin are not translated.","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-36560].   {panel}  h3.Step to replicate  # Create a page with a Task Report Macro   # Change the language setting  for the user to a non English language  # Go back to the page.    h3. Expected Result  The Task Report Macro is displayed in the selected languages      h3. Observed Result  The Headers of the Task Report Macro are not translated even when a different languages is selected.  !test_1.png|thumbnail!    h3. Cause  The mismatch occurs when the user's language is different from the global language. In some places, the global language is preferred over the user's.    h3. Workaround  If it is feasible, ensure that the global language (Confluence Admin > Languages) is set to the same language as the end user's. The end user should also ensure that their browser language is set to their preferred language.",2
"CONFSERVER-36711","02/27/2015 19:06:42","Regression: Large images are cut off on PDF Export","The original thread: https://jira.atlassian.com/browse/CONF-33727    A large image is just cutted in width on a PDF export instead of being resized.    h3. Steps to reproduce:    # Create a new page;  # Include an image (I am attaching the one I used in the test, adding borders in order to better notice the cut);  # Save the page;  # Export as PDF;  # Notice the right part is cut.  ",3
"CONFSERVER-36841","03/11/2015 13:23:54","5.7 Comments Not Working on Headings when other Macros on page","Hi there,    This page won't allow me to add comments to the headings. Running Confluence 5.7. Any ideas?  !testing.png|thumbnail!    Here's the page's source code:   !testing.png|thumbnail!  {code:java}  <ac:layout>    <ac:layout-section ac:type=""two_right_sidebar"">      <ac:layout-cell>        <h3>Word Document Dragged onto Page</h3>        <p> </p>        <p>          <ac:structured-macro ac:name=""view-file"">            <ac:parameter ac:name=""height"">250</ac:parameter>            <ac:parameter ac:name=""name"">              <ri:attachment ri:filename=""DealMaker Release Notes v6.08.9.doc""/>            </ac:parameter>          </ac:structured-macro>        </p>        <h3>PPT Dragged onto Page</h3>        <p>          <ac:structured-macro ac:name=""view-file"">            <ac:parameter ac:name=""height"">250</ac:parameter>            <ac:parameter ac:name=""name"">              <ri:attachment ri:filename=""Doc_POV_PPT.pptx""/>            </ac:parameter>          </ac:structured-macro>        </p>        <p> </p>        <h3>Random file dragged onto page</h3>        <p>          <ac:structured-macro ac:name=""view-file"">            <ac:parameter ac:name=""height"">250</ac:parameter>            <ac:parameter ac:name=""name"">              <ri:attachment ri:filename=""iqstage-current.log.gz""/>            </ac:parameter>          </ac:structured-macro>        </p>        <p> </p>        <h3>Word Macro</h3>        <p>          <ac:structured-macro ac:name=""viewdoc"">            <ac:parameter ac:name=""name"">              <ri:attachment ri:filename=""DealMaker Release Notes v6.08.9.doc""/>            </ac:parameter>          </ac:structured-macro>        </p>        <p> </p>        <p> </p>        <h3>PPT Macro</h3>        <p>          <ac:structured-macro ac:name=""viewppt"">            <ac:parameter ac:name=""name"">              <ri:attachment ri:filename=""Doc_POV_PPT.pptx""/>            </ac:parameter>          </ac:structured-macro>        </p>        <p> </p>        <h3>Simple attachment list</h3>        <p>          <ac:structured-macro ac:name=""list-attachments""/>        </p>        <p> </p>        <h3>Attachments Macro</h3>        <p>Pla<ac:inline-comment-marker ac:ref=""d1990fb6-7e4f-42b3-b0d3-9953bd1f5695"">in t</ac:inline-comment-marker>est</p>        <p>          <ac:structured-macro ac:name=""attachments""/>        </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p> </p>        <p>          <ac:structured-macro ac:name=""attachments"">            <ac:parameter ac:name=""sortBy"">name</ac:parameter>          </ac:structured-macro>        </p>        <p>          <ac:structured-macro ac:name=""viewtracker""/>        </p>        <p> </p>      </ac:layout-cell>      <ac:layout-cell>        <p>          <ac:structured-macro ac:name=""toc""/>        </p>      </ac:layout-cell>    </ac:layout-section>  </ac:layout>  {code}    ",3
"CONFSERVER-48462","04/02/2015 07:51:40","Sort Event Types alphabetically in calendar view","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-48462].   {panel}  Steps to reproduce:  - Add new calendar  - Add some custom Event types for the new calendar, named ""A"", ""B"", ""C"" etc.  - Add events with the different custom event types  - In the calendar view page, the event types are not sorted alphabetically, but in an odd and not comprehensible order. See screenshot.    This is very annoying in a calendar with many event types.",3
"CONFSERVER-37890","06/12/2015 07:51:39","Page Properties Report is fetching a limited number of pages","h3. Summary  Page Property Report Macros only fetches a limited number of pages.     h3. Environment  Experienced in 6.3.1 while issues reported from previous versions listed in the ""Affected Version""    h3. Steps to Reproduce   h5. How to reproduce method #1: Use the sample Space Export   Get this XML space export  [^900pagesPPRmacro.zip]  which is a space that contains 900 pages containing Page Property macro with the labels ""discussion""  # Load the page with the title ""PP Report Macro with Number of items to display = 100"" from the xml export  # Load the page with the title ""PP Report Macro with Number of items to display = 10000"" from the xml export    h5. How to reproduce method #2: create own space with 900 pages containing page-properties (any number more than 500):  {panel}  # create a space with more than 500 (eg: 900) pages containing page-properties.  # create a page containing the page-properties-report macro and set the ""number of objects to be shown"" to 100 and 10000  {noformat}  <p>    <ac:structured-macro ac:macro-id=""08027386-e7e9-4d92-8ad6-5168aa775020"" ac:name=""detailssummary"" ac:schema-version=""2"">      <ac:parameter ac:name=""pageSize"">100</ac:parameter>      <ac:parameter ac:name=""analytics-key"">requirements</ac:parameter>      <ac:parameter ac:name=""cql"">label = ""product"" and space = currentSpace()</ac:parameter>    </ac:structured-macro>  </p>  {noformat}  {panel}    h3.Expected Results  # all 900 pages should be listed and the page should have 9 tabs appeared (100 result for every tab)  # all 900 pages should be displayed    h3.Actual Results  # only 5 tabs are listed in this page (100 pages on every tab = only displaying 500 pages)  # only 500 pages are listed   #* Results may vary from 500-550     The following appears in atlassian-confluence.log:  {code}  2017-07-16 16:59:58,699 WARN [pool-12-thread-2] [atlassian.confluence.event.MonitorableCallerRunsPolicy] rejectedExecution Queue Overflow happened: Runnable: [Invoker: com.atlassian.confluence.event.ConfluenceListenerHandlersConfiguration$TimingListenerHandler$1$1@16fe75dc; Event: com.atlassian.confluence.impl.content.render.xhtml.analytics.MarshallerMetricsAnalyticsEvent@bcfc4d6]; Executor: [java.util.concurrent.ThreadPoolExecutor@3569abb7[Running, pool size = 2, active threads = 2, queued tasks = 256, completed tasks = 30473]]   -- url: /rest/masterdetail/1.0/detailssummary/lines | referer: http://localhost:8613/display/PPM/PP+Report+Macro+with+Number+of+items+to+display+%3D+10000 | traceId: 723d28b96b998853 | userName: admin  {code}  # Increasing http threads and database connection threads does not make any difference  # Disabling Analytics does not make any difference and the logs above still appears  # Increasing Page Property Report Caching does not make any difference    h3. Notes  The issue is specifically caused by an issue in ""fetching"" the complete result. This is because when we change the Page Property Report macro configuration as ""Reverse Sort"" (and the pages are sorted based on modified date), the oldest pages now appears in the list while the recently created pages disappeared.  ",3
"CONFSERVER-38036","06/24/2015 08:26:34","Confluence Attachment search does not work if the attachment name has hyphen  ""-""","I have uploaded an attachment which has hyphen(""-"") in its name, to a confluence page.   When I try to search the attachment by clicking ""insert -> images -> Search -> This space"",   attachment was not found in Search result.   Confluence Search is not able to find the attachment if it has ""-"" in the name.    +Steps to reproduce:+  * Upload an attachment which has ""-"" in it's name to a confluence page.(Ex: Outlook-encrypt.png)  * Edit the page and try to embed the attached image on this page by clicking ""images => Search => This space"".  * Enter the search string as ""Outlook-encrypt"" and search.  * Even though attachment exists, it will not be displayed while searching with search string ""Outlook-encrypt"".    It's very common practise to have hyphen in file names.   There are many attachments uploaded to our Confluence pages by users have the hyphens in attachment names.  Our users are not able to search the attachments because of this issue.",5
"CONFSERVER-38277","06/26/2015 16:49:43","Confluence Page gadget throws ""The resource rest/webResources/1.0/resources, cannot be found."" error","h3. Summary  After creating an application link between JIRA and Confluence, have JIRA subscribe to Confluence gadget and add the *Confluence Page Gadget* to a JIRA dashboard. You will see the following error in it.    h3. Steps to Reproduce  # Install JIRA 6.4.7 with context path (http://localhost:6471/jira)  # Install Confluence 5.8.4 with context path (http://localhost:5841/conf)  # Create an AppLink between them  # Subscribe to Confluence gadget in JIRA  # Add the *Confluence Page Gadget* to a JIRA dashboard  # Select a space and a page    h3. Expected Results  The page shows up fine with no error    h3. Actual Results  You will see the below error while nothing is thrown in the logs:    *The resource /conf/rest/webResources/1.0/resources, cannot be found*  !error.png|thumbnail!    Clicking on the link will redirect to http://localhost:6471/conf/rest/webResources/1.0/resources which is the wrong port/context path combination     h3. Notes  * Tested with both Trusted Application and OAuth  * Also tested with JIRA 6.3.15 and Confluence 5.8.4  * Does *not* happen with JIRA 6.4.7 and Confluence 5.7    h3. Workaround  If JIRA and Confluence URLs do not have a context path, the error doesn't appear.",3
"CONFSERVER-38191","07/06/2015 00:38:43","HTML-encoded characters aren't found in text searches","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-38191].   {panel}  Found with customer [~georg.kraler1] in a Page Properties Report issue CONF-37890.    Specifically, pages with words including &amp;uuml; aren't being found when searching for ü.",2
"CONFSERVER-38182","07/06/2015 10:40:43","Internet Explorer 11 memory increases continuously when browsing Confluence","h3. Summary    When browsing Confluence via IE 11 , the browser memory increases and after sometime IE does not response.  h3. Environment    Internet Explorer 11  h3. Steps to Reproduce   # Access Confluence using IE 11   # Open any page (You can also test this on confluence.atlassian.com)   # Press the development tools with F12, open Memory and start profiling ([https://msdn.microsoft.com/en-us/library/dn255003(v=vs.85).aspx])   # Just switch between pages and browse the confluence instance   # You should see an increase of memory usage with every switch    h3. Expected Results    IE 11 should not crash and run normally  h3. Actual Results    IE 11 stops working  h3. Notes    You will not be able to replicate this issue if you have large amount of RAM on your machine . I was able to replicate this when the browser memory reached 2 GB .  {panel:title=Atlassian Resolution|borderStyle=solid|borderColor=#3c78b5|titleBGColor=#3c78b5|bgColor=#e7f4fa}  Thanks for your interest in this issue.    As we dug deeper into the IE11 memory leak issue, we have been able to reliably reproduce the leak within IE11 11.0.9600.18861 (circa 08/2017) on Windows 8. Using a vanilla Confluence installation and refreshing the page a number of time, it can be observed that the memory consumed by the page itself remains consistent, however the iexplore.exe process continues to grow.    Restesting on IE11 11.251.16299.0 (circa 02/2018) and Edge 41.16299.248.0 on Windows 10 we were unable to reproduce the same memory leak.    We have not been able to find a definitive list of the issues fixed in this IE11 release, but believe the issue is [Memory leak - IE Edge - Microsoft Edge 8020622|https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8020622/] (previosuly fixed in Edge only). Therefore, whilst we are confident that this issue can be resolved, there is a small chance that there still remains an issue.    *Resolution:* Please upgrade to Windows 8/10 and the latest version of IE11 (11.251.16299.0) circa 02/2018 and Edge 41.16299.248.0 or greater to fix this issue. NOTE: The issue persists on Windows 7 for which we have not plans to address this as we believe the issues lies with Microsoft.    Cheers,    The Confluence Server team  {panel}",3
"CONFSERVER-38951","08/28/2015 17:43:36","Inline Comments Missing After Space Export/Import Process","{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-38951].    {panel}    h3. Summary  In-line Comments and Resolved Comments are imported with a Space Export, but throw a 500 error when the REST call is made for rendering the Page. This has been replicated with space exports from Confluence Cloud and Confluence Server.    h3. Environment  * Confluence Cloud  * Confluence Server 5.7, 5.8.18 or 5.9.4.  * The Space has Resolved in-line comments    h3. Steps to Reproduce  # Go to a Space and a Page within that Space. Add two in-line comments and resolve one of them.  # Do a full XML export of the Space  # Import the Space export into a new instance (either same version or same major version)  # Notice the import completes successfully, but the in-line and resolved comments are not displayed even though they are present in the {{entities.xml}} file and database.    h3. Expected Results  In-line comments are displayed.    h3. Actual Results  The in-line comments are imported into the database, however the {{user_key}} is not mapped correctly from the old instance to the new instance.     h3. Workaround  {color:red}SQL manipulation in the database is not supported. Please make sure you have a database backup.{color}    # Shutdown Confluence  # Run this query   {code:language=sql}  select stringval from contentproperties where propertyname = 'status-lastmodifier' and stringval not in (select user_key from user_mapping) group by stringval;  {code}  # In next step after this, you will need to run update statements to replace the _username_ and _old_user_key_ values.  To obtain the corresponding _username_ values, you can use the SQL below on your *source* Confluence database.  If the source was a Cloud instance, you can ask Atlassian Support to run this query for you on your Confluence Cloud database, using the list of values from the previous step.  {code:sql}  select distinct cp.stringval, um.username, um.lower_username from contentproperties cp   join user_mapping um on cp.stringval = um.user_key  where propertyname = 'status-lastmodifier'  and stringval in (  'ff80808157d6342b0157d8d795020000',   'ff80808158be2e8d0158c14ba8ec0001',   'ff80808159726edc015983f2cb090001'  );  {code}  # Run this code to update the resolved comment's user to the correct {{user_key}}  {code:language=sql}  update contentproperties set stringval = (select user_key from user_mapping where username = '<username>') where stringval = '<old user_key>';  {code}  Where  #* {{<username>}} is the username of the User who originally resolved the in-line comment.  #* {{<old user_key>}} is the value identified from the first SQL query.  # Restart Confluence    In-line comments should now display    h3. Analysis  In-line comments are generated by a REST call  * http://confluence.mycompany.com/rest/inlinecomments/1.0/comments?containerId=<pageid>&_=1460592565065    And this returns a 500, which in the logs is  {code:title=atlassian-confluence.log|language=none}  2016-04-14 10:44:11,224 ERROR [http-nio-8090-exec-8] [common.error.jersey.ThrowableExceptionMapper] toResponse Uncaught exception thrown by REST service: null   -- url: /rest/inlinecomments/1.0/comments | userName: jrichards  java.lang.NullPointerException   at com.atlassian.confluence.plugins.inlinecomments.helper.InlineCommentUserHelper.getFullNameForUserKey(InlineCommentUserHelper.java:31)   at com.atlassian.confluence.plugins.inlinecomments.entities.InlineCommentBuilder.buildResolveData(InlineCommentBuilder.java:54)   at com.atlassian.confluence.plugins.inlinecomments.entities.InlineCommentBuilder.convertCommentToInlineComment(InlineCommentBuilder.java:111)   at com.atlassian.confluence.plugins.inlinecomments.entities.InlineCommentBuilder.build(InlineCommentBuilder.java:84)   at com.atlassian.confluence.plugins.inlinecomments.service.InlineCommentServiceImpl.getCommentThreads(InlineCommentServiceImpl.java:255)   at com.atlassian.confluence.plugins.inlinecomments.resources.InlineCommentResource.getInlineComments(InlineCommentResource.java:82)   at sun.reflect.GeneratedMethodAccessor1269.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:497)  {code}    Here's the code  {code:title=InlineCommentUserHelper.java}     public String getFullNameForUserKey(String userKey)      {          if (StringUtils.isNotEmpty(userKey))          {              return userAccessor.getUserByKey(new UserKey(userKey)).getFullName();          }            return i18nBeanFactory.getI18NBean(getUserLocale()).getText(ANONYMOUS_KEY);      }  {code}    In the Space export XML, the in-line comment is associated with the {{user_key}} but if the user is not in the new Confluence, or if they do exist but don't have that same user_key then there's no Full name.    # The above code needs to be more robust for checking nulls  # The import needs to map in-line comments to username the same way Page ownership and other items are mapped",3
"CONFSERVER-38993","09/01/2015 18:24:56","XML Exports containing special characters (like an Ellipsis) in Highlighted Inline Comments Increases String Length, causing the XML Import to Fail ","{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-38993].    {panel}    h3. Summary  Whenever a user inserts an ellipsis character (i.e. ""…"" which is three dots represented as a single character) as content in Confluence, and an inline comment is created from highlighting that content, the resulting Site Export (or Space Export containing comments) will convert the ellipsis to three separate period characters (i.e. 3 ""."" in a row). Thus, the resulting string in the entities.xml import will be longer in character count than the original string. If the original string was close to 255 characters, the 'converted' string will be greater than 255 characters. This causes subsequent attempts to import this data to fail with the following error:    {code} ERROR [Long running task: Importing data] [sf.hibernate.util.JDBCExceptionReporter] logExceptions Data truncation: Data too long for column 'STRINGVAL' at row 1{code}    or this one:    {code}Caused by: java.sql.BatchUpdateException: Batch entry 2 insert into CONTENTPROPERTIES (PROPERTYNAME, STRINGVAL, LONGVAL, DATEVAL, PROPERTYID) values ('inline-original-selection', 'typedef struct EthrLagGroupCbkEntryData{    EthrLagGroupLagLinkList ethrLagLinkList; /* List of LAG links */    EthrLagMemberSpeed ethrLagMemberSpeed;    EthrManualMacAddress ethrManualMacAddress;    ......    EthrLagSpared16 spareField1;    EthrLagSpared8...', NULL, NULL, XXXX) was aborted{code}    This error is dependant on the content you are making a comment from.      h3. Steps to Reproduce  # Log in to Confluence and create a new page  # Enter the following as text in the page {noformat}  typedef struct EthrLagGroupCbkEntryData  {      EthrLagGroupLagLinkList ethrLagLinkList; /* List of LAG links */      EthrLagMemberSpeed ethrLagMemberSpeed;      EthrManualMacAddress ethrManualMacAddress;      ……      EthrLagSpared16 spareField1;      EthrLagSpared8  {noformat}  # highlight the content and wait for the inline comment icon to appear  # create an inline comment  # notice the string length for the highlighted text is less than 255 characters  # Perform a space export, selecting custom to include comments  # Once the zip is created, open the entities.xml and search for the inline comment  # Notice the new content is more than 255 characters {noformat}typedef struct EthrLagGroupCbkEntryData{    EthrLagGroupLagLinkList ethrLagLinkList; /* List of LAG links */    EthrLagMemberSpeed ethrLagMemberSpeed;    EthrManualMacAddress ethrManualMacAddress;    ......    EthrLagSpared16 spareField1;    EthrLagSpared8{noformat}  # This breaks the Space Import since the data column size for STRINGVAL is 255.      h3. Expected Results  The export does not add characters to special characters like the ellipsis.    h3. Notes  For the error to be replicated in an import, the original string for the highlighted text has to be close to 255 characters. If the string is not close, the conversion will not affect the import as it will remain under 255.    h3.Workaround  Before exporting, delete the inline comments which are highlighting text which are close to 255 characters and contain the ellipsis character. Alternatively, you can edit the entities.xml file and shorten the inline comment there to be less than 255 characters.",3
"CONFSERVER-39298","09/17/2015 11:55:14","The entity_picker.js  loading is slow for the first response","The file {{entity_picker.js}} takes 20 seconds+ to load for the first response in a vanilla Confluence. The subsequent response is usually fast after it has been cached. This prevents large instances from loading the file due to a timeout.    h3. Step To Replicate   # Go to *!https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! > General Configuration > Global Permissions*  # Click search for the *Grant browse permission to* field for Groups.    h3. Observed Result  The following result takes 20 second to complete even in a newly installed instance.    !sample.png|thumbnail!   This bug affect all the features that require {{entity_picker.js}}, for example adding restrictions to Team Calendars or Pages.    h3. Workaround  Turning off HTTP compression in *!https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! >  General Configuration > Connection Timeouts* may work in some instances.    !image-2016-08-16-16-39-58-530.png!     ",0
"CONFSERVER-39392","09/25/2015 17:47:45","When using Editor, scrollbar does not work at top of the page","h3. Summary    When editing a page in Confluence, the portion of the scrollbar that lies within the title bar area of the page cannot be clicked and dragged.  Typically, this occurs when the page is very long and scrollbar is small.  However, in certain instances where the scrollbar straddles the title bar and the rest of the content, you can click on the lower portion of the scroll bar that lies within the main content area and drag it.    h3. Steps to Reproduce    # Create a page in Confluence and provide a title and add more than a screen full of text or content.  # Save the page.  # Edit the page.  # Click on that portion of the scrollbar that lies within the title bar area of the page.  It won't move.  # If a portion of the scrollbar lies within the content area of the page, it should be draggable.      h3. Workaround    Use the mouse wheel, touchpad or down arrow key to move the cursor down the page and move the scrollbar down.  Once the scroll bar is out of the title bar area, it should resume working.",3
"CONFSERVER-39393","09/25/2015 23:49:54","Confluence performance can degrade when JIRA/Bamboo has performance problems due to gadget feed retrieval","It was observed when Confluence is configured to retrieve a gadget feed from an external application, such as JIRA or Bamboo, if that application becomes unresponsive, Confluence can also gradually become unresponsive as well. This is due to threads attempting to read gadget feeds from the linked application, triggered by common Confluence Editor operations such as inserting a macro or loading the macro browser.    Thread dumps taken from the Confluence JVM during this time will show the majority of HTTP threads (245 out of 300 in the case observed) looking like the below:  {code}  ""http-nio-8090-exec-232"" #424 daemon prio=5 os_prio=0 tid=0x00007f4aac0d0000 nid=0xca62 waiting on condition [0x00007f47c49c4000]     java.lang.Thread.State: WAITING (parking)   at sun.misc.Unsafe.park(Native Method)   - parking to wait for  <0x00000003cd4014d0> (a java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject)   at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)   at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)   at org.codehaus.httpcache4j.cache.Mutex.acquire(Mutex.java:45)   at org.codehaus.httpcache4j.cache.HTTPCache.doCachedRequest(HTTPCache.java:103)   at org.codehaus.httpcache4j.cache.HTTPCache.doCachedRequest(HTTPCache.java:80)   at com.atlassian.gadgets.directory.internal.impl.GadgetFeedReaderImpl.<init>(GadgetFeedReaderImpl.java:46)   at com.atlassian.gadgets.directory.internal.impl.GadgetFeedReaderFactoryImpl.getFeedReader(GadgetFeedReaderFactoryImpl.java:28)   at sun.reflect.GeneratedMethodAccessor3143.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:497)   at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:307)   at org.springframework.osgi.service.importer.support.internal.aop.ServiceInvoker.doInvoke(ServiceInvoker.java:58)   at org.springframework.osgi.service.importer.support.internal.aop.ServiceInvoker.invoke(ServiceInvoker.java:62)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:131)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:119)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.osgi.service.util.internal.aop.ServiceTCCLInterceptor.invokeUnprivileged(ServiceTCCLInterceptor.java:56)   at org.springframework.osgi.service.util.internal.aop.ServiceTCCLInterceptor.invoke(ServiceTCCLInterceptor.java:39)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.osgi.service.importer.support.LocalBundleContextAdvice.invoke(LocalBundleContextAdvice.java:59)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:131)   at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:119)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)   at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)   at com.sun.proxy.$Proxy2822.getFeedReader(Unknown Source)   at com.atlassian.confluence.plugins.gadgets.metadata.GadgetsMacroMetadataProvider.getUrisFromFeedStore(GadgetsMacroMetadataProvider.java:240)   at com.atlassian.confluence.plugins.gadgets.metadata.GadgetsMacroMetadataProvider.getGadgetUris(GadgetsMacroMetadataProvider.java:225)   at com.atlassian.confluence.plugins.gadgets.metadata.CachingGadgetsMacroMetadataProvider.getGadgetUris(CachingGadgetsMacroMetadataProvider.java:181)   at com.atlassian.confluence.plugins.gadgets.metadata.CachingGadgetsMacroMetadataProvider.getData(CachingGadgetsMacroMetadataProvider.java:116)   at com.atlassian.confluence.plugins.gadgets.metadata.CachingGadgetsMacroMetadataProvider.getSummaries(CachingGadgetsMacroMetadataProvider.java:157)   at com.atlassian.confluence.macro.browser.DefaultMacroMetadataManager.buildMacroSummaries(DefaultMacroMetadataManager.java:123)   at com.atlassian.confluence.macro.browser.DefaultMacroMetadataManager.getAllMacroSummaries(DefaultMacroMetadataManager.java:42)   at com.atlassian.confluence.macro.browser.DefaultMacroBrowserManager.getMacroSummaries(DefaultMacroBrowserManager.java:66)   at com.atlassian.confluence.macro.browser.actions.BrowseMacrosAction.getSummaries(BrowseMacrosAction.java:58)   at com.atlassian.confluence.macro.browser.actions.BrowseMacrosAction.execute(BrowseMacrosAction.java:36)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:168)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.ConfluenceWorkflowInterceptor.intercept(ConfluenceWorkflowInterceptor.java:65)  ...   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)   at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)   at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)   at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:501)   at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)   at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)   at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)   at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)   at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1040)   at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:607)   at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1721)   at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1679)   - locked <0x000000048d4da578> (a org.apache.tomcat.util.net.NioChannel)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)   at java.lang.Thread.run(Thread.java:745)  {code}    These threads will be long-running and appear in multiple thread dumps taken over a period of time. The impact to users is that eventually Confluence will not have enough threads free in order to service users.    Other indications include in {{atlassian-confluence.log}} messages like  {code:title=atlassian-confluence.log}  2017-08-14 11:45:46,664 ERROR [http-nio-8887-exec-6] [[Standalone].[localhost].[/].[servlet-module-container-servlet]] log Servlet.service() for servlet [servlet-module-container-servlet] in context with path [] threw exception  java.lang.RuntimeException: java.util.concurrent.TimeoutException  {code}  and  {code:title=atlassian-confluence.log}  2017-08-14 11:55:32,685 WARN [http-nio-8887-exec-10] [confluence.util.profiling.DefaultActivityMonitor] close Exceeded the threshold of 60000 ms: ActivitySnapshot{startTime=1502682314843, threadId=146, threadName='http-nio-8887-exec-10', userId='<unknown>', type='web-request', summary='/plugins/macrobrowser/browse-macros.action?detailed=false&macroMetadataClientCacheKey=1502682297826'}   -- referer: https://confluence.mycompany.com/display/SK/This+is+a+page | url: /plugins/macrobrowser/browse-macros.action | traceId: 8bfdb50a52b72392 | userName: userXYZ  {code}    h3. Workaround  Effort should be made to address the JIRA or Bamboo unavailability problem as that is the trigger for this bug. In the short term, the offending gadget feed may be temporarily removed from Confluence Admin > External Gadgets in order to avoid further outages.",3
"CONFSERVER-39555","10/13/2015 09:47:47","When inserting a macro into a page, macro browser errors with ""Failed to get macro details"" because of race condition in gadgets ehcache acquiring","{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-39555].  {panel}  h3. Summary    Occasionally users will attempt to insert a macro into Confluence and receive an error, {{Failed to get macro details}}    !Screen Shot 2015-09-15 at 1.50.46 pm.png|thumbnail!  h3. Environment   * Confluence 5.9.1-OD-2015.40.1-0001    h3. Steps to Reproduce   # Unknown what triggers, but may be a caching issue.   # On an affected instance, go to edit a page in Confluence, type a curly bracket, and instead of the macro browser loading, you receive the error above.    h3. Expected Results    Generally typing curly bracket will load the macro browser  h3. Actual Results    From clog when loading the macro browser:  {noformat}  2015-10-13 10:33:42.754518500 2015-10-13 10:33:42,721 ERROR [ajp-bio-127.0.0.101-8009-exec-2306] [atlassian.confluence.servlet.ConfluenceServletDispatcher] sendError Could not execute action  2015-10-13 10:33:42.754520500  -- referer: https://*/wiki/display/KEY/Page+Name | url: /wiki/plugins/macrobrowser/browse-macros.action | username: johnsmith  2015-10-13 10:33:42.754521500 com.atlassian.cache.CacheException: java.lang.NullPointerException  2015-10-13 10:33:42.754521500  at com.atlassian.cache.ehcache.DelegatingCache.get(DelegatingCache.java:101)  2015-10-13 10:33:42.754542500  at com.atlassian.confluence.cache.ehcache.DefaultConfluenceEhCache.get(DefaultConfluenceEhCache.java:46)  2015-10-13 10:33:42.754543500  at com.atlassian.confluence.cache.ConfluenceMonitoringCache.get(ConfluenceMonitoringCache.java:49)  2015-10-13 10:33:42.754543500  at com.atlassian.confluence.plugins.gadgets.metadata.CachingGadgetsMacroMetadataProvider.getData(CachingGadgetsMacroMetadataProvider.java:127)  2015-10-13 10:33:42.754546500  at com.atlassian.confluence.plugins.gadgets.metadata.CachingGadgetsMacroMetadataProvider.getSummaries(CachingGadgetsMacroMetadataProvider.java:147)  2015-10-13 10:33:42.754548500  at com.atlassian.confluence.macro.browser.DefaultMacroMetadataManager.buildMacroSummaries(DefaultMacroMetadataManager.java:173)  2015-10-13 10:33:42.754553500  at com.atlassian.confluence.macro.browser.DefaultMacroMetadataManager.getAllMacroSummaries(DefaultMacroMetadataManager.java:90)  2015-10-13 10:33:42.754553500  at com.atlassian.confluence.macro.browser.DefaultMacroBrowserManager.getMacroSummaries(DefaultMacroBrowserManager.java:61)  2015-10-13 10:33:42.754554500  at com.atlassian.confluence.macro.browser.actions.BrowseMacrosAction.getSummaries(BrowseMacrosAction.java:85)  2015-10-13 10:33:42.754557500  at com.atlassian.confluence.macro.browser.actions.BrowseMacrosAction.execute(BrowseMacrosAction.java:47)  2015-10-13 10:33:42.754557500  at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:168)  2015-10-13 10:33:42.754558500  at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)  2015-10-13 10:33:42.754559500  at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)  2015-10-13 10:33:42.754561500  at com.atlassian.confluence.core.ConfluenceWorkflowInterceptor.intercept(ConfluenceWorkflowInterceptor.java:65)  2015-10-13 10:33:42.754562500  at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)  2015-10-13 10:33:42.754563500  at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)  2015-10-13 10:33:42.754567500  at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)  2015-10-13 10:33:42.754567500  at com.atlassian.xwork.interceptors.XsrfTokenInterceptor.intercept(XsrfTokenInterceptor.java:100)    ...    2015-10-13 10:33:42.755160500  at com.atlassian.confluence.plugins.gadgets.metadata.GadgetCacheFlusher.getGadgetsCaches(GadgetCacheFlusher.java:163)  2015-10-13 10:33:42.755161500  at com.atlassian.confluence.plugins.gadgets.metadata.GadgetCacheFlusher.performSelectiveGadgetsCacheFlush(GadgetCacheFlusher.java:109)  2015-10-13 10:33:42.755164500  at com.atlassian.confluence.plugins.gadgets.metadata.GadgetCacheFlusher.requestGadgetsCacheFlush(GadgetCacheFlusher.java:95)  2015-10-13 10:33:42.755165500  at com.atlassian.confluence.plugins.gadgets.metadata.MetadataCacheLoader.load(MetadataCacheLoader.java:46)  2015-10-13 10:33:42.755166500  at com.atlassian.confluence.plugins.gadgets.metadata.MetadataCacheLoader.load(MetadataCacheLoader.java:22)  2015-10-13 10:33:42.755171500  at com.atlassian.cache.ehcache.LoadingCache.getFromLoader(LoadingCache.java:145)  2015-10-13 10:33:42.755172500  at com.atlassian.cache.ehcache.LoadingCache.loadValueAndReleaseLock(LoadingCache.java:100)  2015-10-13 10:33:42.755172500  at com.atlassian.cache.ehcache.LoadingCache.get(LoadingCache.java:76)  2015-10-13 10:33:42.755173500  at com.atlassian.cache.ehcache.DelegatingCache.get(DelegatingCache.java:96)  2015-10-13 10:33:42.755175500  ... 339 more  2015-10-13 10:33:42.756931500 2015-10-13 10:33:42,755 INFO [ajp-bio-127.0.0.101-8009-exec-2306] [atlassian.confluence.status.SystemErrorInformationLogger] writeToLog  2015-10-13 10:33:42.756933500 Request Unique ID : 4e51a8ee-a2dc-470e-9f59-6af7e57e4fa9  2015-10-13 10:33:42.756933500 --------------------------  2015-10-13 10:33:42.756933500 JVM Stats  2015-10-13 10:33:42.756934500 --------------------------  2015-10-13 10:33:42.756934500 usedMemory = 652840544  2015-10-13 10:33:42.756934500 usedMemoryInMegabytes = 622  2015-10-13 10:33:42.756934500 availableHeap = 408973728  2015-10-13 10:33:42.756945500 freeMemoryInMegabytes = 167  2015-10-13 10:33:42.756946500 allocatedHeap = 828534784  2015-10-13 10:33:42.756946500 freeAllocatedHeap = 175694240  2015-10-13 10:33:42.756946500 totalMemory = 828534784  2015-10-13 10:33:42.756947500 totalMemoryInMegabytes = 790  2015-10-13 10:33:42.756947500 availablePermGen = 0  2015-10-13 10:33:42.756947500 maxPermGen = -1  2015-10-13 10:33:42.756948500 maxHeap = 1061814272  2015-10-13 10:33:42.756948500 usedHeap = 652840544  2015-10-13 10:33:42.756948500 freeMemory = 175694240  2015-10-13 10:33:42.756950500 usedPermGen = -1  2015-10-13 10:33:42.756950500 --------------------------  2015-10-13 10:33:42.756951500 Request Information  2015-10-13 10:33:42.756951500 --------------------------  2015-10-13 10:33:42.756951500 URL: https://*/wiki/500page.jsp  2015-10-13 10:33:42.756952500 Scheme: https  2015-10-13 10:33:42.756952500 Server: *  2015-10-13 10:33:42.756952500 Port: 443  2015-10-13 10:33:42.756952500 URI: /wiki/500page.jsp  2015-10-13 10:33:42.756953500 Context Path: /wiki  2015-10-13 10:33:42.756955500 Servlet Path: /500page.jsp  2015-10-13 10:33:42.756955500 Path Info: null  2015-10-13 10:33:42.756955500 Query String: detailed=false&macroMetadataClientCacheKey=1444607378198  2015-10-13 10:33:42.756956500 --------------------------  2015-10-13 10:33:42.756956500 Attributes  2015-10-13 10:33:42.756956500 --------------------------  2015-10-13 10:33:42.756957500 javax.servlet.forward.request_uri: /wiki/plugins/macrobrowser/browse-macros.action  2015-10-13 10:33:42.756961500 javax.servlet.forward.context_path: /wiki  2015-10-13 10:33:42.756961500 javax.servlet.forward.servlet_path: /plugins/macrobrowser/browse-macros.action  2015-10-13 10:33:42.756962500 javax.servlet.forward.query_string: detailed=false&macroMetadataClientCacheKey=1444607378198  2015-10-13 10:33:42.756962500 javax.servlet.error.status_code: 500  2015-10-13 10:33:42.756963500 com.opensymphony.sitemesh.APPLIED_ONCE: true  2015-10-13 10:33:42.756965500 __cleanup_recursion_counter: 0  2015-10-13 10:33:42.756965500 com.atlassian.confluence.web.filter.validateparam.RequestParamValidationFilter_already_filtered: true  2015-10-13 10:33:42.756966500 atlassian.core.seraph.original.url: /500page.jsp?detailed=false&macroMetadataClientCacheKey=1444607378198  2015-10-13 10:33:42.756967500 com.atlassian.labs.botkiller.BotKillerFilter: true  2015-10-13 10:33:42.756967500 com.atlassian.gzipfilter.GzipFilter_already_filtered: true  2015-10-13 10:33:42.756969500 Confluence-Request-Time: 1444725222489  2015-10-13 10:33:42.756969500 com.atlassian.confluence.web.ConfluenceJohnsonFilter_already_filtered: true  2015-10-13 10:33:42.756970500 com.atlassian.seraph.auth.LoginReason: OK  2015-10-13 10:33:42.756970500 com.atlassian.plugins.landlord.servlet.TenantHeaderFilter_already_filtered: true  2015-10-13 10:33:42.756971500 webwork.valueStack: com.opensymphony.xwork.util.OgnlValueStack@12d9680  2015-10-13 10:33:42.756973500 confluence.themecontext: com.atlassian.confluence.themes.ThemeContext@1f4704d  2015-10-13 10:33:42.756978500 javax.servlet.error.message:  2015-10-13 10:33:42.756979500 javax.servlet.error.servlet_name: action  2015-10-13 10:33:42.756979500 com.atlassian.confluence.security.websudo.MessagesDecoratorFilter__already_filtered__: true  2015-10-13 10:33:42.756980500 com.opensymphony.sitemesh.USINGSTREAM: false  2015-10-13 10:33:42.756980500 loginfilter.already.filtered: true  2015-10-13 10:33:42.756981500 javax.servlet.jsp.jspException: com.atlassian.cache.CacheException: java.lang.NullPointerException  2015-10-13 10:33:42.756983500 javax.servlet.error.request_uri: /wiki/plugins/macrobrowser/browse-macros.action  2015-10-13 10:33:42.756984500 com.atlassian.core.filters.HeaderSanitisingFilter_already_filtered: true  2015-10-13 10:33:42.756985500 com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFixupFilter: true  2015-10-13 10:33:42.756985500 javax.servlet.error.exception: com.atlassian.cache.CacheException: java.lang.NullPointerException  2015-10-13 10:33:42.756987500 os_securityfilter_already_filtered: true  2015-10-13 10:33:42.756988500 com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFilter: true  2015-10-13 10:33:42.756988500 --------------------------  2015-10-13 10:33:42.756989500 Parameters  2015-10-13 10:33:42.756989500 --------------------------  2015-10-13 10:33:42.756989500 macroMetadataClientCacheKey : 1444607378198  2015-10-13 10:33:42.756990500 detailed : false  2015-10-13 10:33:42.756996500 caused by: com.atlassian.cache.CacheException: java.lang.NullPointerException  2015-10-13 10:33:42.756996500 at com.atlassian.cache.ehcache.DelegatingCache.get(DelegatingCache.java:101)  2015-10-13 10:33:42.757001500 caused by: java.lang.NullPointerException  2015-10-13 10:33:42.757001500 at com.atlassian.confluence.cache.ehcache.EhCacheManager.wrapCache(EhCacheManager.java:176)  2015-10-13 10:33:42.757002500  2015-10-13 10:33:52.644892500 2015-10-13 10:33:52,624 ERROR [ajp-bio-127.0.0.101-8009-exec-2309] [atlassian.confluence.servlet.ConfluenceServletDispatcher] sendError Could not execute action  2015-10-13 10:33:52.644894500  -- referer: https://*/wiki/pages/createpage.action?spaceKey=KEY&fromPageId=96764471&src=quick-create | url: /wiki/plugins/macrobrowser/browse-macros.action | userName: johnsmith  2015-10-13 10:33:52.644895500 com.atlassian.cache.CacheException: java.lang.NullPointerException  2015-10-13 10:33:52.644896500  at com.atlassian.cache.ehcache.DelegatingCache.get(DelegatingCache.java:101)  2015-10-13 10:33:52.644906500  at com.atlassian.confluence.cache.ehcache.DefaultConfluenceEhCache.get(DefaultConfluenceEhCache.java:46)  2015-10-13 10:33:52.644906500  at com.atlassian.confluence.cache.ConfluenceMonitoringCache.get(ConfluenceMonitoringCache.java:49)  2015-10-13 10:33:52.644907500  at com.atlassian.confluence.plugins.gadgets.metadata.CachingGadgetsMacroMetadataProvider.getData(CachingGadgetsMacroMetadataProvider.java:127)  2015-10-13 10:33:52.644909500  at com.atlassian.confluence.plugins.gadgets.metadata.CachingGadgetsMacroMetadataProvider.getSummaries(CachingGadgetsMacroMetadataProvider.java:147)  2015-10-13 10:33:52.644910500  at com.atlassian.confluence.macro.browser.DefaultMacroMetadataManager.buildMacroSummaries(DefaultMacroMetadataManager.java:173)  2015-10-13 10:33:52.644914500  at com.atlassian.confluence.macro.browser.DefaultMacroMetadataManager.getAllMacroSummaries(DefaultMacroMetadataManager.java:90)  2015-10-13 10:33:52.644914500  at com.atlassian.confluence.macro.browser.DefaultMacroBrowserManager.getMacroSummaries(DefaultMacroBrowserManager.java:61)  2015-10-13 10:33:52.644915500  at com.atlassian.confluence.macro.browser.actions.BrowseMacrosAction.getSummaries(BrowseMacrosAction.java:85)  2015-10-13 10:33:52.644917500  at com.atlassian.confluence.macro.browser.actions.BrowseMacrosAction.execute(BrowseMacrosAction.java:47)  2015-10-13 10:33:52.644917500  at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:168)  2015-10-13 10:33:52.644918500  at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)  2015-10-13 10:33:52.644918500  at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)  2015-10-13 10:33:52.644920500  at com.atlassian.confluence.core.ConfluenceWorkflowInterceptor.intercept(ConfluenceWorkflowInterceptor.java:65)  2015-10-13 10:33:52.644920500  at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)  2015-10-13 10:33:52.644923500  at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)  2015-10-13 10:33:52.644924500  at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)  2015-10-13 10:33:52.644924500  at com.atlassian.xwork.interceptors.XsrfTokenInterceptor.intercept(XsrfTokenInterceptor.java:100)  2015-10-13 10:33:52.644925500  at com.atlassian.confluence.xwork.ConfluenceXsrfTokenInterceptor.intercept(ConfluenceXsrfTokenInterceptor.java:26)  {noformat}  h3. Workaround 1   # Disable the ""Gadget Plugin"" and the ""Gadget Plugin SPI"". This will allow the macro browser to load, minus gadgets   # Re-enable each plugin    h3. Workaround 2   # Restart Confluence    h3. Workaround 3   # If you are using Copy Page Tree, downgrading Copy Page Tree plugin from 2.5.X to version 2.4.2.   # You may follow the knowledge base below to downgrade Confluence   #* https://confluence.atlassian.com/upm/downgrading-an-add-on-to-an-earlier-version-311918719.html   # Download version 2.4.2 from the link below.  #* https://marketplace.atlassian.com/plugins/com.nurago.confluence.plugins.treecopy/versions    *Dev Notes*   * PR: [https://stash.atlassian.com/projects/CONF/repos/confluence-gadgets/pull-requests/23/overview]",2
"CONFSERVER-39744","10/29/2015 20:50:04","Using emoji on a page disables inline commenting ","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-39744].   {panel}  h3. Summary  Using Emoji on a Confluence Page prevents Inline Commenting    h3. Environment  * Confluence 1000.95 (Cloud)   * Confluence 5.8.5 (Server)    h3. Steps to Reproduce  # Create a Page in Confluence which includes a Unicode-6 Emoji Character (📷 🏈)  # Attempt to Inline Comment    h3. Expected Results  A comment is added inline to the Page    h3. Actual Results  When attempting to save the Inline Comment, an error appears indicating ""Unable to Save The Comment""    Confluence logs show:  {noformat}2016-05-18 22:43:05,223 ERROR [http-bio-1996-exec-49] [common.error.jersey.ThrowableExceptionMapper] toResponse Uncaught exception thrown by REST service: [com.ctc.wstx.exc.WstxLazyException] Illegal character entity: expansion character (code 0xd83c) not a valid XML character{noformat}     h3. Notes  Seems to only be affected by [Unicode-6 Emoji|http://emojipedia.org/unicode-6.0/]  Using ⚽️ (not listed in the link above) seems to work    h3.Workaround  Remove Emoji Characters from Page",3
"CONFSERVER-40008","11/11/2015 23:59:17","Icons aligned incorrectly on Spaces list macro","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40008].   {panel}  See screenshots of how it looks in 5.8 vs 5.9",3
"CONFSERVER-39893","11/12/2015 17:18:59","Font not found warning messages when indexing PDF","{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-39893].  {panel}  Confluence is throwing warning messages regarding font not found when performing the index of the instance:  {code:java}  WARN [Indexer: 4] [apache.fontbox.util.FontManager] findTTFontname Font not found: Times New Roman,Italic  {code}  This warning happens to other fonts as well, not limited to only Times new roman.  {code:java}  WARN [Indexer: 2] [apache.fontbox.util.FontManager] findTTFontname Font not found: Arial-ItalicMT  {code}  I could locate this bug report for the pdf font box: [https://issues.apache.org/jira/browse/PDFBOX-2110]    Seems to be fixed in pdfbox 2.0.0 version. Confluence 5.8.10 is currently using pdfbox 1.8.10.         *Workaround*    Install the missing fonts using steps described in the following KB article:   [https://confluence.atlassian.com/confkb/the-text-in-a-powerpoint-excel-or-word-document-looks-different-when-using-the-viewfile-macro-200213562.html]    *Possible fix*   Upgrade to pdfbox 2.0.0.",3
"CONFSERVER-48771","11/17/2015 04:45:44","JIRA options can be very slow to return with a high number of Roles and/or Shared Filters","When adding JIRA content to Team Calendars, Confluence will reach out to JIRA to obtain options that are returned by the following JIRA URL: http://<jira_base_url>/rest/ical/1.0/ical/config/query/options    This options query times out after 10 seconds by default. Administrators can extend this timeout by following [this KB|https://confluence.atlassian.com/display/CONFKB/JIRA+Calendar+Read+Timed+Out].    Through SQL logging in JIRA, we find that the following components appear to impact the query return time greatly:  * For every project, JIRA appears to fire off one SQL query for each role that exists. In other words, the cost is _number of roles_ times _number of projects_.  * JIRA fires off one SQL query for each shared filter (i.e. excluding private filters).    In one observed instance, there were:  * 1000 projects, 3 roles =  3000 SQL queries  * 15000 shared filters = 15000 SQL queries    Each query took 1-3ms including DB connection borrow and return. Adding latency and other overhead, http://<jira_base_url>/rest/ical/1.0/ical/config/query/options on this instance took 56000ms to finish, well over the 10000ms default timeout.  ",3
"CONFSERVER-40154","12/07/2015 11:06:40","""Content by label"" can render itself recursively, causing a stack overflow","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40154].   {panel}  h3. Summary  A page with the ""Content by label"" macro, combined with an Excerpt Display of ""Rich content"", will render itself leading to a stack overflow.    *This causes:*  * high CPU usage with more than 10MB of log every second.  * Confluence becomes unresponsive until the overflow finishes.  * Going to the page can also return an Error page when the page is displayed.  * The page may render with infinite traces of itself.  * In Cloud the page will automatically try to refresh every 2 minutes if window is left open and will trigger the problem again.    h3. Environment  * Confluence 6.0 or 5.9  * Content by Label macro    h3. Steps to Reproduce  # Create a new page  # Add a ""Content by label"" macro, configured as:  #* Label: ""testing""  #* Excerpt Display: ""rich content""  # Save the page  # Add a label to the page: ""testing""  # Refresh the page (May require 2 or 3 refreshes for the label to be updated)    h3. Expected Results  Page renders quickly and no error are shown in the logs.    h3. Actual Results  Log shows many errors:  {noformat}  2016-01-08 13:19:53.758403500 2016-01-08 13:19:53,749 ERROR [http-bio-1990-exec-4] [xhtml.view.macro.ViewMacroMarshaller] marshalInternal Error rendering macro: contentbylabel  2016-01-08 13:19:53.758404500  -- url: /wiki/display/TES/KB0001 | page: 3735562 | traceId: 8aa2ccdd327d6df3 | userName: usertest | referer: https://<url>/wiki/pages/editpage.action?pageId=3735562 | action: viewpage  2016-01-08 13:19:53.758405500 java.lang.StackOverflowError  2016-01-08 13:19:53.758405500  at org.antlr.v4.runtime.misc.Array2DHashSet.getOrAdd(Array2DHashSet.java:83)  2016-01-08 13:19:53.758437500  at org.antlr.v4.runtime.atn.ATNConfigSet.add(ATNConfigSet.java:167)  2016-01-08 13:19:53.758437500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1447)  2016-01-08 13:19:53.758438500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758438500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758446500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758447500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758447500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758452500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758452500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758453500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758453500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758456500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758457500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758457500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758457500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758460500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758461500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758461500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1414)  2016-01-08 13:19:53.758465500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758465500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758465500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1414)  2016-01-08 13:19:53.758466500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758469500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758469500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758470500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758470500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1414)  2016-01-08 13:19:53.758473500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758473500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758479500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758479500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758480500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1414)  2016-01-08 13:19:53.758480500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758483500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758484500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1414)  2016-01-08 13:19:53.758484500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758484500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758489500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1414)  2016-01-08 13:19:53.758490500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758490500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758494500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1414)  2016-01-08 13:19:53.758494500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758495500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758495500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758498500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758498500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1414)  2016-01-08 13:19:53.758499500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758499500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758502500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1414)  2016-01-08 13:19:53.758503500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758506500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758507500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1414)  2016-01-08 13:19:53.758507500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure_(ParserATNSimulator.java:1492)  2016-01-08 13:19:53.758508500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closureCheckingStopState(ParserATNSimulator.java:1431)  2016-01-08 13:19:53.758510500  at org.antlr.v4.runtime.atn.ParserATNSimulator.closure(ParserATNSimulator.java:1370)  2016-01-08 13:19:53.758511500  at org.antlr.v4.runtime.atn.ParserATNSimulator.computeReachSet(ParserATNSimulator.java:884)  2016-01-08 13:19:53.758511500  at org.antlr.v4.runtime.atn.ParserATNSimulator.execATNWithFullContext(ParserATNSimulator.java:695)  2016-01-08 13:19:53.758512500  at org.antlr.v4.runtime.atn.ParserATNSimulator.execATN(ParserATNSimulator.java:534)  2016-01-08 13:19:53.758514500  at org.antlr.v4.runtime.atn.ParserATNSimulator.adaptivePredict(ParserATNSimulator.java:423)  2016-01-08 13:19:53.758515500  at com.atlassian.querylang.antlrgen.AqlParser.expr(AqlParser.java:1228)  2016-01-08 13:19:53.758515500  at com.atlassian.querylang.antlrgen.AqlParser.subClause(AqlParser.java:1114)  2016-01-08 13:19:53.758531500  at com.atlassian.querylang.antlrgen.AqlParser.andClause(AqlParser.java:983)  2016-01-08 13:19:53.758531500  at com.atlassian.querylang.antlrgen.AqlParser.orClause(AqlParser.java:915)  2016-01-08 13:19:53.758532500  at com.atlassian.querylang.antlrgen.AqlParser.clause(AqlParser.java:864)  2016-01-08 13:19:53.758532500  at com.atlassian.querylang.antlrgen.AqlParser.aqlStatement(AqlParser.java:624)  2016-01-08 13:19:53.758535500  at com.atlassian.querylang.lib.parserfactory.DefaultParserFactory.createParser(DefaultParserFactory.java:36)  2016-01-08 13:19:53.758535500  at com.atlassian.confluence.plugins.cql.impl.DefaultCQLSearchService.createParserForInput(DefaultCQLSearchService.java:339)  2016-01-08 13:19:53.758536500  at com.atlassian.confluence.plugins.cql.impl.DefaultCQLSearchService.performV2Search(DefaultCQLSearchService.java:240)  2016-01-08 13:19:53.758538500  at com.atlassian.confluence.plugins.cql.impl.DefaultCQLSearchService.searchContent(DefaultCQLSearchService.java:175)  2016-01-08 13:19:53.758539500  at com.atlassian.confluence.plugins.cql.impl.DefaultCQLSearchService.searchContent(DefaultCQLSearchService.java:122)  2016-01-08 13:19:53.758539500  at com.atlassian.confluence.plugins.macros.advanced.contentbylabel.LabelledContentMacro.makeRenderContext(LabelledContentMacro.java:109)  2016-01-08 13:19:53.758546500  at com.atlassian.confluence.plugins.macros.advanced.contentbylabel.LabelledContentMacro.execute(LabelledContentMacro.java:85)  2016-01-08 13:19:53.758547500  at com.atlassian.confluence.macro.ContentFilteringMacro.execute(ContentFilteringMacro.java:107)  2016-01-08 13:19:53.758547500  at com.atlassian.renderer.v2.macro.ResourceAwareMacroDecorator.execute(ResourceAwareMacroDecorator.java:51)  2016-01-08 13:19:53.758550500  at com.atlassian.confluence.macro.V2CompatibilityMacro.execute(V2CompatibilityMacro.java:41)  2016-01-08 13:19:53.758550500  at com.atlassian.confluence.macro.LazyLoadingMacroWrapper.execute(LazyLoadingMacroWrapper.java:27)  truncated to fit comment  {noformat}    On Screen it may show the error: ""Oops - an error has occurred"" with the following error:  {noformat}  Cause  java.lang.RuntimeException: Error rendering template for decorator root      at com.atlassian.confluence.setup.velocity.ApplyDecoratorDirective.render(ApplyDecoratorDirective.java:183)  caused by: java.lang.RuntimeException: Error rendering template for decorator page      at com.atlassian.confluence.setup.velocity.ApplyDecoratorDirective.render(ApplyDecoratorDirective.java:183)  caused by: org.apache.velocity.exception.MethodInvocationException: Invocation of method 'getDisplayableItems' in class com.atlassian.confluence.plugin.descriptor.web.ConfluenceWebInterfaceManager threw exception net.sf.hibernate.LazyInitializationException: Failed to lazily initialize a collection at template/includes/menu-macros.vm[line 150, column 45]      at org.apache.velocity.runtime.parser.node.ASTMethod.handleInvocationException(ASTMethod.java:337)  caused by: net.sf.hibernate.LazyInitializationException: Failed to lazily initialize a collection      at net.sf.hibernate.collection.PersistentCollection.initialize(PersistentCollection.java:201)  caused by: net.sf.hibernate.HibernateException: collection was evicted      at net.sf.hibernate.impl.SessionImpl.initializeCollection(SessionImpl.java:3332)  Stack Trace:[hide]  java.lang.RuntimeException: Error rendering template for decorator root   at com.atlassian.confluence.setup.velocity.ApplyDecoratorDirective.render(ApplyDecoratorDirective.java:183)   at org.apache.velocity.runtime.parser.node.ASTDirective.render(ASTDirective.java:175)   at org.apache.velocity.runtime.parser.node.SimpleNode.render(SimpleNode.java:336)   at org.apache.velocity.Template.merge(Template.java:328)   at org.apache.velocity.Template.merge(Template.java:235)   at com.opensymphony.webwork.dispatcher.VelocityResult.doExecute(VelocityResult.java:91)   at com.atlassian.xwork.results.ProfiledVelocityResult.doExecute(ProfiledVelocityResult.java:21)   at com.atlassian.confluence.setup.webwork.EncodingVelocityResult.doExecute(EncodingVelocityResult.java:48)   at com.opensymphony.webwork.dispatcher.WebWorkResultSupport.execute(WebWorkResultSupport.java:116)   at com.opensymphony.xwork.DefaultActionInvocation.executeResult(DefaultActionInvocation.java:263)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:187)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.ConfluenceWorkflowInterceptor.intercept(ConfluenceWorkflowInterceptor.java:65)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)  truncated to fit.  {noformat}       h3. Notes  Wasn't happening in Confluence v5.7 and v5.8.10 because the macro didn't have the 'Rich Content' excerpt.  This is the Macro setting:  !rich_content_setting.jpeg|thumbnail!         h3.Workaround  User a different 'Excerpt Display' option in the macro.    To open the page directly in edit mode:  # get the contentid from the database (Cloud customers please contact Cloud Support)  {noformat}  select *  from content where title like 'Title of the page' and content_status = 'current' and spaceid > 0;  {noformat}  # use the 'contentid' as the page id value in: {{https://<confluence-url>/pages/editpage.action?pageId=}}",3
"CONFSERVER-40165","12/08/2015 07:25:47","Indexing attachments does not remember that an operation has been attempted","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40165].   {panel}  h3. Summary    If a fatal exception (ie, OutOfMemoryError) occurs during the processing of an attachment (such as a large/corrupt PDF or DOCX), Confluence will not record the failure.  When it restarts, it will re-try the indexing.  This leads to a loop of failure, and the application becomes unusable.    h3. Expected Result    Application fails catastrophically only once.  The underlying failure can be investigated and fixed, but the application does not enter a loop of catastrophic failures as it tries to index an invalid file.    h3. Actual Result    Applications enteres a loop of failures where it will become unavailable until Support (or other system administrator) removes the offending file.    h3. Workaround    Identify the file being indexed, and remove it.",8
"CONFSERVER-48449","12/10/2015 14:12:45","recurring events changes not being reflected correctly","Steps to reproduce  *Scenario 1*  # Login to Confluence  # Install Team Calendar  # Click on ""Calendars"" on the top navigation bar  # Click on Add Calendar on the top right and add a calendar called ""test""  # Create a new events called ""testing recurring event"" and set it to Repeat weekly as per the screenshot below :  !recurringEvent1.jpg|thumbnail!  after that click OK  # Select on the recurring events and click on Edit as per the screenshot below :  !editRecurringEvent.jpg|thumbnail!  # Add admin user to the ""Who"" field as per the screenshot below :  !editRecurringEvent2.jpg|thumbnail!  then Click OK  # click on another recurring event and add test user to the ""Who"" field as per the screenshot below :  !editRecurringEvent3.jpg|thumbnail!  !editRecurringEvent4.jpg|thumbnail!  # Now go back to the first event that have the admin user added in the ""Who"" field as per the screenshot below and edit the text to ""testing recurring event 2"". Please ensure that the ""Edit this instance only"" is unticked :  !editRecurringEvent5.jpg|thumbnail!  !editRecurringEvent7.jpg|thumbnail!    *Current result* : the first event does not show ""testing recurring event 2"". It seems that other recurring event is showing the changes but not the event that have user test added to the ""Who"" field as you can see from the screenshot below :  !changes1.jpg|thumbnail!    *Expected result* : the first event should show the changes along with all the recurring events.    Steps to reproduce  *Scenario 2*  # Login to Confluence  # Click on ""Calendar"" on the top navigation bar  # Add a new Calendar named test2  # Add event on test2 calendar named ""test recurring event"" and ensure that Repeat is set to Weekly  # Click one of the events to edit and add user ""admin"" to the ""Who"" field. Ensuring that ""Edit this instance only"" is ticked  # Click on the same event to edit and add user ""test"" to the ""Who"" field. Ensuring that ""Edit this instance only"" is unticked.    *Current result* : the recurring event that we have edited shows that only ""admin"" is in the ""Who"" list while others show the changes that was made as per the screenshot below :  !recurrentEvent.jpg|thumbnail!    *Expected Result* : All recurring event should show the changes including one of the recurring event that we have made changes to.    *Scenario 3*  # Create a recurring weekly event   !Screen Shot 2020-02-18 at 17.09.42.png|thumbnail!   # Edit one specific instance of this recurring event   !Screen Shot 2020-02-18 at 17.10.14.png|thumbnail!   # Add a user on the ""Who"" field (with ""Edit this instance only"" enabled)   !Screen Shot 2020-02-18 at 17.10.37.png|thumbnail!   # The following day's event will switch to the same day as the edited event:   !Screen Shot 2020-02-18 at 17.11.01.png|thumbnail! ",3
"CONFSERVER-40272","12/17/2015 19:59:35","Customizing Link Color via Customizing Color Schemes does not affect Sidebar links in Spaces","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40272].   {panel}  h3. Summary  Customizing the *Link* Color via the [Customising Colour Schemes|https://confluence.atlassian.com/doc/customising-colour-schemes-135906.html] panel does not affect all links in the sidebar within Spaces.    h3. Steps to Reproduce  * *Confluence Administration* > *General Configuration* > *Colour Scheme* > *Edit*  * Change *Links* to a custom color (#E90029)  * *Save*    h3. Expected Results  All links should be turned red on all pages-- Dashboard, Spaces, Pages    h3. Actual Results  Not all links' colors are changed. If you go to any Space, the *page tree* will not be affected  !Screen Shot 2015-12-17 at 12.03.03 PM.png|thumbnail!     h3. Notes  * Tested, and does not affect versions 5.8.18, 5.8.16  * Version 6.0.0-OD-2016.02: Only affect unvisited links. Visited links worked fine.    h3. Workaround (For Server Version)  Adding the below CSS to fix the issue:  * *Confluence Administration* > *General Configuration* > *Style Sheet* > *Edit*  * {code}  .acs-side-bar a,  .acs-side-bar td a  { color: #E90029; }  {code}  * *Save*    No workaround for Cloud version at the moment",1
"CONFSERVER-40283","12/18/2015 06:08:43","Setting posting date for a blog doesn't work","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40283].   {panel}  * ""Create blog"" in the UI (createblogpost.action)  * Edit the ""Posting Date"" field at the bottom of the page, changing it from today (2015-12-18) to two days ago (2015-12-16)  * Publish  * Date in all of the following shows as today, not as the posting date I entered:  ** address bar  ** breadcrumbs  ** rest/api/content/<id> :  *** version.when  *** history.createdDate  ",3
"CONFSERVER-46588","01/08/2016 06:15:14","Confluence Questions is waiting for a lock that is locked by the index","{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-46588].  {panel}  CQ appears to be waiting for a lock that is locked by the index, which is currently trying to process a large amount of updates.  {code:java}  ""http-nio-8081-exec-3"" #252 daemon prio=5 os_prio=0 tid=0x00007f8bbc15e800 nid=0x1f91 waiting on condition [0x00007f8930951000]     java.lang.Thread.State: WAITING (parking)          at sun.misc.Unsafe.park(Native Method)          - parking to wait for  <0x00000005e0802508> (a java.util.concurrent.locks.ReentrantLock$NonfairSync)          at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)  ...          at com.atlassian.bonnie.LoggingReentrantLock.lock(LoggingReentrantLock.java:32)          at com.atlassian.bonnie.LuceneConnection.withWriter(LuceneConnection.java:483)  {code}  The thread 'http-nio-8081-exec-3 is a doeditquestion.action:  ||Thread ID||Thread name||User ID||Type||Summary||Duration||  |252|http-nio-8081-exec-3|amckague|web-request|/cq/doeditquestion.action?id=2669904138|1 hour, 16 minutes, 20 seconds|    The only threads that are getting stuck are CQ threads (see screenshot). Why would we be blocking on a Lucene lock in CQ?    !cq stuck requests.png|height=450!  h3. Impact of this bug    This bug can cause threads to become stuck, which means indexing does not occur, and questions/answers cannot be posted to Confluence Questions (they simply hang). A restart of the instance (or a rolling restart of the full cluster) is required to resolve it.    It can also cause indexing to be delayed after a restart, by up to 20m, depending on the size of your instance.",3
"CONFSERVER-40451","01/12/2016 01:00:27","Confluence 'Create JIRA Report - Change log' doesn't load","{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40451].  {panel}  h3. Summary    The JIRA 'Change log' Report creator in Confluence no longer works.    When attempting to create a report the screen the 'loading' icon is displayed indefinitely and the report never loads.    This worked in 5.9.4, and broke in 6.0.0  h3. Environment   * Confluence Version 6.0.0-OD-2016.02.1-0006    h3. Steps to Reproduce   # In confluence click on the '...' next to the 'Create' button in the top menu bar   # Select 'JIRA Report' and click 'next'   # Select 'Change Log' and click 'next'   # Select a Project from the drop down menu, leave other fields as default and click 'create'    h3. Expected Results   # The report is created and the page is loaded    h3. Actual Results   * The loading icon will be displayed indefinitely and nothing will happen, the report is not created   * The below exception is thrown in the logs  {noformat}  ERROR [http-bio-1990-exec-16] [common.error.jersey.ThrowableExceptionMapper] toResponse Uncaught exception thrown by REST service: com.atlassian.confluence.extra.jira.JiraIssuesManager.retrieveXMLAsChannel(Ljava/lang/String;Ljava/util/List;Lcom/atlassian/applinks/api/ApplicationLink;ZZ)Lcom/atlassian/confluence/extra/jira/JiraIssuesManager$Channel;   -- referer: https://<omitted> | url: /wiki/rest/create-dialog/1.0/content-blueprint/create-draft | traceId: 5427a38ed50bfa63 | userName: <omitted>  2016-01-12 11:55:16.303976500 java.lang.NoSuchMethodError: com.atlassian.confluence.extra.jira.JiraIssuesManager.retrieveXMLAsChannel(Ljava/lang/String;Ljava/util/List;Lcom/atlassian/applinks/api/ApplicationLink;ZZ)Lcom/atlassian/confluence/extra/jira/JiraIssuesManager$Channel;  {noformat}     * Error showing in the Chrome browser Console:  {noformat}  POST https://<site>.atlassian.net/wiki/rest/create-dialog/1.0/content-blueprint/create-draft 500 (Internal Server Error)  {noformat}    h3. Workaround    ""switch to advanced"" prior to hitting ""create"" works for some users  h4. Resolution    Upgrade to Confluence 6.6.10+, or Confluence 6.8+    Note that this issue is not fixed in Confluence 6.7.x",3
"CONFSERVER-40499","01/15/2016 20:48:40","Page properties report broken when using nested macros. ","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40499].   {panel}  h3. Summary    When nesting a macro within a Page Properties the Page Properties report macro will not populate the macro content.      h3. Steps to Reproduce  h3. Steps to Reproduce  # Start with a JIRA + Confluence Cloud instance.  # In Confluence, create a page with a Page Properties Report macro on it.  # Create another page with the Page Properties macro in it that'll show in the Page Properties Report macro above.  # Insert a table into the Page Properties macro that contains a JIRA Issues Macro that will return some number of issues from JIRA.  # View the original page with the Page Properties Report on it.    h3. Expected Results    The page properties for the space will populate in the page properties report.     h3. Actual Results    In two cases I tested it in using the Contributor Macro and Jira issues filter  JIRA issues it will just hang on ""Getting issues"". On the contributors macro it doesn't render and returns an odd result: {""contextEntityId"":12222521} although in preview ""mode"" it works expected.       ",2
"CONFSERVER-48563","02/14/2016 19:34:31","The system is not logging me in after using my password","Am using a stand alone computer",1
"CONFSERVER-40833","02/19/2016 01:14:49","Deleted Pages, Blogpost and Attachments Returning in Confluence Search Results ","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40833].   {panel}  h3. Summary  Attachments which have been deleted from a Confluence Page are still searchable after a Content Index is performed    h3. Environment  * Confluence Cloud version 6.0.0-OD-2016.07.2   * Confluence server version 5.9.x and above    h3. Steps to Reproduce  # Add an attachment to a Confluence Page (does not need to be embedded on the page itself)  # Search for the Attachment using the Filename of the Attachment; it should display in the Search Results  # Delete the Attachment  # Search again for the Attachment; should not display in the Search Results  # Perform a task which triggers a Content Index (Move Pages, Create Space, etc) or as SysAdmin, manually trigger a Content Re-Index    h3. Expected Results  Deleted attachment does not return in search results    h3. Actual Results  * Deleted Attachment is shown in search results however when clicked displays a file not found error:  !AttachmentError.png|thumbnail!  * In some versions, deleted Attachments are able to be viewed like normal attachment  * The attachment also reappeared in the Space Attachment list by going to Space Tools > Content Tools > Attachments    Database shows that the Attachment has been deleted:  {noformat}confluence=> select contentid, contenttype, title, content_status from content where title like '%ExampleAttachment%';   contentid | contenttype |          title          | content_status  -----------+-------------+-------------------------+----------------     5046279 | ATTACHMENT  | 1.ExampleAttachment.png | deleted     5046280 | ATTACHMENT  | 2.ExampleAttachment.png | deleted  (2 rows){noformat}       h3. Notes  # Rebuilding Cache does not seem to correct the issue  # Reindexing from scratch does not seem to correct the issue either    h3.Workaround  # Delete the attachment from the trash by going to Space Tool > Content Tools > Trash > choose the deleted attachments > Delete  # Purge the trash by going to Space Tool > Content Tools > Trash > purge",5
"CONFSERVER-40860","02/23/2016 14:19:29","Page Index macro in large space is bringing down Confluence","{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-40860].    {panel}    {panel:title=Resolution|borderStyle=solid|borderColor=#3C78B5| titleBGColor=#3C78B5| bgColor=#E7F4FA}  The Page Index macro can be quite memory hungry in large spaces.  To prevent it causing out of memory errors in your site, we don't show page excerpts when there are more than 200 pages in the space, and don't list any pages if there are more than 5000 in the space.  This 5000 page limit can be reduced further by setting the system property page.index.macro.max.pages to a lower value.  For example to lower the limit to 500 set the system property to:    -Dpage.index.macro.max.pages=500    More info on how to set system properties for Confluence can be found [here|https://confluence.atlassian.com/doc/configuring-system-properties-168002854.html].  {panel}    h3. Summary    Page Index macro in large space is bringing down Confluence  h3. Environment   * 6.0.0-OD-2016.08.1-0001, server 5.8.18  h3. Steps to Reproduce     # Create a page in a large space (with > 2800 pages)   # Insert _page index macro_   # It would take long to be generated.    h3. Expected Results    Confluence generates the index on the page the macro is inserted with no issues.    h3. Actual Results    Confluence keeps going down with this error:  {noformat}  2016-02-22 12:29:53.789019500 Caused by: org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot get a connection, pool error Timeout waiting for idle object  2016-02-22 12:29:53.789021500  at org.apache.tomcat.dbcp.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:114)  2016-02-22 12:29:53.789024500  at org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)  2016-02-22 12:29:53.789025500  at net.sf.hibernate.connection.DatasourceConnectionProvider.getConnection(DatasourceConnectionProvider.java:59)  2016-02-22 12:29:53.789025500  at net.sf.hibernate.impl.BatcherImpl.openConnection(BatcherImpl.java:292)  2016-02-22 12:29:53.789026500  ... 27 more  2016-02-22 12:29:53.789026500 Caused by: java.util.NoSuchElementException: Timeout waiting for idle object  2016-02-22 12:29:53.789028500  at org.apache.tomcat.dbcp.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:1171)  2016-02-22 12:29:53.789028500  at org.apache.tomcat.dbcp.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:106)  2016-02-22 12:29:53.789028500  ... 30 more  {noformat}  and  {noformat}  2016-02-22 12:20:50.137789500 2016-02-22 12:20:50,060 DEBUG [http-bio-1991-exec-8] [atlassian.confluence.event.MonitorableCallerRunsPolicy] rejectedExecution Queue Overflow happened: QueueOverflowEvent{, runnableInfo='com.atlassian.confluence.event.ConfluenceEventDispatcher$$Lambda$390/16819635@1b8ac5a', threadPoolExecutorInfo='java.util.concurrent.ThreadPoolExecutor@a5ae24[Running, pool size = 1, active threads = 1, queued tasks = 192, completed tasks = 8656]'}  {noformat}    h3. Notes  Error still happens even after the _pool size_ has been increased.    h4. Workaround 1 (for Confluence Server)    This is the Confluence Index Macro, which can be enabled/disabled via:   # !https://confluence.atlassian.com/download/attachments/590259974/Cog.png! > *Add-ons*   # Choose *System* from the drop-down   # Expand *Advanced Macros*   # Expand the *modules* on the right side   # Locate the *index* macro and *Disable* it   !disable_index_module.png|thumbnail!   # Restart Confluence to release the existing threads    h4. Workaround 2    # Search for: {{macroName:index}} and you will see all pages containing this macro.   ** Note that your content indexing may need to be rebuilt for this search to work.   # Delete the macro from the pages in the search results   # Restart Confluence to release the existing threads    If you prefer to search via the database for a list of pages, you can use this query:  {code}  SELECT c.contentid, s.spacekey, c.title, c.lastmoddate  FROM CONTENT c  JOIN BODYCONTENT bc    ON c.contentid = bc.contentid  JOIN SPACES s    ON c.spaceid = s.spaceid  WHERE c.prevver IS NULL    AND bc.body LIKE '%ac:name=""index""%';   {code}  (!) This workaround is for *Confluence Server*. For Confluence Cloud, please contact Support to get a list of pages using this Macro. You could then remove the macro from those pages.",5
"CONFSERVER-40912","02/26/2016 18:20:10","cwd_user table missing a index","h3. Summary    Everywhere in Confluence DB tables, the creator is now set as the user hash. This username hash is stored in the table user_mapping which is made of three columns (user_key, username, lower_username). The last column has a unique index.    Now in cwd_user, there is no index on column lower_user_name. The only index there is on lower_user_name is composed with the other column directory_id.    So this means that for every action where Confluence looks up for creator information, it makes a full table scan on cwd_user. (Unless the caching in Confluence helps to avoid this ? )    h3. Environment    * Confluence 5.9.4  * PostgreSQL 9.3.10    h3. Steps to Reproduce    There are many actions in Confluence which could cause this to occur. One such query which has been found is the below one:    {code:sql}  select internalgr2_.id as id,  internalgr2_.group_name as group_name,  internalgr2_.lower_group_name as lower_gr3_,  internalgr2_.active as active,  internalgr2_.local as local,  internalgr2_.created_date as created_6_,  internalgr2_.updated_date as updated_7_,  internalgr2_.description as descript8_,  internalgr2_.group_type as group_type,  internalgr2_.directory_id as directo10_  from cwd_membership hibernatem0_,  cwd_user internalus1_,  cwd_group internalgr2_  where hibernatem0_.parent_id=internalgr2_.id  and ((internalus1_.lower_user_name=:v2 and hibernatem0_.child_user_id=internalus1_.id)  and(internalgr2_.directory_id=:v1 and hibernatem0_.parent_id=internalgr2_.id))  order by internalgr2_.lower_group_name;  {code}    An explain plan on that shows a table scan is run on the lower_user_name field in cwd_user, if there is enough data in the tables being queried (in a fresh install there is no table scan, probably due to optimization from analyze statistics).    h3. Expected Results    Database query returns quickly without performance impact, by using an index lookup.    h3. Actual Results    Database query returns slowly, and causes a performance hit, as it's using a record lookup (table scan).    h3.Workaround    Manually add an index on lower_user_name in the cwd_user table, for example:    {code:sql}  create index idx_user_lower_user_name on cwd_user (lower_user_name);  {code}    NOTE: If any future fix adds a new index, you may need to manually remove this index before that.",3
"CONFSERVER-40914","02/26/2016 21:11:06","Check size of attachment before content indexing","When indexing larger attachments, it would benefit our clients greatly if we checked the size of attachment before indexing same. In other words, when an attachment is too large, instead of attempting the indexing, bail earlier if the attachment is too large.    System property atlassian.indexing.contentbody.maxsize is meant to provide this functionality, however has been reported not to be working.  h3. Workaround    As of 5.9 there is 'canary' functionality in the Office Connector that will abort indexing on large documents if they would cause an OutOfMemory error. More details can be found [here|https://confluence.atlassian.com/confkb/jvm-crashes-during-import-from-word-in-confluence-815577714.html].    NB: The canary is now enabled by default and does not require a dark feature.",5
"CONFSERVER-41264","04/04/2016 08:43:54","JIRA Issue Macro sends much higher hazelcast traffic between the Data Center nodes","h3. Summary  The Hazelcast 5801 port traffic between the nodes is much larger (about 50~200 times) in Confluence Data Center 5.9.x when browsing a page containing JIRA Issue Macro, comparing to Confluence 5.7.5. The more access the cluster gets, the more traffic is generated between the nodes.    h3. Steps to Reproduce  # Install Confluence Data Center 5.9.5 cluster including 2 nodes  # Install JIRA Software 7.0.5  # Generate an Application Link between the JIRA and the CDC  # Create a page with JIRA Issue Macro in Confluence  # Access to the page by using jMeter or so forth (I used jMeter with 10 parallel threads and infinite loop count)  # Measure the traffic between the nodes by dstat command (specifically ""dstat -n -N <interface>"" command)  # You'll find the traffic is much larger (In my case, the traffic was about 50Mbps):  -- much larger than the case when accessing a page without JIRA Issue Macro (In my case, the traffic was about 250Kbps)  -- much larger than the case when accessing the same page in Confluence Data Center 5.7.5, which is the version that the customer is currently using (In my case, the traffic was about 250Kbps)  # As a result, CPU usage is also increased, though the CPU % does not grow disastrously severe    (i) I confirmed the traffic was hazelcast 5801 port, by creating a separate network interface only for the hazelcast traffic. Another network interface is used for all other traffics such as HTTP, PostgreSQL, NFS.    h3. Expected Results  The traffic is as high as it used to be in Confluence Data Center 5.7.5    h3. Actual Results  The traffic is about 40~200 times higher than it used to be in Confluence Data Center 5.7.5    h3.Workaround  There is no workaround found at the moment.",5
"CONFSERVER-41390","04/14/2016 15:48:04","Misspelling/typo in the Gallery Macro description text","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-41390].   {panel}  There is a misspelling in the *Confluence Gallery Macro* description text:    Create a thumbnail gallery from a *pages *attachments Documentation    That should be ""page's"" with an apostrophe for a possessive noun.    ",2
"CONFSERVER-41579","05/03/2016 09:10:25","Missing or corrupted icons of JIRA issues in PDF export","A Confluence page uses the JIRA Issue/Filter macro, either for displaying a single issue or a list of issues.    When exporting this page to PDF, there are several icons missing or they are corrupted:  * ID of imported issue  * Status of imported issue  * Type of issue  * Priority of issue  ",5
"CONFSERVER-41610","05/05/2016 01:25:18","TDM merger fails due to infinite recursive loop","{panel:bgColor=#e7f4fa}  *NOTE:* After a thorough investigation and analysis of the issue by Development and Support teams, we found that this TDM Merge issue did not have as high of an impact to memory as previously assessed. Our attempts at reproducing an OutOfMemoryError (OOME) or stability problem have been unsuccessful. Both the support and development teams have done a thorough investigation around the linked support cases; and the conclusion is that TDM code is not to blame. The stack trace in the logs is merely just a warning which indicates that the infinite loop has been detected and hence terminated.    We are closing this issue as Cannot Reproduce. If you are still experiencing the symptoms that relate to this bug please contact support by following the links at [https://support.atlassian.com/confluence/] so we can help identify the root cause of your issue.    This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-41610].  {panel}  Regression of CONFSERVER-32164  h4. Problem summary    When Collaborative editing is disabled, or in a version of Confluence below 6.0, under specific conditions, Confluence can run out of memory when a user goes to edit a Confluence page or view his drafts (Username > Drafts), following a sequence of events:   # User A goes edit a page (Version 1)   # Confluence auto-saves a draft based on Version 1, and user does not save the page   # User B edits the same page and saves, promoting the page to Version 2   # User A views his drafts (or edits the page again)   # Confluence tries to merge the three versions (Version 1, Version 1 draft, and Version 2), and results in Confluence hanging    Stack trace:  {noformat}  2016-04-28 12:13:09,528 WARN [com.atlassian.confluence.plugins.merge.TDMMerger:thread-311] [confluence.plugins.merge.TDMMerger] mergeContentInternal Merge failed.   -- url: /confluence/pages/editpage.action | referer: https://XXXX/confluence/display/SPACE/PAGE | userName: user | page: 1052053228 | action: editpage  java.lang.RuntimeException: ASSERTION FAILED: Merge.treeMerge(). Infinitive recursive loop.          at tdm.lib.Merge.treeMerge(Merge.java:107)          at tdm.lib.Merge.treeMerge(Merge.java:173)          at tdm.lib.Merge.treeMerge(Merge.java:173)          at tdm.lib.Merge.treeMerge(Merge.java:173)          at tdm.lib.Merge.treeMerge(Merge.java:173)          at tdm.lib.Merge.merge(Merge.java:82)          at com.atlassian.confluence.plugins.merge.TDMMerger.mergeContentInternal(TDMMerger.java:99)          at com.atlassian.confluence.plugins.merge.TDMMerger.access$000(TDMMerger.java:46)          at com.atlassian.confluence.plugins.merge.TDMMerger$1.call(TDMMerger.java:120)          at com.atlassian.confluence.plugins.merge.TDMMerger$1.call(TDMMerger.java:116)          at com.atlassian.sal.core.executor.ThreadLocalDelegateCallable.call(ThreadLocalDelegateCallable.java:42)          at java.util.concurrent.FutureTask.run(FutureTask.java:266)          at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)          at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)          at java.lang.Thread.run(Thread.java:745)  {noformat}  Details:   * https://jira.atlassian.com/browse/CONF-32164?focusedCommentId=854595&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-854595   * https://jira.atlassian.com/browse/CONF-32164?focusedCommentId=904073&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-904073    h4. Workaround    *6.0 and later*    Make sure that Collaborative Editing is enabled and working, as the affected merge code is not used unless it is disabled.    *Warning:*  The below workarounds involve deleting one or more drafts. Drafts contain edits that have not yet been saved, so important work can be lost by deleting them.    *5.5 and later*  If a user has been identified causing this problem, they can go to {{/users/viewmydrafts.action}} page and discard either all of their drafts or just the draft for the page that is known to trigger this problem.    *All versions*  Alternatively, all the drafts can be deleted directly from the DB:   # Back up Confluence DB as a precaution   # Run the following DELETE statements against the DB:  {code:java}  DELETE FROM BODYCONTENT WHERE contentid IN (SELECT contentid FROM CONTENT WHERE contenttype = 'DRAFT');  DELETE FROM CONTENT WHERE contenttype = 'DRAFT';  {code}     # Confluence Admin > Cache Statistics > Flush all (down at the bottom)",5
"CONFSERVER-41664","05/11/2016 17:49:06","CONFVERSION table empty after full site import","h3. Summary  {{CONFVERSION}} table is empty after full site import    h3. Environment  Bug reproduced on 5.5.6, 5.8.18, 5.9.4 and 5.9.7    h3. Steps to Reproduce  # Install a fresh instance of Confluence  # Configure it with an external database  # Once Confluence is up and running, run the following query on the database  {code}  select * from confversion;  {code}  # You should see the entry for the build number  # Import a full site XML Backup  # Once done, query the {{CONFVERSION}} table again    \\  h3. Expected Results  We should see the same build number entry    \\  h3. Actual Results  {{CONFVERSION}} table is empty now     \\  h3.Workaround  There is no workaround for the time being",3
"CONFSERVER-48832","05/20/2016 03:11:27","Users receive emailed notifications for calendars they don't watch","{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-48832].    {panel}    One of our calendars, which isn't embedded in any page, has been sending email notifications to users who are not watching the calendar. Not all users are affected. There appears to be no way to unsubscribe them from receiving these notifications.    * The users' lists of watched items doesn't contain this calendar  * When the users access the Calendars page and select this calendar's drop down menu from the elipsis, they find that they are not watching this calendar (status reads ""Watch"" and not ""Stop Watching"" or ""Watched"")    I used this query to see if the calendar is embedded anywhere returned no results:    embeddedSubCalendarId:CALENDARID    This seems to be a known issue, as reported here: https://jira.atlassian.com/browse/TEAMCAL-3709    Is there any fix for this?     *Workaround:*    (!) If you navigate to the calendar by following the link provided in the email notification, it has ""Watch"" instead of ""Stop Watching"" as the option. You can see the ""Stop watching"" option by following the specific instructions below to navigate to the calendar.    # Click ""Calendars"" in the top Confluence navigation bar.  # Locate the target calendar and click the ellipses button (!https://confluence.atlassian.com/doc/files/704577869/704577870/1/1422393340385/ellipsis.png!)  # Click *Stop Watching*.",3
"CONFSERVER-43054","06/29/2016 04:44:35","Oracle 11c driver is listed in the setup wizard but Oracle 11 is no longer supported ","Oracle 11.1 and 11.2 support was dropped in Confluence 5.9.      The setup wizard still provides an option to choose Oracle 11g.  We should remove this to avoid confusion. ",2
"CONFSERVER-51861","07/06/2016 06:26:03","NoAuthenticationException in Office Connector plugin (with IE)","IE NoAuthenticationException in the office connector.    For IE, the path authentication filter is not being applied, so documents don't open.    We need the filter so that the ocauth is added to the path.    Related to comment: https://jira.atlassian.com/browse/CONF-38024?focusedCommentId=902895&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-902895",5
"CONFSERVER-43173","07/11/2016 22:01:53","Increase Character Limit of the Description from JIRA Issues Macro creation","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-43173].   {panel}  In Confluence, when we create JIRA issues macro using the highlight option, it will limit the description field when having it created in the JIRA side if we use the option to create multiple issues from a table.    For example, with the following screenshots, we can see how it behaves:    When highlighting the same content as we can see in the below table:    !Screen Shot 2016-07-11 at 5.14.29 PM.png|thumbnail!    It will give us the following result, when selecting the *Create Multiple Issues from Table*:    !Screen Shot 2016-07-11 at 5.58.55 PM.png|thumbnail!    This is a suggestion to either increase the character limit for the description or allow the user to configure it, instead of using ellipsis for the rest of the description.",2
"CONFSERVER-43207","07/15/2016 09:18:48","JIRA Macro couldn't render issues when the filter contains multi-byte characters","h3. Summary    JIRA Macro couldn't render issues when the filter contains multi-byte characters.    h3. Environment    * Confluence 5.10.1  * JIRA 7.1.9    h3. Steps to Reproduce  # Install vanilla JIRA 7.1.9  # Create a project  # Create two issues as follows  ## Create an issue with Japanese summary (The summary is ""テスト"".)  ## Create another issue with English summary (The summary is ""test"".)  !issues.png|thumbnail!   # Install vanilla Confluence 5.10.1 and integrate it with the JIRA  # Create a space and a page  # Use JIRA Macro with the following two types of filters  ## {{summary ~ ""テスト""}}  ## {{summary ~ ""test""}}  # Check if the macro works fine in the preview dialog   !preview.png|thumbnail!     h3. Expected Results    Even if we use Japanese characters in the filter, the issue should be rendered in the page as it works fine with the other filter which contains only English characters.   !english_filter.png|thumbnail!     h3. Actual Results    When we use Japanese characters in the filter, the issue wasn't rendered in the page correctly.  !japanese_filter.png|thumbnail!     h3. Notes    * We can use the filter (JQL) in JIRA to find the issue  * The filter which contains Japanese characters also works fine in the macro preview dialog as I mentioned in the above image  * You can reproduce this bug not only with Japanese characters but also Russian, Korean, Chinese characters (any muti-byte characters)  * This bug *WASN'T seen on Confluence 5.9.12 with JIRA 7.1.9    h3.Workaround    # Stop Confluence  # Add the following line into the bin/setenv.sh file  {code}  CATALINA_OPTS=""-Dfile.encoding=UTF-8 ${CATALINA_OPTS}""  {code}  # Start Confluence",3
"CONFSERVER-43385","08/08/2016 10:27:46","Date Picker no longer set to Monday On European Languages ","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-43385].   {panel}  h5. Summary:  In Confluence 5.8, when using the German Language pack, the date picker:  * Has Monday as the first day of the week  * Days are displayed in German    !screenshot-2.png|thumbnail!     However, In Confluence 5.9 and above, when using the German Language pack, the date picker:  * Has Sunday as the first day of the week  * Days are displayed in English   !screenshot-1.png|thumbnail!     h5. Notes:  Checked in {{confluence-language-pack-de_DE-5.10.0.rc1-v2r12978-2016-06-06.jar/i18n/aui_de_DE.properties}} noticed the line  {{ajs.datepicker.localisations.first-day}} was set to {{1}},   {code}  ajs.datepicker.localisations.first-day=1  {code}  which supposed to set the day picker to start on Monday. However, the date picker still shows Sunday as the first day of the week    Most of European countries start the week with Monday, see https://en.wikipedia.org/wiki/Week.  h5. Workaround:  No workaround yet  ",3
"CONFSERVER-43947","09/02/2016 01:12:07","6.0.0m70 upgrade via windows installer failed","This morning I attempted to upgrade Confluence on Windows from 6.0.0-m68 to 6.0.0-m70    I've been upgrading this Confluence with all the milestones using the windows installer.    This time I got an error that was something like 'file still in use', the installer didn't complete, and I was left with most of my install directory empty.    I've attached my application log. All that is left in my installation directory is Logs directory (Catalina logs etc are gone though), and the confluence\WEB-INF\lib and the JRE directory.    We should confirm this isn't a freaky one off.    See also https://jira.atlassian.com/browse/CONF-43948",2
"CONFSERVER-43776","09/16/2016 23:21:21","Confluence mobile version serves up login screen even when the anonymous access is enabled","{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-43776].  {panel}  h3. Summary    When accessing Confluence from a mobile device on iOS 10 and Safari, the application serves up a login screen that is invalid. This is true for all pages, even with anonymous access enabled.  h3. Steps to Reproduce   # Install Confluence 5.10.4 (this can also be replicated in previous versions of Confluence such as 5.9.10)   # Enable anonymous access   # Make sure the system add-on called the 'Confluence Mobile Plugin' is enabled   # Access the Confluence instance using iOS 10 and the vanilla Safari browser that comes included   # Notice you will get an invalid login prompt asking you to login to Confluence    h3. Expected Results    Confluence mobile should open up Confluence without asking you to log in.  h3. Actual Results    A prompt comes up in Confluence asking all users to log in every few seconds.    !Login Prompt.png|thumbnail!  h3. Notes    This prompt only happens in Safari that comes bundled with iOS 10.   Switching to Desktop version does *not* correct the situation in Cloud, and is not a workaround. Nor is disabling Confluence Mobile.   Tested in iOS 9 and it is not a problem there.  h3. Workaround   - Install the [Confluence Server|https://itunes.apple.com/au/app/confluence-server/id1288365159?mt=8] iOS app and use that instead - requires Confluence 6.8 or later   - Or install Google Chrome or Firefox instead on the device and use that.   - Or disable Confluence Mobile by disabling the system add-on called the 'Confluence Mobile Plugin' . Please note CONF-40782 - ""Disabling the Confluence Mobile Plugin also disables the Workbox - Host Plugin in Confluence 5.9.X"" when performing this workaround.",5
"CONFSERVER-43949","09/21/2016 10:31:25","Cannot save inline comment with MS Edge","{panel:bgColor=#e7f4fa}    *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-43949].    {panel}    h3. Summary  Cannot save inline comment when the page has code block macro or in a table.    h3. Environment  * Windows 10 Professional version 1607  * Edge 38.14393.0.0 or later  * Confluence 5.10.0 or later     h3. Steps to Reproduce  Case 1:  # Create a page and add some text then save   # Try to add an inline comment then save it. It works (/)  # Edit the page and add a code block macro in the middle of the page then save it  # Try to add an inline comment before the code clock and after (also the table)    Case 2:  # Create a page and add some text then save   # Try to add an inline comment then save it. It works (/)  # Edit the page and add a table in the middle of the page then save it  # Try to add an inline comment before the table, in the table  and after it    h3. Expected Results    The inline comment should be able to save wherever the text is selected    h3. Actual Results    Can't save inline comment after the code block, in the table or after the code block or table. Error in the screen ""Could not save the comment""      Error appearers in the log  {code:borderStyle=solid}  2016-09-16 13:04:00,174 WARN [http-nio-8090-exec-25] [plugins.inlinecomments.service.InlineCommentServiceImpl] attemptInlineCommentCreateForPage The text selection is wrong  – referer:  | url: /rest/inlinecomments/1.0/comments | traceId: 3d669b131184c2e7 | userName: admin  com.atlassian.confluence.plugins.highlight.SelectionModificationException: The text selection is wrong  at com.atlassian.confluence.plugins.highlight.service.SelectionValidator.validateSelection(SelectionValidator.java:65)  at com.atlassian.confluence.plugins.highlight.service.SelectionValidator.validate(SelectionValidator.java:29)  at com.atlassian.confluence.plugins.highlight.service.DefaultSelectionModifier.modify(DefaultSelectionModifier.java:46)  at com.atlassian.confluence.plugins.highlight.DefaultSelectionStorageFormatModifier.markSelection(DefaultSelectionStorageFormatModifier.java:57)  at sun.reflect.GeneratedMethodAccessor2691.invoke(Unknown Source)  {code}",3
"CONFSERVER-43952","09/21/2016 11:13:11","""Not Permitted"" error on page refresh using Collab Editing","I have a space called ""Lars"", with a page called ""Collab""    I log in to confluence, and edit the page:  http://documentation.example.com/pages/resumedraft.action?draftId=6652144&draftShareId=cf4a941e-b40c-4149-a30f-5d1e6c10b67c    If i hit F5 (refresh) i get ""Not Permitted"" and the url changes  http://documentation.example.com/pages/editpage.action?useDraft=true&spaceKey=LARS&draftId=6652144&pageId=6652143    Pressing back, lets me choose edit the page one again. It will let me save. My user is also member of confluence-administrators",3
"CONFSERVER-44194","09/22/2016 01:13:32","Random blank lines inserted around panels","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-44194].   {panel}  This page shows two places where extra white space has been added, making it hard to layout a page the way you want:  # Blank space above the ""info"" and ""panel"" macros in the side-columns.  # Blank space above and below the ""excerpt"" macro in the info box (despite having ""inline"" mode selected).",5
"CONFSERVER-44094","09/26/2016 21:54:16","""Update published page"" dialog overlaps the Update button on Windows browsers","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-44094].   {panel}  h3. Summary  When Collaborative Editing is on and you're editing a page the ""_Update published page_"" dialog overlaps the Update button itself making it hard to click the Update button to save the changes.    h3. Environment  Confluence Cloud  This could only be reproducible on all browsers running on Windows 7 (IE11, Chrome and Firefox)    h3. Steps to Reproduce  # Have Collaborative Editing enabled  # Access a page and click the Edit button  # Hover the mouse over the Update button    h3. Expected Results  The dialog is completely above the button    h3. Actual Results  The dialog overlaps the Update button       h3.Workaround  No workaround on Windows",3
"CONFSERVER-51879","09/27/2016 05:08:46","Fix Skate Dependency Order","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-51879].   {panel}  Make sure Skate depends on Almond explicitly.",1
"CONFSERVER-45096","09/27/2016 06:13:39","Trying to delete the whitespace at the start of a nested macro can duplicate and break the macro","With an info box and a nested excerpt (Not sure if this issue is isolated to these two particular macros but they're the ones I encountered it with), if you navigate to outside the excerpt macro, and hit backspace to attempt to delete the empty paragraph tag (which will get reinserted by editor_plugin_src.js#addSurroundingCursorTargetParagraph), the macro gets duplicated and the content is messed up    It's a little hard to reproduce reliably, so I've attached a video and the source of the page after it's been messed up",8
"CONFSERVER-48498","09/28/2016 23:31:04","Changes to JIRA issues never synchronize to Team Calendars without manually refreshing the calendar","h3. Summary    Team Calendars are configured to display JIRA data. Making a change to a JIRA issue in JIRA is never reflected in Team Calendars unless the calendar is manually refreshed or Confluence's cache is cleared. Changes also do not get pushed through to  external subscription feeds.     h3. Steps to Reproduce  # Create a calendar in Confluence.   # Add a new JIRA event using the 'Event Type' - JIRA Issue Date.  # Select Project and an applicable Project in the Display drop-down list.   # Select all check boxes under Single Date:  # In JIRA, make a change to the Due Date on one of the existing issues.   # Wait    h3. Expected Results  The calendar will update within 1 hour.    h3. Actual Results  The calendar never updates.     h3.Workaround (only available for Confluence server)  # Go to !https://s3.amazonaws.com/uploads.hipchat.com/10804/2041359/oZYNLidcDNI3S8o/Dashboard%20-%20Confluence%202015-05-13%2013-43-47.png!  > General Configuration > Cache Management.  # Choose *Show Advanced View*.  # For all Team Calendar caches, click the *Adjust Size* link and change the 'Maximum elements' to *1*.  # Click Submit.    The following caches are available:  * Team Calendars - iCal subscription sub-calendar data  * Team Calendars - JIRA Agile Sprints sub-calendar events   * Team Calendars - JIRA connection drag drop support   * Team Calendars - JIRA Project Release sub-calendar events   * Team Calendars - JIRA sub-calendar data (old)   * Team Calendars - JIRA sub-calendar events   * Team Calendars - JIRA sub-calendars   * Team Calendars - User preferences",5
"CONFSERVER-51880","10/09/2016 23:46:24","Database Lock timeout after site import","Looks like it's possible to hit a database lock timeout due to stopping and then starting Synchrony during an import, according to our tests. This situation is highly unlikely and almost certainly involves also installing or uninstalling or enabling/disabling other plugins while doing an import.",3
"CONFSERVER-45080","10/17/2016 05:31:49","Cannot copy an old version of a page","h3.Steps       # View any page   #  Open the Page History   # View any version    # Click Copy button to copy it     *What happened...*   The Copy Page dialog is showed, but we can't do anything else (no space can't be searched, the Copy button is disabled)   *What should have happened...*  The destination Space should be searchable and the dialog should allow me to copy it.",3
"CONFSERVER-44930","10/18/2016 09:25:09","BR elements between inline macros","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-44930].   {panel}  Steps to reproduce:    * create empty page  * insert excerpt macro using { notation then write something inside then hit the down arrow  * insert second excerpt macro using { notation then write something inside then hit the down arrow  * insert third excerpt macro using { notation and write something inside  * check that all three macros have the ""inline"" display option selected (by clicking on the macro placeholder to show the property panel)  * update the page to go back into the page view mode  * result shared-drafts turned on: spans are on three different lines  * result shared-drafts turned off: spans are on the same line",3
"CONFSERVER-45098","10/19/2016 01:00:43","Clicking layout dashed lines selects all the page text","h3.Steps      # Edit a page that has layouts   # Click on the one of the double dashed lines that separates the layout sections   # it selects all the text then the usual single clicking inside of the same text area doesn't unselect it  # Noting that this is especially strange because it'll select text across several different sections - which is otherwise impossible in Confluence these days  # If you keep clicking randomly, maybe after 4 or more clicks it'll unselect the text     *What happened...*   Full text on page selected, and not easily unselected     *What should have happened...*  The full text on the page doesn't get selected and I can go about my merry way editing the page",8
"CONFSERVER-45084","10/20/2016 07:01:19","The files preview shows up underneath the show changes dialog when a picture is clicked on","h3.Steps      # make an attachment picture to a page, and add it to the page   # ensure collab edit is on, and have someone make changes to the page   # update the page, show up the changes dialog, and see the changes   # click on the image     *What happened...*   The image shows up as a files preview, but the preview is underneath the dialog.     *What should have happened...*  The preview should be above the dialog. Or not be able to preview in the show diffs view.",2
"CONFSERVER-45659","10/21/2016 06:11:05","Extra paragraph added when a paragraph is selected and a symbol inserted in collab editor","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-45659].   {panel}  Steps to reproduce:    * Create a page with two paragraphs. Publish.  * Edit the page. Select the first paragraph.  * Click on insert > symbol  * Insert a symbol  * Notice another blank paragraph got added after the paragraph you selected.    ",1
"CONFSERVER-44977","10/21/2016 21:00:43","Creating JIRA issues from Confluence is not updating the project list based on the selected JIRA instance selection","Environment:    *JIRA 7.1.4*   *JIRA 7.1.6*   *Confluence 5.10.8*    (i) Cannot replicate this with Confluence 5.8.18 or Confluence 5.9.9. Can replicate it with Confluence 5.10.0 and Confluence 5.10.7 as well.    Steps to Reproduce:   Create Application Links between Confluence 5.10.8 to both JIRA instances    JIRA 7.1.4 has the following projects:   !jira714_projects.png|thumbnail!    JIRA 7.1.6 has the following projects:   !jira716_projects.png|thumbnail!    Highlight some text on a Confluence page and select ""Create JIRA issue"":   !create_jira_issue.png|thumbnail!    The JIRA set a primary will be displayed with it's projects:   !jira716_selected.png|thumbnail!    However, if you change for the other JIRA instance linked to your Confluence, the project list won't be updated:   !jira714_selected.png|thumbnail!    If you end up clicking on ""Create"" and the project doesn't exist on your JIRA instance, the issue creation screen will keep spinning until times out. Logs won't show any stacktrace.  h2. Resolution    The recommended resolution is to upgrade to Confluence 6.2.3 and above when it is released.    If upgrading is not possible and you are running Confluence 6.0.2 or above, an alternative is to upgrade the JIRA content plugin to 2.0.5 or newer which can be downloaded here: [^confluence-jira-content-2.0.5.jar] Note that this version of the plugin is only known to work with Confluence 6.0.2 and above.",2
"CONFSERVER-45081","10/25/2016 10:33:05","Blank page on edit after collaborative editing switched off and on again","h3.Steps      # Find a page to edit   # Switch collab editing off   # Switch collab editing on   # Edit the page you chose in the first step     *What happened...*     9 times out of 10 I am getting a blank page instead of the page contents when I click edit.       *What should have happened...*    Editor should have loaded with the content.    *Workaround*  Refreshing the page loads the editor fine and this only seems to happen to the page the first time after collab editing has been switched back on.  ",3
"CONFSERVER-48891","10/27/2016 01:51:02","Add event button not responding when embedding a Team Calendar to a page in Chrome","{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? See the corresponding bug reports   * https://jira.atlassian.com/browse/CONFCLOUD-48891   * https://jira.atlassian.com/browse/CONFCLOUD-56825{panel}  h3. Summary    When embedding a team calendar to a page, the *Add event* button is unusable in Google Chrome.  h3. Enviroment   * Confluence 6.1.3 (64bit linux)   * Google Chrome 61.0.3163.79 or 61.0.3163.100   * Internet Explorer 11    h3. Steps to Reproduce   # Add a date picker (by typing //datetime) to a page   # Embed a calendar to the page with the *Team Calendar* macro and save the page   # Click on the *Add event* button to add some events.    h3. Expected Results    A pop-up is displayed allowing you to add events to your calendar.  h3. Actual Results    Nothing happens after clicking on the *Add event* button.   The following JS error is seen in the browser's console.  {noformat}  Uncaught TypeError: Confluence.TeamCalendars.Dialogs.getEditEventDialog is not a function      at s (confluence.mycompany.com/wiki/s/d41d8cd98f00b…ge/batch.js?build-number=6452&externals=__local-default__&locale=en-GB:907)      at HTMLButtonElement.<anonymous> (confluence.mycompany.com/s/d41d8cd98f00b…ge/batch.js?build-number=6452&externals=__local-default__&locale=en-GB:907)      at HTMLButtonElement.dispatch (jquery-min.js:2)      at HTMLButtonElement.s (jquery-min.js:2)  {noformat}  h3. Workaround    Add events from the calendar itself on the *Calendars* page as it is still working there.",2
"CONFSERVER-45182","11/08/2016 00:48:08","Vertical spacing removed on preview or publish after certain user operations","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-45182].   {panel}  h3. Summary  Using some operations are causing vertical spacing between the macros to be stripped out as {{auto-cursor-target}} class is applied.    h3. Steps to Reproduce  Steps to reproduce:  # Start creating a newpage  # Insert a block macro (e.g. the info macro)  # Insert another macro below the first (e.g. another info macro)  # In the space between the two macros, add a line break (in the editor DOM there are now two paragraphs between the macros - one with the {{auto-cursor-target}} class and one without)  # Click on preview and observe that there is vertical spacing between the macros  # Perform one of the ""user operations"" listed below - do this below the two macros to make the effect clearer to observe (in the editor DOM, both paragraphs between the macros now have the {{auto-cursor-target}} class applied)  # Click on preview and observe that the vertical spacing between the macros has been stripped out    User operations known to cause this issue:  * Wiki autoformatting (e.g. when you type {{h2.}} followed by a space to trigger heading formatting)  * Cutting content (e.g. via {{cmd + v}} shortcut)    This issue is only reproducible on instances that do *not* have the collaborative editing feature enabled.  h3. Expected Results  The spaces are not modified    h3. Actual Results  Vertical spacing between the macros were stripped out.    h3.Workaround  Use operations on the top menu when available, such as selecting a text and making it title, instead of using {{h2.}}.    ",8
"CONFSERVER-45189","11/08/2016 22:40:26","External gadgets in Confluence should not prompt users to Login and Approve","Problem:    When using an external gadget (e.g., JIRA gadget ""Pie Chart"") in a Confluence page, every user who views the page is prompted to ""Login and approve"" the gadget in JIRA before they can see the content.    This happens *for every user for every gadget,* meaning that if I create a Confluence page using Pie Chart, Filter Results, Average Age Chart, and Two-Dimensional Issue Statistics and send it to executives for review, every executive has to ""Login and Approve"" every gadget. Worse, sometimes the ""approval"" token doesn't stick, and a user has to go through the process again.    We have tried single sign-on, creating a trusted application link, setting up 2-way oauth with impersonation, and combinations of all of the above, to no avail.    Atlassian support has confirmed there is currently no way to bypass or automate the approval.    This is unacceptable for our 10,000 user base and makes our Confluence look unprofessional.    *Please allow 2-way oauth with impersonation to automatically approve external gadgets.*    Note: We never experienced this problem on Confluence 5.6. We cannot roll-back our upgrade, but we are severely regretting it.    h3. Steps to Reproduce:  # Integrate JIRA with Confluence through Application link.  # On the create application link wizard, check the same user base option and make sure the user used for the integration is exist on Confluence.  # After it, an applicaiton link with Oauth(Impersonation) will be created.  # On JIRA Dashboard, add a new gadget to find JIRA Gadget XML e.g. Filter Result Gadget.  # Copy the XML link and navigate to Confluence _General Configuration > External Gadgets_.  # Add the gadget by using the XML link.  # Create a new Confluence page and add a gadget by using ""Other Macros""  # Choose the newly added JIRA ""Filter Results"" gadget.    h3. Expected Result:  - Just like JIRA Issue Macro, the filter will be researchable or issues for JIRA Issue Macro.    h3. Actual Result:  - ""Login & Approve"" will come out and user need to authenticate to retrive filters in JIRA.    h3. Note:  Referring to the documentation [Oauth Security for Applinks|https://confluence.atlassian.com/display/APPLINKS/OAuth+security+for+application+links] that using impersonation would not be needed for the user to authenticate as long the user is not redirected to the linked information:  bq. they're automatically authenticated on the other application and don't get asked to authorize requests.  ",8
"CONFSERVER-45232","11/14/2016 00:30:40","The Collaborative Editing Plugin may fail to start due to disabled plugins after upgrade","This bug was raised to investigate problems with the collaborative editing plugin not starting correctly.    This error appears in the browser's console:  {code:java}  Error running batched script. Error: confluence-collaborative-editor-plugin/editor-blanket missing confluence-editor/editor/page-editor(…)  {code}  There are no errors in the Confluence logs.  h5. Symptoms    You cannot edit any pages after upgrading to Confluence 6.0.1. You get the message ""Collaborative editing is taking a while..."".  h5. Environment    This problem has been observed in a Windows Environment, with the following factors:   * SQL Server 2012   * No reverse proxy    h5. Workaround  # Enable JIRA Integration :: Plugin (com.atlassian.integration.jira.jira-integration-plugin)  #* This plugin has been confirmed as a cause for the editor to not load.  ## Click the !https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! and click Manage add-ons  ## Search for JIRA Integration :: Plugin  ## Click Enable  # If the editor is still missing enable all plugins  #* [How to Manually Reset All Plugin Back to its Default State Through the Database|https://confluence.atlassian.com/confkb/how-to-manually-reset-all-plugin-back-to-its-default-state-through-the-database-859509873.html]  #* [#comment-1045971]    h5. Attempted Patch    Development provided a patched library, however, it did not have any positive impact on the problem. Instead, the browser then reported the following:  {code:java}  TypeError: cannot read property 'getEditor' of undefined(...)  {code}  In the end, we had to get the customer to roll back their instance. This bug is being raised to determine if this is a bonafide bug, or a freak occurrence.",8
"CONFSERVER-45325","11/21/2016 17:11:42","Epic Name/Link column on JIRA issues macro displaying wrong Epic Name","h3. Summary    When listing issues using the JIRA Macro on Confluence, if the issues are Epics and you add the column Epic Name/Epic Link, only the first Epic Name is shown correctly:    Confluence:     !Confluence.png|thumbnail!         JIRA (same filter):    !JIRA.png|thumbnail!    h3. Environment   * Confluence server 6.0.1, 5.10.8   * JIRA Server 7.2.0    h3. Steps to Reproduce   # Create 3 Epics on JIRA   # Add a JIRA Macro on a Confluence page with the filter: {{project = <PROJECT-NAME> and issuetype = Epic}}   # Add Epic Name/Epic Link in the *Columns to Display* field    h3. Expected Results    Epics are listed with the correct name inside the lozenge with the Epic Link.  h3. Actual Results    Only the first Epic is listed with the correct name, the other are listed with the same name as the first one.  h3. Notes    Inspecting the link, we can see that it leads to the correct Epic on JIRA, so just the Name is incorrect:    !Link.png|thumbnail!    This issue is probably related to the latest changes to the Epic Name/Link, where both columns are intended to show the same information. Also, the Epic key used to shown in the link name, and now the Epic Name is shown as per the following suggestion:    * https://jira.atlassian.com/browse/CONF-31534         One other behavior observed is that issues that are *not* Epic nor are linked to an Epic, are listed by the macro with the same Epic as the other issues. Here is an example, where *BT-21* is a Story and it is not linked to any Epic:      !Screen Shot 2016-12-14 at 4.19.17 PM.png|thumbnail!    The filter used here is {{project = BT ORDER BY created ASC}}. If it is changed to {{project = BT ORDER BY created DESC}} and the Story issue is the first listed, the Story is not listed as linked to an Epic. However, the other issues are listed as the same Epic as the first one:    !Screen Shot 2016-12-14 at 4.32.52 PM.png|thumbnail!  h3. Workaround    There is no known workaround for this issue.",3
"CONFSERVER-45344","11/23/2016 10:43:18","Collaborative editing does not work when Confluence is running with SSL configured in Tomcat and behind a firewall with DNAT port forwarding ","{panel:title=UPDATE as of 29 May, 2017|titleBGColor=#ccd9ea}  This issue only happened in Confluence 6.0.1 because Confluence failed to route Synchrony requests to its built-in proxy when SSL is configured in Tomcat. The problem has been fixed since Confluence 6.0.2 (with this ticket: [CONFSERVER-45273|https://jira.atlassian.com/browse/CONFSERVER-45273]) and above. In Confluence 6.1+, the built-in proxy is properly utilised when Confluence detects that SSL is terminated at Tomcat. I will close this ticket to avoid any confusion.  {panel}  h5. Example configuration:   * No Proxy. Just SSL   * Sample confluence URL: {{[https://mycompany.com:8016|https://mycompany.com:8016/]}}   * reza.port=8017   * synchrony.port=8017    {code:java|title=Server.xml}  <Server port=""8000"" shutdown=""SHUTDOWN"">      <Service name=""Tomcat-Standalone"">          <Connector port=""8015"" connectionTimeout=""20000"" redirectPort=""8443""                  maxThreads=""48"" minSpareThreads=""10""                  enableLookups=""false"" acceptCount=""10"" URIEncoding=""UTF-8""                  protocol=""org.apache.coyote.http11.Http11NioProtocol"" />            <Engine name=""Standalone"" defaultHost=""localhost"">              <Host name=""localhost"" appBase=""webapps"" unpackWARs=""true"" autoDeploy=""false"">                  <Context path="""" docBase=""../confluence"" reloadable=""false"" useHttpOnly=""true"">                      <Manager pathname="""" />                      <Valve className=""org.apache.catalina.valves.StuckThreadDetectionValve"" threshold=""60"" />                  </Context>              </Host>          </Engine>     <Connector             protocol=""org.apache.coyote.http11.Http11NioProtocol""             port=""8443"" maxThreads=""200"" minSpareThreads=""25"" maxHttpHeaderSize=""8192""             enableLookups=""false"" disableUploadTimeout=""true""             acceptCount=""100"" scheme=""https"" secure=""true"" SSLEnabled=""true""             keystoreFile=""<path-to-keystore-file>/keystore.jks"" keystorePass=""password""             clientAuth=""false"" sslProtocol=""TLS""/>      </Service>  </Server>  {code}  Registered JVM Arguments in the application.xml:  {code:java|title=Application.xml}      <virtual-machine-arguments>-Dcatalina.base=<Confluence Service Location> -Dcatalina.home=<Confluence Service Location> -Djava.endorsed.dirs=<Confluence Service Location>\endorsed -Djava.io.tmpdir=<Confluence Service Location>\temp -XX:MaxPermSize=512m -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.util.logging.config.file=<Confluence Service Location>\conf\logging.properties -Dreza.port=8017 -Dsynchrony.port=8017 -Dhttps.proxyHost=mycompany.com -Dhttps.proxyPort=8016 exit -Xms512m -Xmx2048m</virtual-machine-arguments>  {code}  h5. other notes   * Connector ports used for HTTP and HTTPS are 8015 and 8443 but we're accessing Confluence via HTTPS and port 8016   * Address {{mycompany.com}} is currently a redirection from the public gateway to the internal confluence machine, using *DNAT portforwarding*   * If we access Confluence using HTTP and port 8015: {{[http://mycompany.com:8015|http://mycompany.com:8015/]}} synchrony is working    h5. Observation:    Confluence is *accessible* in HTTPS and port 8016, :{{[https://mycompany.com:8016|https://mycompany.com:8016/]}} while *Synchrony is not*. We keep seeing this error:  {code:java|title=atlassian-confluence.log}  2016-11-18 10:18:26,804 DEBUG [ListenableFutureAdapter-thread-3] [plugins.synchrony.utils.SynchronyProxyUtil] isSynchronyProxyRunning {}   -- url: /rest/synchrony-interop/enable | referer: https://mycompany.com:8016/admin/confluence-collaborative-editor-plugin/configure.action | traceId: d2d97f26a2exxxxx | userName: admin  org.apache.http.conn.HttpHostConnectException: Connect to mycompany.com:8016 [mycompany.com/192.168.x.x] failed: Connection refused: connect          ...   at com.atlassian.confluence.plugins.synchrony.utils.SynchronyProxyUtil.isSynchronyProxyRunning(SynchronyProxyUtil.java:41)  {code}",5
"CONFSERVER-45357","11/24/2016 05:20:57","A new synchrony-standalone jar temp file should not be generated every time Confluence is restarted","Each jar file occupies around 60MB of disk space. Multiple jar files will occupy a considerable space until the temp directory is cleaned up.  The synchrony-standalone jar must be named in a consistent way, for example: synchrony-standalone-6.1.0.jar",3
"CONFSERVER-45572","12/07/2016 02:51:06","NPS view sample survey on the admin panel is broken","*How to reproduce*  - enable NPS plugin  - navigate to General Configuration > Analytics  - click ""View a sample""    *Expected*  - a sample nps dialog is displayed    *Actual*  - no inline dialog is displayed    instead there is the following error message in the console :  {code}  survey-inline-dialog.js?data-wrm-batch-type=resource&data-wrm-key=com.atlassian.plugins.atlassian-n…:78 Uncaught TypeError: $surveyEl[0].show is not a function  {code}    which is triggered from the following piece of code :   {code}              if (isAuiFiveNine) $surveyEl[0].open = true;              else $surveyEl[0].show();  {code}      Note : that is the case for plugin version 3.1.18, however it has been addressed in most recent versions    So a simple plugin upgrade would solve all our issues    *Done When*  - Main Plugin build includes an nps plugin job (/)  - Bump nps plugin version to latest (/)  ",0
"CONFSERVER-45555","12/13/2016 23:32:24","Confluence incorrectly using HTTP protocol to reach synchrony-proxy during healthcheck when running over SSL","h2. Problem summary    When Confluence's server.xml is configured to run over SSL, the healthcheck URL continues to use the HTTP protocol to reach synchrony-proxy, which causes a failure as the request should be over HTTPS.  h2. Steps to reproduce    Install Confluence 6.0.2 to run over SSL (e.g. port 8443) at the Tomcat level (no external proxy involved). Self-signed cert is ok as long as it is imported into the Java trust store that Confluence is using.    After startup, observe the following repeated in logs:  {code:java}  2016-12-13 17:28:52,918 WARN [synchrony-interop-executor:thread-1] [plugins.synchrony.bootstrap.DefaultSynchronyProxyMonitor] pollHealthcheck Could not ping the synchrony-proxy [http://localhost:8443/synchrony-proxy/healthcheck]:   org.apache.http.NoHttpResponseException: The target server failed to respond  {code}  Healthcheck URL should be [https://localhost:8443/synchrony-proxy/healthcheck] (HTTPS) rather than plain HTTP.  h2. Workaround   1. Enable the standard HTTP connector port in the {{server.xml}} file, for example:  {code:java}  <Connector port=""8090"" connectionTimeout=""20000"" redirectPort=""8443""                  maxThreads=""48"" minSpareThreads=""10""                  enableLookups=""false"" acceptCount=""10"" debug=""0"" URIEncoding=""UTF-8""                  protocol=""org.apache.coyote.http11.Http11NioProtocol""/>  {code}     2. Disable the healthcheck request by setting a system property *synchrony.proxy.healthcheck.disabled* to true (in setenv.sh or setenv.bat) in Confluence 6.1.0 (when it's released). For example:  {code:java}  CATALINA_OPTS=""-Dsynchrony.proxy.healthcheck.disabled=true ${CATALINA_OPTS}""  {code}    If you are running Confluence as a Windows Service, access the [Java Options|https://confluence.atlassian.com/confkb/how-to-set-system-properties-for-confluence-running-as-a-service-on-windows-873858384.html] and add this line:    {code}  -Dsynchrony.proxy.healthcheck.disabled=true  {code}    The 1st workaround is already included in our documentation as below:   - [Troubleshooting collaborative editing|https://confluence.atlassian.com/display/DOC/Troubleshooting+Collaborative+Editing]   - [Running Confluence Over SSL or HTTPS|https://confluence.atlassian.com/display/DOC/Running+Confluence+Over+SSL+or+HTTPS]    The 2nd workaround will be added in the same documentation when 6.1 is released. This ticket will now be resolved since the workarounds have been provided.",1
"CONFSERVER-45575","12/15/2016 03:38:58","More descriptive error messaging when Synchrony is down","Currently in Confluence 6.0.x when the editor can't connect to a Synchrony server the following error appears on the UI:    {quote}  Loading the editor's taking longer than usual.  Give it a few moments, then refresh your page if  it still doesn't load. Speak to your Confluence  admin if that doesn't fix it.  {quote}    A more specific error message to Admins may be more helpful, for example pointing to the [collab editing troubleshooting guide|https://confluence.atlassian.com/doc/troubleshooting-collaborative-editing-858772087.html] or even better, explaining what the error is (eg: socket already in use, base-url issue, etc...)    !image-2016-12-15-14-36-40-936.png|thumbnail! ",2
"CONFSERVER-45778","12/20/2016 00:32:53","fix class cast exception on MailEventServerListener","We seem to hit the following error on the Cluster Acceptance Test build  {code}  2016-12-19 08:58:20,777 ERROR [cached4] [atlassian.confluence.event.ConfluenceEventDispatcher] run There was an exception thrown trying to dispatch event [com.atlassian.confluence.cluster.hazelcast.HazelcastClusterEventWrapper[source=null]] from the invoker [com.atlassian.confluence.event.ConfluenceListenerHandlersConfiguration$TimingListenerHandler$1$1@50dd2b40]   -- event: com.atlassian.confluence.event.events.admin.MailServerEditEvent[source=null] | originatingMemberUuid: c5e0aa3a-c46f-42ea-998b-ca7d2b8f9873  java.lang.ClassCastException: com.atlassian.confluence.cluster.hazelcast.HazelcastClusterEventWrapper cannot be cast to com.atlassian.confluence.event.events.admin.MailServerEditEvent    at com.atlassian.confluence.event.listeners.MailServerEventListener.handleEvent(MailServerEventListener.java:34)    at com.atlassian.event.legacy.LegacyListenerHandler$LegacyListenerInvoker.invoke(LegacyListenerHandler.java:55)    at com.atlassian.confluence.event.ConfluenceListenerHandlersConfiguration$TimingListenerHandler$1$1.invoke(ConfluenceListenerHandlersConfiguration.java:69)    at com.atlassian.confluence.event.ConfluenceEventDispatcher$VCacheRequestContextRunnableFactory$1.lambda$run$0(ConfluenceEventDispatcher.java:93)    at com.atlassian.confluence.vcache.VCacheRequestContextOperations.lambda$doInRequestContext$0(VCacheRequestContextOperations.java:50)    at com.atlassian.confluence.impl.vcache.VCacheRequestContextManager.doInRequestContextInternal(VCacheRequestContextManager.java:87)    at com.atlassian.confluence.impl.vcache.VCacheRequestContextManager.doInRequestContext(VCacheRequestContextManager.java:71)  {code}    The root cause is definitely legit  {code}  Event underlyingEvent = EventUtils.extractWrappedEventOrOriginal(event);            if (underlyingEvent instanceof MailServerCreateEvent) {              MailServerCreateEvent createEvent = (MailServerCreateEvent) underlyingEvent;              MailServer server = createEvent.getServer();              JmxUtil.registerBean(makeNameForServer(server.getName()), createEvent.getServer());          } else if (underlyingEvent instanceof MailServerDeleteEvent) {              JmxUtil.unregisterBean(makeNameForServer(((MailServerDeleteEvent) underlyingEvent).getServer().getName()));          } else if (underlyingEvent instanceof MailServerEditEvent) {              //Additionally handle edit events              MailServerEditEvent editEvent = (MailServerEditEvent) event;              JmxUtil.unregisterBean(makeNameForServer(editEvent.getOriginalServerName()));              JmxUtil.registerBean(makeNameForServer(editEvent.getServer().getName()), editEvent.getServer());          }  {code}    we are casting the wrong Edit Event",2
"CONFSERVER-45657","12/22/2016 07:07:16","Synchrony keys are not generated during Confluence DC upgrade","""_jwt.private.key_"" and ""_jwt.public.key_"" properties are not generated during Confluence DC upgrade from 5.x to 6.x.    The workaround is to create a fresh Confluence installation (either DC or demo would work) and copy appropriate properties from _confluence.cfg.xml_ file from confluence home directory, for example:  {code}  <property name=""jwt.private.key"">XXXXXXX</property>  <property name=""jwt.public.key"">YYYYYY</property>  {code}    h5.Workaround  # Download attached jar utility  [^Sec.jar], run it from the command line (this can be run on any system with Java, not necessarily the server):  {code}  java -jar Sec.jar  {code}  # Copy and paste the output into {{confluence.cfg.xml}} before the {{</properties>}} tag, and restart Confluence for the changes to take effect.",2
"CONFSERVER-46178","12/23/2016 00:56:45","Synchrony Status Cache doesn't work in cluster","The SynchronyStatusCheckJob runs every 30 seconds but doesn't actually save anything to the cache. This is most-likely a bug in VCache to do with the Hazelcast cache. It works fine in non-DC instances.    Because of this, Synchrony might be down but the big red banner will never display, since if there is nothing in the cache, we assume Synchrony is just up and everything is fine. That should only happen the first time the job runs. Every other time it will be populated with Synchrony's actual status.    We should fix the VCache issue with Hazelcast. We shouldn't use a supplier in the get for the cache miss, because it will make all page loads slow since it is used by the SynchronyDownBannerDataProvider which determines if the banner should be displayed or not. That runs on every page, and we can't be waiting for a rest request there, even if it's only for Sysadmins. Additionally, it accesses the cache multiple times in the job itself.",2
"CONFSERVER-45712","12/23/2016 01:03:26","Fix Synchrony Process Manager TimeoutException on Confluence start.","There is a TimeoutException that happens sometimes on Confluence Startup when Synchrony doesn't start within its timeout limit. This is a result of fixing a deadlock in Tomcat with the Synchrony Proxy webapp by dropping the timeout from 30 seconds to 10.     We should get rid of this TimeoutException, either by increasing the timeout back to 30 seconds, or by simply removing that block altogether, if it's not really required.  {code:java}  2016-12-20 12:19:20,701 WARN [lifecycle:thread-20] [plugins.synchrony.bootstrap.SynchronyInteropBootstrap] onStart An exception occurred while waiting for Synchrony to start: Timeout waiting for task.  2016-12-20 12:19:20,702 DEBUG [lifecycle:thread-20] [plugins.synchrony.bootstrap.SynchronyInteropBootstrap] onStart Details:  java.util.concurrent.TimeoutException: Timeout waiting for task.{code}  The timeout doesn't actually affect Synchrony's operation. It will still start normally after that.",3
"CONFSERVER-45676","12/30/2016 14:59:19","Copy page hierarchy doesn't work with SQL server ","h3. Summary    Unable to copy page hierarchy when using start *Start titles with* and *Replace title text* options    h3. Environment  * Confluence 6.0.2  * SQL Server 11.00.6020    h3. Steps to Reproduce  # Install confluence 6.0.2 and configure it with SQL server 11.00.6020 according to [Database Setup for SQL Server|https://confluence.atlassian.com/doc/database-setup-for-sql-server-9258.html]  # Create a space with pages that contains child pages  # Click on the (...) and then pick copy  # Check ""Include child pages"" then hit next  # In the *Start titles with* put some random text, in my case *new*  # In the *Replace title text* put some random text, in my case *ion*  # In the *With this text* put some random text, in my case *aaa*  # Hit *copy*     ps: see video for more details http://recordit.co/fIquIjx70V    h3. Expected Results  Pages should be copied and text should be replaced    h3. Actual Results  Error is showing ""Something went wrong."" and pages are not copied    The below exception is thrown in the atlassian-confluence.log file:  {noformat}  2016-12-30 14:48:52,346 ERROR [http-nio-8090-exec-3] [engine.jdbc.spi.SqlExceptionHelper] logExceptions The replace function requires 3 argument(s).   -- referer: http://ec2-54-194-5-4.eu-west-1.compute.amazonaws.com:8090/display/OMAR/back-end+leverage+networks+-+1483105629502 | url: /rest/page-hierarchy/copy | traceId: b1d95ef835705392 | userName: admin  2016-12-30 14:48:52,347 ERROR [http-nio-8090-exec-3] [engine.jdbc.spi.SqlExceptionHelper] logExceptions Incorrect syntax near ')'.   -- referer: http://ec2-54-194-5-4.eu-west-1.compute.amazonaws.com:8090/display/OMAR/back-end+leverage+networks+-+1483105629502 | url: /rest/page-hierarchy/copy | traceId: b1d95ef835705392 | userName: admin  2016-12-30 14:48:52,358 ERROR [http-nio-8090-exec-3] [rest.api.model.ExceptionConverter] convertServiceException No status code found for exception, converting to internal server error :   -- referer: http://ec2-54-194-5-4.eu-west-1.compute.amazonaws.com:8090/display/OMAR/back-end+leverage+networks+-+1483105629502 | url: /rest/page-hierarchy/copy | traceId: b1d95ef835705392 | userName: admin  net.sf.hibernate.HibernateException: org.hibernate.exception.SQLGrammarException: could not extract ResultSet      at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:147)      at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:155)      at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1407)      at com.atlassian.hibernate.adapter.adapters.query.QueryV2Adapter.list(QueryV2Adapter.java:201)        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)      at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)      at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)      at java.lang.Thread.run(Thread.java:745)  Caused by: org.hibernate.exception.SQLGrammarException: could not extract ResultSet      at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConversionDelegate.java:106)      at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:42)      at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:111)      at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:97)      at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:79)      at org.hibernate.loader.Loader.getResultSet(Loader.java:2123)      at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1911)      at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1887)        at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1426)      at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1398)      ... 290 more  Caused by: java.sql.SQLException: The replace function requires 3 argument(s).      at net.sourceforge.jtds.jdbc.SQLDiagnostic.addDiagnostic(SQLDiagnostic.java:372)      at net.sourceforge.jtds.jdbc.TdsCore.tdsErrorToken(TdsCore.java:2988)      at net.sourceforge.jtds.jdbc.TdsCore.nextToken(TdsCore.java:2421)      at net.sourceforge.jtds.jdbc.TdsCore.getMoreResults(TdsCore.java:671)      at net.sourceforge.jtds.jdbc.JtdsStatement.executeSQLQuery(JtdsStatement.java:505)      at net.sourceforge.jtds.jdbc.JtdsPreparedStatement.executeQuery(JtdsPreparedStatement.java:1029)      at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:379)      at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.extract(ResultSetReturnImpl.java:70)      ... 305 more  caused by:  java.sql.SQLException: Incorrect syntax near ')'.      at net.sourceforge.jtds.jdbc.SQLDiagnostic.addDiagnostic(SQLDiagnostic.java:372)      at net.sourceforge.jtds.jdbc.TdsCore.tdsErrorToken(TdsCore.java:2988)      at net.sourceforge.jtds.jdbc.TdsCore.nextToken(TdsCore.java:2421)      at net.sourceforge.jtds.jdbc.TdsCore.getMoreResults(TdsCore.java:677)      at net.sourceforge.jtds.jdbc.JtdsStatement.executeSQLQuery(JtdsStatement.java:505)      at net.sourceforge.jtds.jdbc.JtdsPreparedStatement.executeQuery(JtdsPreparedStatement.java:1029)      at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:379)        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)      at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)      at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)      at java.lang.Thread.run(Thread.java:745)  Caused by: java.lang.IllegalStateException: Transaction already active      at org.hibernate.engine.transaction.internal.TransactionImpl.begin(TransactionImpl.java:52)      at org.hibernate.internal.AbstractSharedSessionContract.beginTransaction(AbstractSharedSessionContract.java:387)      at com.atlassian.hibernate.util.TransactionHelper.beginTransactionCommitNested(TransactionHelper.java:28)      at com.atlassian.hibernate.adapter.adapters.session.SessionV2Adapter.beginTransaction(SessionV2Adapter.java:507)      at org.springframework.orm.hibernate.HibernateTransactionManager.doBegin(HibernateTransactionManager.java:441)      ... 177 more  {noformat}     h3. Notes  This is working fine with other database  ",0
"CONFSERVER-46917","01/10/2017 21:06:02","The language pack update is not pick up by Confluence question","h3. Step to reproduce:  # Install Confluence question plugin with the Confluence question French Language pack.  # Create a new user and set his default language to French via profile setting  # Create a new space and create a new question.   # Go the question page via the space side bar.     h3. Expected behaviour  The text in the search bar should be ""Que voulez-vous savoir à propos de <space name>"", as set in the language pack from the file ""confluence-questions_fr_FR.properties"" :  {code}  cq.searchbox.input.placeholder.space=Que voulez-vous savoir \u00E0 propos de {0}?  {code}   !Screen Shot 2017-01-10 at 22.15.20.png|thumbnail!     h3. Actual behaviour  The text in the search bar is showing ""Que voulais vous savoir à propos de <space name>"" as set in the default  translation mapping of the Confluence question plugin.  {code}  cq.searchbox.input.placeholder.space=Que voulais vous savoir \u00E0 propos de {0}?  {code}  which is a wrong translation of the sentence.    h3. Workaround  {panel:borderStyle=dashed| borderColor=#3C78B5| titleBGColor=#3C78B5| bgColor=#E7F4FA}  (!) *PLEASE READ*: As with all recommendations made by Atlassian Support, please follow best practices for Change Management and *test and validate* these settings in a Test/Development and Staging environment *prior to* rolling any changes into a Production environment. This is to validate these changes and ensure that they will function well within your infrastructure prior to placing these changes in production.  {panel}    For Confluence Questions 2.6.11:  # Download [^confluence-questions-2.6.11.obr] (fixed version attached here)  # Navigate to !https://confluence.atlassian.com/download/attachments/590259974/Cog.png! > *Add-ons*  # Click *Upload add-on*   # Upload the new obr downloaded in step 1  ",5
"CONFSERVER-45732","01/11/2017 05:02:35","Recommended Updates email process runs for a long time consuming resources","h3. Summary    When using a large instance of Confluence, the recommended updates email process may run for a long time while pulling large amounts of data from the database. This can sometimes cause an outage to Confluence as everything gets bottlenecked on this. This differs from CONF-30581 as that bug was caused by multiple concurrent running schedules, but this bug is caused by a single large schedule.    h3. Steps to Reproduce    # Have a very large instance of Confluence  # Allow the recommended updates email process to run    h3. Expected Results    No hit to performance    h3. Actual Results    Confluence performs slowly and may even become totally unresponsive    h3.Workaround    Disable the Daily Summary Email scheduled job as described at [Configuring the recommended updates email notification|https://confluence.atlassian.com/doc/configuring-the-recommended-updates-email-notification-281480712.html]",5
"CONFSERVER-45733","01/11/2017 09:02:09","Discarding a shared draft for a new page does not allow other users to save or discard the changes in the page afterwards","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-45733].   {panel}  h3. Summary  h5. Scenario    Two users are editing a newly created page, whereby user A created the page and passed the URL {{<base-url>/pages/resumedraft.action?draftId=xxxxx&draftShareId=xxxxx}} to user B.  h5. Outcome #1    If user A closes the editor (as the creator of the page draft), user B will not be able to publish the changes or close the editor.  h5. Outcome #2    If user B closes the editor, the user gets an error in the top-right corner of the editor that says, ""There were errors discarding your draft. An unknown error has occurred. Please check your logs.""  h3. Steps to reproduce   # Login as user A in a browser and login as user B in incognito browser.   # As user A, create a new page.   # Copy paste the link in incognito browser so user B can join the editing session.   # Add some text.    h5. For outcome #1   # Get user A to click on 'Close' and 'Discard everyone's changes'.   # Afterwards, get user B to try to publish the page.    h5. For outcome #2:   # Get user B to click on 'Close' and 'Discard everyone's changes'.    h3. Expected Results    For both outcome #1 and #2, the page should be able to be discarded or saved depending on the user's option.  h3. Actual Results  h5. For outcome #1:    The page just loads, but nothing happens. This is what we see in the browser console:    !Outcome 1.png|thumbnail!  h5. For outcome #2:    We see the following error in the editor:    !Outcome 2.png|thumbnail!",2
"CONFSERVER-51868","01/11/2017 21:51:15","Stream inline comments to a page to avoid connection timeout that makes all inline comments disappear","{panel:bgColor=#e7f4fa}   *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51868].   {panel}  ",3
"CONFSERVER-45760","01/13/2017 07:36:48","Confluence getBlogEntry does not always return the full exception message","h3. Summary    Confluence XML-RPC function getBlogEntry does not always return the full exception message if the ID requested is a page  h3. Environment   * Confluence 5.10+    h3. Steps to Reproduce   # Install Confluence   # Enable XML-RPC from *Administration* -> *Further Configuration*   # Send multiple requests for _getBlogEntry_    h3. Expected Results    Every time Confluence will reply with the below error  {code:java}  <Fault 0: 'java.lang.Exception: java.lang.ClassCastException: com.atlassian.confluence.pages.Page cannot be cast to com.atlassian.confluence.pages.BlogPost'>  {code}  h3. Actual Results    After multiple attempts, the returned error looks like this:  {code:java}  <?xml version=""1.0""?><methodResponse><fault><value><struct><member><name>faultString</name><value>java.lang.Exception: java.lang.ClassCastException</value></member><member><name>faultCode</name><value><int>0</int></value></member></struct></value></fault></methodResponse>  {code}  (!) Note the difference:   java.lang.Exception: java.lang.ClassCastException   java.lang.Exception: java.lang.ClassCastException: com.atlassian.confluence.pages.Page cannot be cast to com.atlassian.confluence.pages.BlogPost  h3. Workaround   * The problem on the Confluence side is caused due to JVM does JIT optimisation and suppresses stack-trace for frequent errors.   * Restart of the Confluence temporary solves the problem.   * Disable JIT optimization in Confluence, add to JVM parameter:  {code:java}  -XX:-OmitStackTraceInFastThrow  {code}",2
"CONFSERVER-45910","01/25/2017 11:21:58","Confluence throws ""Comparison method violates its general contract!"" when trying to sort multiple long-running tasks","h3. Code to reproduce    Use a unit test below to reproduce this by running the comparator:  {code:java}          Collections.sort(fullList, (o1, o2) -> {              // Sorting by name is not as good as sorting by start time (unavailable) but better than anything              // else we can think of this iteration. Changing this order later is unable to raise any blockers              // in production.              Message o1Name = o1.getName();              if (o1Name == null || o1Name.getKey() == null)                  return 1;  // push o1 to bottom                Message o2Name = o2.getName();              if (o2Name == null || o2Name.getKey() == null)                  return -1;  // push o2 to bottom                return o1Name.getKey().compareTo(o2Name.getKey());          });  {code}  Which is copied from Confluence code.    Confluence will throw the following error message:  {code:java}  Comparison method violates its general contract!  {code}  That basically means that the comparator is not written correctly.  h3. Environments    Attached a test class to reproduce the error: [^ContractViolationTest.java]   - on Windows 10,   - java version ""1.8.0_111"" Java(TM) SE Runtime Environment (build 1.8.0_111-b14), Java HotSpot(TM) Client VM (build 25.111-b14, mixed mode)   - Important: it only breaks if collection size is >= 32    h3. A possible fix in Confluence    Switching the +1 and -1 return values in the comparator's two if blocks fixes the problem.    Note that this change makes ""null key"" cases appear before ""not-null key"" cases in the sorted list. It does not affect the original order of objects where the key is not-null.  h3. Workaround    Adding this JVM system property fixes the issue:   -Djava.util.Arrays.useLegacyMergeSort=true  h3. References   * TimSort has been introduced in Java 7, it is a stable sort that was designed for relatively expensive comparison operations. Only used for sorting objects, not primitives. Its problematic code path is only reached for collections with size >= 32. See [http://stackoverflow.com/questions/4018332/is-java-7-using-tim-sort-for-the-method-arrays-sort]   * Exception might be caused by non-transitive comparators: [http://stackoverflow.com/questions/8327514/comparison-method-violates-its-general-contract]   * Atlassian has seen something similar, too: [https://confluence.atlassian.com/fishkb/comparison-method-violates-its-general-contract-387941517.html]   * Oracle has open issues related to this, promised to be fixed in Java 9: [http://bugs.java.com/bugdatabase/view_bug.do?bug_id=7075600]   * See: com.atlassian.confluence.api.impl.service.longtasks.LongTaskFactory#buildStatus",3
"CONFSERVER-45919","01/26/2017 10:27:14","Server Base URL becomes N/A after restoring from a Cloud backup.","h5. Steps To Replicate :   # Export a backup from cloud   # Import into Confluence Server   # Generate a support zip   # Check *application.xml* file   # Search for <server.base.url> in the xml file   # The server base url becomes N/A  {code:java}  <server.base.url>N/A</server.base.url>  {code}    h5. Workaround   # Log in Confluence as a system administrator   # !https://confluence.atlassian.com/download/attachments/703398523/Cog.png?version=1&modificationDate=1421718696855&api=v2! > General Configuration   # Select *Edit*   # Ensure Server Base URL is displayed correctly in the text field   # Save    or follow the steps in  * [How Do I replace all 'hard' links to my old Base URL|https://confluence.atlassian.com/confkb/how-do-i-replace-all-hard-links-to-my-old-base-url-284366235.html]    to make the changes.    Note : Due to this issue, it may prevent synchrony from working properly right after the restoration.",5
"CONFSERVER-45921","01/26/2017 15:30:37","Blog post titles for different dates within the same space must be unique if Collaborative Editing is enabled","h3. Summary  If you enable Collaborative Editing in Confluence 6.x and create two blog posts with identical titles in the same space (whether they're created on the same day or not), Confluence throws an error message saying:  {quote}A page with the title 'blog 1' already exists in this space. Enter a different title for your page.{quote}    In short, this means the behaviour with Collaborative Editing turned on is as such:  # Two blog posts with identical titles set for the same day cannot be saved.  # Two blog posts with identical titles set for different days cannot be saved.    The behaviour is different with Collaborative Editing turned off / in Confluence 5.x, whereby the results are as such:  # Two blog posts with identical titles set for the same day cannot be saved.  # Two blog posts with identical titles set for different days *can* be saved.    This change is not mentioned anywhere in the [Confluence 6.0 Release Notes|https://confluence.atlassian.com/doc/confluence-6-0-release-notes-844235309.html].    h3. Steps to reproduce  # Install Confluence 6.0.4.  # Create a space.  # Create a new blog post for January 20, 2017 titled 'blog 1' and save it.  # Create another blog post for January 3, 2017 titled 'blog 1' and save it.    h3. Expected Results  The second blog post can be saved.    h3. Actual Results  The second blog post can't be saved with the following error:     !Screen Shot 2017-01-26 at 9.57.15 PM.png|thumbnail! ",3
"CONFSERVER-45966","01/29/2017 13:07:25","Links containing umlaut or cyrillic characters become invalid","h3. Summary    When you insert a link that contains umlaut or cyrillic characters via {{Insert more content > Link > Web link}} or the shortcuts {{⌘+K}} / {{CTRL+K}}, the link changes so that Confluence encodes the percentage (%) symbol as {{%25}}. This renders the link to be unusable.    For example:   # Correct link inserted into a Confluence page: [https://de.wikipedia.org/wiki/Die_L%C3%B6wen]   # Incorrect link after saving the page and clicking on the link: [https://de.wikipedia.org/wiki/Die_L%25C3%25B6wen]    You can see the % symbol in the original link has been replaced as {{%25}}.  h3. Steps to Reproduce    Option 1   # Create a new page and insert a web link via one of the methods below:   ** {{Insert more content > Link > Web link}}   ** {{⌘+K}} / {{CTRL+K}}   # Insert this URL into the 'Address' field: [https://de.wikipedia.org/wiki/Die_L%C3%B6wen]   # Insert any text into the the 'Link text' field.   # Click on ""Insert"".   # Save the page.   # Try to open the link.    Option 2   # Create a new page and paste a web link   # Edit the link and see that the 'Address' and 'Link text' field have not changed   # Change the 'Link text' field to new text   # Save the link   # Edit the link again   # The URL in the 'Address' field has now been changed    h3. Expected Results    The link on the page should direct you to the correct page: [https://de.wikipedia.org/wiki/Die_L%C3%B6wen]  h3. Actual Results    The link directs you to an invalid page: [https://de.wikipedia.org/wiki/Die_L%25C3%25B6wen]  h3. Notes    Tested in Confluence 5.9.14. The functionality works as expected  h3. Workaround    -Option 1: Replace all {{%}} signs in links with spaces instead-   # -Take: {{[https://de.wikipedia.org/wiki/Die_L%C3%B6wen]}} URL-   # -Change to: {{[https://de.wikipedia.org/wiki/Die_L] C3 B6wen}}-    Option 1: Paste the link into the editor instead of using insert link dialog.   * In this method you cannot modify the link text, so the link text will be automatically set based on the url    Option 2: Use square brackets to insert the link. [ ]   # Type ""[""   # Type the text you want for your link in the editor, for example ""My Link""   # Type a ""|""   # *Type* the url   # Type ""]"" to complete the link.   # Save or preview the page to confirm it works.   # *Important!* Don't open the link dialog for this link. If you do, the link will be double-encoded.    For step 4, you could also try pasting the url but this might have less success since the url will be converted to a link automatically and you might have to first undo that automatic conversion, which in turn may cause the closing ""]"" to have no effect. See option 3 instead.    Option 3   # Paste the URL into the editor.   # Press undo to undo any automatic link creation/extraction so you see the original URL.   # If the URL is still a link, click it, and click ""Unlink"" to return it back to regular text.   # At the beginning of the link, type [ followed by `Escape` to exit the Link Autocomplete   # Type the text to display for the link followed by ""|""   # Now your link should look like this   ## !Screen Shot 2017-05-11 at 7.37.39 AM.png|width=379,height=48!   # Click at the end of the link and type ""]"" to complete the link. This should auto-convert it to a link with the desired text.   # Save or preview the page to confirm it works.   # *Important!* Don't open the link dialog for this link. If you do, the link will be double-encoded.         Option 4: Using the Source Editor to change links after adding them   # Install the [Confluence Source Editor|https://marketplace.atlassian.com/plugins/com.atlassian.confluence.plugins.editor.confluence-source-editor/server/overview] (free add-on)   # Edit the page   # Click on the {{<>}} icon in the top right   # Find the *href=* attribute that contains the '%25' in the URL   # Replace it with just '%'   # Apply the changes and save the page",2
"CONFSERVER-46039","01/31/2017 13:59:06","Links can't be edited or clicked on after saving the page","h3. Summary  When you insert a link via {{Insert more content > Link > Web link}} or the shortcuts {{⌘+K}} / {{CTRL+K}}, the link is no longer clickable or editable once you save the page.    h3. Steps to Reproduce  # Create a new page and insert a web link via one of the methods below:  #* {{Insert more content > Link > Web link}}  #* {{⌘+K}} / {{CTRL+K}}  # Insert any one of the URLs with the protocols below into the 'Address' field:  #* {{Notes://xxxxxxxxxxx/xxxxxxxxxx}} (For Lotus Notes)  #* {{File://xxxxx}} (For local file links)  #* {{scp://user@ip_address}}  # Insert any text into the the 'Link text' field.  # Click on ""Insert"".  # Test that the link can be edited by clicking on it.  # Save the page.  # Test that the link can be clicked on and works.  # Click on ""Edit"" to edit the page again.  # You can see that the link is no longer editable because nothing appears when you click on it.  # Save the page.    h3. Expected Results  The link on the page should be clickable.    h3. Actual Results  The link is not clickable and nothing happens when you click on it.    h3. Note  This happens because it changes the storage format of the page from:  {code}<p><a href=""File://xxxxx"">Test</a></p>{code}  To:  {code}<p><a>Test</a></p>{code}    *Identifying Affected Pages*  This isn't foolproof as it may bring up lines that Confluence believes are links due to automatic formatting, however, you can try searching the database for instances of {{%<a>%</a>%}}:  {code:sql}  SELECT c.contentid,c.title,bc.body FROM bodycontent as bc  JOIN content as c  ON c.contentid=bc.contentid  WHERE bc.body like '%<a>%</a>%' and prevver is null;  {code}  (i) Depending on your database, you may need to rewrite this query to be suitable for your DBMS",3
"CONFSERVER-46040","01/31/2017 17:01:12","Edit in Office (WebDAV Launcher 1.1.0) install loop on Firefox 51.0","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-46040].   {panel}  h3. Summary    Attempting to edit a document in Office using the Edit in Office link in a Firefox 51 browser will always prompt to install the WebDAV extensions.  h3. Environment    (Optional - If Applicable)   * Windows   * Firefox 51   * MS Office    h3. Steps to Reproduce   # Attach a word document to a page in Confluence   # Install Firefox (updated to latest version)   # Attempt to Edit in Office    h3. Expected Results    The extension installs and the document opens in Office for editing.  h3. Actual Results    The extension is installed, but when you click on Edit in Office again it asks to install the extension again. You can then repeat the loop until you get bored enough to stop. See the video below:   [^firefox51_webdav_install_loop.mov]  h3. Notes   * This currently is only affected in the latest release of Firefox (51)   * Currently verified in Windows 7    h3. Workaround   # Use a different browser/version   ** Use Edit in Office in Internet Explorer   ** Uninstall Firefox 51, install [Firefox 50.1|https://ftp.mozilla.org/pub/firefox/releases/50.1.0/], disable autoupdate   # Disable autostart:   ## Go to ""about:config"" in firefox address bar   ## Search ""browser.tabs.remote.autostart""   ## Double click the entry to make the value false. If you see ""browser.tabs.remote.autostart.x"" entries, make them false too.   ## Restart firefox   ## Go to ""about:support"" and make sure the value of ""Multiprocess Windows"" is ""0/1 (Disabled)""    h3. Notes for the fix   * You don't have to upgrade to 6.0.7 or 6.1.0. The fix is just the firefox add-on and it is backward compatible.   * The new version hosted by Mozilla is still under review and there is no timeline for when it will be public. Thus you can not install it using standard update of Firefox at this moment.   * To get it installed:   ** You can download it from [here|https://update.atlassian.com/office-connector/URLLauncher/latest/webdavloader.xpi] and manually install it    ** Or you can remove the existing add-on from Firefox and then confluence will prompt the installation.     ",2
"CONFSERVER-46227","02/07/2017 13:54:11","Shortcut links become empty after editing the page with Collaborative Editing turned on","h3. Summary  If you use a shortcut link in a page, editing the page with Collaborative Editing turned on will result in the link to become empty. Thus, the link on the page will point to the page itself.    h3. Steps to replicate  (i) Make sure Collaborative Editing is turned on.  # Navigate to {{Confluence Administration > General Configuration > Shortcut Links}} and make sure the default key 'google' and expanded value 'http://www.google.com/search?q=' is still valid.  # Create a new page.  # Insert a link to the page and under the 'Advanced' tab, insert the following values:   *Link*: atlassian@google   *Link text*: atlassian  # Save the page.  # The link opens this page (as expected): https://google.com/search?q=atlassian  # Edit the page again and save it.  # Try to click on the same link as before.    h3. Expected results  The same page as before should be opened: https://google.com/search?q=atlassian    h3. Actual results  The link refers back to the URL of the page itself. If you edit the page and click on 'Edit' for the link, you can see that the 'Link' field is now empty.",3
"CONFSERVER-46312","02/09/2017 21:47:41","When editing a page, text is being changed to a hyperlink","With Collaborative Editing enabled, some pages turn text into hyperlink text when editing.    h3. Steps to Reproduce  # Download the attached Storage Format  # Create a new page in Confluence 6.0 with Collaborative Editing enabled  # Download *Source Editor* plugin from the marketplace  # Copy the text from the Storage Format  # Use the source editor plugin to paste the text to the new page  # Update  # Edit  # Update again    h3. Expected Result  Text will appear normally with no links    h3. Actual Result  The entire section will appear as a hyperlink    h3. Other Information  Please note, if you disable Collaborative Editing, the page appears as expected.    ",3
"CONFSERVER-46504","02/21/2017 03:05:18","Pasting a large amount of text will disconnect Synchrony","h3. Environment  This has only been seen when using IIS as a reverse proxy.    h3. Workaround  Enable the Synchrony proxy as well, by adding {{-Dsynchrony.proxy.enabled=true}} to the JVM params. See [Administering Collaborative Editing|https://confluence.atlassian.com/doc/administering-collaborative-editing-858772086.html#AdministeringCollaborativeEditing-Confluence'sinternalSynchronyproxy] for more information.",5
"CONFSERVER-46523","02/22/2017 03:26:44","request access to unpublished draft or content created by anonymous fails","*Steps to reproduce*   * enable anonymous access   * anonymous user creates a page P   * User A with set restrictions permission (for instance space admin) restricts page P to themselves   * User B views the page and is presented with request access panel   * User B clicks ""Request Access""    *Expected Behaviour*   * a notification is sent to space admin   * User B is prompted that a notification was sent    *Actual Behaviour*   * no notification is sent   * User B is prompted that a notification was not sent     ",2
"CONFSERVER-46542","02/23/2017 09:06:48","XLSX File Conversion Service causes OutOfMemory","h3. Summary    Uploading some XLSX files to Confluence can cause OutOfMemory error while generating preview.  h3. Steps to Reproduce   # Upload with 700x40 XLSX file to Confluence   # Open file in preview window    h3. Expected Results    Preview generated or ""Not possible to preview"" showed.  h3. Actual Results    Confluence became unresponsive.   The below exception is thrown in the catalina.out file:  {noformat}  22-Feb-2017 16:41:32.141 SEVERE [http-nio-8081-ClientPoller-0] org.apache.tomcat.util.net.NioEndpoint$Poller.run   java.lang.OutOfMemoryError: Java heap space          at java.util.Collections$UnmodifiableCollection.iterator(Collections.java:1038)          at org.apache.tomcat.util.net.NioEndpoint$Poller.timeout(NioEndpoint.java:1287)          at org.apache.tomcat.util.net.NioEndpoint$Poller.run(NioEndpoint.java:1094)          at java.lang.Thread.run(Thread.java:745)  {noformat}  The below exception is thrown in the atlassian-confluence.log:  {noformat}  2017-02-22 16:41:35,731 ERROR [conversion-thread-0] [plugins.conversion.impl.TimeoutConversionRunnable] run Cannot convert. Execution error:   -- url: /display/DEMO/NEW+XLS+test | page: 917505 | traceId: 4ecd169c1d90bb85 | userName: admin | referer: http://ec2-54-229-125-162.eu-west-1.compute.amazonaws.com:8081/ | action: viewpage  java.lang.OutOfMemoryError: Java heap space          at com.aspose.cells.zth.b(Unknown Source)          at com.aspose.cells.zth.a(Unknown Source)          at com.aspose.cells.zth.a(Unknown Source)          at com.aspose.cells.zth.a(Unknown Source)          at com.aspose.cells.zth.a(Unknown Source)          at com.aspose.cells.zbwm.a(Unknown Source)          at com.aspose.cells.SheetRender.<init>(Unknown Source)          at com.atlassian.plugins.conversion.convert.image.CellsConverter.generateThumbnailDirect(CellsConverter.java:102)          at com.atlassian.confluence.plugins.conversion.impl.runnable.JVMConversionRunnable.generateThumbnail(JVMConversionRunnable.java:109)          at com.atlassian.confluence.plugins.conversion.impl.runnable.JVMConversionRunnable.doWork(JVMConversionRunnable.java:77)          at com.atlassian.confluence.plugins.conversion.impl.runnable.ConversionRunnable.run(ConversionRunnable.java:36)          at com.atlassian.confluence.plugins.conversion.impl.runnable.JVMConversionRunnable.run(JVMConversionRunnable.java:22)          at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)          at java.util.concurrent.FutureTask.run(FutureTask.java:266)          at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)          at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)          at java.lang.Thread.run(Thread.java:745)  {noformat}  h3. Heap Dump Analysis    !Screen Shot 2017-02-23 at 10.33.27.png|thumbnail!    !Screen Shot 2017-02-23 at 10.35.04.png|thumbnail!  h3. Workaround    Upgrade the Document Conversion add-on with the latest version, below   * Download the right *document-conversion-library-x.x.xx.jar*  ||Confluence version ||Document Library  Version||  |6.0 - 6.4|Document conversion [1.2.25|https://packages.atlassian.com/maven-closedsource-local/com/atlassian/plugins/document-conversion-library/1.2.25/document-conversion-library-1.2.25.obr] ([mirror|https://drive.google.com/file/d/1oqv9iuJDnsxE_aRRRMOQ6Yc0DHOoJlnl/view?usp=sharing])|  |h4. after 6.4|Document conversion [2.0.2.1|https://packages.atlassian.com/maven-closedsource-local/com/atlassian/plugins/document-conversion-library/2.0.2.1/document-conversion-library-2.0.2.1.jar] |     * Install the add on by file upload, as per [installing plugins |https://confluence.atlassian.com/upm/installing-add-ons-273875715.html#Installingadd-ons-Installingbyfileupload]     ",5
"CONFSERVER-48483","02/24/2017 02:10:32","TC is making too many requests to the Media API","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-48483].   {panel}  As you can see on https://zipkin.atlassian.io/traces/352e5b2b2c21229f , TC is making 39 requests to the Media API for the exact same file.    Transcription from HC:    {quote}  [11:33 AM] Eduardo Garcia [Atlassian]: so it's asking for the same icon ~30 times?  [11:34 AM] Eduardo Garcia [Atlassian]: is it possible to cache that somehow, at least for the same call? (which is what we're seeing here)  [11:41 AM] Richard Atkins [Atlassian]: I'm still trying to see where the rest resource inlines any attachments, rather than just generating links to them  [11:41 AM] Richard Atkins [Atlassian]: (because browsers are great at ensuring they only retrieve a link once)  [11:41 AM] Eduardo Garcia [Atlassian]: yeah :D  [11:41 AM] Eduardo Garcia [Atlassian]: although for that to work, you probably need a signed url  [11:41 AM] Eduardo Garcia [Atlassian]: but in any case, that'd be better, yes  [11:42 AM] Richard Atkins [Atlassian]: com.atlassian.confluence.extra.calendar3.rest.resources.EventResource#getEvents(java.lang.String, java.lang.String, java.lang.String, java.lang.String) is the entry point for that rest request  [11:42 AM] Eduardo Garcia [Atlassian]: or using something like VCache or whatever to cache the icons for a while, if the probability of them being repeated is high  [11:42 AM] Eduardo Garcia [Atlassian]: we can also do some kind of caching in our side at some point, but it's a lot more involved of course :)  [11:48 AM] Richard Atkins [Atlassian]: I'm not seeing anything that would cause a rest request to have an inlined attachment of any kind. Have you been able to reproduce this on any test env?  [11:49 AM] Richard Atkins [Atlassian]: What I am seeing is that reminder notifications (and other notification types) will inline images, but that's only when generating emails  [11:50 AM] Richard Atkins [Atlassian]: What sort of zipkin trace header integration was created for the jobs triggered by the external job scheduler?  [11:50 AM] Richard Atkins [Atlassian]: are they triggered through rest requests, or through SQS?  [11:51 AM] Richard Atkins [Atlassian]: Because it all feels like we're looking in the wrong place  [11:54 AM] Richard Atkins [Atlassian]: hmmmmm, maybe not  [11:54 AM] Richard Atkins [Atlassian]: any time DefaultResourceDataHandler.createAttachmentDataHandler is called, it reads all the bytes in the relevant attachment  [11:55 AM] Richard Atkins [Atlassian]: and that *could* be being called on rest requests, even when that DataHandler is subsequently not used for anything  [11:56 AM] Richard Atkins [Atlassian]: that's all as a side effect of invoking com.atlassian.confluence.extra.calendar3.calendarstore.event.transformers.SubCalendarEventSupportingInviteesTransformer#transform  [11:59 AM] Richard Atkins [Atlassian]: It looks like that Transformer will only trigger the problem if there is precisely one invitee for the event that's being sent. If there are more, then we'll just append the names of the invitees (sounds like bad ux)  [11:59 AM] Richard Atkins [Atlassian]: Looks like you're getting 30 requests for the same file because you're retrieving 30 events with the same user  [12:00 PM] Richard Atkins [Atlassian]: You'll be happy to know that switching to Aa managed avatars will probably make this problem go away for you  [12:02 PM] Richard Atkins [Atlassian]: of course, it will also *break* in that case, because it assumes that all profile pictures are still managed by Confluence's AttachmentManager  [12:11 PM] Richard Atkins [Atlassian]: @DuyLuong which issue tracker should @Edu  raise a bug in?  [12:12 PM] Richard Atkins [Atlassian]: Looks like we can fix an ugly performance and memory problem at the same time, simply by making the Transformer (or DataHandler) aware that it's rendering for REST vs a notification  [12:13 PM] Richard Atkins [Atlassian]: (notification ==> inline any Avatar that isn't external)  [12:13 PM] Richard Atkins [Atlassian]: And at the same time, we can fix the bug where external avatars will cause NPEs or worse  [12:14 PM] Richard Atkins [Atlassian]: Just because a ProfilePictureInfo has a downloadPath, it doesn't mean that path is inside Confluence  [12:15 PM] Richard Atkins [Atlassian]: I'm assuming that there's another team taking care of the Cloud side of the TeamCal fork...  {quote}    ",3
"CONFSERVER-51568","03/02/2017 12:48:50","JIRA issues Macro instead of Epic Name showing Epic Link column","{panel:bgColor=#e7f4fa}  *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-51568].  {panel}  h3. Summary    JIRA issues macro in table view is showing Epic Link when in display options only Epic Name is chosen.  h3. Environment    JIRA 7.2.4   Confluence 5.10.8 - 6.4.x  h3. Steps to Reproduce   # Create an Epic in JIRA   # In Confluence insert JIRA Issues Macro to the page   ## Select the issue key of the Epic in a search   ## In the display options   ### select columns to display = Key, Summary, Epic Name, Epic Status, Issue Type => the table shows Epic Link instead of Epic Name   [^Screen Shot 2017-03-02 at 13.58.50.png]    [^Screen Shot 2017-03-02 at 13.58.33.png]   ### select columns to display = Key, Summary, Epic Name, Epic Status => Same result for JIRA 7.2 and error for JIRA 6.4:   [^4-View without Issue Type.JPG]   ### select columns to display = Key, Summary, Epic Name, Epic Status, Epic Link => the table shows Epic Links instead of Epic Name and column Epic Links doesn't exist    h3. Workaround    No workaround available at the moment.  h3. Solution    Upgrade to Confluence 6.5.0 or newer.",8
"CONFSERVER-51631","03/07/2017 00:15:18","Upgrading from 5.9.x to 5.10.x or above fails if any data exists in user_relation, content_relation or usercontent_relation tables","h3. Summary    When upgrading to 5.10 or above from 5.9.x, the RelationConstraintsPreSchemaUpgradeTask gets re-run due to the build number being bumped since 5.10. This means that if any data exists in any of the affected tables user_relation, content_relation or usercontent_relation, then the upgrade task will fail, and hence the upgrade as a whole.      h3. Steps to Reproduce    # Install Confluence 5.9.x  # Perform some action which causes data to exist in these tables (I am not actually sure how it gets there)  # Upgrade to 5.10 or above    h3. Expected Results    Upgrade succeeds    h3. Actual Results    Upgrade fails with the below log entry:    {code:none}  2017-01-27 17:24:59,240 ERROR [localhost-startStop-1] [atlassian.confluence.plugin.PluginFrameworkContextListener] launchUpgrades Upgrade failed, application will not start: RelationService upgrade failed to prevent data loss. Please read https://confluence.atlassian.com/x/MRJZLw for more details  com.atlassian.confluence.upgrade.UpgradeException: RelationService upgrade failed to prevent data loss. Please read https://confluence.atlassian.com/x/MRJZLw for more details          at com.atlassian.confluence.upgrade.upgradetask.RelationConstraintsPreSchemaUpgradeTask.assertTableIsEmpty(RelationConstraintsPreSchemaUpgradeTask.java:72)          at com.atlassian.confluence.upgrade.upgradetask.RelationConstraintsPreSchemaUpgradeTask.upgradeTable(RelationConstraintsPreSchemaUpgradeTask.java:64)          at com.atlassian.confluence.upgrade.upgradetask.RelationConstraintsPreSchemaUpgradeTask.doUpgrade(RelationConstraintsPreSchemaUpgradeTask.java:58)          at com.atlassian.confluence.upgrade.AbstractUpgradeManager$UpgradeStep$3.execute(AbstractUpgradeManager.java:641)          at com.atlassian.confluence.upgrade.AbstractUpgradeManager.executeUpgradeTask(AbstractUpgradeManager.java:248)          at com.atlassian.confluence.upgrade.AbstractUpgradeManager.executeUpgradeStep(AbstractUpgradeManager.java:228)          at com.atlassian.confluence.upgrade.AbstractUpgradeManager.runSchemaUpgradeTasks(AbstractUpgradeManager.java:190)  {code}     h3.Workaround    The workaround is to store the data in a temporary table while upgrading, and then copy it back after it's complete. Here's some steps to perform this. The examples below are for MySQL and Postgres environments, but the same concept can be adapted to other DBMS though the syntax may be different:    h4. MySQL  # Stop Confluence and ensure you take a database backup in case anything goes wrong  # Create a new temporary table which is a copy of the table containing data, for example:  {code:sql}  create table usercontent_relation_backup like usercontent_relation;  insert usercontent_relation_backup select * from usercontent_relation;  {code}  # Truncate the original table, for example:  {code:sql}  truncate table usercontent_relation;  {code}  # Perform the upgrade as normal  # Stop Confluence  # Move the data back from the temporary table into the newly created empty table, for example:  {code:sql}  insert usercontent_relation select * from usercontent_relation_backup;  {code}  # Remove the temporary table:  {code:sql}  drop table usercontent_relation_backup;  {code}  # Start Confluence again    h4. Postgres  # Stop Confluence and ensure you take a database backup in case anything goes wrong  # Create a new temporary table which is a copy of the table containing data, for example:  {code:sql}  CREATE TABLE usercontent_relation_backup AS SELECT * FROM usercontent_relation;  {code}  # Truncate the original table, for example:  {code:sql}  TRUNCATE usercontent_relation;  {code}  # Perform the upgrade as normal  # Stop Confluence  # Move the data back from the temporary table into the newly created empty table, for example:  {code:sql}  INSERT INTO usercontent_relation SELECT * FROM usercontent_relation_backup;  {code}  # Remove the temporary table:  {code:sql}  DROP TABLE usercontent_relation_backup;  {code}  # Start Confluence again    h4. Oracle   # Stop Confluence and ensure you take a database backup in case anything goes wrong   # Create a new temporary table which is a copy of the table containing data, for example: {code:sql}  CREATE TABLE usercontent_relation_backup AS SELECT * FROM usercontent_relation; {code}  Per [https://stackoverflow.com/questions/8997399/creating-duplicate-table-from-existing-table]   # Truncate the original table, for example: {code:sql}  TRUNCATE TABLE usercontent_relation; {code}  Per [https://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_10007.htm#SQLRF01707]   # Perform the upgrade as normal   # Stop Confluence   # Move the data back from the temporary table into the newly created empty table, for example: {code:sql}  INSERT INTO usercontent_relation SELECT * FROM usercontent_relation_backup; {code}  Per [https://www.techonthenet.com/oracle/insert.php]   # Remove the temporary table {code:sql}  DROP TABLE usercontent_relation_backup PURGE; {code}  Per [https://docs.oracle.com/cd/B19306_01/server.102/b14200/statements_9003.htm]   # Start Confluence again.",5
"CONFSERVER-51651","03/08/2017 00:07:18","Add User token expired in email","h3. Summary  When using the Add User option to invite a user to Confluence the link that is sent contains an expired token.  h3. Environment  NA  h3. Steps to Reproduce  # Setup Confluence 6.0.6 with an email server  # Go to !https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png!>Users>Add User  # Add the user and send the email to the user to set their password    h3. Expected Results  The user is sent a link to set their password    h3. Actual Results  The link will be sent but the token is expired:  !resetpasswordtoken.png|thumbnail!     h3. Notes  h3.Workaround  The user can click on the ""get a new token here"" link and reset the password.  ",1
"CONFSERVER-51661","03/08/2017 08:25:19","There are many errors ""executeClusteredJobWithRecoveryGuard Unhandled exception"" in atlassian-confluence.log after migrating from Cloud to Server or after an upgrade","h3. Summary  There are many errors ""executeClusteredJobWithRecoveryGuard Unhandled exception"" in atlassian-confluence.log after migrating from Cloud to Server or after upgrading Confluence    {noformat}  ERROR [Caesium-1-2] [scheduler.caesium.impl.CaesiumSchedulerService] executeClusteredJobWithRecoveryGuard Unhandled exception during the attempt to execute job '24ec482d-9c69-43bd-bcdf-13e619147a0c-CrowdDirectorySynchroniserJobRunner'; will attempt recovery in 60 seconds  {noformat}    h3. Environment  * Migrated from Confluence Cloud to Server 6.0.2  * Confluence Upgrade      h3. Steps to Reproduce  # Restore Confluence Cloud backup into Confluence Server  # Restart Confluence    h3. Expected Results  No errors in atlassian-confluence.log    h3. Actual Results  The below exception is thrown in the atlassian-confluence.log file:  {noformat}  2017-03-03 11:01:24,175 ERROR [Caesium-1-2] [scheduler.caesium.impl.CaesiumSchedulerService] executeClusteredJobWithRecoveryGuard Unhandled exception during the attempt to execute job '24ec482d-9c69-43bd-bcdf-13e619147a0c-CrowdDirectorySynchroniserJobRunner'; will attempt recovery in 60 seconds  com.atlassian.scheduler.SchedulerRuntimeException: The parameters cannot be accessed: com.atlassian.scheduler.core.JobRunnerNotRegisteredException: No job runner registered for job runner key '24ec482d-9c69-43bd-bcdf-13e619147a0c-CrowdDirectorySynchroniserJobRunner'          at com.atlassian.scheduler.core.status.UnusableJobDetails.getParameters(UnusableJobDetails.java:52)          at com.atlassian.scheduler.core.status.LazyJobDetails.getParameters(LazyJobDetails.java:94)          at com.atlassian.confluence.impl.schedule.caesium.ConfluenceSchedulerService.enqueueJob(ConfluenceSchedulerService.java:132)          at com.atlassian.scheduler.caesium.impl.CaesiumSchedulerService.executeClusteredJob(CaesiumSchedulerService.java:437)          at com.atlassian.scheduler.caesium.impl.CaesiumSchedulerService.executeClusteredJobWithRecoveryGuard(CaesiumSchedulerService.java:462)          at com.atlassian.scheduler.caesium.impl.CaesiumSchedulerService.executeQueuedJob(CaesiumSchedulerService.java:390)          at com.atlassian.scheduler.caesium.impl.CaesiumSchedulerService$1.consume(CaesiumSchedulerService.java:285)          at com.atlassian.scheduler.caesium.impl.CaesiumSchedulerService$1.consume(CaesiumSchedulerService.java:282)          at com.atlassian.scheduler.caesium.impl.SchedulerQueueWorker.executeJob(SchedulerQueueWorker.java:65)          at com.atlassian.scheduler.caesium.impl.SchedulerQueueWorker.executeNextJob(SchedulerQueueWorker.java:59)          at com.atlassian.scheduler.caesium.impl.SchedulerQueueWorker.run(SchedulerQueueWorker.java:34)          at java.lang.Thread.run(Thread.java:745)  Caused by: com.atlassian.scheduler.core.JobRunnerNotRegisteredException: No job runner registered for job runner key '24ec482d-9c69-43bd-bcdf-13e619147a0c-CrowdDirectorySynchroniserJobRunner'          at com.atlassian.scheduler.core.status.UnusableJobDetails.<init>(UnusableJobDetails.java:37)          at com.atlassian.scheduler.core.status.LazyJobDetails$1.create(LazyJobDetails.java:85)          at com.atlassian.scheduler.core.status.LazyJobDetails$1.create(LazyJobDetails.java:58)          at com.atlassian.util.concurrent.LazyReference$Sync.run(LazyReference.java:325)          at com.atlassian.util.concurrent.LazyReference.getInterruptibly(LazyReference.java:143)          at com.atlassian.util.concurrent.LazyReference.get(LazyReference.java:112)          at com.atlassian.scheduler.core.status.LazyJobDetails.getDelegate(LazyJobDetails.java:121)          ... 11 more  {noformat}        h3. Workaround  # Shut down Confluence  # Backup scheduler_clustered_jobs table or the whole Confluence database *This must be done*  # Executing the following SQL query to clear off the table :  {code}  TRUNCATE TABLE scheduler_clustered_jobs;  {code}  # Start Confluence",5
"CONFSERVER-52797","03/13/2017 08:22:22","Large synchrony EVENTS table leads to OOM during XML Site Backup","We use a <composite-id> type in hibernate for the EVENTS table (because synchrony has two columns as a composite id). However, hibernate treats entities with composite ids differently to entities with an id field. Specifically, hibernate when being asked what the id of an entity is (which is what we do to get a handle during export), it returns the entire entity object as the id.    We keep around these ""transient"" ids in our xml export to make sure we don't duplicate etc. The code that uses these ids assume that they are small.    We will have to re-implement it with a composite id class, and hopefully, that will fix the issue.      ",2
"CONFSERVER-51824","03/14/2017 03:02:12","Add timestamp to synchrony log messages","{panel:bgColor=#e7f4fa}    *NOTE:* This suggestion is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding suggestion|http://jira.atlassian.com/browse/CONFCLOUD-51824].    {panel}    h3. Problem Definition  Timestamp is not a part of the standard synchrony logging yet.  Please update message format in log4j properties file so we log the timestamp for messages.    h3. Suggested Solution  Add timestamp to Synchrony log file     h3. Workaround  You can add the timestamp by following the below steps:    # Stop Confluence  # Go to {{<confluence-install>/confluence/WEB-INF/classes/log4j.properties}}  # Look for the section that starts with the below line:  {code:java}  log4j.appender.synchronylog=com.atlassian.confluence.logging.SynchronyLogAppender  {code}  # In that section, you should have the following line  {code:java}  log4j.appender.synchronylog.layout.ConversionPattern=%m%n  {code}  # Modify this to become:  {code:java}  log4j.appender.synchronylog.layout.ConversionPattern=%d %p %M %m%n  {code}  # Start Confluence    For more info on PatternLayout, please check [Log4j Pattern Layout Documentation|https://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/PatternLayout.html].        Log snippet example:    {code:borderStyle=solid}  2017-03-29 11:17:41,479 DEBUG processLine Running QueryDSL sytem...  2017-03-29 11:17:41,588 DEBUG processLine {""synchrony"":{""message"":""synchrony.querydsl.jdbc [info] connection pool test-connection-on-checkin: true idle-connection-test-period: 100 max-idle-time-excess-connections: 100 max-idle-time: 3600"",""ns"":""synchrony.querydsl.jdbc"",""level"":""info""},""message"":""synchrony.querydsl.jdbc [info] connection pool test-connection-on-checkin: true idle-connection-test-period: 100 max-idle-time-excess-connections: 100 max-idle-time: 3600""}  2017-03-29 11:17:41,605 DEBUG processLine MLog initialization issue: slf4j found no binding or threatened to use its (dangerously silent) NOPLogger. We consider the slf4j library not found.  2017-03-29 11:17:41,606 DEBUG processLine MLog clients using log4j logging.  2017-03-29 11:17:41,631 DEBUG processLine Initializing c3p0-0.9.5.1 [built 16-June-2015 00:06:36 -0700; debug? true; trace: 10]  2017-03-29 11:18:18,384 DEBUG processLine {""synchrony"":{""message"":""synchrony.middleware.memoize-response [info] request for static resource"",""cache-key"":[""0.0.0.0"",""/synchrony/resources/js/vendor/sockjs.min.js"",null],""ns"":""synchrony.middleware.memoize-response"",""level"":""info""},""message"":""synchrony.middleware.memoize-response [info] request for static resource""}  2017-03-29 11:18:18,502 DEBUG processLine {""synchrony"":{""message"":""synchrony.middleware.memoize-response [info] request for static resource"",""cache-key"":[""0.0.0.0"",""/synchrony/resources/js/synchrony.min.js"",null],""ns"":""synchrony.middleware.memoize-response"",""level"":""info""},""message"":""synchrony.middleware.memoize-response [info] request for static resource""}  2017-03-29 11:18:18,958 DEBUG processLine Initializing c3p0 pool... com.mchange.v2.c3p0.ComboPooledDataSource [ acquireIncrement -> 3, acquireRetryAttempts -> 30, acquireRetryDelay -> 1000, autoCommitOnClose -> false, automaticTestTable -> null, breakAfterAcquireFailure -> false, checkoutTimeout -> 0, connectionCustomizerClassName -> null, connectionTesterClassName -> com.mchange.v2.c3p0.impl.DefaultConnectionTester, contextClassLoaderSource -> caller, dataSourceName -> 1bqvx939n71a0e010n5igr|47864b2e, debugUnreturnedConnectionStackTraces -> false, description -> null, driverClass -> org.postgresql.Driver, extensions -> {}, factoryClassLocation -> null, forceIgnoreUnresolvedTransactions -> false, forceSynchronousCheckins -> false, forceUseNamedDriverClass -> false, identityToken -> 1bqvx939n71a0e010n5igr|47864b2e, idleConnectionTestPeriod -> 100, initialPoolSize -> 3, jdbcUrl -> jdbc:postgresql://localhost:5432/confluence610, maxAdministrativeTaskTime -> 0, maxConnectionAge -> 0, maxIdleTime -> 3600, maxIdleTimeExcessConnections -> 100, maxPoolSize -> 15, maxStatements -> 0, maxStatementsPerConnection -> 0, minPoolSize -> 3, numHelperThreads -> 3, preferredTestQuery -> null, privilegeSpawnedThreads -> false, properties -> {user=******, password=******}, propertyCycle -> 0, statementCacheNumDeferredCloseThreads -> 0, testConnectionOnCheckin -> true, testConnectionOnCheckout -> false, unreturnedConnectionTimeout -> 0, userOverrides -> {}, usesTraditionalReflectiveProxies -> false ]  2017-03-29 11:18:19,339 DEBUG processLine {""synchrony"":{""message"":""synchrony.sync.hub [info] create-entity"",""event"":""entity.created"",""entity"":""/Synchrony-901a371c-caf0-3343-b0be-836ec2606cff/confluence-327699"",""ns"":""synchrony.sync.hub"",""level"":""info""},""message"":""synchrony.sync.hub [info] create-entity""}  2017-03-29 11:18:20,911 DEBUG processLine {""synchrony"":{""message"":""synchrony.metrics.hub-metrics [info] init-session"",""source"":""O32qVJ5HfgeDrEblwh9zQz4"",""event"":""session.created"",""modified-content"":false,""entity"":""/Synchrony-901a371c-caf0-3343-b0be-836ec2606cff/confluence-327699"",""ns"":""synchrony.metrics.hub-metrics"",""level"":""info""},""message"":""synchrony.metrics.hub-metrics [info] init-session""}  2017-03-29 11:18:32,280 DEBUG processLine {""synchrony"":{""message"":""synchrony.metrics.hub-metrics [info] close-session"",""source"":""O32qVJ5HfgeDrEblwh9zQz4"",""event"":""session.destroyed"",""modified-content"":true,""entity"":""/Synchrony-901a371c-caf0-3343-b0be-836ec2606cff/confluence-327699"",""ns"":""synchrony.metrics.hub-metrics"",""level"":""info""},""message"":""synchrony.metrics.hub-metrics [info] close-session""}  {code}",2
"CONFSERVER-52405","03/14/2017 03:11:08","Add timestamp to synchrony log messages","Raised here: https://jira.atlassian.com/browse/CONF-51824",1
"CONFSERVER-51872","03/16/2017 15:30:03","'slf4j library not found' error message in Confluence 6","h3. Summary  'slf4j library not found' error message in the Confluence 6 {{atlassian-synchrony.log}}    h3. Environment  * Confluence 6  * Synchrony enabled    h3. Steps to reproduce  Anytime Confluence is started using Collaborative editing, the following message is printed to the logs:  {noformat}  Running QueryDSL sytem...  {""synchrony"":{""message"":""synchrony.querydsl.jdbc [info] connection pool test-connection-on-checkin: true idle-connection-test-period: 100 max-idle-time-excess-connections: 100 max-idle-time: 3600"",""ns"":""synchrony.querydsl.jdbc""}}  MLog initialization issue: slf4j found no binding or threatened to use its (dangerously silent) NOPLogger. We consider the slf4j library not found.  MLog clients using log4j logging.  Initializing c3p0-0.9.5.1 [built 16-June-2015 00:06:36 -0700; debug? true; trace: 10]  {noformat}    This is printed whether Collaborative editing is working, or if its configured correctly or incorrectly.      h3. Notes  Error seems to be benign as Synchrony still works, but there could be a logging issue.    h3.Workaround  No workaround found so far.  ",2
"CONFSERVER-51873","03/16/2017 15:33:12","Creating EVENTS table fails with ERROR The size (16777215) given to the column 'event' exceeds the maximum allowed for any data type (8000)","h3. Summary  Customers on MSSQL run into the following error indicating that the EVENTS table failed to be created due to the size given to the EVENT column.    h3. Environment  * MSSQL    h3. Expected Results  The EVENT table gets created    h3. Actual Results  The below exception is thrown in the logs, and the EVENT table subsequently doesn't get created.  {code}  ERROR [localhost-startStop-1] [hibernate.tool.hbm2ddl.SchemaUpdate] execute Unsuccessful: create table [EVENTS] ([rev] varchar(255) not null, [history] varchar(255) not null, [partition] int not null, [sequence] int not null, [event] varbinary(16777215) null, primary key ([rev], [history]))  java.sql.SQLException: The size (16777215) given to the column 'event' exceeds the maximum allowed for any data type (8000).  {code}     h3. Notes  The create table command seems to be requesting the EVENT column to be created with {{VARBINARY(16777215)}} as opposed to more correct {{VARBINARY(MAX)}}    h3.Workaround    [Upgrading fails with ERROR The size (16777215) given to the column 'event' exceeds the maximum allowed for any data type (8000) in Confluence|https://confluence.atlassian.com/display/CONFKB/Upgrading+fails+with+ERROR+The+size+%2816777215%29+given+to+the+column+%27event%27+exceeds+the+maximum+allowed+for+any+data+type+%288000%29+in+Confluence]  ",3
"CONFSERVER-51900","03/17/2017 20:09:36","Synchrony is Ignoring java.io.tmpdir Property","h3. Summary    Synchrony is ignoring the system property *java.io.tmpdir* when added to file *synchrony-args.properties*.    h3. Steps to Reproduce    # Add *java.io.tmpdir=/path/to/your/own/temp/directory* to *<confluence-home>/synchrony-args.properties*  # Restart Confluence  # Create or Edit a page    h3. Expected Results    The file *snappy-1.1.0.1-3787f697-2b19-4e27-9c89-be03fcde98a4-libsnappyjava.so* is located under /path/to/your/own/temp/directory.    h3. Actual Results    The mentioned file is located at the default system */tmp* folder.     h3. Notes    This is a regression on version 6.0.6, from versions 6.0.2 to 6.0.5 the property was successfully read by Synchrony. This is a big problem while working around the limitation of not being able to mount /tmp with *exec* permissions as in the following KB:    * [Editor fails to load in Confluence 6.x due to 'Could not initialize class org.xerial.snappy.Snappy' error|https://confluence.atlassian.com/confkb/editor-fails-to-load-in-confluence-6-x-due-to-could-not-initialize-class-org-xerial-snappy-snappy-error-859462192.html]    Adding the property *-Djava.io.tmpdir* to setenv file *does not work around this issue*. Confluence reads the system property successfully but Synchrony does not.    h3.Workaround    No known workaround at the moment.",3
"CONFSERVER-51937","03/21/2017 12:51:49","JRE_HOME is not set when using Linux(x64) installer","h3. Summary    Confluence 6.1 installed with the installer on Linux cannot start with embedded JRE because neither JAVA_HOME nor JRE_HOME are set by setenv script  h3. Environment    Confluence 6.1.0   Ubuntu 14.04  h3. Steps to Reproduce   # Install Confluence with the installer (x64) on Linux   # Choose Not start   # Go to $CONFLUENCE_INSTALL/bin   # {{./start_confluence.sh}}  h3. Expected Results    Confluence started  {code:java}  root@ip-172-31-33-170:/opt/atlassian/confluence/bin# ./start-confluence.sh     To run Confluence in the foreground, start the server with start-confluence.sh -fg  executing using dedicated user: confluence  If you encounter issues starting up Confluence, please see the Installation guide at http://confluence.atlassian.com/display/DOC/Confluence+Installation+Guide    Server startup logs are located in /opt/atlassian/confluence/logs/catalina.out  ---------------------------------------------------------------------------  Using Java: /opt/atlassian/confluence/jre//bin/java  2017-03-21 12:42:10,107 INFO [main] [atlassian.confluence.bootstrap.SynchronyProxyWatchdog] A Context element for ${confluence.context.path}/synchrony-proxy is found in /opt/atlassian/confluence/conf/server.xml. No further action is required  ---------------------------------------------------------------------------  Using CATALINA_BASE:   /opt/atlassian/confluence  Using CATALINA_HOME:   /opt/atlassian/confluence  Using CATALINA_TMPDIR: /opt/atlassian/confluence/temp  Using JRE_HOME:        /opt/atlassian/confluence/jre/  Using CLASSPATH:       /opt/atlassian/confluence/bin/bootstrap.jar:/opt/atlassian/confluence/bin/tomcat-juli.jar  Using CATALINA_PID:    /opt/atlassian/confluence/work/catalina.pid  Tomcat started.  {code}  h3. Actual Results    Confluence cannot start, no logs are created in catalina.out or Confluence home.   The console showing the issue  {code:java}  root@ip-172-31-33-170:/opt/atlassian/confluence/bin# ./start-confluence.sh     To run Confluence in the foreground, start the server with start-confluence.sh -fg  executing using dedicated user: confluence  If you encounter issues starting up Confluence, please see the Installation guide at http://confluence.atlassian.com/display/DOC/Confluence+Installation+Guide    Server startup logs are located in /opt/atlassian/confluence/logs/catalina.out  Checking operation system...  Neither the JAVA_HOME nor the JRE_HOME environment variable is defined    {code}    h3. Root Cause    The issue is happening because of incorrect logic in the script {{setjre.sh}} :  {code:java}    if [ -z ""$JAVA_HOME"" -a -z ""$JRE_HOME"" ]; then      echo ""Neither the JAVA_HOME nor the JRE_HOME environment variable is defined""      echo ""At least one of these environment variable is needed to run this program""      exit 1    fi  fi  if [ -z ""$JAVA_HOME"" -a ""$1"" = ""debug"" ]; then    echo ""JAVA_HOME should point to a JDK in order to run in debug mode.""    exit 1  fi  if [ -z ""$JRE_HOME"" ]; then    JRE_HOME=""$JAVA_HOME""  fi    echo ""Setting JRE_HOME....""  JRE_HOME=""/opt/atlassian/confluence/jre/""; export JRE_HOME  {code}  When the execution will got into the condition \{\{ if [ -z ""$JAVA_HOME"" -a -z ""$JRE_HOME"" ]}} it terminates with {{exit 1;}} so {{JRE_HOME=""/opt/atlassian/confluence/jre/""; export JRE_HOME}} will never be executed.    There's a bug in the shell script. If there's a /usr/bin/java file, then JRE_HOME will be temporarily set to /usr and then it will be corrected at the end of the script. So this issue happens on a Linux machine that doesn't have the default JVM installed.  h3. Workaround(s)  * Set {{JAVA_HOME=""/opt/atlassian/confluence/jre/""}} explicitly before starting Confluence (keep in mind that /opt/atlassian/confluence/jre is the path to Confluence installation direcotry and should be adapted if you are using your own path)  * [Use Confluence with external Oracle JDK (recommended)|https://confluence.atlassian.com/doc/installing-java-for-confluence-144212101.html]  * Remove the {{exit 1}} lines  * Move {{JRE_HOME=""/opt/atlassian/confluence/jre/""; export JRE_HOME}} to the top of {{setjre.sh}}  * ",3
"CONFSERVER-52100","03/22/2017 01:20:18","The log level for the root appender in synchrony-proxy is empty","{panel:bgColor=#e7f4fa}   *NOTE:* This bug report is for *Confluence Server*. Using *Confluence Cloud*? [See the corresponding bug report|http://jira.atlassian.com/browse/CONFCLOUD-52100].   {panel}  The log level should be set to WARN, otherwise a lot of DEBUG logs will be written to the catalina.out file.",2
"CONFSERVER-51951","03/22/2017 09:49:31","Indexer does not handle attachments efficiently for a page update","h3. Summary  There are two *different* symptoms for this problem, but both go back to the same root cause.    h5. Scenario 1  When a page is updated and needs to be indexed, the indexer does not add the attachments, comments and permissions into the journal table. This will overload the hibernate session, where it will pick up items from the journal table. These items will introduce more work on the indexer than expected, where it will need to process all the attachments, comments and permissions of the current page. From the user perspective, it will look like the indexer stalls and slow at processing a small number of tasks     h5. Scenario 2  When a page is updated multiple times and those changes are included in a single indexer batch, the indexer does not handle this efficiently. It will index those changes with every change.      h3. Steps to Reproduce  Reproducing this behavior for Scenario 2 will require multiple quick updates to a certain page (within 5 seconds.)    *Hint:* This can be done through rest api   # Create a new page   # Add multiple attachments to the page (preferably large attachments)   # Edit the page and save   # Edit the page again and save   # Edit the page a third time and save   # Enable DEBUG logging for the package  {code:java}  com.atlassian.confluence.search.lucene.DefaultConfluenceIndexManager  {code}      h3. Expected Results  The indexer will show that it is processing the page along with all the attachments, comments and permission efficiently.   The page should be processed *only once* in a single batch.        h3. Actual Results  The indexer will show that it is processing a single page only while it is actually processing page, attachments, comment and permissions. Also the indexer will process each change separately, redoing all the work again.  This is very time and resource consuming and will cause the indexer to stall or lead to an outage      Large attachments can affect the processing time as well. Below is the log snippet of the behavior for *Scenario 1*  {code:borderStyle=solid}  2017-03-21 11:15:03,887 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 291 items in 43881 milliseconds  2017-03-21 11:14:20,006 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  2017-03-21 11:14:16,240 DEBUG [scheduler_Worker-1] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 2338 items in 276234 milliseconds  2017-03-21 11:09:40,005 DEBUG [scheduler_Worker-1] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  2017-03-21 11:09:36,402 DEBUG [scheduler_Worker-2] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 1527 items in 466396 milliseconds  2017-03-21 11:01:50,006 DEBUG [scheduler_Worker-2] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  2017-03-21 11:01:47,935 DEBUG [scheduler_Worker-1] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 1778 items in 667844 milliseconds  2017-03-21 10:50:40,091 DEBUG [scheduler_Worker-1] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  2017-03-21 10:50:36,342 DEBUG [scheduler_Worker-6] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 869 items in 26337 milliseconds  2017-03-21 10:50:10,004 DEBUG [scheduler_Worker-6] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  ....  2017-03-21 10:48:02,290 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 6 items in 2285 milliseconds  2017-03-21 10:48:00,005 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  ....  2017-03-21 10:36:50,333 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 4 items in 10325 milliseconds  2017-03-21 10:36:40,007 DEBUG [scheduler_Worker-4] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  ....  2017-03-21 10:34:58,947 DEBUG [scheduler_Worker-9] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue Flushed 157 items in 3942 milliseconds  2017-03-21 10:34:55,005 DEBUG [scheduler_Worker-9] [confluence.search.lucene.DefaultConfluenceIndexManager] flushQueue flush requested  {code}      h3. Workaround  The current workaround is to reduce the index batch size in order to avoid including multiple changes in a single batch.  Please add the below to your JVM argument:  {code:java}  -Dindex.queue.batch.size=100  {code}",8
"CONFSERVER-51958","03/22/2017 21:11:16","Unable to start the plugin container for plugin 'com.atlassian.upm.plugin-license-storage-plugin' after upgrade to Confluence 6.x","h3. Steps to reproduce   # Install Confluence 5.x;   # Upgrade ""Atlassian Universal Plugin Manager - Plugin License Storage plugin"";   # Upgrade Confluence to 6.x;    *Expected results*    No errors are thrown.    *Actual results*  {noformat:title=atlassian-confluence.log}  2017-03-16 17:07:07,764 ERROR [ThreadPoolAsyncTaskExecutor::Thread 24] [plugin.osgi.factory.OsgiPlugin] onPluginContainerFailed Unable to start the plugin container for plugin 'com.atlassian.upm.plugin-license-storage-plugin'   -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy  org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'licenseReceiptValidator' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.PluginLicenseRepository]: Error creating bean with name 'pluginLicenseRepository' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'pluginLicenseRepository' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)   at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:185)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1143)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1046)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)   at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)   at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)   at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)   at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:772)   at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:839)   at org.eclipse.gemini.blueprint.context.support.AbstractDelegatedExecutionApplicationContext.access$1600(AbstractDelegatedExecutionApplicationContext.java:60)   at org.eclipse.gemini.blueprint.context.support.AbstractDelegatedExecutionApplicationContext$4.run(AbstractDelegatedExecutionApplicationContext.java:325)   at org.eclipse.gemini.blueprint.util.internal.PrivilegedUtils.executeWithCustomTCCL(PrivilegedUtils.java:85)   at org.eclipse.gemini.blueprint.context.support.AbstractDelegatedExecutionApplicationContext.completeRefresh(AbstractDelegatedExecutionApplicationContext.java:290)   at org.eclipse.gemini.blueprint.extender.internal.dependencies.startup.DependencyWaiterApplicationContextExecutor$CompleteRefreshTask.run(DependencyWaiterApplicationContextExecutor.java:137)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)   at java.lang.Thread.run(Thread.java:745)  Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'pluginLicenseRepository' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)   at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:185)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1143)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1046)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)   at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)   at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)   at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)   at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1192)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1116)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)   at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:813)   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741)   ... 19 more  Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:749)   at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:185)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1143)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1046)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)   at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)   at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)   at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)   at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1192)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1116)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)   at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:813)   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741)   ... 33 more  Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1105)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1050)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:510)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:482)   at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:306)   at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:230)   at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:302)   at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:1192)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1116)   at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1014)   at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:813)   at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:741)   ... 47 more  Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:163)   at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:89)   at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1098)   ... 59 more  Caused by: java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder   at com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl.<init>(LicenseManagerProviderImpl.java:40)   at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)   at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)   at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)   at java.lang.reflect.Constructor.newInstance(Constructor.java:423)   at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147)   ... 61 more  2017-03-16 17:07:17,795 ERROR [ThreadPoolAsyncTaskExecutor::Thread 24] [internal.util.concurrent.RunnableTimedExecution] execute Closing runnable for context NonValidatingOsgiBundleXmlApplicationContext(bundle=com.atlassian.upm.plugin-license-storage-plugin, config=osgibundle:/META-INF/spring/*.xml) did not finish in 10000ms; consider taking a snapshot and then shutdown the VM in case the thread still hangs   -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy  2017-03-16 17:07:17,842 WARN [ThreadPoolAsyncTaskExecutor::Thread 24] [confluence.util.profiling.DurationThresholdWarningTimingHelperFactory] logMessage Execution time for publishing event com.atlassian.plugin.event.events.PluginContainerFailedEvent@2ea04998 took 10077 ms (warning threshold is 5000 ms)   -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy  2017-03-16 17:07:17,842 ERROR [ThreadPoolAsyncTaskExecutor::Thread 24] [extender.internal.support.ExtenderConfiguration] onOsgiApplicationEvent Application context refresh failed (NonValidatingOsgiBundleXmlApplicationContext(bundle=com.atlassian.upm.plugin-license-storage-plugin, config=osgibundle:/META-INF/spring/*.xml))   -- referer: https://wiki.wiki.com/plugins/servlet/upm/manage/all | url: /rest/plugins/1.0/com.atlassian.upm.plugin-license-storage-plugin-key | traceId: 1fe445b981f47ecc | userName: billy  org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'licenseReceiptValidator' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.PluginLicenseRepository]: Error creating bean with name 'pluginLicenseRepository' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'pluginLicenseRepository' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 0 of type [com.atlassian.upm.license.internal.HostLicenseProvider]: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'confluenceHostLicenseProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Unsatisfied dependency expressed through constructor argument with index 1 of type [com.atlassian.upm.license.internal.LicenseManagerProvider]: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'licenseManagerProvider' defined in URL [bundle://206.0:0/META-INF/spring/atlassian-plugins-components.xml]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.atlassian.upm.license.internal.impl.LicenseManagerProviderImpl]: Constructor threw exception; nested exception is java.lang.NoClassDefFoundError: Could not initialize class com.atlassian.extras.decoder.v1.Version1LicenseDecoder  {noformat}  !ss.png|thumbnail!    When we upgrade a system plugin, Confluence handles it as ""User Installed"" and stores the data in the *PLUGINDATA* table. Since 'com.atlassian.upm.plugin-license-storage-plugin' has been unbundled from Confluence 6.x, it fails to load the *PLUGINDATA* entry.    *Workaround*    (!) Always backup the database before any changes.   # Shutdown Confluence;   # Ensure that there's an entry of this plugin in the PLUGINDATA table  {code:sql}  SELECT plugindataid, pluginkey, filename, lastmoddate FROM PLUGINDATA where PLUGINKEY='com.atlassian.upm.plugin-license-storage-plugin';  {code}   # Delete the bad entry in PLUGINDATA  by executing the following DELETE statement:  {code:sql}  delete from PLUGINDATA where PLUGINKEY='com.atlassian.upm.plugin-license-storage-plugin';  {code}   # *[Clear Confluence plugin cache|https://confluence.atlassian.com/display/CONFKB/How+to+clear+Confluence+plugins+cache]*;   # Start Confluence;    See  * [Unable to start the plugin container for plugin 'com.atlassian.upm.plugin\-license\-storage\-plugin' after upgrade to Confluence 6.x|https://confluence.atlassian.com/confkb/unable-to-start-the-plugin-container-for-plugin-com-atlassian-upm-plugin-license-storage-plugin-after-upgrade-to-confluence-6-x-922911414.html]",3
"CONFSERVER-52052","03/23/2017 05:09:39","Base URL check displays warning when URL is the same","In some configurations, particularly when Tomcat's the proxyName or proxyPort values are not configured properly, the Base URL check is warning admins that their current URL is different to the base URL, but the URLs displayed in the warning are identical. Example screenshot:    !baseurl.png!    While this indicates an actual problem in the configuration, the warning is very confusing and should be updated to something more meaningful.    h2. Steps to reproduce     * Don't use a reverse proxy   * Configure the proxyName and proxyPort to bogus values   * You should get the error above when accessing Confluence    or     * Use a reverse proxy   * Do not configure the proxyName and proxyPort values or configure them to incorrect values   * You should get the error above    h2. Workaround    It is recommended that admins configure the proxyName and proxyPort settings correctly in Tomcat's server.xml file.    A KB article exists with instructions on how to disable the plugin so the incorrect warning is not shown.  https://confluence.atlassian.com/display/CONFKB/Your+URL+doesn%27t+match+warning+in+Confluence+6.1+or+later",2
"CONFSERVER-51985","03/24/2017 12:01:23","Embedded JIRA macro in Page Properties Grandchild Page causes Continuous Loop of Page","h4. Summary    Per Developer Escalation creating this defect for a problem that occurs when a Page Properties report on a grandchild Page contains an embedded JIRA macro. The ultimate parent page will be thrown into a continuously refreshing loop, and we are unable to stop the loop from occurring without forcing the browser to stop.  h4. Steps to Reproduce   # Create a new Confluence 6.0.6 instance   # Add the demo site content and a local admin account   # Import the attached Space Export [^se2.zip] into the newly created Confluence 6.0.6 site   # Perform a Content Indexing administration for the site   # Navigate to <yourConfleunceURL>/display/TS2/Page+Properties+testing   # Observe the page in a *continuous loop* as the Page Properties report in a grandchild page has a JIRA issues gadget in the report   # Observe that you can not stop the page from looping by clicking links, the back button or other methods   # Quit your browser   # Reopen your browser   # Go to <yourConfluenceURL>/display/TS2/Summary+of+BLUE+Child+Pages   # Remove the JIRA Gadget in the report for *Blue page 1, with JIRA Gadget*   # Navigate back to <yourConfleunceURL>/display/TS2/Page+Properties+testing   # Observe that the page looping is no longer present    h4. Expected Results    Page Properties reports would display without issue and the page would render normally.  h4. Actual Results    Page becomes stuck in a loop, and continues to attempt to render the reports - refreshing the page continuously and appending to the page URL with each attempt. The only way to stop the rendering is to force the browser to stop the attempt by manual intervention.   h4. Workaround    The only workaround at present is to insure that JIRA macros are only embedded at the Child Page level and *no* *deeper* than the child level, or the looping will occur. ",5
"CONFSERVER-51998","03/25/2017 17:18:13","Attachment links are changed to a self referential link of the page once you edit the page","h3. Summary  When you edit a page that contains attachments that are displayed as a link, those links will point to the page itself and the name of the link will also change to the name of the page.    h3. Steps to replicate  # Create a new page called 'Test'.  # Use the Confluence Source Editor add-on to insert this storage format into the page:   {code}<p>    <ac:structured-macro ac:macro-id=""fa94f7f6-7974-42a4-a8b7-752c0f3e27a8"" ac:name=""toc"" ac:schema-version=""1""/>  </p>  <h3>Documentation</h3>  <p>    <ac:link>      <ri:attachment ri:filename=""File 1.docx""/>    </ac:link>  </p>  <h3>Schedule</h3>  <p>    <ac:link>      <ri:attachment ri:filename=""File 2.xlsx""/>    </ac:link>  </p>  <h3>Attachments</h3>  <table class=""wrapped"">    <colgroup> <col/> <col/> </colgroup>    <tbody>      <tr>        <th> </th>        <th> </th>      </tr>      <tr>        <td>Questions</td>        <td>          <div class=""content-wrapper"">            <p>              <ac:link>                <ri:attachment ri:filename=""File 3.xlsx""/>              </ac:link>            </p>            <p>              <ac:link>                <ri:attachment ri:filename=""File 4.docx""/>              </ac:link>            </p>          </div>        </td>      </tr>      <tr>        <td>Answers</td>        <td>          <div class=""content-wrapper"">            <p>              <ac:link>                <ri:attachment ri:filename=""File 5.xlsx""/>              </ac:link>            </p>          </div>        </td>      </tr>    </tbody>  </table>  <p class=""auto-cursor-target"">    <br/>  </p>{code}  # Save the page.  # Confirm that the links are named as File 1 to File 5.  # Edit the page.  # Click on 'Preview' or save the page.    h3. Expected results  The link names should remain as File 1, File 2, File 3, etc.    h3. Actual results  The link names are all changed to the page title, 'Test'.    h3. Note  Looking at the storage format, the edit results in this link:  {code}<ac:link><ri:attachment ri:filename=""File 5.xlsx"" /></ac:link>{code}  To change to this:  {code}<ac:link />{code}  We've also seen it change to reference the page ID in stead of the attachment, like this:   {code}  <ac:link><ri:content-entity ri:content-id=“PAGE ID"" /></ac:link>  {code}",3
"CONFSERVER-52138","03/26/2017 22:27:40","tableSorter JS error from content report plugin","Sometimes there is a js error due to a missing dependency on aui-table-sortable",1
"CONFSERVER-52044","03/28/2017 06:48:34","Invalid JWT error occurs after upgrading Confluence from 5.9.12 to 6.1.0","After upgrade I am having trouble connecting to Synchrony in the editor. The problems seems to be downloading this file:  {code}http://localhost:10610/synchrony-proxy/v1/data/Synchrony-57773741-2cbe-3c1d-a5ef-d2677cb35abf/confluence-471465985?state-at=@head&state-format=type-tagged&rewrite-request=true&cached=false{code}    The first request fails as expected, because it does not contain the context path. However, the second one should add the context path and it does not. It is identical.    !screenshot-1.png|height=150px!    See attached HAR    *Update*: After removing the contextpath from my installation I still get the same error. If I hit the link directly, I get this:  {code}  {  type: ""missing-token"",  message: ""Missing token""  }  {code}    See second HAR",3
"CONFSERVER-52060","03/29/2017 07:34:14","Images, attachments, user mentions are broken after changing the BaseURL","{panel:title=Atlassian Update - March 2018|borderStyle=solid|borderColor=#3C78B5|titleBGColor=#3C78B5|bgColor=#E7F4FA}  The fix for this issue released in 6.8.0 will prevent links to images (and view attachment macros) from being corrupted after a change in the Confluence baseURL.    However, if there are any existing link corruptions that occurred prior to upgrading to 6.8.0, those corruptions will remain, and the only way to fix is to either revert to a published version of a page without such corruptions, or discard the draft (if the corruption is only in the draft).    I have created an issue to track a fix on the already corrupted links: CONFSERVER-55249  {panel}  h3. Steps to Reproduce    # Set up an instance with no context path, eg [http://localhost:8090/]   # Create a page and add some images, attachments and user mentions to it   -- Confirm it displays ok   # Shut down Confluence and set a context path, eg [http://localhost:8090/confluence]   # Restart and update the base URL in Confluence Admin > General Configurations   # view the page   -- Observe that the images are still ok   # Edit the page   -- Observe that the images are broken in edit mode   # Type some text and save   -- Observe that the images are still broken    This is likely happening because Synchrony ""saved"" the links with the old BaseURL, and then when the BaseURL changed, those changes aren't propagated into Synchrony (because it's saving the editor format).  h3. Workaround  h5. Turn Collaborative Editing Off and back On (recommended)    It has been confirmed that *turning Synchrony Off and On* again resolves the related issue with links in --CONFSERVER-52455--. It is unclear if this applies to the image issue as well.    !https://jira.atlassian.com/images/icons/emoticons/warning.png|width=16,height=16!   All existing shared drafts are lost when you switch collaborative editing off, so make sure your users have published any work they want to keep before you make the change.   # Go to  !https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! > *General Configuration* > *Collaborative editing*   # Click *Change mode*   # Select *Off*   # Click *Change*   # Then turn Synchrony back on   # Then [rebuild the index|https://confluence.atlassian.com/doc/content-index-administration-148844.html#ContentIndexAdministration-Rebuildingthesearchindex] via the UI   # The issue will stop occurring but you will need to go back and manually restore any pages that were affected  ## You can restore the page to an older version  ## Or you can manually adjust the links    h5. Note about this workaround  When Collaborative Editing is enabled, and a page is being edited, all those small changes are stored in Synchrony in-memory cache/events table on the database. That includes the base URL.   When the base URL got changed in Confluence, Synchrony won't be aware of this change. When turning off Collaborative Editing, you discard all the data that Synchrony had and when enabling again, you are forcing to fetch a new copy of the base URL from Confluence. That's how turning it off and on again helps workaround this issue    h5. Turn Collaborative Editing Off Entirely (not recommended)    !https://jira.atlassian.com/images/icons/emoticons/warning.png|width=16,height=16!   All existing shared drafts are lost when you switch collaborative editing off, so make sure your users have published any work they want to keep before you make the change.   # Go to  !https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! > *General Configuration* > *Collaborative editing*   # Click *Change mode*   # Select *Off*   # Click *Change*   # Then [rebuild the index|https://confluence.atlassian.com/doc/content-index-administration-148844.html#ContentIndexAdministration-Rebuildingthesearchindex] via the UI   # The issue will stop occurring but you will need to go back and manually restore any pages that were affected  ## You can restore the page to an older version  ## Or you can manually adjust the links    (i) More information can be found in [Administering Collaborative editing|https://confluence.atlassian.com/doc/administering-collaborative-editing-858772086.html].    If turning off Collaborative Editing is not an option or the affected area is not too big for the instance, there is a workaround that can be applied to a page to fix it on a page to page   basis:  # Edit the affected page that has either _User Mention_ or _Attachment Link_ in it  # Save the page without making any changes (this would break the page due to this bug)  # Revert the page back to the history of 1 version before the current broken version (the version that has all the user mentions and attachment links still intact)    Now that the page has been _affected_ once, any edits after this will not cause the user mentions or attachment links to change again.    ",8
"CONFSERVER-52066","03/29/2017 14:23:29","Contributor Macro is Extremely Slow to Render with Large Spaces and Contributors","h3. Summary    Contributor macro in Confluence 6.0.6 takes 6 minutes to return results when loading the page it is on if the space it is searching contains many pages, ~17,000 pages for example, and is configured to scan descendants or children.  h3. Environment   * Confluence 6.0.6 Data Center    h3. Steps to Reproduce   # Have a space with ~17,000 pages and over ~1170 contributors in the space   # Configure the root page of the space with the contributor macro with the following options:   Contribution Type: Authors   Sort by: Count   Display Format: List   Maximum Number of Contributors: 50   Show Count: Checked   Show last Contribution Time: Checked   Include Page Hierarchy: Descendants    h3. Expected Results    When loading the page the contributor macro will display the contributors within a minute or two.  h3. Actual Results    The page displays, but the macro does not display the contributors until 6 minutes later. Many end users do not wait and report that the macro is not working. The logs show:    _2017-03-27 14:46:10,048 WARN [http-nio-8090-exec-4] [confluence.util.profiling.DefaultActivityMonitor] close Exceeded the threshold of 60000 ms: ActivitySnapshot\{startTime=1490650763574, threadId=238, threadName='http-nio-8090-exec-4', userId='admin', type='web-request', summary='/rest/com.atlassian.confluence.contributors/1.0/contributors?mode=list&showCount=true&scope=children&limit=100&spaces=PROD&showLastTime=true&contextEntityId=1022429&_=1490650763508'}_   _– referer: [https://INSTANCE_DOMAIN.com/display/USERS/Users+Home|https://instance_domain.com/display/USERS/Users+Home] | url: /rest/com.atlassian.confluence.contributors/1.0/contributors | traceId: caf7733225cb19da | userName: admin_   _2017-03-27 14:47:02,920 INFO [http-nio-8090-exec-7] [confluence.rpc.auth.TokenAuthenticationInvocationHandler] invokeAuthenticatedMethod Executing remote API method [ getPage ] as user [ admin ][ admin ]_  h3. Notes    This can easily be reproduced by the customer in their environment due to the size of the space and contributors.  h3. Workaround    There is not an available workaround.",8
"CONFSERVER-52102","03/30/2017 06:30:57","Broken Attachment Link in JIRA Activity Stream Gadget","h3. Summary    Confluence attachment is rendered as a broken link when viewed in JIRA Activity Stream gadget from JIRA and Activity Stream gadget from Confluence.  h3. Environment   * Confluence 6.1.0, 6.1.2   * JIRA 7.3.3, 7.3.5    h3. Steps to Reproduce   # Set up application links between JIRA and Confluence   # Add attachment in an existing Confluence page   # See JIRA Activity Stream gadget from JIRA Dashboard    h3. Expected Results    The attachment is rendered correctly  h3. Actual Results   * The attachment is rendered as a broken link   * Opening the attachment in a new tab will result in a System Error page with below error:    {noformat}  Cause  java.lang.NullPointerException  at com.atlassian.confluence.servlet.download.AttachmentDownload.getStreamForDownload(AttachmentDownload.java:105)  Stack Trace:[hide]  java.lang.NullPointerException  at com.atlassian.confluence.servlet.download.AttachmentDownload.getStreamForDownload(AttachmentDownload.java:105)  at com.atlassian.confluence.servlet.download.ServeAfterTransactionDownload$StreamResultCallback.doInTransaction(ServeAfterTransactionDownload.java:110)  at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:133)  at com.atlassian.confluence.servlet.download.ServeAfterTransactionDownload.getStreamInTransaction(ServeAfterTransactionDownload.java:36)  at com.atlassian.confluence.servlet.download.ServeAfterTransactionDownload.serveFile(ServeAfterTransactionDownload.java:42){noformat}  h3. Notes   * JIRA Activity Stream gadget can render the attachment correctly when JIRA 7.3.3 is integrated with Confluence 5.10.5   * The same URL is used for linking the attachment when integrated with Confluence 5.10.5 and 6.1.0, for example {{[http://10.60.2.82:8090//download/attachments]}}    h3. Workaround    Open the attachment link in a new tab and remove one of the 2 forward slashes between the Base URL and _download/attachments_. E.g. from:   * {{[http://10.60.2.82:8090//download/attachments]}}    to   * {{[http://10.60.2.82:8090/download/attachments]}}",3
"CONFSERVER-52103","03/30/2017 07:35:40","On upgrade to Confluence 6.1, an error 'The database name component of the object qualifier must be the name of the current database' occurs","This is the same issue as  * https://jira.atlassian.com/browse/BAM-18278  * https://confluence.atlassian.com/bamkb/the-component-of-the-database-name-of-the-object-qualifier-must-be-the-name-of-the-current-database-879008646.html    h3. Summary  Confluence throws a database error while trying to upgrade to 6.1.0 when using Microsoft SQL Server database:    {code}  2017-03-29 23:28:01,077 ERROR [localhost-startStop-1] [engine.jdbc.spi.SqlExceptionHelper] logExceptions The database name component of the object qualifier must be the name of the current database.  2017-03-29 23:28:01,105 ERROR [localhost-startStop-1] [atlassian.confluence.plugin.PluginFrameworkContextListener] launchUpgrades Upgrade failed, application will not start: com.atlassian.config.ConfigurationException: Cannot update schema  com.atlassian.confluence.upgrade.UpgradeException: com.atlassian.config.ConfigurationException: Cannot update schema   at com.atlassian.confluence.upgrade.AbstractUpgradeManager.upgrade(AbstractUpgradeManager.java:133)   at com.atlassian.confluence.plugin.PluginFrameworkContextListener.launchUpgrades(PluginFrameworkContextListener.java:118)   at com.atlassian.confluence.plugin.PluginFrameworkContextListener.contextInitialized(PluginFrameworkContextListener.java:77)   at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4853)   at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5314)   at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)   at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1408)   at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1398)   at java.util.concurrent.FutureTask.run(FutureTask.java:266)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)   at java.lang.Thread.run(Thread.java:745)  Caused by: com.atlassian.config.ConfigurationException: Cannot update schema   at bucket.core.persistence.hibernate.schema.SchemaHelper.validateSchemaUpdateIfNeeded(SchemaHelper.java:174)   at com.atlassian.confluence.upgrade.AbstractUpgradeManager.upgrade(AbstractUpgradeManager.java:119)   ... 11 more  Caused by: org.hibernate.exception.GenericJDBCException: Error accessing table metadata   at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:47)   at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:111)   at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:97)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.convertSQLException(InformationExtractorJdbcDatabaseMetaDataImpl.java:97)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.locateTableInNamespace(InformationExtractorJdbcDatabaseMetaDataImpl.java:352)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.getTable(InformationExtractorJdbcDatabaseMetaDataImpl.java:239)   at org.hibernate.tool.schema.internal.exec.ImprovedDatabaseInformationImpl.getTableInformation(ImprovedDatabaseInformationImpl.java:110)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.performMigration(SchemaMigratorImpl.java:251)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.doMigration(SchemaMigratorImpl.java:136)   at com.atlassian.confluence.impl.hibernate.ConfluenceHibernateSchemaManagementTool$3.doMigration(ConfluenceHibernateSchemaManagementTool.java:105)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.doMigration(SchemaMigratorImpl.java:109)   at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:87)   at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:58)   at bucket.core.persistence.hibernate.schema.SchemaHelper.validateSchemaUpdateIfNeeded(SchemaHelper.java:171)   ... 12 more  Caused by: java.sql.SQLException: The database name component of the object qualifier must be the name of the current database.   at net.sourceforge.jtds.jdbc.SQLDiagnostic.addDiagnostic(SQLDiagnostic.java:372)   at net.sourceforge.jtds.jdbc.TdsCore.tdsErrorToken(TdsCore.java:2988)   at net.sourceforge.jtds.jdbc.TdsCore.nextToken(TdsCore.java:2421)   at net.sourceforge.jtds.jdbc.TdsCore.getMoreResults(TdsCore.java:677)   at net.sourceforge.jtds.jdbc.JtdsStatement.executeSQLQuery(JtdsStatement.java:505)   at net.sourceforge.jtds.jdbc.JtdsPreparedStatement.executeQuery(JtdsPreparedStatement.java:1032)   at net.sourceforge.jtds.jdbc.JtdsDatabaseMetaData.getTables(JtdsDatabaseMetaData.java:1836)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.locateTableInNamespace(InformationExtractorJdbcDatabaseMetaDataImpl.java:337)   ... 21 more  {code}    h3. Steps to Reproduce  # Create a Microsoft SQL Server database named *Confluence*.  # Install Confluence lower than 6.1.0.  # Connect Confluence to the Microsoft SQL Server database using the connection string url as *confluence* (instead of Confluence with an uppercase letter C).  # Upgrade Confluence 6.1.0    h3. Expected Results  * Upgrade is successful.    h3. Actual Results  * Upgrade fails with  {noformat}  Caused by: java.sql.SQLException: The database name component of the object qualifier must be the name of the current database.  {noformat}    h3.Workaround  # Get the name of the Microsoft SQL Server database using the following SQL statement:  {code:sql}  SELECT name, database_id, create_date FROM sys.databases;  {code}  # Compare it with the database name configured inside the {{<confluence_home>/confluence.cfg.xml}} file:  #* Or in the *server.xml* file if you are using *data source* connection.  {noformat}  jdbc:jtds:sqlserver://<host>:<port>/<database name>  {noformat}  # Update the database name so it matches the exact name of the database from the SQL statement.  # Restart Confluence.",5
"CONFSERVER-52116","03/31/2017 01:10:40","PDF Export of a space can cause OutOfMemory errors","Despite all the work done in CONF-19815 and related tickets, it is still possible for a space export to cause memory pressure such that there is an OutOfMemory error, or performance issues that impact Hazelcast in Confluence Data Center. This can cause outages.",5
"CONFSERVER-52266","04/05/2017 16:18:20","adding an image in edit mode adds ""confluence-thumbnail"" class unnecessarily causing poor image to be displayed","h3. Steps   # Upload an image   # Save the page   # Notice that it looks like it's a really small image scaled up   # Wonder why    It's not really consistent but it seems like uploading an @2x image for the first time on a page is showing a really bad-looking version of it on the page (view, not edit). It looks fine in FileViewer and some times replacing the image (select and drop same file on to replace) fixes it.    h3. Workaround  # Edit the page  # Select the image to bring up the image toolbar  # Resize the image to another size  # Resize it back again to the desire size immediately  # Save the page   ",3
"CONFSERVER-52256","04/11/2017 00:49:56","Links added using configured shortcut links is broken after page edit","h3. Summary    Links added using configured shortcut links on your Confluence site, is broken when you edit the page.    h3. Steps to Reproduce   # Configure Shortcut links eg.  Key: test  Expanded Value: [https://google.com|https://google.com/]  Default Alias: %s   # Create a new page and a link to ""atlassian"" text using [atlassian@test]   # Publish the page   # Edit the page and Publish again    h3. Expected Results   * The link should still be working after editing the page    h3. Actual Results   * The link will not work after editing the page.",3
"CONFSERVER-52528","04/19/2017 01:28:49","Time format is incorrect, should be ""internationalized""","Time format should be ""internationalized"".    *Italy*   In Italy we don't use AM and PM, we always use the 24 hour time.",5
"CONFSERVER-52296","04/19/2017 14:24:34","c3p0 Class not Found on the Classpath and its Properties are Ignored","h3. Summary    On a fresh install of Confluence 6.1.x, we get warnings during the startup that the c3p0 properties are being ignored and the Hibernate built-in connection pool will be used instead.    h3. Environment    * Confluence 6.1.x    h3. Steps to Reproduce    # Fresh install  # Restart the application  # Tail the atlassian-confluence.log    h3. Expected Results    No warning is shown and c3p0 properties are applied.    h3. Actual Results    The following warnings are printed:    {code}  2017-04-18 10:11:51,380 WARN [AtlassianEvent::CustomizableThreadFactory-4] [jdbc.connections.internal.ConnectionProviderInitiator] instantiateC3p0Provider HHH000022: c3p0 properties were encountered, but the c3p0 provider class was not found on the classpath; these properties are going to be ignored.  2017-04-18 10:11:51,386 WARN [AtlassianEvent::CustomizableThreadFactory-4] [hibernate.orm.connections.pooling] configure HHH10001002: Using Hibernate built-in connection pool (not for production use!)  {code}    h3. Notes    After a deeper analysis, we identified that the warnings are harmless and are caused by a schema check before the complete startup of Hibernate. With that said, after the check and the complete startup of Hibernate, the c3p0 properties are successfully applied so we can safely ignore the warnings.    h3.Workaround    No known workaround at the moment.",1
"CONFSERVER-52308","04/22/2017 05:16:03","Code Macro Plugin gives message about not designed for Data Centre","  h2. Summary  In Confluence 6.1.2 Data Centre, the Code Macro Plugin displays a message  {panel}  *This add-on is not designed for Data Center versions of Confluence. Request an update from the vendor.*  {panel}  However it works correctly.     !CodeMacroPlugin.png|thumbnail!     h2. Steps to reproduce  # Install and start Confluence DataCentre 6.1.2  # Go to !https://confluence.atlassian.com/doc/files/590259974/590058056/1/1398739558493/Cog.png! > *Add-ons*  # Search for All Add-Ons  # Enter *Code Macro Plugin* in the filter  # Open the Add-On  # See the message  {panel}  *This add-on is not designed for Data Center versions of Confluence. Request an update from the vendor.*  {panel}    h2. Expected Results  It does not display the message    h2. Actual results  The message is displayed    h2. Workaround  Testing indicates this is likely to be an error with Atlassian Marketplace as the Code Macro works as expected.    ",2
"CONFSERVER-54623","04/26/2017 04:00:06","When the server runs out of disk space, uploading attachments fail without a proper error message","When the server runs out of disk space, and the user attempts to upload an attachment, they get a cryptic error message that doesn't tell them the cause.         We need to add a proper error message that helps them diagnose the source of the error by displaying the message from the underlying IOException.",5
"CONFSERVER-52327","04/27/2017 18:20:18","@mentions in replies to inline comments do not generate notifications nor notification emails","h3. Summary  When replying to an inline comment and using an @mention, the mentioned user does not receive a *<username> mentioned you in <pagename>* email nor a notification in the workbox    h3. Steps to Reproduce  # Configure an [outgoing mail server in Confluence|https://confluence.atlassian.com/doc/configuring-a-server-for-outgoing-mail-151078.html], if one is not already present  # On a Confluence page add an [inline comment|https://confluence.atlassian.com/conf57/commenting-on-pages-and-blog-posts-701435207.html#Commentingonpagesandblogposts-Addaninlinecomment]  # In the reply to an inline comment, mention a user who is not  #* Not watching the page  #* But does receive e-mail notifications    h3. Expected Results  They receive:  # A notification that they were mentioned in a reply to an inline comment  # An e-mail from Confluence with the subject *<username> mentioned you in <pagename>*    h3. Actual Results  They receive no notifications nor e-mails    h3.Workaround  If the mentioned user happens to be watching the page they get e-mails regarding the changes.",2
"CONFSERVER-52353","05/04/2017 14:32:20","Upgrade Confluence to version 6.1.x Failed with ""ORA-01000: maximum open cursors exceeded"" Error","h5. Summary    Upgrade Confluence (connected to Oracle 12c) to version 6.1.x failed with the following error in the logs (atlassian-confluence.log) :  {code:java}  ERROR [localhost-startStop-1] [atlassian.confluence.plugin.PluginFrameworkContextListener] launchUpgrades Upgrade failed, application will not start: com.atlassian.config.ConfigurationException: Cannot update schema  com.atlassian.confluence.upgrade.UpgradeException: com.atlassian.config.ConfigurationException: Cannot update schema   at com.atlassian.confluence.upgrade.AbstractUpgradeManager.upgrade(AbstractUpgradeManager.java:133)   at com.atlassian.confluence.plugin.PluginFrameworkContextListener.launchUpgrades(PluginFrameworkContextListener.java:118)   at com.atlassian.confluence.plugin.PluginFrameworkContextListener.contextInitialized(PluginFrameworkContextListener.java:77)   at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4853)   at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5314)   at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:145)   at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1408)   at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1398)   at java.util.concurrent.FutureTask.run(FutureTask.java:266)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)   at java.lang.Thread.run(Thread.java:745)  Caused by: com.atlassian.config.ConfigurationException: Cannot update schema   at bucket.core.persistence.hibernate.schema.SchemaHelper.validateSchemaUpdateIfNeeded(SchemaHelper.java:174)   at com.atlassian.confluence.upgrade.AbstractUpgradeManager.upgrade(AbstractUpgradeManager.java:119)   ... 11 more  Caused by: org.hibernate.exception.GenericJDBCException: Error accessing table metadata   at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQLExceptionConverter.java:47)   at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:111)   at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:97)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.convertSQLException(InformationExtractorJdbcDatabaseMetaDataImpl.java:97)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.locateTableInNamespace(InformationExtractorJdbcDatabaseMetaDataImpl.java:352)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.getTable(InformationExtractorJdbcDatabaseMetaDataImpl.java:226)   at org.hibernate.tool.schema.internal.exec.ImprovedDatabaseInformationImpl.getTableInformation(ImprovedDatabaseInformationImpl.java:110)   at org.hibernate.tool.schema.internal.exec.ImprovedDatabaseInformationImpl.locateTableInformation(ImprovedDatabaseInformationImpl.java:142)   at org.hibernate.tool.schema.extract.internal.InformationExtractorJdbcDatabaseMetaDataImpl.getForeignKeys(InformationExtractorJdbcDatabaseMetaDataImpl.java:655)   at org.hibernate.tool.schema.extract.internal.TableInformationImpl.foreignKeys(TableInformationImpl.java:88)   at org.hibernate.tool.schema.extract.internal.TableInformationImpl.getForeignKey(TableInformationImpl.java:99)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.findMatchingForeignKey(SchemaMigratorImpl.java:529)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.applyForeignKeys(SchemaMigratorImpl.java:505)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.performMigration(SchemaMigratorImpl.java:314)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.doMigration(SchemaMigratorImpl.java:136)   at com.atlassian.confluence.impl.hibernate.ConfluenceHibernateSchemaManagementTool$3.doMigration(ConfluenceHibernateSchemaManagementTool.java:105)   at org.hibernate.tool.schema.internal.SchemaMigratorImpl.doMigration(SchemaMigratorImpl.java:109)   at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:87)   at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:58)   at bucket.core.persistence.hibernate.schema.SchemaHelper.validateSchemaUpdateIfNeeded(SchemaHelper.java:171)   ... 12 more  Caused by: java.sql.SQLException: ORA-01000: maximum open cursors exceeded     at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:450)   at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:399)   at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1059)   at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:522)   at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:257)  {code}  h5. Analysis    Running the following query in the database found out that Confluence is taking up ~600 open cursors :  {code:sql}  select a.value, s.username, s.sid, s.serial#  from v$sesstat a, v$statname b, v$session s  where a.statistic# = b.statistic#  and s.sid=a.sid  and b.name = 'opened cursors current'  and USERNAME='<INSERT-USERNAME-HERE>'  {code}    h5. Cause  This is a known bug with Oracle JDBC driver version 12.1.0.2, which leaks database cursors. See this Oracle Community forum post for more information: https://community.oracle.com/thread/3682300.     h5. Workarounds    See [this KnowledgeBase article for detailed instructions|https://confluence.atlassian.com/confkb/upgrade-to-version-6-1-x-failed-with-error-ora-01000-maximum-open-cursors-exceeded-922914154.html].    There are two known workarounds for this issue:    *1. Update the Oracle JDBC Driver to the latest version (12.2.0.1)*  There is a new version of the Oracle JDBC driver which fixes the cursor leak. Updating your driver prior to upgrading Confluence to 6.1.x will prevent this issue.  To update the driver:  # Stop Confluence, and create a backup of the installation and home directory.  # Download version 12.2.0.1 (or later) of the driver from the Oracle JDBC Driver page.  # Replace the existing ojdbc7.jar in <Confluence installation>/confluence/WEB-INF/lib with the new driver. For detailed instructions, follow step 6 in the database setup for oracle page.  # Start Confluence.  # Re-attempt upgrade.    *2. Increase Maximum Open Cursors*  Increase the maximum open cursor in the database :  {code:sql}  ALTER SYSTEM SET open_cursors = 1000 SCOPE=BOTH;{code}  (i) The query above is obtained from [Side Bar Is Not Visible Due To Not Sufficient Open Cursors In Oracle|https://confluence.atlassian.com/confkb/side-bar-is-not-visible-due-to-not-suficient-open-cursors-in-oracle-780863319.html]. You may change the value of '1000' as required.",5
"CONFSERVER-52367","05/08/2017 00:43:42","Inactive avatars immediately replaced by active avatars creates jarring transition effect","This happens sometimes in the following situation.   # A user has made edits to a page and is currently in the editing session.   # Another user joins the editing session.    When the second user joins, he or she will sometimes see a gray version of the first user's avatar (indicating that that user has made changes which haven't yet been published) which is immediately replaced by the colored (active) version of that user's avatar (since they are currently active). Because this happens really quickly, it creates for a bit of a jarring transition as the gray avatar is immediately replaced by the colored avatar. It would be better to first display all the active avatars, then the inactive ones, instead of first displaying the inactive avatars which might be immediately replaced by the active ones if the user is currently in the session.       h2. Done when    * Change the order of operations so that the inactive users are added after the active users from synchrony",2
"CONFSERVER-52390","05/10/2017 00:37:26","Drag n Dropping a pdf file into the editor generates a tiny thumbnail","h3.Steps      # Create a page    # In edit mode drag n drop a PDF file into the editor       *What happened...*     You get a tiny thumbnail for the PDF document     *What should have happened...*    You should get a regular sized thumbnail     *Workaround*     Toggle the thumbnail to a different size will correct the issue.  The issue is also correct at the point of publishing the page.  ",3
"CONFSERVER-52397","05/10/2017 19:47:16","Team Calendar doesn't display Oauth prompt for JIRA Events","Environment:   - Team Calendar 5.3.17   - Confluence 5.10.8 / 6.1.0   - Jira 7.3.0    h3. Steps to reproduce   # Install Confluence Team Calendars;   # Create an Application Link between Confluence and JIRA;   # Create a Calendar;   # Click Add Event and try to select a JIRA EVENT TYPE;    h3. Expected behavior    It shows ""Login & Approve"" message  h3. Actual behavior    *Error(s) occurred.* with a large stack trace or it simply doesn't display the expected information.    In atlassian-confluence.log there is the below error:  {code:java}  2017-05-10 15:20:54,281 ERROR [http-nio-8090-exec-7] [calendar3.rest.ExceptionMappers.GeneralExceptionMapper] getResponseError Could not authenticate to Jira instance   -- referer: http://localhost:8090/confluence/calendar/mycalendar.action | url: /confluence/rest/calendar-services/1.0/calendar/jira/9de8af3e-0937-3d4b-8e79-933a2124cd43/query/options.json | traceId: eb6cfe39fe771334 | userName: admin  com.atlassian.applinks.api.CredentialsRequiredException:    at com.atlassian.confluence.extra.calendar3.calendarstore.DefaultJiraAccessor$1.credentialsRequired(DefaultJiraAccessor.java:221)   at com.atlassian.confluence.extra.calendar3.calendarstore.DefaultJiraAccessor$1.credentialsRequired(DefaultJiraAccessor.java:217)   at com.atlassian.applinks.oauth.auth.OAuthApplinksResponseHandler$1.credentialsRequired(OAuthApplinksResponseHandler.java:115)   at com.atlassian.applinks.oauth.auth.OAuthApplinksResponseHandler.handle(OAuthApplinksResponseHandler.java:62)   at com.atlassian.plugins.rest.module.jersey.JerseyRequest$2.handle(JerseyRequest.java:134)   at com.atlassian.sal.core.net.HttpClientRequest.executeAndReturn(HttpClientRequest.java:104)   at com.atlassian.plugins.rest.module.jersey.JerseyRequest.executeAndReturn(JerseyRequest.java:131)   at com.atlassian.applinks.core.auth.ApplicationLinkRequestAdaptor.execute(ApplicationLinkRequestAdaptor.java:58)   at com.atlassian.applinks.oauth.auth.ThreeLeggedOAuthRequest.execute(ThreeLeggedOAuthRequest.java:51)   at com.atlassian.confluence.extra.calendar3.calendarstore.DefaultJiraAccessor.getQueryOptions(DefaultJiraAccessor.java:215)   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)   ...  {code}  *Workaround*  # Insert a *JIRA Issue macro* into a Confluence page;  # Try to query a Jira issue using JQL;  # It should display the ""Login & Approve"" message - click there and proceed with the authentication;  # Save the page;  # Back in the calendar, the JIRA Events should work properly.",3
"CONFSERVER-52403","05/11/2017 17:54:39","Table of Contents and Table of Contents Zone macros affect in-page editing feature","h3. Summary    When the [Table of Contents|https://confluence.atlassian.com/doc/table-of-contents-macro-182682099.html] or [Table of Contents Zone|https://confluence.atlassian.com/doc/table-of-content-zone-macro-189890742.html] macros are on a page, the [in-place editing function introduced in Confluence 5.9.x|https://confluence.atlassian.com/doc/confluence-5-9-release-notes-785333580.html#Confluence5.9ReleaseNotes-Editapage,withoutlosingyourplace] does not work as expected.  h3. Steps to Reproduce   # Create a page with several paragraphs text, enough to require scrolling through the page   # Include different headers and sections   # Add a Table of Contents macro or the Table of Contents Zone macro   # Save the page   # Scroll to the middle of the page in view mode   # Press *E* or click *Edit* on the hovering page data toolbar    h3. Expected Results    Confluence should take you to the same general area that you were when viewing the page  h3. Actual Results    You may receive a few different results:   # The editor does not move and just focuses at the top of the page   # The editor focuses on a different spot on the page, unrelated to the spot you had scrolled to in view mode    There are no errors in the log files.  h3. Workaround    The only workaround at this time is to remove the Table of Contents and Table of Contents Zone macros if they are in use",3
"CONFSERVER-52411","05/15/2017 00:20:33","Keyboard shortcut for Share is missing a space in the title","Hovering over the Share button on a Page gives the title ""Share this page with others (sor k)"". There should be a space between the ""s"" and the ""or""",1
"CONFSERVER-52417","05/15/2017 18:04:45","""Chart by"" filter not picking Number Fields from Custom Fields list","h3. Summary    ""Chart by"" filter not picking Number Fields from Custom Fields list    h3. Environment  (Optional - If Applicable)  * Confluence 6.1.0  * JIRA 7.3.0    h3. Steps to Reproduce  # *In JIRA*, go to the ""Custom Fields"" page.  # Create two custom fields.  # Create one as *Number Field* and the other as *Labels*.  # Reindex JIRA and Confluence.  # *In Confluence*, go to any page and insert a *JIRA Chart* macro.  # On the ""Display options"", open the ""Chart By"" selector.      h3. Expected Results    Both custom fields will be returned    h3. Actual Results  Only the ""Label"" field will be returned.     h3. Notes  The same thing doesn't happen on a regular JIRA macro. In other words, only the Pie Chart is affected.    h3.Workaround  No workarounds   ",3
"CONFSERVER-52420","05/15/2017 23:22:32","Links containing certain encoded special characters become double-encoded","This ticket stems from -CONFSERVER-45966-. In that ticket, if you enter a link that contains url-encoded characters such as %25 or %2f, etc., those characters became double-encoded.    The resolution in CONFSERVER-45966 resolved most of these characters including all umlaut and cyrillic characters per the description of that ticket.    The problem is that there are certain characters which when encoded in the link are still being double encoded.    Those characters are: ""; , / ? : @ & = + $"". The encoded versions of these characters are: ""%3B %2C %2F %3F %3A %40 %26 %3D %2B %24"" and if the link contains any of the encoded version, that character will be double-encoded.       h3. Workaround    Option 1: Paste the link into the editor instead of using insert link dialog.   * In this method you cannot modify the link text, so the link text will be automatically set based on the url    Option 2: Use square brackets to insert the link. [ ]   # Type ""[""   # Type the text you want for your link in the editor, for example ""My Link""   # Type a ""|""   # *Type* the url   # Type ""]"" to complete the link.   # Save or preview the page to confirm it works.   # *Important!* Don't open the link dialog for this link. If you do, the link will be double-encoded.    For step 4, you could also try pasting the url but this might have less success since the url will be converted to a link automatically and you might have to first undo that automatic conversion, which in turn may cause the closing ""]"" to have no effect. See option 3 instead.    Option 3   # Paste the URL into the editor.   # Press undo to undo any automatic link creation/extraction so you see the original URL.   # If the URL is still a link, click it, and click ""Unlink"" to return it back to regular text.   # At the beginning of the link, type [ followed by `Escape` to exit the Link Autocomplete   # Type the text to display for the link followed by ""|""   # Now your link should look like this   ## !Screen Shot 2017-05-11 at 7.37.39 AM.png|width=379,height=48!   # Click at the end of the link and type ""]"" to complete the link. This should auto-convert it to a link with the desired text.   # Save or preview the page to confirm it works.   # *Important!* Don't open the link dialog for this link. If you do, the link will be double-encoded.         Option 4: Using the Source Editor to change links after adding them   # Install the [Confluence Source Editor|https://marketplace.atlassian.com/plugins/com.atlassian.confluence.plugins.editor.confluence-source-editor/server/overview] (free add-on)   # Edit the page   # Click on the {{<>}} icon in the top right   # Find the *href=* attribute that contains the '%25' in the URL   # Replace it with just '%'   # Apply the changes and save the page",0
"CONFSERVER-52441","05/18/2017 10:22:01","Emoticon is changing to image after the first save and edit of the page","h3.  Summary    Emoticons macro is changing to image after the first save and edit of the page.  h3. Steps to Reproduce   # Create a page and add an emoticon by typing in the keyboard or using the macro menu   # Save the page and check the storage format of the page it should look like this  {code:java}  <p><ac:emoticon ac:name=""smile"" /></p>  {code}     # Click on edit the page, don't add any thing and just save again   # Check the storage format one more ttime    h3. Expected Results    Should be the same  {code:java}  <p><ac:emoticon ac:name=""smile"" /></p>  {code}  h3. Actual Results    It changes into an image  {code:java}  <p>    <img alt=""(smile)"" border=""0"" class=""emoticon emoticon-smile"" src=""http://localhost:8090/s/en_GB/7109/b3b701b9e2252507726313c2d8313cd50ef12760/_/images/icons/emoticons/smile.png"" title=""(smile)""/>  </p>  {code}  In Confluence version *6.14.x*, this bug changes the source URL from HTTPS to HTTP if Confluence is running behind proxy and SSL.  h3. Workaround   # Disable Collaborative Editing - To avoid the issue from occurring   # For Confluence 6.14.x, editing the storage format to point the broken URL from HTTP to HTTPS able to temporarily fix the issue.       h3. *Notes*   # This issue leads into a confusion when doing version comparison or when receiving email update about the change because Confluence is detecting an change about the content from macro to an image to it includes into the changes.   In the screenshot attached you can see that Confluence is considering all emotions being part of the change, but actually only *Start* was changed to *cool* and *normal* to *change*.   !Screen Shot 2017-05-18 at 11.19.01.png|thumbnail!   # This is not reproducible with Confluence 5.10.x   # This could be an issue as emoticons are converted to hard links, and would present an issue when a type of base-URL related migration occurs in the future       {panel:title=Atlassian update - 7 June 2019|borderStyle=none|borderColor=#6554c0|titleBGColor=#eae6ff|bgColor=#eae6ff}  Hi everyone    Thank you for your patience as we have been working on the solution for this issue. It has been a complicated one to solve and we wanted to include a few notes on this fix we have shipped in the 6.15.5 release.    *Adding new emoticons (including Hipchat emoticons) to a page:* This is now fixed. They will be saved in valid storage format (e.g {{<ac:emoticon ac:name=""smile""/>}} for standard Confluence emoticons or {{<ac:hipchat-emoticon ac:shortcut=""name""/>}} for Hipchat emoticons).  *Existing pages with invalid emoticons and collaborative editing turned OFF:* Viewing or editing the page will display fixed emoticons. Saving the page will correct the storage format of the broken emoticons.  *Existing pages with invalid emoticons and collaborative editing turned ON:* Viewing the page will display fixed emoticons. If there is a current draft with broken emoticons, then the broken emoticons will be displayed once in the editor. On the next save of the page, any invalid emoticons will be fixed.      *For those using Hipchat emoticons*, please note:    If an invalid Hipchat emoticon has the same name as one of the standard Confluence emoticons (such as ""smile"", ""thumbs-up"" or ""tick""), it will be converted into the corresponding Confluence emoticon once the page is saved.      For all cases, saving the page will fix the broken emoticons. We explored the possibility of including a front-end editor fix to automatically resolve all of these broken emoticon instances. As it would involve checking every page and have an ongoing performance impact, we decided against doing this. So, if you come across any broken emoticons, please edit and update/publish your page to resolve the problem.        Thanks again for your understanding.    Niraj | Senior Development Team Lead, Confluence Server  {panel}",5
"CONFSERVER-52445","05/18/2017 22:39:39","DACI template displays broken images","h3. Summary  When adding a DACI template to a Confluence page, the images under *Pros and Cons* on the table are broken    h3. Environment  Confluence 6.1+    h3. Steps to Reproduce  # Create a page using the DACI template  # Select *in progress* from the template wizard  # Check the table under *Options Considered*    h3. Expected Results  (+) & (-) icons are displayed    h3. Actual Results  Images are broken     h3. Notes  The plugin seems to be pointing to a hardcoded, internal URL to pull those images.    h3. Possible solution  # Follow this guide: [How to edit bundled or system plugins|https://confluence.atlassian.com/confkb/how-to-edit-bundled-or-system-plugins-302811979.html]  # Edit the {{com/atlassian/confluence/plugins/dacidecision/soy/daci-decision-blueprint-template.soy}} file to remove lines pointing to https://extranet.atlassian.com and repoint to an emoticon  # Follow this guide to place the file in the appropriate directory in Confluence: [How to edit files in Confluence JAR files|https://confluence.atlassian.com/confkb/how-to-edit-files-in-confluence-jar-files-103711179.html]  # [Clear the plugin cache|https://confluence.atlassian.com/display/CONFKB/How+to+clear+Confluence+plugins+cache] and restart Confluence    h3. Workaround  Remove those images, and replace with (+) & (-) icons",2
"CONFSERVER-52449","05/19/2017 13:52:40","mailto links doesn't work correctly when the email starts with a special character.","h3. Summary    mailto links doesn't work correctly when the email starts with a special character.  h3.    h3. Steps to Reproduce   # Create an email link to 2 different emails test@test.com and _test@test.com on a page   # Save the page and try clicking on both links    h3. Expected Results    Both links to emails should be working  h3. Actual Results    Only the 1st link to the email is working. The second one doesn't.   Storage format loonks like the following:    \{code:borderStyle=solid}   <p>   <br/>   </p>   <p>   <a href=""mailto:test@test.com"">test@test.com</a>   </p>   <p>   <br/>   </p>   <p>   <a>_test@test.com</a>   </p>   \{code}",3
"CONFSERVER-52450","05/19/2017 16:40:42","Long space names overflow the Spaces drop-down","If a Space is created with a long name (and no spaces), when it appears in the 'Spaces' drop-down at the top of the screen, it will not wrap, and will overflow the drop-down box.    Steps to Recreate:  1. Create a new space with a name such as ConfluenceTestSpace_6.1.3_Long_Name_To_Test_Overflow  2. After creating the space, click the 'Spaces' drop-down at the top of the screen, and you will see the new space overflowing the box.    Tested on Chrome, Safari, and Firefox.  All show the issue.  Screenshot from Chrome is attached.",2
"CONFSERVER-52504","05/30/2017 15:57:40","Unable to save Confluence page with certain set of macros.","*STEPS TO REPLICATE*  # Create a page in Confluence.  # Insert the following macro:  #* attachments macro  #* blog-posts macro  #* change-history macro  #* children macro  #* contentbylabel macro  #* content-by-user macro  #* content-report-table macro  #* contributors-summary macro  #* create-from-template macro  #* create-space-button macro  #* favourite pages macro  #* labels list macro  #* network macro  #* popular label macro  #* recently updated macro  #* recently updated dashboard macro  #* recently used labels macro  #* related labels macro  #* space attachments macro  #* space details macro  #* spaces list macro  # *Save* the page.  # Edit the page again and insert *cheese macro* on top op the page.  # *Save* the page.    *EXPECTED BEHAVIOUR*  The page will be save.    *ACTUAL BEHAVIOUR*  An ERROR appear while saving the page *Unable to communicate with server. Saving is not possible at the moment.*    ERROR below appear in the *atlassian-confluence.log* file:  *MySQL:*  {code}  2017-05-30 22:33:58,383 ERROR [http-nio-8090-exec-1] [engine.jdbc.spi.SqlExceptionHelper] logExceptions Data truncation: Data too long for column 'STRINGVAL' at row 1   -- referer: http://localhost:8090/pages/resumedraft.action?draftId=327700&draftShareId=2d93ae94-a816-4402-b016-6640fe292ee9 | url: /rest/api/content/327693 | traceId: 7c333ddb6362d6b8 | userName: admin  2017-05-30 22:33:58,398 WARN [http-nio-8090-exec-1] [confluence.impl.hibernate.ConfluenceHibernateTransactionManager] doRollback Performing rollback. Transactions:    ->[com.atlassian.confluence.api.impl.service.content.draft.ContentDraftServiceImpl.publishEditDraft]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT (Session #413923909)          [null]: PROPAGATION_REQUIRES_NEW,ISOLATION_DEFAULT,readOnly (Session #2053122999)   -- referer: http://localhost:8090/pages/resumedraft.action?draftId=327700&draftShareId=2d93ae94-a816-4402-b016-6640fe292ee9 | url: /rest/api/content/327693 | traceId: 7c333ddb6362d6b8 | userName: admin  2017-05-30 22:33:58,429 ERROR [http-nio-8090-exec-1] [rest.api.model.ExceptionConverter] convertServiceException No status code found for exception, converting to internal server error :    -- referer: http://localhost:8090/pages/resumedraft.action?draftId=327700&draftShareId=2d93ae94-a816-4402-b016-6640fe292ee9 | url: /rest/api/content/327693 | traceId: 7c333ddb6362d6b8 | userName: admin  org.springframework.dao.DataIntegrityViolationException: could not execute statement; SQL [n/a]; nested exception is org.hibernate.exception.DataException: could not execute statement  {code}    *H2 database:*  {code}  Caused by: org.h2.jdbc.JdbcSQLException: Value too long for column ""STRINGVAL VARCHAR(255)"": ""'blog-posts,contributors-summary,favpages,change-history,attachments,recently-used-labels,listlabels,create-from-template,space-... (256)""; SQL statement:  insert into CONTENTPROPERTIES (PROPERTYNAME, STRINGVAL, LONGVAL, DATEVAL, PROPERTYID) values (?, ?, ?, ?, ?) [22001-176]   at org.h2.message.DbException.getJdbcSQLException(DbException.java:344)   at org.h2.message.DbException.get(DbException.java:178)   at org.h2.table.Column.validateConvertUpdateSequence(Column.java:332)   at org.h2.table.Table.validateConvertUpdateSequence(Table.java:726)   at org.h2.command.dml.Insert.insertRows(Insert.java:152)   at org.h2.command.dml.Insert.update(Insert.java:115)   at org.h2.command.CommandContainer.update(CommandContainer.java:79)   at org.h2.command.Command.executeUpdate(Command.java:254)   at org.h2.server.TcpServerThread.process(TcpServerThread.java:346)   at org.h2.server.TcpServerThread.run(TcpServerThread.java:160)   at java.lang.Thread.run(Thread.java:745)  {code}    *WORKAROUND*  # Edit the page and insert additional macro with longer name (*Tasks Report* macro or *Table of Content Zone* macro, for example)   # *Save* the page.",3
"CONFSERVER-52537","06/05/2017 08:49:01","PDF preview does not render characters both multibyte characters and single-byte characters","h3. Summary    PDF preview does not render characters both multibyte characters and single-byte characters.   Some pdf files are not rendered on PDF Preview in Confluence 6.1 and 6.2.  h3. Environment   * Confluence 6.1.4   * Confluence 6.2.0   * Confluence 5.10.8 can render the characters    h3. Steps to Reproduce   # Attach the sample pdf file to a page. ( [^testpdf.pdf] )   !origin.jpg|thumbnail!   # Save the page.   # thumbnail looks good.   !thumbnail.jpg|thumbnail!    # Preview the pdf file. no characters.   !preview.jpg|thumbnail!    h3. Expected Results    Characters are rendered normally.  h3. Actual Results    All characters are not rendered in PDF preview.  h3. Workaround    no workaround",3
"CONFSERVER-52540","06/05/2017 18:01:16","Custom DNS name for Load Balancer when using AWS CloudFormation","h3. Summary  When setting up Confluence Data Center with AWS Cloudformation template, the Synchrony node always takes the ELB hostname even though the base url was changed on Confluence (including Synchrony service URL)    h3. Environment  AWS    h3. Steps to Reproduce  # Setup Confluence Data Center from AWS Cloudformation template  # Get both Confluence and Synchrony nodes up and running  # Change Confluence base URL to a custom domain specific URL  # Update Synchrony service URL from {{<confluence-install>/bin/setenv.sh}}  {code:borderStyle=solid}  -Dsynchrony.service.url=https://your-custom-domain  {code}  # Scale down Synchrony node to 0 then back to 1    h3. Expected Results  Synchrony node should be able to pick up those changes and set the proxy name and port on Synchrony to the DNS entry instead of the load balancer hostname    h3. Actual Results  No changes on Synchrony side, the ELB hostname is still configured as the proxy name  {code:borderStyle=solid}  2017-06-01 17:01:29 === BEGIN: service atl-init-confluence start ===  2017-06-01 17:01:29 Initialising Atlassian Confluence  2017-06-01 17:01:29 Checking if Confluence has already been installed  2017-06-01 17:01:29 Creating file /etc/ld.so.conf.d/confluence.conf  2017-06-01 17:01:30 Creating file /etc/ld.so.conf.d/confluence.conf ==> done  2017-06-01 17:01:30 Downloading Confluence 6.1.1 from https://s3.amazonaws.com/atlassian-software/releases/confluence/atlassian-confluence-6.1.1-linux-x64.bin  2017-06-01 17:02:14 Creating Confluence install directory  2017-06-01 17:02:14 Installing Confluence to /opt/atlassian/confluence  Unpacking JRE ...  Starting Installer ...  Jun 01, 2017 5:02:16 PM java.util.prefs.FileSystemPreferences$1 run  INFO: Created user preferences directory.  The installation directory has been set to /opt/atlassian/confluence.  [?7hExtracting files ...  Jun 01, 2017 5:02:29 PM com.atlassian.modzdetector.HashRegistry store  INFO: wrote 925 hashes to /opt/atlassian/confluence/install.reg  Finishing installation ...  2017-06-01 17:02:29 Installed Confluence to /opt/atlassian/confluence  2017-06-01 17:02:29 Cleaning up  2017-06-01 17:02:29 Confluence installation completed  <xsl:stylesheet version=""1.0"" xmlns:xsl=""http://www.w3.org/1999/XSL/Transform"">      <xsl:output omit-xml-declaration=""yes"" indent=""yes""/>        <xsl:template match=""@*|node()"">          <xsl:copy>              <xsl:apply-templates select=""@*|node()""/>          </xsl:copy>      </xsl:template>        <xsl:template match=""/Server/Service/Connector[@port='8080' and not(@proxyName)]"">          <xsl:copy>              <xsl:apply-templates select=""@*|node()""/>              <xsl:attribute name=""secure"">true</xsl:attribute>              <xsl:attribute name=""scheme"">https</xsl:attribute>              <xsl:attribute name=""proxyName"">Confl-LoadB-XXXXX-XXXXX.us-west-2.elb.amazonaws.com</xsl:attribute>              <xsl:attribute name=""proxyPort"">443</xsl:attribute>          </xsl:copy>      </xsl:template>  </xsl:stylesheet>  <xsl:stylesheet version=""1.0"" xmlns:xsl=""http://www.w3.org/1999/XSL/Transform"">      <xsl:output omit-xml-declaration=""yes"" indent=""yes""/>        <xsl:template match=""@*|node()"">          <xsl:copy>              <xsl:apply-templates select=""@*|node()""/>          </xsl:copy>      </xsl:template>             <xsl:template match=""/Server/Service[not(Connector[@port='8081'])]"">           <xsl:copy>              <xsl:apply-templates select=""@*|node()""/>                            <Connector port=""8081"" protocol=""HTTP/1.1""                     maxHttpHeaderSize=""65536""                     URIEncoding=""UTF-8""                     connectionTimeout=""20000""                     useBodyEncodingForURI=""true""                     compression=""on""                     compressableMimeType=""text/html,text/xml,text/plain,text/css,application/json,application/javascript,application/x-javascript"" />          </xsl:copy>      </xsl:template>  </xsl:stylesheet>  2017-06-01 17:02:29 Updated server.xml for host name change to Confl-LoadB-XXXXX-XXXXX.us-west-2.elb.amazonaws.com, secure=true, scheme=https, proxyPort=443  2017-06-01 17:02:29 Updating web.xml to redirect HTTP to HTTPS.  <xsl:stylesheet version=""1.0"" xmlns:xsl=""http://www.w3.org/1999/XSL/Transform"">      <xsl:output omit-xml-declaration=""yes"" indent=""yes""/>        <xsl:template match=""@*|node()"">          <xsl:copy>              <xsl:apply-templates select=""@*|node()""/>          </xsl:copy>      </xsl:template>              <xsl:template match=""/*[name() = 'web-app' and not(./*[name() = 'security-constraint'])]"">           <xsl:copy>              <xsl:apply-templates select=""@*""/>              <security-constraint>                  <web-resource-collection>                      <web-resource-name>HTTPSOrHTTP</web-resource-name>                      <url-pattern>/status*</url-pattern>                  </web-resource-collection>                  <user-data-constraint>                      <transport-guarantee>NONE</transport-guarantee>                  </user-data-constraint>              </security-constraint>              <security-constraint>                  <web-resource-collection>                      <web-resource-name>HTTPSOnly</web-resource-name>                      <url-pattern>/*</url-pattern>                  </web-resource-collection>                  <user-data-constraint>                      <transport-guarantee>CONFIDENTIAL</transport-guarantee>                  </user-data-constraint>              </security-constraint>              <xsl:apply-templates select=""node()""/>          </xsl:copy>      </xsl:template>  </xsl:stylesheet>  {code}",3
"CONFSERVER-52551","06/06/2017 21:37:29","External Gadgets not working due to error with MacroMetadataProvider","h3. Summary    External gadgets won't be found in the Macro Browser due to errors from the *MacroMetadataProvider*. You also won't be able to insert them manually, as the summary of the macro won't appear as the following screenshots:         *Working gadget:*    !working.png|thumbnail!    *Not working:*    !not_working.png|thumbnail!  h3. Environment   * Confluence 6.2.0(with and without proxy)    h3. Steps to Reproduce   # Setup Confluence and JIRA with SSL(selfsigned certificate).   # Add a gadget feed in Confluence.   # Stop both services and revert the changes(remove the SSL).   # Remove the existing gadget feed(with HTTTPS url).   # Add a new gadget feed(with HTTP url)  or     # Install Copy Page Tree add-on( v2.5.0, v2.5.2 or v2.5.3)    h3. Expected Results    External Gadgets will be found in the macro browser and you will be able to insert them.  h3. Actual Results    Macros are not found and manually inserting the gadget doesn't work. Logs will show:  {code:java}  2017-06-06 17:10:15,693 ERROR [http-nio-8090-exec-4] [confluence.macro.browser.DefaultMacroMetadataManager] buildMacroSummaries Error getting summaries from MacroMetadataProvider,  – referer: [http://localhost:8090/confluence/display/BLAN/teste+2] | url: /confluence/plugins/macrobrowser/browse-macros.action | traceId: 5185927b4b60903a | userName: admin | action: browse-macros  java.lang.NullPointerException  at com.atlassian.confluence.cache.ehcache.EhCacheManager.wrapCache(EhCacheManager.java:151)  at com.atlassian.confluence.cache.ehcache.EhCacheManager.getCache(EhCacheManager.java:160)  at com.atlassian.confluence.cache.ehcache.EhCacheManager.getCaches(EhCacheManager.java:141)  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)  {code}  h3. Notes   - Flushing the cache won't fix.   - Clear the plugins cache won't fix.   - Restart both instances won't fix.   - No errors besides the above one in the logs.    h3. Workaround    In case you have the Copy Page Tree add-on installed( v2.5.0, v2.5.2 or v2.5.3), *uninstall* it or downgrade it.",5
"CONFSERVER-52595","06/14/2017 19:46:23","When importing a word document, header order is not respected","h3. Summary  When importing a word document and splitting by headers, the page tree that gets created is alphabetized. What we are expecting to happen is that the page tree would be in the same order in which the headers appear in the document.    To reproduce, simply import a word document which can be split by multiple headers that do not appear in alphabetical order within the document. Once the document is imported, notice that the page tree is alphabetical in order as opposed to their order within the document.    I have attached an example Word document to test with.    h3. Steps to Reproduce  # Import  [^Brian.docx] to Confluence and use Split by heading functionality.  # Observe pages tree generated in sidebar.    h3. Expected Results  # Page tree will be ordered properly (as in document).    h3. Actual Results  # Pages are sorted alphabetically.  #  !tree.png|thumbnail!        h3. Notes  The issue is not reproducible with 5.10.8.   It looks like problem is introduced in Confluence version 6.0.6 and plugin OfficeConnector-5.0.3.jar. The issue is not present in plugin 5.0.2 and Confluence 6.0.5.    h3.Workaround  There are 2 workaround at this point:  # Manually sort and [reorder pages|https://confluence.atlassian.com/doc/move-and-reorder-pages-146407727.html].  # Downgrade the plugin:  #- Stop confluence  #- Find the folder <confluence-install>/confluence/WEB-INF/atlassian-bundled-plugins/ on production  #- Backup and move {{OfficeConnector-5.x.x.jar}} from this folder  #- Download [Confluence 5.10.8 zip|https://www.atlassian.com/software/confluence/downloads/binary/atlassian-confluence-5.10.8.zip].  #- Extract from the same folder OfficeConnector-5.0.2.jar. and copy it to the same folder on production.  #- Remove the following folders:  #-- <confluence-home>/bundled-plugins  #-- <confluence-home>/plugins-cache  #-- <confluence-home>/plugins-osgi-cache  #-- <confluence-home>/plugins-temp  #-- <confluence-home>/bundled-plugins_language  #- Start Confluence    *Note:* The work around (2) has been confirmed to work up up to Confluence 6.5.2 but does not work for Confluence 6.7.1 (Confluence 6.7.1 will crash when importing Word Documents when using the older {{OfficeConnector-5.0.2.jar}})",3
"CONFSERVER-52597","06/15/2017 10:43:59","Page Restrictions Dialogue is Incorrect","h3. Steps to Reproduce    # Create a Page Tree:  {code}  Page A   - Page B     - Page C  {code}  # Make sure all pages are individually restricted to User Y and User Z only  # Revoke all permissions for User Y on Page B  # Go to Page B, and click on *... -> Restrictions*, it will still list User Y.    h3. Workarounds:    # Go to *Space Tools -> Permissions -> Restricted Pages*.  It will show correct permissions.  # Go to Page C, and click on *... -> Restrictions -> Inherited view restrictions*.  It will show correct permissions         ",2
"CONFSERVER-52632","06/19/2017 15:04:37","AWS Confluence DC CloudFormation Template: could be able to resolve EFS not only via DNS but also IP","h3. Problem Definition  It's not possible to deploy an Internal Facing Confluence DC on AWS using the quick start CloudFormation template when using own DNS Server.    This happens because the template uses the DNS to mount the EFS into the new Confluence Node, so the two conditions on EC2 to use the EFS via DNS are:  # The connecting EC2 instance must be inside a VPC and must be configured to use the DNS server provided by Amazon. For information about Amazon DNS server, see DHCP Options Sets in the Amazon VPC User Guide.  # The VPC of the connecting EC2 instance must have DNS host names enabled. For more information, see Viewing DNS Hostnames for Your EC2 Instance in the Amazon VPC User Guide.    h3. Suggested Solution  Make it possible to deploy Confluence DC using our own DNS Server.    h3. Why this is important  Currently we can only deploy internet-facing datacenters, but most of the companies need to deploy dev/staging instances too, that should be accessed internally only due to security policies.     h3. Workaround   Currently the only workaround is to use the AWS DNS server instead.",3
"CONFSERVER-52633","06/19/2017 16:00:20","The language pack provided in the TAC is not complete and it mixes Danish with Finnish.","h3. Description  The customer would like to have Danish as one of the supported languages in confluence. The language pack provided in the translations.atlassian.com is not complete and it mixed Danish with Finnish.   !image-2017-06-19-22-59-11-427.png|thumbnail!   *Green - Danish*  *Red - Finnish*       Suggestion  Have a proper translation for Danish and make is a one of the supported languages in confluence.",5
"CONFSERVER-52811","06/20/2017 06:02:57","Space homepage tasks not rendering correctly when you create a new space","*Steps to reproduce:*    1. In 6.3.0-beta2 create a new Blank space  2. Go to space homepage    *Expected result:*    Nicely formatted tasks    *Actual result:*     !image-2017-06-20-15-02-24-184.png|thumbnail!      Problem only occurs on blank space.  Space blueprints (team space, doc space, kb space etc appear to be fine)",2
"CONFSERVER-52668","06/21/2017 15:40:47","Some text do not translate to German when user use German language","h3. Description  Some text of the team calendar is not translated to German when the user selects German as the profile language.    *Steps to reproduce*  # Login confluence  # Install Team Calendar  # Go to profile  # Change the language to Deutsch  # Go to one of the space  # You will notice the word *Calendar* do not translate to German *Kalender*    Expected Result  All the text is translated correctly.    Actual Result   !screenshot-1.png|thumbnail! ",3
"CONFSERVER-52681","06/22/2017 22:35:13","Multiple macros inside a header break the entire table when Collaborative Editing is enabled","h3. Steps to reproduce    # Create a blank page;  # Insert a table;  # Add two or more macros to a Header cell;  # Save the page - It displays the table correctly;  # Edit the page again;      *Expected behavior*  The same table is there, ready to be edited.    *Actual Behavior*  The header pops out everything below the first macro and removes all subsequent cells.     !First View mode.png|thumbnail!  !Editing.png|thumbnail!     h3. Workaround    Remove the headers before saving to avoid loosing the table formatting.    - If the page is already affected, copy the page storage format in view mode, then use Source Editor to paste it in edit mode; or  - Disable Collaborative Editing:  *General Configuration > Collaborative Editing > Change Mode > OFF > Change*    Notes:  - This does not seem to affect drafts.",5
"CONFSERVER-52703","06/27/2017 10:28:38","cant search in Editor when a character occurred twice or more in MS edge","*Steps to replicate*  # create a page with Microsoft Edge 40.15063.0.  #  Put in content with  ""A A A A"".  # press the magnifying glass in the editor.  # search  ""A"" and press [Next] three times    Expected behavior:    All 4 ""A"" should be able to search one after another    Actual behavior:     [^CSP–206450.mp4]        [^storate.txt] ",3
"CONFSERVER-52714","06/28/2017 07:59:22","@ mention and // don't work with macOS Japanese Input Method on Safari","h3. Summary  @ mention and // don't work with macOS Japanese Input Method on Safari.    ||browser|| Japanese Input Method||@||//||  |Safari | macOS Japanese Input method|(x)|(x)|  |Safari | google Japanese Input method|(/)|(/)|    h3. Environment  * macOS + Safari + macOS Japanese Input method  *     h3. Steps to Reproduce  # Enable macOS default Japanese Input method in macOS System Preference  https://support.apple.com/kb/PH22653?locale=en_US  # Edit a page in Confluence  # Input @ or //, it does not work.    h3. Expected Results  Performing @ works as a mention.  Performing // works as a date.    h3. Actual Results  @ and // do NOT work as a mention or date.    h3.Workaround  Use Google Japanese Input method on Safari.  or   Use Chrome browser",3
"CONFSERVER-52736","06/30/2017 16:34:26","Ancestor table is broken after reordering pages and applying restrictions","h3. Summary  If the pages have been reordered prior to applying restriction to one of them and then top page has been moved to another space then the ancestors for that page will be calculated incorrectly.  h3. Environment  * Confluence Server 6.2.3  * Two users: usera and userb  * Two Spaces: PLAY and LAL (created by admin)  * All users may add page restrictions in both spaces'  * PLAY contains these three pages: ""page1"", ""page2"", ""page3"", ""page4""  * Page tree is the following: {{PLAY Home ->  ""page1"" -> ""page2"" -> ""page3"" -> ""page4""}}  h3. Steps to Reproduce  # Log in as {{usera}}  # Go to {{PLAY -> Reorder pages}}  # Reorder pages to some random order by changing the parent-child relationship   !Screen Shot 2017-06-30 at 13.08.28.png|thumbnail!   # Reorder pages back to initial hierarchy: {{PLAY Home ->  ""page1"" -> ""page2"" -> ""page3"" -> ""page4""}}  # userb adds an edit restriction to ""test2""  # usera adds a view and edit restriction to ""test1""  # usera moves ""test1"" to the space LAL  # check LAL: it does only contain ""test1"" as usera wasn't allowed to edit the page ""test2"" and couldn't move it  # get back to PLAY and check for orphaned pages (it should contain ""test2"")  # Check the restrictions for ""test2"" (it still has inherited restrictions from ""test1""(!))  # Try to move ""test1"" back to PLAY    h3. Expected Results  # ""test2"" as orphaned page has only its own restrictions  # ""test1"" can be moved to PLAY without any error    h3. Actual Results  # ""test2"" has inherited restrictions from ""test1"" while being orphaned page:   !Screen Shot 2017-06-30 at 18.02.01.png|thumbnail!  !Screen Shot 2017-06-30 at 18.02.19.png|thumbnail!   # It's impossible to move ""test1"" to PLAY because Confluence think it still has ""test3"" and ""test4"" as ancestors   !Screen Shot 2017-06-30 at 13.19.35.png|thumbnail!      h3.Workaround  # [Rebuild Ancestor table|https://confluence.atlassian.com/doc/rebuilding-the-ancestor-table-153948.html]  # [Reuild content index|https://confluence.atlassian.com/doc/content-index-administration-148844.html]",5
"CONFSERVER-52747","07/03/2017 20:47:24","Unable to Save Page if the Draft contains a Link to a Deleted Space","Same as in CONFCLOUD-54860:  h3. Summary    If a draft contains a link to a removed space, (space exists when creating the draft, but the space was removed while the draft is still yet to be published), then attempts to save the page will fail with this error:  {code:java}  2017-05-03 11:58:46.019681500 2017-05-03 11:58:46,013 ERROR [http-bio-1994-exec-264] [common.error.jersey.ThrowableExceptionMapper] toResponse Uncaught exception thrown by REST service: Could not unmarshal a link in the editor.  2017-05-03 11:58:46.019683500  -- url: /wiki/rest/tinymce/1/drafts | traceId: c8ba9d74ca33d1a9 | userName: sysadmin | referer: https://hipagesgroup.atlassian.net/wiki/pages/resumedraft.action?draftId=134930910&draftShareId=0a6c4505-43f5-4b2f-8137-af10991755d8  2017-05-03 11:58:46.019684500 com.atlassian.confluence.content.render.xhtml.editor.link.CannotUnmarshalLinkException: Could not unmarshal a link in the editor.  ...  2017-05-03 11:58:46.021669500 Caused by: com.atlassian.confluence.content.render.xhtml.model.resource.identifiers.CannotResolveResourceIdentifierException: Unable to resolve the resource identifier IdAndTypeResourceIdentifier[id=8060929,type=space]  2017-05-03 11:58:46.021678500  at com.atlassian.confluence.content.render.xhtml.model.resource.identifiers.IdAndTypeResourceIdentifierResolver.resolve(IdAndTypeResourceIdentifierResolver.java:50)  2017-05-03 11:58:46.021679500  at com.atlassian.confluence.content.render.xhtml.model.resource.identifiers.IdAndTypeResourceIdentifierResolver.resolve(IdAndTypeResourceIdentifierResolver.java:20)  2017-05-03 11:58:46.021686500  at com.atlassian.confluence.content.render.xhtml.editor.resource.identifiers.IdAndTypeAnalyzingResourceIdentifierUnmarshaller.unmarshal(IdAndTypeAnalyzingResourceIdentifierUnmarshaller.java:60)  2017-05-03 11:58:46.021687500  at com.atlassian.confluence.content.render.xhtml.editor.resource.identifiers.IdAndTypeAnalyzingResourceIdentifierUnmarshaller.unmarshal(IdAndTypeAnalyzingResourceIdentifierUnmarshaller.java:26)  2017-05-03 11:58:46.021694500  at com.atlassian.confluence.content.render.xhtml.editor.link.EditorLinkUnmarshaller.unmarshal(Ed  {code}  The issue also occurs when you delete a Space and then try to Edit an existing page that has a link to a page from that Space.  h3. Steps to Reproduce   # Create a test page   # Edit the page (after it has been created in step 1), and add a link to a space. *Do not publish the draft at this point*   # In a separate browser tab, *remove the space* that was linked earlier   # Attempt to publish the draft containing that space link now    h3. Expected Results    The page should be published, with a broken space link  h3. Actual Results    Page publishing fails, with the error in the logs above, and this error in the UI:   !Error.png|thumbnail!  h3. Workaround 1    Turn off Collaborative Editing.  h3. Workaround 2    1. Copy current page.  2. Delete current page.  3. Rename the copy such the original one.  h3. Workaround 3    Remove the broken link and try to save the page.    h3. 7/21/2020 Update:  Please note that we've verified that this bug is still open as commented by Christoffer below.  We're awaiting for further review by our developers.",2
"CONFSERVER-52749","07/04/2017 06:00:54","Cannot start Confluence due to corrupt plugin cache","h2. Problem Definition  Often, on startup, especially on an upgrade, the plugin cache can become corrupted with invalid Add-Ons. This often causes issues for customers and support tickets.    Please note the similar bug  * [CONFSERVER\-54123: Confluence plugins have version errors on start up causing incompatability|https://jira.atlassian.com/browse/CONFSERVER-54123]    In {{atlassian-confluence.log}} we can see errors like  {code}  2017-08-24 22:38:17,847 ERROR [FelixDispatchQueue] [osgi.container.felix.FelixOsgiContainerManager] frameworkEvent Framework error in bundle org.randombits.support.core  org.osgi.framework.BundleException: Unresolved constraint in bundle org.randombits.support.core [270]: Unable to resolve 270.0: missing requirement [270.0]{code}    Error like these may also appear  {code}  2017-07-30 09:45:48,035 ERROR [localhost-startStop-1] [plugin.osgi.factory.OsgiPluginInstalledHelper] availableForTraversal Cannot determine required plugins, cannot resolve bundle 'com.atlassian.confluence.extra.bobswift-graphviz'  2017-07-30 09:45:48,552 ERROR [localhost-startStop-1] [plugin.osgi.factory.OsgiPluginInstalledHelper] availableForTraversal Cannot determine required plugins, cannot resolve bundle 'com.gliffy.plugin.confluence.gliffy-confluence-plugin'  2017-07-30 09:45:48,648 ERROR [localhost-startStop-1] [plugin.osgi.factory.OsgiPluginInstalledHelper] availableForTraversal Cannot determine required plugins, cannot resolve bundle 'net.customware.confluence.plugin.redirection'  2017-07-30 09:45:48,650 ERROR [localhost-startStop-1] [plugin.osgi.factory.OsgiPluginInstalledHelper] availableForTraversal Cannot determine required plugins, cannot resolve bundle 'org.randombits.storage.confluence'  2017-07-30 09:45:48,652 ERROR [localhost-startStop-1] [plugin.osgi.factory.OsgiPluginInstalledHelper] availableForTraversal Cannot determine required plugins, cannot resolve bundle 'org.randombits.support.confluence'  2017-07-30 09:45:48,653 ERROR [localhost-startStop-1] [plugin.osgi.factory.OsgiPluginInstalledHelper] availableForTraversal Cannot determine required plugins, cannot resolve bundle 'org.randombits.support.core'  {code}    h2. Suggested Solution  The directories  * <confluence.home>/bundled-plugins/  * <confluence.home>/plugins-cache/  * <confluence.home>/plugins-osgi-cache/  * <confluence.home>/plugins-temp/  * <confluence.home>/bundled-plugins_language/    should be completely deleted on restart.    h2. Why this is important  For support we often have to ask customers to do this when we see OSGI version errors, or other side effects after start up causing instability.    For example  * there may be a left over jar file from a removed Add-On still in the plugin directory that Confluence tries to load  * On upgrade from Java 7 to Java 8 the jar files need to be completely rebuilt    Support will usually point customers to one of these documents  * https://confluence.atlassian.com/confkb/how-to-manually-remove-malfunctioning-add-ons-113705118.html  * https://confluence.atlassian.com/confkb/how-to-clear-confluence-plugins-cache-297664846.html    This is a related bug, where an Add-On is invalid on upgrade and needs to be removed from the database and disk  * https://jira.atlassian.com/browse/CONFSERVER-51958    h2. Workaround (the traditional approach)  # Shut down Confluence  # Delete the all the files and folders in (may need adjusting for your environment)  #* <confluence.home>/bundled-plugins  #* <confluence.home>/plugins-cache  #* <confluence.home>/plugins-osgi-cache  #* <confluence.home>/plugins-temp  #* <confluence.home>/bundled-plugins_language (might not exist)  # Restart Confluence  ",5
"CONFSERVER-52753","07/04/2017 15:33:02","Page Properties Report Macro Doesn't Render If ""With Parent"" Filter is Applied.","h5. Summary  Page Properties Report Macro with ""With Parent = Current Page"" will stuck while rendering. The macro keep saying: *Generating page properties report*   !Screen Shot 2017-07-04 at 10.35.49 PM.png|thumbnail!     h5. Additional Details  * The macro start to notice slowness in rendering while the page (with page properties report macro) has more than 1000 child pages.  * The macro will load significantly faster if the filter ""With Parent = Current Page"" was removed.    h5. Expected Results  The macro will load in seconds    h5. Actual Results  The macro keep saying: *Generating page properties report* and it's consuming resources and spiking CPU usage.    h5. Steps to Replicate  # Setup a new Confluence instance  # Import either one of the spaces below, both of them contains ~1000 child pages  #*  [^Confluence-space-export-215124-2.xml.zip]   #*  [^Confluence-space-export-221409-4.xml.zip]   # Open up the main page with page properties macro report  # Compare the rendering speed between page properties report macro (with or without ""with parent"" filter)    h5. Workaround  Remove ""With Parent"" Filter",3
"CONFSERVER-52755","07/04/2017 20:51:39","Unable to delete space after import from Atlassian Cloud hosted export/import","h3. Summary    When trying to delete a space which was imported from a Cloud version then the import completes and we see a foreign key violation on the table {{fk_notifications_content}} in the logs  h3. Environment    Cloud version  Confluence 6.2.0  h3. Steps to Reproduce   # Export a space from cloud version   # Import it to Confluence 6.2.0   # Delete the imported space    h3. Expected Results    The space should be deleted  h3. Actual Results    The below exception is thrown in the atlassian-confluence.log file and space does not get deleted the progress is stuck at some point:  {noformat}  2017-05-29 23:59:07,129 ERROR [Long running task: Space removal long running task] [engine.jdbc.spi.SqlExceptionHelper] logExceptions ERROR: update or delete on table ""content"" violates foreign key constraint ""fk_notifications_content"" on table ""notifications""    Detail: Key (contentid)=(1966804) is still referenced from table ""notifications"".   -- space: 1998852 | url: /spaces/doremovespace.action | traceId: 608cac2fcc885b69 | userName: admin | referer: https://confluence.wiki.com/spaces/removespace.action?key=IT1 | action: doremovespace  2017-05-29 23:59:07,131 ERROR [Long running task: Space removal long running task] [atlassian.confluence.event.ConfluenceEventDispatcher] run There was an exception thrown trying to dispatch event [com.atlassian.confluence.event.events.space.SpaceWillRemoveEvent[source=com.atlassian.confluence.spaces.DefaultSpaceManager@5aa6c096]] from the invoker [com.atlassian.confluence.event.ConfluenceListenerHandlersConfiguration$TimingListenerHandler$1$1@3fd3e159]   -- space: 1998852 | url: /spaces/doremovespace.action | traceId: 608cac2fcc885b69 | userName: admin | referer: https://confluence.wiki.com/spaces/removespace.action?key=IT1 | action: doremovespace  java.lang.RuntimeException: could not execute statement; SQL [n/a]; constraint [fk_notifications_content]; nested exception is org.hibernate.exception.ConstraintViolationException: could not execute statement   at com.atlassian.event.internal.SingleParameterMethodListenerInvoker.invoke(SingleParameterMethodListenerInvoker.java:41)   at com.atlassian.confluence.event.ConfluenceListenerHandlersConfiguration$TimingListenerHandler$1$1.invoke(ConfluenceListenerHandlersConfiguration.java:69)   ...    {noformat}  h3. Workaround  Some users have resolved this issue by running the command below to delete invalid notifications tied to deleted pages in the space (Similar to solution from CONFSERVER-15964):    {code:sql}  DELETE FROM NOTIFICATIONS  WHERE CONTENTID IN (    SELECT CONTENTID FROM CONTENT    WHERE (CONTENT_STATUS = 'deleted' AND SPACEID = <spaceid-here>)       OR PREVVER IN (         SELECT CONTENTID FROM CONTENT         WHERE CONTENT_STATUS = 'deleted' AND SPACEID = <spaceid-here>));  {code}    {panel:borderStyle=dashed| borderColor=#3C78B5| titleBGColor=#3C78B5| bgColor=#E7F4FA}  (!) With direct database manipulation, be sure to *test and validate* these changes in a test environment and create all necessary backups *prior to* rolling any changes into a Production environment.  {panel}",3
"CONFSERVER-52757","07/05/2017 09:32:12","Find/Replace function change heading format to paragraph format if any word found in the both heading and paragraph","While editing a page and use the ""Find/Replace"" function the heading format will be changed to paragraph format if the search term matches for one word of the heading and paragraph.    Steps to reproduce:  # Access Confluence using Internet Explorer 11 [^Find and Replace Bug.mp4]   # Create a new Page  # Give the Page a title (does not matter which title name)  # Paste two word in heading format: ""Example Test""  # Paste some words in next line in paragraph format which includes also a word of the heading: ""Text Example to show the Bug"". The page will be similar to below screenshot(:   !screenshot-1.png|thumbnail!   # Use the Find/Replace function and search for ""Example"" and click next to find the match.  # Click next to find the matching word in the text after the heading    h5. Expected Behavior  Heading format will remain the same    h5. Actual behavior  Internet Explorer 11: Heading format change to paragraph format after search term matches word in heading and paragraph  Chrome: Heading format will remain the same  Edge: Heading format will remain the same  ",3
"CONFSERVER-52763","07/05/2017 18:56:17","Users if mentioned receive emails with answers/comments on questions in a restricted space they don't have permissions to view","h3. Summary    Users if mentioned receive emails with answers/comments on questions in a restricted space they don't have permissions to view  h3. Steps to reproduce   # Ask a question in a restricted space and mention a user that doesn't have permissions to access this space   # Add a comment to the question and mention the user   # Answer the question and mention the user    h3. Expected result    The user should not receive emails with contents that he/she doesn't have permissions to view.  h3. Actual result    The user receives emails of those answers/comments. If he/she clicks on the links sent in the emails, the links are blocked. However, the contents are still available in the emails.",3
"CONFSERVER-52821","07/11/2017 16:02:00","Upgrade to Confluence 6.0.6+ is taking a long time for large instances","h3. Summary    Upgrading to Confluence 6.2.3 is taking a long time for large instances  h3. Steps to Reproduce   # Existing Confluence 6.0.5 and below   # You should have a large set of data (specifically in {{CONTENT}} and {{CONTENTPROPERTIES}} tables)   # Upgrade Confluence to 6.0.6 or above    h3. Expected Results    The upgrade should be done within reasonable time  h3. Actual Results    The upgrade takes a long time to finish because of the following upgrade task {{correctCsvAttachmentMimeTypeUpgradeTask}} which fixes the following bug --CONFSERVER-26926--.   This upgrade task is executing the following query  {code:sql}  UPDATE CONTENTPROPERTIES SET STRINGVAL = 'text/csv' where PROPERTYNAME = 'MEDIA_TYPE' AND CONTENTID in (SELECT CONTENTID FROM CONTENT WHERE CONTENTTYPE = 'ATTACHMENT' AND LOWERTITLE LIKE '%.csv');  {code}  (!) *Note: We have customers who took 15 hours for the upgrade to finish successfully. Others took more than 50 hours and did not finish.*  h3. Workaround  h4. Disabling correctCsvAttachmentMimeTypeUpgradeTask   # Stop Confluence   # Go to this directory {{<confluence-install>/confluence/lib}} and locate the file {{confluence-6.x.x.jar}}   # Take a backup of {{confluence-6.x.x.jar}}   # Open this jar file and locate the file {{upgradeSubsystemContext.xml}}   # Remove any occurrence of the following task {{correctCsvAttachmentMimeTypeUpgradeTask}}   # Save and make sure the jar file is updated   # Reattempt the upgrade    The upgrade now should skip that upgrade task.  h4. Manually apply the upgrade task    After the upgrade is completed successfully, we have to apply this task. What we are going to do is to split the query into 2 separate parts.  h5. Part 1 - Fetch Content ID    We first need to run the following query to get the list of all content ids that need to be updated  {code:java}  SELECT CONTENTID FROM CONTENT WHERE CONTENTTYPE = 'ATTACHMENT' AND LOWERTITLE LIKE '%.csv';  {code}  Save this into a text file and separate the content ids with a comma like this  {code:java}  id1, id2, id3...  {code}  h5. Part 2 - Update Content Properties  {code:java}  UPDATE CONTENTPROPERTIES SET STRINGVAL = 'text/csv' where PROPERTYNAME = 'MEDIA_TYPE' AND CONTENTID in (<list-of-ids-fetched-before>);  {code}  This should split the heavy work of LIKE and IN and make this update query faster since we have the list of IDs pre-fetched.    *Split the updates*    In case Part 2 is still taking a long time, some customers have also benefitted from splitting the UPDATE statement into individual updates instead of using the IN clause:  {code:java}  UPDATE CONTENTPROPERTIES SET STRINGVAL = 'text/csv' where PROPERTYNAME = 'MEDIA_TYPE' AND CONTENTID = <first-id-from-part-one>;  UPDATE CONTENTPROPERTIES SET STRINGVAL = 'text/csv' where PROPERTYNAME = 'MEDIA_TYPE' AND CONTENTID = <second-id-from-part-one>;  ...  UPDATE CONTENTPROPERTIES SET STRINGVAL = 'text/csv' where PROPERTYNAME = 'MEDIA_TYPE' AND CONTENTID = <last-id-from-part-one>;{code}   ",2
"CONFSERVER-52985","07/20/2017 00:48:38","For some instance type (ex I2.xlarge), Confluence could not download and install properly because the failure when mounting to ephemeral0","When manual mount to ephemeral0 for [some instance type|http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html] does not require, a common script (this script is using by all products) fails. For Confluence, we do not use that temporary storage so we could skip that mounting but for other products it will be a problem. ",5
"CONFSERVER-52990","07/26/2017 03:55:57","Cloud to Server export users can't log in","{panel:title=Atlassian Update|borderStyle=solid|borderColor=#3c78b5|titleBGColor=#3c78b5|bgColor=#e7f4fa}  The fix shipped in 6.5.1 added [Restore Passwords To Recover Admin User Rights|https://confluence.atlassian.com/doc/restore-passwords-to-recover-admin-user-rights-158390.html].  This method can be used to recover an administrator account in cases like this and other cases. The documentation [Migrate from Confluence Cloud to Server|https://confluence.atlassian.com/doc/migrate-from-confluence-cloud-to-server-298979321.html] has also been updated.  {panel}  h2. Summary    Backup taken from Cloud doesn't allow users to login after import in Server.    Credentials *sysadmin* username/password as mentioned on [Migrate from Confluence Cloud to Server - Atlassian Documentation|https://confluence.atlassian.com/doc/migrate-from-confluence-cloud-to-server-298979321.html] don't work.  h2. Environment   * Confluence Cloud    h2. Steps to Reproduce   # Create a Confluence Cloud export   # Install latest Confluence Server   # On the set up page, use the Cloud XML export to import a full site   # Log in as *sysadmin*/*sysadmin*    h2. Expected Results    *sysadmin* user is able to login using password *sysadmin*  h2. Actual Results    *sysadmin* user is not able to login.  h2. Notes    The export doesn't contain the passwords for any of the users.    The *sysadmin* account is not fully created. There is no entry for *sysadmin* in {{cwd_user}} table and no {{cwd_membership}} table entries, but there is a *sysadmin* entry in the {{user_mapping}} table.  h2. Workaround    See   * [Restoring Passwords To Recover Admin User Rights|https://confluence.atlassian.com/doc/restore-passwords-to-recover-admin-user-rights-158390.html]    To add an *admin* user to the database with password *admin*   # Shutdown Confluence   # Run this SQL insert to create the *admin* user with password *admin*  {code:sql}  insert into cwd_user(id, user_name, lower_user_name, active, created_date, updated_date, first_name, lower_first_name, last_name, lower_last_name, display_name, lower_display_name, email_address, lower_email_address, directory_id, credential) values (1212121, 'admin', 'admin', 'T', '2009-11-26 17:42:08', '2017-11-26 17:42:08', 'System', 'system', 'Administrator', 'administrator', 'System Administrator', 'system administrator', 'admin@example.com', 'admin@example.com', (select id from cwd_directory where directory_name='Confluence Internal Directory'), 'x61Ey612Kl2gpFL56FT9weDnpSo4AV8j8+qx2AuTHdRyY036xxzTTrw10Wq3+4qQyB+XURPWx1ONxp3Y3pB37A==');  insert into user_mapping values ('2c9681954172cf560000000000000001', 'admin', 'admin');  {code}     # Add the *admin* user to the *confluence-users* and *confluence-administrators* groups  {code:sql}  insert into cwd_membership (id, parent_id, child_user_id) values (888888, (select id from cwd_group where group_name='confluence-users' and directory_id=(select id from cwd_directory where directory_name='Confluence Internal Directory')), 1212121);  insert into cwd_membership (id, parent_id, child_user_id) values (999999, (select id from cwd_group where group_name='confluence-administrators' and directory_id=(select id from cwd_directory where directory_name='Confluence Internal Directory')), 1212121);  {code}     # Restart Confluence   # Log in as user *admin* with password *admin*",5
"CONFSERVER-52991","07/26/2017 04:23:03","Synchrony could not start on some AWS regions (e.g. Ohio)","When attempting to deploy Confluence to some AWS regions Synchrony will not start properly because of AWS API using the wrong endpoint. The effected regions are:   * US East (Ohio) - us-east-2   * EU (London) - eu-west-2 _- See Note 1_   * Asia Pacific (Mumbai) - ap-south-1 _- See Note 1_   * Asia Pacific (Seoul) - ap-northeast-2 _- See Note 1_   * Canada (Central) - ca-central-1 _- See Note 1_    Note 1: presently does not support EFS which is required to deploy on AWS using the Atlassian CloudFormation template  h3. Workaround    a. Use a different region to deploy Confluence    or    b. Do not deploy Synchrony and disable Collaborative Editing in Confluence",3
"CONFSERVER-53001","07/26/2017 15:54:04","Pressing menu key causes the editor to jump to the top","Steps to replicate :  # Login to Confluence  # Copy the text generated from the following page to a Confluence page to the point where you would need to scroll :  http://www.lipsum.com/feed/html  # After adding the text, please scroll to the bottom of the editor  # Click on the menu key, you can find the picture of the menu key in case you have trouble finding it :  !key.png|thumbnail!    Current behavior : the cursor jump to the top of editor  Expected behavior :  the cursor should not jump to the top of the editor and should open normal internet browser context menu (like you would have pressed a right click in a web page).  ",3
"CONFSERVER-53002","07/26/2017 16:05:24","Using ""space"" as a context path will break some UI images in Confluence.","h3. Summary    When configuring context for Confluence application if word ""space"" is used, some images in UI will be missing.  h3. Steps to Reproduce   # Edit server.xml and add context path to be ""/space"", ""/space"", ""/spac"", ""/sp""   # Start Confluence    h3. Expected Results    No changes in UI, all icons should be visible.  h3. Actual Results    Icons are missing as per image.    !missing images.png!  h3. Notes    Issue was not present in Confluence 5.7. As it looks like some other contexts that start with /sp will also have the same issue.  h3. Workaround    Change context path to something different (eg. /confluence).",3
"CONFSERVER-53013","07/27/2017 07:06:15","Calling ImportExportManager.doImport with a space export without setting the space key rebuilds the entire ancestor table","Code to reproduce:    {code:java}  DefaultImportContext ctx = new DefaultImportContext(spaceExportUrl, Confluence.getConfluenceUser());  ctx.setPostProcessor(createImportContextPostProcessor(new Date()));  Confluence.getImportExportManager().doImport(ctx);  {code}    The Confluence code that causes the issue is in com.atlassian.confluence.pages.ancestors.RebuildAncestorsPostImportTask#rebuildPageAncestors",3
"CONFSERVER-53040","07/27/2017 20:47:55","Team Calendars throws exception when get external calendar data and run on Confluence CDC","The current implementation of CacheLoader in TC returns Object as empty value. It only works on memory cache and it does not work on Hazelcast because Object does not implement Serializable",3
"CONFSERVER-53055","07/31/2017 01:49:57","Rebuild of the CONFANCESTORS table does not write to the database in batches","The process to [rebuild the CONFANCESTORS table|https://confluence.atlassian.com/doc/rebuilding-the-ancestor-table-153948.html] operates in batches, but it does not write those batches to the database as it progresses. It writes them all at once at the end of the job.    This, when combined with slowness (eg caused by CONFSERVER-53054) can cause the process to be interrupted by a restart etc, which leaves the table completely empty, and no inherited permissions are applied.    NB: Even after logging {{Ancestors persisted to database in 507875 ms}}, the table is still at 0.",5
"CONFSERVER-53081","08/02/2017 05:38:38","Activity Stream gadget throws ""The resource rest/webResources/1.0/resources, cannot be found."" error","h2. *How to reproduce this problem*    Have Confluence 6.2.3 + JIRA 7.3.8 installed and configured with application links:   # Create a dashboard in JIRA   # Click Add Gadget, then Manage gadgets to add the Activity Stream Gadget with the gadget URL served from confluence   # Add the *Activity Stream Gadget* to a JIRA dashboard, and observe the error message about resource cannot be found.    The issue could be reproduced by adding the Activity Stream gadget into a page in confluence.  h2. *Diagnosis*    Within *Jira*:   # Navigate to *Jira Administration* » *System* » *Logging and profiling*   ** Enable *HTTP Access logging*    Within *Confluence*:   # Add the *Activity Stream Gadget* to a JIRA dashboard, and observe the error message about resource cannot be found.    On *Jira side*:   # Open up {{$JIRA_HOME/log/atlassian-jira-http-access.log}}   # Search for *{{rest/webResources/1.0/resources}}*  {code:java|title=atlassian-jira-http-access.log}  127.0.0.1 i843x1060x1 admin [02/Nov/2017:14:03:22 +1100] ""POST http://localhost:8080/jira/jira/rest/webResources/1.0/resources HTTP/1.1"" - - - ""http://localhost:8751/jira/plugins/servlet/gadgets/ifr?container=atlassian&mi...  127.0.0.1 o843x1060x1 admin [02/Nov/2017:14:03:22 +1100] ""POST http://localhost:8080/jira/jira/rest/webResources/1.0/resources HTTP/1.1"" 404 0 0.0010 ""http://localhost:8751/jira/plugins/servlet/gadgets/ifr?container=atlas...  {code}   # You can see that the URL requested into Jira by confluence has the Jira web context ""*/jira*"" incorrectly added twice resulting in a *HTTP 404 Not Found Error*    h2. *Cause*    Confluence is incorrectly doubling up the Jira web context path when hitting the Jira *{{rest/webResources/1.0/resources}}* REST call.    h2. *Workaround*    Some people are able to work around the issue by creating a redirect rule as follows:    Pattern: \bconfluence/(\bconfluence.*)   Rewrite URL: http://localhost:8090/\{R:1}    Essentially chopping off the second /confluence.  NOTE: You must move this rule above the rewrite rule that sends normal traffic to confluence.    The same for double jira.",3
"CONFSERVER-53188","08/13/2017 04:10:51","Some Team Calendar notifications aren't set with a date parse error","h3. Summary  Team Calendar notifications aren't sent due to a date parse error.    In {{atlassian-confluence.log}} this error is thrown, there is no stack trace, just this  {code:title=atlassian-confluence.log}  2017-08-13 13:04:37,468 WARN [http-nio-8090-exec-4] [extra.calendar3.util.TimeZoneUtil] tryParseDateTimeStringForEventEdit Unable to parse date    -- referer: http://confluence.mycompany.com:8090/calendar/mycalendar.action | url: /rest/calendar-services/1.0/calendar/events.json | traceId: cf06ed098f41e2a7 | userName: userXYZ  {code}    h3. Environment  * Team Calendar 5.3.19  * SMTP configured    h3. Steps to Reproduce  # Log in as *usera*  # Create an all day event, not repeating  # Add *usera* as first invitee (with email address usera@mycompany.com)  # Add *userb* as second invitee (with email address userb@mycompany.com)  # Click *Ok*    h3. Expected Results  All added users get an email notifying of the event    h3. Actual Results  The below exception is thrown in the {{atlassian-confluence.log}} file:  {noformat}  2017-08-13 13:04:37,468 WARN [http-nio-8090-exec-4] [extra.calendar3.util.TimeZoneUtil] tryParseDateTimeStringForEventEdit Unable to parse date    -- referer: http://confluence.mycompany.com:8090/calendar/mycalendar.action | url: /rest/calendar-services/1.0/calendar/events.json | traceId: cf06ed098f41e2a7 | userName: userXYZ  {noformat}  The user mentioned in the log does not receive the email, the other users do.    h3. Notes  This seems to be only affecting some users. On testing with 2 users exactly the same, one receives the email and the other doesn't. This is reliable. The error is from this exception  {code:language=java|title=team-calendars/src/main/java/com/atlassian/confluence/extra/calendar3/util/TimeZoneUtil.java}          catch (Exception iae)          {              LOG.warn(""Unable to parse date "" + date + (StringUtils.isNotBlank(time) ? "" time "" + time : """"));              LOG.debug(""Exception when parsing date:"", iae);              return null;          }  {code}  Based on the error we can see, the date is blank.    Code was introduced with  * [TEAMCAL-3764 - refactoring update event logic in CalendarRestResouce to make it more maintianable|https://jira.atlassian.com/browse/TEAMCAL-3764]    However, the bug is likely elsewhere as this code is using date that is sent to it.    h3.Workaround  Add all other users and save the event. Have another user add yourself to the event.",3
"CONFSERVER-53203","08/15/2017 10:35:42","Logs flooded excessively with ""Hazelcast instance is not active!"" once Hazelcast has shut down","h2. Problem description  In a Data Center configuration, if Hazelcast is shut down on a node (e.g. in a cluster panic) the logs are quickly flooded with stacktraces like the below:  {code}  2017-04-13 08:41:55,001 ERROR [scheduler_Worker-8] [org.quartz.core.ErrorLogger] schedulerError Unable to notify JobListener(s) of Job to be executed: (Job will NOT be executed!). trigger= DEFAULT.IndexQueueFlusher job= DEFAULT.IndexQueueFlusher  org.quartz.SchedulerException: JobListener 'ScheduledJobListener' threw exception: Problem retrieving a value from cache com.atlassian.bandana.BandanaPersister [See nested exception: com.atlassian.cache.CacheException: Problem retrieving a value from cache com.atlassian.bandana.BandanaPersister]          at org.quartz.core.QuartzScheduler.notifyJobListenersToBeExecuted(QuartzScheduler.java:1951)          at org.quartz.core.JobRunShell.notifyListenersBeginning(JobRunShell.java:364)          at org.quartz.core.JobRunShell.run(JobRunShell.java:190)          at com.atlassian.confluence.schedule.quartz.ConfluenceQuartzThreadPool.lambda$runInThread$0(ConfluenceQuartzThreadPool.java:16)          at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:549)  Caused by: com.atlassian.cache.CacheException: Problem retrieving a value from cache com.atlassian.bandana.BandanaPersister          at com.atlassian.cache.hazelcast.HazelcastCache.getOrLoad(HazelcastCache.java:268)          at com.atlassian.cache.hazelcast.HazelcastCache.get(HazelcastCache.java:97)          at com.atlassian.confluence.cache.DefaultConfluenceCache.get(DefaultConfluenceCache.java:46)          at com.atlassian.confluence.cache.ConfluenceMonitoringCache.get(ConfluenceMonitoringCache.java:44)          at com.atlassian.confluence.setup.bandana.ConfluenceCachingBandanaPersister.retrieve(ConfluenceCachingBandanaPersister.java:52)          at com.atlassian.bandana.DefaultBandanaManager.getValue(DefaultBandanaManager.java:32)          at com.atlassian.bandana.DefaultBandanaManager.getValue(DefaultBandanaManager.java:24)          at com.atlassian.confluence.schedule.persistence.dao.ClusterSafeScheduledJobDao.getScheduledJobConfiguration(ClusterSafeScheduledJobDao.java:90)          at com.atlassian.confluence.schedule.managers.DefaultScheduledJobStatusManager.getScheduledJobStatus(DefaultScheduledJobStatusManager.java:44)          at com.atlassian.confluence.schedule.listeners.ScheduledJobsListener.lambda$executeWithJobAndJobStatus$2(ScheduledJobsListener.java:107)          at com.atlassian.confluence.schedule.listeners.ScheduledJobsListener$1.doInTransactionWithoutResult(ScheduledJobsListener.java:131)          at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:33)          at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:128)          at com.atlassian.confluence.schedule.listeners.ScheduledJobsListener.executeInTransaction(ScheduledJobsListener.java:128)          at com.atlassian.confluence.schedule.listeners.ScheduledJobsListener.executeWithJobAndJobStatus(ScheduledJobsListener.java:102)          at com.atlassian.confluence.schedule.listeners.ScheduledJobsListener.jobToBeExecuted(ScheduledJobsListener.java:59)          at org.quartz.core.QuartzScheduler.notifyJobListenersToBeExecuted(QuartzScheduler.java:1949)          ... 4 more  Caused by: com.hazelcast.core.HazelcastInstanceNotActiveException: Hazelcast instance is not active!          at com.hazelcast.spi.AbstractDistributedObject.getService(AbstractDistributedObject.java:93)          at com.hazelcast.map.impl.proxy.MapProxySupport.toData(MapProxySupport.java:1046)          at com.hazelcast.map.impl.proxy.MapProxyImpl.get(MapProxyImpl.java:83)          at com.atlassian.cache.hazelcast.HazelcastCache.getOrLoad(HazelcastCache.java:244)          ... 20 more  {code}    These stacktraces are recorded at the rate of tens/hundreds of times per minute and can quickly fill up the default log configuration of ~120 MB of atlassian-confluence.log files with nothing but these entries. The logs can roll in a matter of minutes.    The reason this is a problem is that it can cause the root cause of the node shutting down (e.g. the cluster panic event) to be rolled off the logs way before administrators have a chance to react/intervene to recover the node or manually pull the logs before rolling off. In other words, this flood of logging can hamper efforts for root cause analysis for large clients.    Ideally, we can log this type of stacktrace *once* and minimize the verbosity future entries of a similar type instead of repeatedly logging the stacktrace.    h2. Workaround  The current workaround is to extend the default logging so that more logs are kept in archive, in order to give administrators a greater window to capture the relevant logs. This can be done my modifying the following two parameters in <confluence_install>/confluence/WEB-INF/classes/log4j.properties, which influences size of log files and number of logs kept in archive, respectively:  {code}  log4j.appender.confluencelog.MaxFileSize=20480KB  log4j.appender.confluencelog.MaxBackupIndex=5  {code}    Note however that increasing the logs kept will impact the disk footprint and size of Support Zips generated.",3
"CONFSERVER-53278","08/22/2017 14:29:39","Linked Jira issue details are not loading on Confluence tasks lists.","h3. Summary    When you have more than 15 tasks with JIM(JIRA Issue Macro), the Confluence task list can't get the JIRA details.     h3. Environment  * Confluence 6.2.3  * JIRA 7.3.7    h3. Steps to Reproduce  # Go to JIRA.  # Create a new JIRA ticket for this test(it must be a ticket that was never inserted in Confluence).  # Go to Confluence.  # Create a new page and insert a task(for the admin user and with a JIM with the new ticket).  #* Copy and paste the task, it must have more than 15 or 20 to reproduce the issue.  # In Confluence, click on the profile of the user and select ""Task"" menu.    h3. Expected Results  All the JIM details will be rendered.    h3.Notes  - Rebuilding the indexing of the content won't resolve.  - Flushing the cache won't resolve.    h3. Actual Results   !JIM.png|thumbnail!   h3.Workaround  Restart Confluence.  ",3
"CONFSERVER-53404","08/31/2017 08:25:06","Relation timestamp is incorrectly updated on the old version of a page when it is published","h2. Steps to reproduce   * Create a page and publish it.   * Observe the time on the collaborator relations on the page.   * Update the page and publish it.   * Check the time on the collaborator relationships on the old version of the page. It shows the current time instead of the original time.    h2. Explanation and actual behaviour    Because of the way versioning works in Confluence, during a page publish we:   * Create a copy of the latest published version of the page   * Create the collaborator relationships on the new page object which has the old published version of the page   * Update the current version of the page in place   * Update the collaborator relationships for the current version    If you publish a new version of an already published page, the relations created on the old version of the page have the current time instead of the times on the original collaborator relationships. This is a bug.  h2. Expected behaviour    The time of the collaborator relationship on the previous version of the page does not change.  h2. Workarounds    No workaround exists.     ",2
"CONFSERVER-53381","08/31/2017 19:42:02","Frequent deadlocks on the scheduler_run_details table can cause an outage","{panel:title=Resolution|borderStyle=solid|borderColor=#3C78B5|titleBGColor=#3C78B5|bgColor=#E7F4FA}  A [Scheduled Job|https://confluence.atlassian.com/doc/scheduled-jobs-96567525.html] called 'Purge Old Job Run Details' has been introduced to purge scheduled job history    {panel}    h2. Summary    Frequent deadlocks on the scheduler_run_details table can cause an outage.    The scheduler_run_details table holds the job execution history for both clustered and non-clustered jobs. When a deadlock occurs on this table it prevents the job history from being updated and eventually leads to an outage.  h2. Environment   * Confluence Data Center   * Confluence server Standalone   * Microsoft SQL Server   ** Transaction isolation level [READ_COMMITTED_SNAPSHOT|https://confluence.atlassian.com/doc/database-setup-for-sql-server-9258.html]   ** [Collation|https://confluence.atlassian.com/confkb/how-to-fix-the-collation-of-a-microsoft-sql-server-confluence-database-687216725.html] has been verified correct   * MySQL database   * PostgreSQL database   * Large number of records in the scheduler_run_details table    h2. Symptoms  h4. Application logs  {code:java}  ERROR [Caesium-1-2] [scheduler.caesium.impl.SchedulerQueueWorker] executeJob Unhandled exception thrown by job QueuedJob[jobId=LocalTaskQueueFlushJob,deadline=1502117974606]  org.springframework.dao.DeadlockLoserDataAccessException: PreparedStatementCallback; SQL [DELETE FROM scheduler_run_details WHERE job_id = ? AND start_time < ?]; Transaction (Process ID 691) was deadlocked on lock resources with another process and has been chosen as the deadlock victim. Rerun the transaction.; nested exception is java.sql.SQLException: Transaction (Process ID 691) was deadlocked on lock resources with another process and has been chosen as the deadlock victim. Rerun the transaction.  {code}  {code:java}  WARN [Gemini Blueprint context shutdown thread1] [impl.schedule.caesium.SchedulerClusteredJobDaoProxyWrapper] delete Could not delete clustered job 'synchronyStatusCheck'  org.springframework.transaction.CannotCreateTransactionException: Could not open Hibernate Session for transaction; nested exception is java.lang.NullPointerException  ...  Caused by: java.lang.NullPointerException  {code}  (i) The job name and ID will vary, as this can happen to any non-clustered job in the Confluence cluster.  h4. DB logs    The DB error logs will look similar to what you see here:  {code:java}  spid29s     deadlock-list  spid29s      deadlock victim=process366e253848  ...  spid29s        process id=process366e253848 taskpriority=0 logused=1156 waitresource=KEY: 8:72057594177191936 (f0b68475683a) waittime=248 ownerId=119979139 transactionname=implicit_transaction lasttranstarted=2017-08-20T19:40:00.013 XDES=0x34cf387240 lockMode=U schedulerid=7 kpid=1004 status=suspended spid=772 sbid=0 ecid=0 priority=0 trancount=2 lastbatchstarted=2017-08-20T19:40:00.007 lastbatchcompleted=2017-08-20T19:40:00.007 lastattention=1900-01-01T00:00:00.007 clientapp=jTDS hostname=R0091KP0C hostpid=123 loginname=jirm70m isolationlevel=read committed (2) xactid=119979139 currentdb=8 lockTimeout=4294967295 clientoption1=671088672 clientoption2=128058  ...  spid29s     (@P0 nvarchar(4000),@P1 datetime)DELETE FROM scheduler_run_details WHERE job_id =  @P0  AND start_time <  @P1       ...  {code}  Confirm if there is table scanning by running an execution plan against the delete queries - see [Displaying Graphical Execution Plans (SQL Server Management Studio)|https://technet.microsoft.com/en-us/library/ms178071(v=sql.105).aspx] from MS documentation for details of how this can be done in your environment.  h2. Details of the problem    It is possible that multiple nodes are updating the table concurrently, because the table is not for clustered job.    The current implementation of SchedulerRunDetailsDao increases contention as it does purge (delete outdated job details) every time when a new record is added to the table:  {code:java}      @Override      public void addRunDetails(JobId jobId, RunDetails runDetails) {          purgeOldHistory();          purgeJobHistory(jobId, runDetails.getRunOutcome() == RunOutcome.SUCCESS);            SchedulerRunDetails record = SchedulerRunDetails.fromRunDetails(jobId, runDetails);          save(record);      }  {code}  {code:java}     private void purgeJobHistory(JobId jobId, boolean success) {          Date threshold = new Date(System.currentTimeMillis() - PURGE_JOB_OFFSET_MILLIS);          if (success) {              // The current write is a SUCCESS, purge everything older than threshold.              JdbcTemplate jdbc = DataAccessUtils.getJdbcTemplate(getSession());              jdbc.update(                      ""DELETE FROM scheduler_run_details WHERE job_id = ? AND start_time < ?"",                      new Object[]{jobId.toString(), threshold}              );          } else {              JdbcTemplate jdbc = DataAccessUtils.getJdbcTemplate(getSession());              String successOutcome = String.valueOf(SchedulerRunDetails.runOutcomeToChar(RunOutcome.SUCCESS));              jdbc.update(                      ""DELETE FROM scheduler_run_details WHERE job_id = ? AND start_time < ? AND outcome <> ?"",                      new Object[]{jobId.toString(), threshold, successOutcome}              );          }      }  {code}  Normally, the database should be able to handle these kind of concurrent transactions (as we are deleting things rather than updating the same record). However, it is not handled perfectly by MS SQL Server or MySQL. The situation is escalated and one transaction is chosen to be rolled back as a deadlock victim. This may lead to other symptoms.    These are two queries frequently being deadlocked:  {code:java}  DELETE FROM scheduler_run_details WHERE job_id =  @P0  AND start_time <  @P1  DELETE FROM scheduler_run_details WHERE job_id =  @P0  AND start_time <  @P1  AND outcome <>  @P2  {code}  The lack of the indexes is very likely to cause a full table scan during the execution of the delete statements. Adding the indexes in the workaround should significantly reduce the chance of deadlocks.    And another thing is, the design of addRunDetails is not optimal. The purge should be implemented as a cluster wide job rather than part of the add logic. It would eliminate contention completely. Or at least it should be made less frequent (on a daily basis, for example).  h2. Workaround  h4. Option 1    Add the following 2 composite indexes to the SCHEDULER_RUN_DETAILS table, based on the predicates of the two delete statements.  {code:java}  CREATE NONCLUSTERED INDEX IX_scheduler_run_details_jobib_starttime ON confluence.scheduler_run_details (job_id, start_time);    CREATE NONCLUSTERED INDEX IX_scheduler_run_details_jobib_starttime_outcome ON confluence.scheduler_run_details (job_id, start_time, outcome);    {code}  h4. Option 2    After performing the above, deadlocks are still possible if the size of the table is very large (i.e. over 100k rows) due to the frequency of the purge request.    You can try deleting entries in the scheduler_run_details older than 1 day. The SQL query to do this would be something like below, replacing the date with one day ago:  {code:sql}  DELETE FROM scheduler_run_details WHERE start_time < ?  {code}  (!) *Important:* You should not run this in production without first testing in your staging environment. You should also take a database backup or dump prior to running this in production. If anything does not work as expected, you can then restore from the backup.    h4. Option 3    You may also try to apply one of the below DB changes:   # Disable lock escalation for the table scheduler_run_details   # Disable page lock for the table scheduler_run_details    The final option would prevent the possibility of a deadlock caused by concurrent purges. Since the purged jobs are obsolete, this shouldn't be a problem. See also the below articles for more details on this:   * [http://www.sqlpassion.at/archive/2016/10/31/disabling-row-and-page-level-locks-in-sql-server/]   * [https://stackoverflow.com/questions/15073547/avoid-deadlock-for-concurrent-delete]    (i) Your DBA may have some experience in these options too.",5
"CONFSERVER-53407","09/04/2017 01:58:33","Items in the dashboard recently worked on sometimes move around","Items in the recently worked on section of the dashboard sometimes move around. This is caused by the last modified date for the user sometimes being newer than the last contributed date. Currently the last contributed date is always used when present. We should use the newer date instead.",1
"CONFSERVER-53408","09/04/2017 02:00:20","Infinite scrolling sometimes does not work on the dashboard","Currently the dashboard fetches 20 pages at a time and if less than 20 results are returned, it does not attempt to fetch more pages. However the backend can sometimes return fewer results. We should make this more robust by always fetching more pages until an empty page is returned.",2
"CONFSERVER-53469","09/14/2017 03:33:53","Insert JIRA Macro - Timeout while getting placeholder, Rendering this content exceeded the timeout of 5 seconds","h4. Summary    When using JIRA macro (with Total issue count selected in the Display options), displays Error 'Timeout while getting placeholder. Please try again shortly.'  when inserting the macro and the Confluence logs logged the message ""Rendering this content exceeded the timeout of 5 seconds."" even if {{confluence.macro.placeholder.timeoutMillis}} is set.  h4. Steps to reproduce   # Create a page and Insert JIRA issue macro   # Use JQL similar to \{\{project=confserver and issuetype=""bug"" and status was Open after -5d}} (note: This JQL took 7.5 seconds to return data from JAC)   # Select Total Issue count from the Display options drop down in JIRA issues macro   # Insert the Macro    # After 5 seconds, Editor throws an error ""Timeout while getting placeholder, Please try again shortly"", Confluence logs logged the message ""Rendering this content exceeded the timeout of 5 seconds.   # Set the system property value to change the default timeout from 5 seconds to much higher value (It was set to 10 seconds for this test)   # *CATALINA_OPTS=""-Dconfluence.macro.placeholder.timeoutMillis=<value> $\{CATALINA_OPTS}""*   # Restart Confluence   # Repeat steps 1 to 4   # The page Editor still throws the same error ""Timeout while getting placeholder, Please try again shortly""    h4. Expected Results    JIRA Macro should get inserted in the page without any errors  h4. Actual Results    The editor Errors out as  'Timeout while getting placeholder. Please try again shortly.'      It is observed the placeholder timeout value in the Javascript doesn't respect the confluence.macro.placeholder.timeoutMillis parameter and it defaults to 5 seconds.  h4. Workaround    No workaround     Need a fix or a workaround to allow Javascript macro placeholder timeout value to be increased.  h4.       ",2
"CONFSERVER-53500","09/18/2017 21:41:20","JIRA Issues macro fails with custom field","JIRA macro does not load when a Custom Field is added as a Column to Display. After saving the page, the macro shows up as ""loading issues"" with a spinning wheel. When it finally fails, the error message can be seen as in the screenshot, and the macro is greyed out.  h3. How to replicate    Created blank page on brand new Confluence instance, added one JIRA Issues macro containing a custom field (A) and another without the custom field (B) - *Macros break*  Edited macro A in order to remove the custom field - *Macros break*  Removed macro A and inserted another macro without the custom field (C) - *Macros render properly*  Edited macro B in order to add the custom field - *Macros break*  h3. Expected results    Macros render correctly in all cases.  h3. Actual results    Macros fail when there's a custom field on them.  h3. Workaround    If you are unable to upgrade, the Jira [Filter Results Gadget|https://confluence.atlassian.com/jira064/adding-the-filter-results-gadget-720416922.html] can be added to Confluence via [Registering External Gadgets|https://confluence.atlassian.com/doc/registering-external-gadgets-204050482.html] to load custom fields.",5
"CONFSERVER-53513","09/20/2017 10:44:56","Not able to delete new user after they login without editing any pages in confluence","h3. Description    When a new user is created by admin in confluence, the admin will not be able to delete the user after the new user login to confluence and view some pages without editing any pages. Confluence will show an error to the admin saying that the user is not able to delete due to edited some pages in confluence.  *The issue can be reproduced on 6.2, 6.3 and 6.4.*    *Steps to reproduce*   # Login as confluence admin   # Go to *Users* page   # create a new user with the following details   ** username: atlassiantestu1   ** full name: atlassiantestu1   ** password: 1234   # Logout confluence   # Login confluence with the newly created user account *atlassiantestu1*   # Complete the setup and view some pages in confluence. (DO NOT CREATE OR EDIT ANy PAGES)   # Logout confluence   # Login as confluence admin and try to delete the atlassiantestu1 user   (i) For details, you may refer to the video   [^Recording #31.mp4]    Expected Result   The user will be deleted.    Actual Result   !screenshot-1.png|thumbnail!",3
"CONFSERVER-53535","09/22/2017 08:40:15","Mentioning user didn't work when creating new question","h3. Summary    Mentioning user didn't work when creating a new question.  It worked when editing a question, answering to a question and commenting on a question as expected.    h3. Environment    * Questions for Confluence 2.4.19    h3. Steps to Reproduce    # Open create question screen  # Mention any user in the editor (e.g. Type ""@Test User"")  # Press _Save_ button    h3. Expected Results    The user should be mentioned.    h3. Actual Results    The user was not mentioned and it was shown as just a link for the user profile. (The notification wasn't sent to the user.)     !create_question.png|thumbnail!     If you edit the question and mention the user in the description, the user is mentioned as expected.     !edit_question.png|thumbnail!     h3. Notes    * This problem didn't seem to happen on Questions for Confluence 2.4.15    h3.Workaround    There is no workaround.",2
"CONFSERVER-53573","09/27/2017 15:13:20","Underscore prevents search in space directory","Summary    Space directory search filters fails with underscore    Environment  Confluence version : 5.10.x and I was able to reproduce on 6.1.3.  No plugins no proxy used no SSL    Browser versions:  •  All 3 browsers are affected     Steps to Reproduce  1. Log in to confluence  2. Navigate to space directories when searching with space name that contains _ nothing is found  3. Tested with dash and results were showing  Screen shots showing:    1.full list of spaces   2. result of underscore- not showing output   3. result with dash filter- showing output  Expected Results  To have results similar to dash",2
"CONFSERVER-59486","10/03/2017 02:16:53","Team name should be shown in REST API/Confluence macros instead of just the Team ID","Right now, when adding a Issue filter macro to Confluence, the team column has team IDs instead of team names. A similar behaviour applies to XML exports.    The team column should follow a behaviour similar to Agile Sprints, where the name is shown in the column.",3
"CONFSERVER-53651","10/05/2017 05:32:29","HTTP Client in Confluence does not accept RFC6265 compliant date format in ""Expires"" cookie header","{panel:bgColor=#deebff}  We closed this ticket because:   * It is too generic since there are different sources that could generate the same WARN messages.   * These WARN messages are mostly harmless and misleading on AWS because it currently returns a new a rotating cookie key to the client for every request and *the sticky session is not lost*.   * We have also verified that Confluence Data Center has been working properly behind an Nginx Plus Load Balancer with session affinity enabled.    For any specific case, we will open a new ticket to address it, such as CONFSERVER-56254. Please don't reference to this ticket but raise a new one if you can narrow down to which use case that causes the sticky session to be lost and the user is asked to log in again.  {panel}  h3. Summary    When using a load balancer, firewall or application that sets cookies with an {{expires}} attribute (not {{Max-Age}}) in a Cookie header, Confluence throws a WARN (in this example it's trying to get the data from a Jira User Server via the firewall)  {code:java}  2017-10-04 16:31:55,549 WARN [http-nio-8443-exec-45] [http.client.protocol.ResponseProcessCookies] processCookies Invalid cookie header: ""Set-Cookie: this_is_a_cookie=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA; e  xpires=Thu, 04 Oct 2018 12:31:45 GMT; path=/; Domain=.mycompany.com"". Invalid 'expires' attribute: Thu, 04 Oct 2018 12:31:45 GMT  -- referer: https://confluence.mycompany.com/plugins/servlet/embedded-crowd/configure/jira/ | url: /plugins/servlet/embedded-crowd/configure/jira/ | traceId: 905ff3f698dd7782 | userName: username@mycompany.com  {code}  h3. Environment   * External firewall or loadbalancer that Confluence is connecting through    h3. Steps to Reproduce   # Set up a load balancer or firewall that sets cookies with an *expires* element on the {{Cookie:}} header   # Have Confluence pull content via load balancer    h3. Expected Results    Link is parsed without error  h3. Actual Results    The below exception is thrown in the {{atlassian-confluence.log}} file:  {noformat}  2017-10-04 16:31:55,549 WARN [http-nio-8443-exec-45] [http.client.protocol.ResponseProcessCookies] processCookies Invalid cookie header: ""Set-Cookie: this_is_a_cookie=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA; e  xpires=Thu, 04 Oct 2018 12:31:45 GMT; path=/; Domain=.mycompany.com"". Invalid 'expires' attribute: Thu, 04 Oct 2018 12:31:45 GMT  -- referer: https://confluence.mycompany.com/plugins/servlet/embedded-crowd/configure/jira/ | url: /plugins/servlet/embedded-crowd/configure/jira/ | traceId: 905ff3f698dd7782 | userName: username@mycompany.com  {noformat}  h3. Notes    This can be reproduced with Amazon ALB.  h3. Workaround    Bypass the firewall or load balancer, or make sure the external application does not return cookies with {{expires}} attribute.",5
"CONFSERVER-54184","10/18/2017 05:50:02","Cannot delete Comments on Attachments","h3. Steps:   # Upload an attachment like an image or PDF and insert it on a page.   # View the page and click the attachment to preview.   # Drag out an attachment comment and save it.   # Click the ""..."" menu on the comment and click ""Delete""    h3. What should have happened    the comment should be deleted.  h3. What actually happened    Nothing.  h3. Workaround    Resolve the comment.",2
"CONFSERVER-53993","10/20/2017 15:13:57","Unable to create/edit page after a fresh installation of Confluence with MS SQL Server. Synchrony could not load driverClass net.sourceforge.jtds.jdbc.Driver","*STEPS TO REPLICATE*   # Install Confluence version 6.4.2 (using *atlassian-confluence-6.4.2.tar.gz* for this test)   # During the database setup, *Driver Class Name* is automatically set to use {{com.microsoft.sqlserver.jdbc.SQLServerDriver}} as per screenshot below:   !databasesetup.png|thumbnail!   # Enter the database URL and credential.   # Complete the installation.    *EXPECTED BEHAVIOUR*  User able to create a page after the installation.    *ACTUAL BEHAVIOUR*  Stack trace below appear in Confluence <HOME_directory>/logs/*atlassian-synchrony.log*:  {code:java}  2017-10-20 21:40:11,815 DEBUG [197:StdOutHandler [/Library/Java/JavaVirtualMachines/jdk1.8.0_102.jdk/Contents/Home/jre/bin/java]] Could not load driverClass net.sourceforge.jtds.jdbc.Driver  2017-10-20 21:40:11,815 DEBUG [197:StdOutHandler [/Library/Java/JavaVirtualMachines/jdk1.8.0_102.jdk/Contents/Home/jre/bin/java]] java.lang.ClassNotFoundException: net.sourceforge.jtds.jdbc.Driver  {code}  User unable to create/edit page:   !erroredit.png|thumbnail!    *WORKAROUND*  update the jtds url to a correctly formatted Microsoft SQL Server driver url as per their documentation ([https://docs.microsoft.com/en-us/sql/connect/jdbc/building-the-connection-url]) :   # *Stop Confluence*   # Navigate to Confluence <HOME_directory>/*confluence.cfg.xml* file and replace the line below:  {code:java}  <property name=""hibernate.connection.url"">jdbc:jtds:sqlserver://localhost:1433/confluence</property>  {code}  with:  {code:java}  <property name=""hibernate.connection.url"">jdbc:sqlserver://localhost:1433;databaseName=confluence</property>  {code}     # *Start Confluence*",2
"CONFSERVER-54000","10/23/2017 04:28:56","During database setup, using a mismatched driver class and jdbc connection url does not fail the connection tests","causes https://jira.atlassian.com/browse/CONFSERVER-53993    [See screehshot here|https://jira.atlassian.com/secure/attachment/295939/295939_databasesetup.png]    The connection test button will attempt to load the given driver class. However, the actual connection test may not utilize the given driver, but instead loads the driver associated with the jdbc url. In the case of CONFSERVER-53993, the JTDS drivers exists, and therefore, they are used. Thus passing the connection test.    The setup should ensure that only matching drivers and connection urls are saved.",1
"CONFSERVER-54063","10/27/2017 06:50:33","Page Restrictions icon is red unlocked instead of grey unlocked when Editing is restricted","h2. Steps   # Create a page.   # Add edit restrictions to it.   # Notice the lock icon is grey and unlocked.   # Refresh the page.   # Notice the lock icon is now red and unlocked (*which is wrong*).   # Click it to edit restrictions.   # Notice the icon has changed to gray.    h2. Expected    The Page Restrictions icon should not change (grey unlocked). Red unlocked means the page inherits restrictions from other pages.    This is behaviour prior to the introduction of the bug:  ||Restriction||Icon||  |None|Grey unlocked|  |Edit restriction only|Grey unlocked|  |Inherited view restriction|Red unlocked|  |Page view restriction|Red locked|    This might require a UX review. Documentation: [https://confluence.atlassian.com/doc/page-restrictions-139414.html]",2
"CONFSERVER-54067","10/27/2017 13:58:20","Confluence UI shows garbled or corrupt text on CAPTCHA, macros and/or diagrams due to missing fonts in Linux","Macro header shows garbled text and weird symbols in Linux. Captcha appears warped and unreadable.    h6. Environment   # Linux distributions, especially RedHat (RHEL)  and CentOS   # Confluence v6 and above    h6. Steps to reproduce   # Insert any macro having a title, like the Panel Macro    h6. Expected Behavior  Macro header (the name of the macro) renders properly    h6. Actual Behavior  Strange characters appear in place of the macro name.    !macro-garbled.png|thumbnail!    h6. Workaround  # Stop Confluence  # Make one or both of the following changes:  #* Uninstall lyx-fonts package (Lyx/MathML fonts - A collection of Math symbol fonts for lyx) if it is installed on the server  #* Ensure the following fonts are installed:  {code:borderStyle=solid}  yum install ghostscript  yum install dejavu-fonts-common  yum install dejavu-sans-fonts  yum install dejavu-sans-mono-fonts  yum install motif  {code}   (!) some versions of ghostscript package can be affected by security vulnerability CVE-2018-16509 discovered in September 2018.     for more details see     https://security-tracker.debian.org/tracker/CVE-2018-16509   https://access.redhat.com/security/cve/cve-2018-16509  https://www.exploit-db.com/exploits/45369/    # Rebuild the font cache by using the following command:  {code:borderStyle=solid}  fc-cache -s  {code}  # Clear the plugin cache as described at  [How to clear Confluence plugins cache|https://confluence.atlassian.com/confkb/how-to-clear-confluence-plugins-cache-297664846.html]  # Rebuild the content index as described at [How to Rebuild the Content Indexes From Scratch on Confluence Server|https://confluence.atlassian.com/confkb/how-to-rebuild-the-content-indexes-from-scratch-on-confluence-server-110035351.html]  # Start Confluence  # Clear browser cache and verify fonts are displayed correctly    h6. Notes  Confluence requires some fonts to work in Linux distributions that are not included in the installation package or in the documentation as a requirement.    In some cases, the workaround also works for file previews such as Office files and PDF.",5
"CONFSERVER-54093","10/31/2017 02:22:24","Cursor focus is not automatically set in the text area when mentioning user in Chrome","h3. Summary    Cursor focus is not automatically set in the text area when mentioning user in Chrome.   This problem was reproduced only in case that we mentioned users from the navigation menu _+ > User mention_. (If we mention users with ""@"" shortcut, the problem is not reproduced.)  h3. Environment   * Chrome    h3. Steps to Reproduce   # Start to edit a page   # Click _+ > User mention_    h3. Expected Results    Cursor focus should be automatically set in the text area as in other browsers.  h3. Actual Results    Cursor focus was not automatically set in the text area. We need to click inside of the text area to input the user name.  !cursor.png|thumbnail!    h3. Notes    This problem seemed to be originally reported in -CONFSERVER-38633- but it was closed as ""Obsolete"".  h3. Workaround    Use other browsers like Firefox.",3
"CONFSERVER-54154","11/07/2017 03:04:53","Context path changes causes @mention avatar thumbnail to not display","h3. Summary  If the context path is updated, the avatar thumbnail image does not display when using an @mention.  Testing revealed that this applied to any user whose profile picture was created before the context path change.  Problem does not occur for user profile pictures uploaded after the context path change.    h3. Environment  Confluence version 6.4.1   Not dependent on OS, DB or browser    h3. Steps to Reproduce  # Create a user profile and add a avatar picture.  # Stop Confluence.  # Change the context path value within the server.xml and confluence.cfg.xml files.  # Start Confluence  # Create a page and add an @mention.    h3. Expected Results  The user should be found and their avatar thumbnail image should appear when being @mentioned.     h3. Actual Results  While the user should be found, no avatar thumbnail image displays when being @mentioned.     h3.Workaround  # Locate every record in the content table with a title of 'user-avatar' created prior to the change in context path:  {code:sql}  select * from content where title = 'user-avatar' and creationdate > timestamp '2017-11-05 00:00:00';  {code}  # For every record returned, delete the corresponding records in the contentproperties table based on contentid.  # Likewise, delete the corresponding records in the imagedetails table based on contentid from content table equalling the attachmentid in imagedetails table.  # If there are entries in the content table with a value in the prevver column, delete these records.   # Delete every 'user-avatar' record from the content table.  # In Confluence, rebuild the Content Index.  # For each user included in the delete statements above, readd their profile picture.  # When you do a subsequent @mention, you will need to type in a minimum of 3 characters before the profile thumbnail appears.    While this works, this will not be practical for larger user populations.",2
"CONFSERVER-54166","11/08/2017 00:39:36","Clicking 'More' in Workbox doesn't do anything when instance has a large number of notifications","When clicking 'More' in Workbox, you see the spinner and then it disappears, without showing older notifications.    In the console the request has the path '/rest/mywork/latest/notification/nested?before=10000000&limit=30' and the reponse is an empty list. When doing a rest request for notifications without the 'before' parameter (i.e. '/rest/mywork/latest/notification/nested?limit=30'), it looks like all my recent notifications have ids > 10000000.",3
"CONFSERVER-54169","11/08/2017 10:44:34","Can't update system/bundled plugins when JVM flag ""-Djsse.enableSNIExtension=false"" is used","h5. Summary   * JVM ""-Djsse.enableSNIExtension=false"" parameter was added in setenv.shas a workaround to [error 'handshake alert: unrecognized_name' when setting up application links after upgrading Confluence|https://confluence.atlassian.com/confkb/error-handshake-alert-unrecognized_name-when-setting-up-application-links-after-upgrading-confluence-753895174.html]. Permanent resolution can't be applied because of apache/oracle limitations   * Then it is not possible to update any system or user plugins via Confluence Administration -> Manage add-ons.  This was working fine till September, when changes happened on Marketplace side    h3. Instance Details   * Problem reproducible on instances 5.10, 6.4.3, 6.1, databases psotgreSQL 9.4 and H2, bundled Java 8    h3. How to Replicate   * Install Confluence 6.4.3 (linux 64 bit) using default installation parameters and H2 database.   * Download directly from marketplace any 3rd party plugin .jar file (use one or two versions below the most recent so that update option is possible)   * Upload plugin manually by going to Confluence Administration -> manage add ons -> Upload add-on   * Shutdown Confluence. Add following parameter to setenv.sh file  {code:java}  CATALINA_OPTS=""-Djsse.enableSNIExtension=false ${CATALINA_OPTS}""    {code}     * Start Confluence, go to COnfluence Administration -> Manage add-ons. Try to update 3rd party plugin installed previously.  Update will not be possible, following message should be visible in application logs    {code:java}   2017-10-10 08:59:16,876 ERROR [UpmAsynchronousTaskManager:thread-3] [rest.resources.install.InstallFromUriTask] download Error downloading plugin from https://marketplace.atlassian.com/download/plugins/com.gliffy.integration.confluence/version/1004028 -- url: /rest/plugins/1.0/ | referer: https://eshare.advantest.com/plugins/servlet/upm | traceId    {code}     h3. Workaround   * Remove the JVM Parameter ""-Djsse.enableSNIExtension=false""   * Add the correct ServerName/ServerAlias(ses) to the specific hosts in the Apache configuration as this article describes: [https://community.qualys.com/thread/13532]",2
"CONFSERVER-54194","11/10/2017 01:24:43","Deleting Calendar from Team Calendar with more than 1000 events cause Oracle ORA-01795","h3. Summary  Calendar in Team Calendar cannot be removed due to more than 1000 events.     h3. Environment  * Oracle Database only    h3. Steps to Reproduce  # Configure latest Confluence on Oracle with Team Calendars  # Create calendar  # Create more than 1000 events for that calendar  # Remove Calander     h3. Expected Results  Deleting calendar removes the calendar    h3. Actual Results    The below exception is thrown in the atlassian-confluence.log file:  {noformat}   2017-10-19 13:56:24,984 ERROR [http-nio-8090-exec-21] [calendar3.rest.ExceptionMappers.GeneralExceptionMapper] getResponseError General exception happen on calendar resources   -- referer: http://<base-url>/wiki/calendar/mycalendar.action | url: /wiki/rest/calendar-services/1.0/calendar/subcalendars.json | traceId: e8fd0a07b99f1130 | userName: yd7.park  com.atlassian.activeobjects.internal.ActiveObjectsSqlException: There was a SQL exception thrown by the Active Objects library:  Database:   - name:Oracle   - version:Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production  With the Partitioning, OLAP, Advanced Analytics and Real Application Testing options   - minor version:1   - major version:12  Driver:   - name:Oracle JDBC driver   - version:12.1.0.1.0    java.sql.SQLSyntaxErrorException: ORA-01795: maximum number of expressions in a list is 1000     at com.atlassian.activeobjects.internal.EntityManagedActiveObjects.deleteWithSQL(EntityManagedActiveObjects.java:118)   at com.atlassian.activeobjects.osgi.TenantAwareActiveObjects.deleteWithSQL(TenantAwareActiveObjects.java:281)  {noformat}     h3. Notes  This bug is specifically only for Team Calander that have more than 1000 events and using Oracle database.    h3. Diagnostic Step  Please use the SQL below to see if this bug is applicable to you before proceeding to the workaround step  {code:title=SQL query for all events in specific calander}  select * from ""AO_950DC3_TC_SUBCALS"" tc,""AO_950DC3_TC_EVENTS"" te where   dBMS_LOB.INSTR( tc.name, '<Calendar >')>0   and te.""SUB_CALENDAR_ID"" = tc.""ID""  {code}  (i) Please replace the <calender> with the calendar name  (!) The SQL above have been tested but do necessary changes accordingly to the need of your instance.     h3.Workaround  (i) This workaround will only work if you have more than 1000 events on the calendar  (!) Do note that this requires removing events from the database level. Please make the necessary backup    # Shut down Confluence  # Run the SQL Below  #* {code}  select tc.""NAME"",te.""SUB_CALENDAR_ID""  from ""AO_950DC3_TC_SUBCALS"" tc,""AO_950DC3_TC_EVENTS"" te where   dBMS_LOB.INSTR( tc.name, '<Calender')>0   and te.""SUB_CALENDAR_ID"" = tc.""ID""  {code}  # Note the SUB_CALENDAR_ID  # Run the SQL and replace the SUB_CALENDAR_ID  #* {code}  delete from ""AO_950DC3_TC_EVENTS"" where ""SUB_CALENDAR_ID""='<SUB_CALENDAR_ID>'  {code}  # Start Confluence  # Remove Calender  ",3
"CONFSERVER-54262","11/16/2017 23:56:24","Searching for users can use lots of memory resulting in long GC pauses  ","Searching for users in different parts of the product such as @ mentioning users on pages, sharing pages, creating team calendar events, etc can cause memory to spike which results in longer memory cleanup cycles and results as long GC pauses.   ",3
"CONFSERVER-54310","11/22/2017 13:42:01","Confluence 'Create JIRA Report - Change log' doesn't load - regression","h3. Summary    The JIRA 'Change log' Report creator in Confluence no longer works.    When attempting to create a report the screen the 'loading' icon is displayed indefinitely and the report never loads.    This worked in 6.4.1, and broke in 6.5.0  h3. Environment   * Confluence Version 6.5.0   * Jira 7.5.3    h3. Steps to Reproduce   # In confluence click on the '...' next to the 'Create' button in the top menu bar   # Select 'JIRA Report' and click 'next'   # Select 'Change Log' and click 'next'   # Select a Project from the drop down menu, leave other fields as default and click 'create'    h3. Expected Results   # The report is created and the page is loaded    h3. Actual Results   * The loading icon will be displayed indefinitely and nothing will happen, the report is not created   * The below exception is thrown in the logs  {noformat}  ERROR [http-nio-8090-exec-6] [common.error.jersey.ThrowableExceptionMapper] toResponse Uncaught exception thrown by REST service: com.atlassian.confluence.extra.jira.JiraIssuesManager.retrieveXMLAsChannel(Ljava/lang/String;Ljava/util/List;Lcom/atlassian/applinks/api/ReadOnlyApplicationLink;ZZ)Lcom/atlassian/confluence/extra/jira/JiraIssuesManager$Channel;   -- referer: http://confluence/display/650650/test+jim | url: /rest/create-dialog/1.0/content-blueprint/create-draft | traceId: cb8d51cecbc8fab0 | userName: admin  java.lang.NoSuchMethodError: com.atlassian.confluence.extra.jira.JiraIssuesManager.retrieveXMLAsChannel(Ljava/lang/String;Ljava/util/List;Lcom/atlassian/applinks/api/ReadOnlyApplicationLink;ZZ)Lcom/atlassian/confluence/extra/jira/JiraIssuesManager$Channel;  {noformat}     * Error showing in the Chrome browser Console:  {noformat}  POST https://confluence/rest/create-dialog/1.0/content-blueprint/create-draft 500 (Internal Server Error)  {noformat}    !jira-report.png|thumbnail!    h3. Workaround 1    - Remove the current version of Blueprints that you have bundled with Confluence. Refer to the following guide to uninstall bundled plugins: [How to Remove Bundled or System Plugins|https://confluence.atlassian.com/confkb/how-to-remove-bundled-or-system-plugins-648544751.html]  - Manually install new version of confluence-software-blueprints version 4.1.1. We have found this to work with the JAR file taken from Confluence 6.6.10. [^confluence-software-blueprints-4.1.1.jar]. A guide on how to manually install is here: [Installing Marketplace apps|https://confluence.atlassian.com/upm/installing-add-ons-273875715.html#InstallingMarketplaceapps-Installingbyfileupload].    h3. Workaround 2    ""switch to advanced"" prior to hitting ""create"" works for some users   * The error will occur if *Automatically update issue status and summaries from Jira* is checked in the *Switched to Advance* settings    h3. Workaround 3    Manually create the page",1
"CONFSERVER-54328","11/24/2017 10:30:20","Disabled user is still receiving mail notification for team calendar reminder","Steps to replicate :  # Create a new user in Confluence  # Add an event to the calendar and ensure that you add the newly created user to the ""Who"" text field  # Set the ""When"" to 10 minutes from the current time  # Reminder set to 5 minutes before  # Disable the newly created user immediately after that  # Wait for about 5 minutes and the newly created user will receive a mail notification    *Workaround*  Change the user email address to another email address via the admin panel",2
"CONFSERVER-54962","12/14/2017 00:27:21","Wrong Edit button color in Preview mode","h3. Steps   # Edit a page   # Hit Preview button    *What happened...*    The Edit button's colour seems very dark and not the same as the Preview button. It make the Edit button not like a button.    !wrong-edit-button-color-in-preview-mode.gif|width=500!   *What should have happened...*   The Edit's button colour should have been lighter (i.e. it should have looked like the Preview button)",2
"CONFSERVER-55236","01/02/2018 05:47:55","404 broken link in email notification","the link marked - [Team Collaboration Software|http://www.atlassian.com/software/confluence/overview/team-collaboration-software?utm_source=email-footer]    that points to - [http://www.atlassian.com/software/confluence/overview/team-collaboration-software?utm_source=email-footer]    is broken (404)    see attached.     ",3
"CONFSERVER-54778","01/11/2018 21:03:44","Can not edit User Macros after upgrading Confluence 6.6.0(User Macros broken after upgrading)","h3. Summary    Confluence is breaking User Macros after upgrading to the 6.6.0 version. It is breaking the edition of the macro to be more specific, so if you create a macro and you want to edit it, the editing screen will hang.    h3. Steps to Reproduce  # Install Confluence 6.3.3 or 6.5.0.  #* Reproduced in both environments.  # Create a User Macro with the following configuration:  #*  [^pestatus - macro code.txt] .  #*  !pestatus - Edit User Macro.png|thumbnail!   # Go to any page and insert the macro.  # Edit the macro and switch its Status values just to see that it is working.  # Save the page.  # Upgrade Confluence to the 6.6.0 version.  # Try to edit the macro again    h3. Expected Results  User will be able to edit the macro.  h3. Actual Results  The editor screen hangs and the Console of Google Chrome will throw the following error:  {code}  Uncaught TypeError: Cannot read property '[object String]' of null      at String.<anonymous> (batch.js?analytics-enabled=true&build-number=7502&confluence.table.resizable=true&confluence.view.edit.transition=true&healthcheck-resources=true&highlightactions=true&hostenabled=true&is-server-instance=true&isSystemAdministrator=true&locale=en-GB:1173)      at Function.each (batch.js?locale=en-GB:189)      at init.each (batch.js?locale=en-GB:182)      at Object.enum (batch.js?analytics-enabled=true&build-number=7502&confluence.table.resizable=true&confluence.view.edit.transition=true&healthcheck-resources=true&highlightactions=true&hostenabled=true&is-server-instance=true&isSystemAdministrator=true&locale=en-GB:1173)      at v (batch.js?analytics-enabled=true&build-number=7502&confluence.table.resizable=true&confluence.view.edit.transition=true&healthcheck-resources=true&highlightactions=true&hostenabled=true&is-server-instance=true&isSystemAdministrator=true&locale=en-GB:1226)      at Object.<anonymous> (batch.js?analytics-enabled=true&build-number=7502&confluence.table.resizable=true&confluence.view.edit.transition=true&healthcheck-resources=true&highlightactions=true&hostenabled=true&is-server-instance=true&isSystemAdministrator=true&locale=en-GB:1231)      at Function.each (batch.js?locale=en-GB:189)      at init.each (batch.js?locale=en-GB:182)      at Object.loadMacroInBrowser (batch.js?analytics-enabled=true&build-number=7502&confluence.table.resizable=true&confluence.view.edit.transition=true&healthcheck-resources=true&highlightactions=true&hostenabled=true&is-server-instance=true&isSystemAdministrator=true&locale=en-GB:1231)      at Object.successCallback [as success] (batch.js?analytics-enabled=true&build-number=7502&confluence.table.resizable=true&confluence.view.edit.transition=true&healthcheck-resources=true&highlightactions=true&hostenabled=true&is-server-instance=true&isSystemAdministrator=true&locale=en-GB:1277)  {code}    !screen_hanging.png|thumbnail!   h3. Notes      - User won't be able to insert any User Macro until this problem is fixed.  - Simple users macros from https://confluence.atlassian.com/doc/writing-user-macros-4485.html are not affected  - Editing the macro will let it working again temporarily. After some time, it will break again.  - Broken macros affected had the {{type=enum}}. Maybe that property is related to bug.    h3.Workaround  ",3
"CONFSERVER-54805","01/18/2018 06:13:10","Page and space with attachment failed to Export to PDF for Confluence","h3. Summary    Page with attachment failed to Export to PDF for Confluence hosted in Windows/Linux as well as space export.    Confluence 6.6.1 hosted in Windows/Linux will have issue exporting a page/space into PDF if there is an attachment in the page.  h3. Steps to Reproduce   # Install Confluence 6.6.1 on a Windows/Linux machine   # Create a page and include an attachment to the page (I tested using drag and drop a JPG file)   # Export the Page to PDF or export the space    h3. Expected Results    Page/Space can be exported as expected  h3. Actual Results    Confluence will hit into *System Error* page and show the stacktrace in the page   !SystemError.png|thumbnail!    error below is thrown in the {{atlassian-confluence.log}}:  {code:java}  2018-01-18 13:46:17,145 ERROR [http-nio-8090-exec-8] [atlassian.confluence.servlet.ConfluenceServletDispatcher] sendError Could not execute action   -- url: /spaces/flyingpdf/pdfpageexport.action | traceId: 27d57be9b3196c01 | userName: admin | referer: http://localhost:8090/display/PROJ/abc  com.atlassian.confluence.importexport.ImportExportException: Could not close the export file C:\Installers\Confluence\confluence6.6.1\home\temp\pdfexport-20180118-180118-1346-13\PROJ-abc-180118-1346-14.pdf   at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerXmlToPdfConverter.convertXhtmlToPdf(FlyingSaucerXmlToPdfConverter.java:111)   at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerXmlToPdfConverter.convertXhtmlToPdf(FlyingSaucerXmlToPdfConverter.java:54)   at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerPdfExporterService.createPdfForPage(FlyingSaucerPdfExporterService.java:95)   at com.atlassian.confluence.extra.flyingpdf.ExportPageAsPdfAction.doExecute(ExportPageAsPdfAction.java:40)   at com.atlassian.confluence.extra.flyingpdf.ExportPageAsPdfAction.execute(ExportPageAsPdfAction.java:29)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:168)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.ConfluenceWorkflowInterceptor.intercept(ConfluenceWorkflowInterceptor.java:33)   ....   at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)   at java.lang.Thread.run(Thread.java:748)  Caused by: java.io.IOException: Unable to delete file: C:\Installers\Confluence\confluence6.6.1\home\temp\pdfexport_01182018_134617068\_01182018_134617109   at org.apache.commons.io.FileUtils.forceDelete(FileUtils.java:2400)   at org.apache.commons.io.FileUtils.cleanDirectory(FileUtils.java:1721)   at org.apache.commons.io.FileUtils.deleteDirectory(FileUtils.java:1617)   at com.atlassian.confluence.extra.flyingpdf.util.ImageFileCacheUtils.removeTempDirectory(ImageFileCacheUtils.java:28)   at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerXmlToPdfConverter.convertXhtmlToPdf(FlyingSaucerXmlToPdfConverter.java:109)   ... 369 more  {code}  h3. Note   * Tested on OS:   ** Windows 7 (x)   ** Windows 10 (x)   ** Linux (x)   * Tested with attachment file type:   ** JPG (x)   ** PDF (x)   ** TXT (x)   ** XLSX (x)   ** RAR (x)   * Confluence 6.6.1 installed on Linux *does not* encounter this issue.   * This is likely to be caused by the extra code added in *confluence-flyingpdf-plugin-4.1.3.jar* as downgrading to *confluence-flyingpdf-plugin-4.1.2.jar* then the export with attachment will work.    h3. Workaround    Remove the *confluence-flyingpdf-plugin-4.1.3.jar* located in {{<Confluence-Installation>/confluence/WEB-INF/atlassian-bundled-plugins}} and replace it with *confluence-flyingpdf-plugin-4.1.4.jar* from [Atlassian Repository|https://maven.atlassian.com/content/repositories/atlassian-public/com/atlassian/confluence/extra/confluence-flyingpdf-plugin/4.1.4/confluence-flyingpdf-plugin-4.1.4.jar]    (!) Please take a backup of the original bundled plugin",2
"CONFSERVER-54961","01/22/2018 01:57:55","Page tree padding looks too tight","After rebuild the page tree, the 5px padding between rows has disappeared. We need to add it back in.    Keep in mind, the page tree has some weird dependencies between:   * Open sidebar page tree   * Closed sidebar page tree   * Page tree macro    These should all be tested individually.",2
"CONFSERVER-54830","01/22/2018 23:11:43","Team Calendar event notification not sent due to missing user profile picture.","h3. Summary    Within Team Calendar 5.5.0, if a calendar event is updated, the users referenced by that event will not receive an email notification if at least one of them doesn't have a profile picture set.  h3. Environment   * Confluence 6.3.1   * Team Calendar 5.5.0    h3. Steps to Reproduce   # Create a user with no profile picture set.   # Create a calendar.   # Create an event or update an existing event and add the above user to the event.    h3. Expected Results    An email notification should be generated and sent to all users on a calendar event after it is created or updated.  h3. Actual Results    No email notification is sent.  h3. Notes    Within the logs, the following error message appears:  {code:java}  2018-01-22 12:06:14,231 ERROR [AtlassianEvent::CustomizableThreadFactory-3] [atlassian.confluence.event.ConfluenceEventDispatcher] run There was an exception thrown trying to dispatch event [com.atlassian.confluence.extra.calendar3.events.SubCalendarEventCreated[source=com.atlassian.confluence.extra.calendar3.DefaultCalendarManager@716b01c0]] from the invoker [com.atlassian.confluence.event.ConfluenceListenerHandlersConfiguration$TimingListenerHandler$1$1@7af92cd8]   -- url: /conf/rest/calendar-services/1.0/calendar/events.json | referer: http://localhost:9641/conf/calendar/mycalendar.action | traceId: 597a0a4b7ab10488 | userName: kimo  java.lang.RuntimeException: java.lang.NullPointerException   at com.atlassian.event.internal.SingleParameterMethodListenerInvoker.invoke(SingleParameterMethodListenerInvoker.java:41)   at com.atlassian.confluence.event.ConfluenceListenerHandlersConfiguration$TimingListenerHandler$1$1.invoke(ConfluenceListenerHandlersConfiguration.java:69)   at com.atlassian.confluence.event.ConfluenceEventDispatcher$VCacheRequestContextRunnableFactory$1.lambda$run$0(ConfluenceEventDispatcher.java:93)  ...  Caused by: com.atlassian.mail.MailException: java.lang.NullPointerException   at com.atlassian.confluence.extra.calendar3.notification.DefaultCalendarNotificationManager$21.doInTransaction(DefaultCalendarNotificationManager.java:2393)   at com.atlassian.confluence.extra.calendar3.notification.DefaultCalendarNotificationManager$21.doInTransaction(DefaultCalendarNotificationManager.java:2373)  ...  Caused by: java.lang.NullPointerException   at javax.mail.util.ByteArrayDataSource.<init>(ByteArrayDataSource.java:87)   at com.atlassian.confluence.core.DefaultDataSourceFactory.getServletContainerResource(DefaultDataSourceFactory.java:182)   at com.atlassian.confluence.core.DefaultDataSourceFactory.getServletContainerResource(DefaultDataSourceFactory.java:155)   at com.atlassian.confluence.extra.calendar3.notification.DefaultCalendarNotificationManager.createDefaultProfilePictureDataHandler(DefaultCalendarNotificationManager.java:1531)   at com.atlassian.confluence.extra.calendar3.notification.DefaultCalendarNotificationManager.createAvatarDataHandler(DefaultCalendarNotificationManager.java:1457)  {code}  Note where the NullPointerException is occurring within createDefaultProfilePictureDataHandler method.  h3. Workaround    Uninstall Team Calendar 5.5.0 and fall back to version 5.3.20.",3
"CONFSERVER-54888","01/31/2018 21:43:05","Cannot change favicon","h3. Summary    In Confluence 6.7.0, when attempting to change favicon to anything other than the Confluence logo, the image is uploaded but does not change in the browser tab. After upload, the favicon setting in Confluence shows the uploaded image, but the tab still only displays the Confluence logo.    h3. Steps to Reproduce    # Navigate to *Site Logo and Favicon* in the Admin Console  # Select ""Choose File"" from *Upload from File*    h3. Expected Results    Icon in the browser changes to the image you uploaded    h3. Actual Results    The Icon in the browser tab never changes from the Confluence Logo  !https://images.g2crowd.com/uploads/product/image/large_detail/large_detail_1505148164/confluence.png|width=15!    h3. Notes    Tested in Confluence 6.6 and the issue does not exist   Site Logo and title still functional    h3. Workaround    # Shutdown Confluence  # Update {{<confluence_install>/confluence/images/brand-images/favicons/fav-confluence.ico}} with your custom favicon.ico  # Update {{<confluence_install>/confluence/johnson/fav-confluence.ico}} with your custom favicon.ico  # Delete the contents of {{<confluence_install>/work/*}} (do not remove the folder)  # Delete the contents of {{<confluence_install>/temp/*}} (do not remove the folder)  # Startup Confluence and the {{favicon.ico}} should show on the Browser tab  ",5
"CONFSERVER-54978","02/14/2018 10:05:08","IE11 will not render .png images when Image Effect is applied and nosniff enabled","h3. Summary    When adding *.png* image and applying image effect on to it, image generated from thumber will incorrectly return with mime type image/jpeg  As a result, when using in combination with X-Content-Type-Options: *nosniff* set at Apache frontend and IE11 image will not be rendered  h3. Environment   * Microsoft Internet Explorer 11    h3. Steps to Reproduce   # Inserted an image *screenshot.png* into a Confluence page and embed it   # Add an ImageEffect to the picture   # The generated image is screenshot.jpg   # Analyze the screenshot.jpg with Apache Tika or [HAR|https://confluence.atlassian.com/display/KB/Generating+HAR+files+and+Analysing+Web+Requests] file    The following image properties are returned:    !image-info.png|thumbnail!  h3. Expected Results    The generated image should remain .png and content-type of the image with effects is image/png  h3. Actual Results    The content-type of the image with effects is image/jpeg    !response-headers.png|thumbnail!    As a result, if X-Content-Type-Options: *nosniff *set at Apache frontend, then Image will not be rendered by IE11  h3. Workaround    Issue is not observed by Other Browsers or [disable nosniff|https://geekflare.com/secure-mime-types-in-apache-nginx-with-x-content-type-options/].",2
"CONFSERVER-55035","02/22/2018 05:24:07","The bundled Atlassian Application Links plugin had various XSS issues - CVE-2018-5227","Application Links needs to be updated see https://ecosystem.atlassian.net/browse/APL-1356. The affected version(s) of Application Links is/are before version 5.4.4.",1
"CONFSERVER-55070","03/01/2018 00:25:33","When a draft of a page is saved/published with Collaborative Editing turned off, the page is added to the root of the space, not the page tree where it was intended.","h3. Summary    When a draft of a page is saved with Collaborative Editing turned off, the page is added to the root of the space, not the page tree where it was intended.     h3. Environment  * Can be reproduced in 6.7.0, 6.7.1  * Cannot be reproduced in earlier versions than 6.0 (tested in 5.9.3 and 5.10.x)    h3. Steps to Reproduce  # Turn Collaborative Editing off  # Go to a space with existing page trees [Ex. SpaceTest1]  # Go to an existing parent page tree with a child page(s) [In this example, call it PageTree1]  # Click the ""..."" next to the ""Create"" button on the top menu bar  # Select a blank page and clicking the ""SpaceTest1"" space in the drop down menu  # Type in random text ""abc12345678910"" and clicked close  # Click on your avatar and navigate to ""Drafts""  # You should see it listed in ""Drafts"" and click it to continue editing   # Make another change, like adding the string ""12345678910abc""  # Click ""Save"" to publish your change  # This page was intended to be a child of the ""PageTree1"" page tree, but instead is saved under the ""SpaceTest1"" space    h3. Expected Results    The page was expected to be saved under the page tree selected, not the root of the space    h3. Actual Results  An intended child page is created as a parent page under the Space     h3. Notes  This only occurs when Collaborative editing is OFF. Functionality performs as intended when Collaborative Editing is ON.    h3.Workaround  Manually move the child page under the parent page or turn Collaborative Editing on    ",3
"CONFSERVER-55093","03/02/2018 00:54:14","Cmd + S doesn't publish the page if used inside title","h3. Summary:  When editing/creating new pages, providing the title and then immediate clicking on {{cmd + s}} shortcut, Confluence does not publish the page anymore    h3. Notes:  * 6.6.0 : When entered title only - Saves as page; when entered title and tab to the page editor - Saves the page  * 6.7.0 : When entered title only - Saves as HTML; when entered title and tab to the page editor - Saves the page  * 6.7.1 : When entered title only - Saves as HTML; when entered title and tab to the page editor - Saves the page",3
"CONFSERVER-55134","03/08/2018 10:36:22","Workbox Notification will timeout on first attempt, and shows blank page and System Error message","h3. Summary  [Workbox Notification|https://confluence.atlassian.com/doc/workbox-notifications-284365963.html] does not work and shows empty page on first attempt following a Confluence restart. It will work and able to retrieve information on the next attempts/ page refresh.    h3. Steps to Reproduce  # On a fresh installation of Confluence,   # Click on the Workbox Notification icon on the top right corner    h3. Expected Results  The workbox notification loads correctly    h3. Actual Results  # The workbox notification shows blank page:   !screenshot-2.png|thumbnail!   # After a while, at times, a System Error appears in the page after a page refresh   !screenshot-1.png|thumbnail!     The following appears in the atlassian-confluence.log when the page is blank  {code}  2018-03-07 23:20:57,928 ERROR [http-nio-8090-exec-5] [atlassian.confluence.event.ConfluenceEventDispatcher] run There was an exception thrown trying to dispatch event [com.atlassian.mywork.host.event.BeforeCountNewNotificationsEvent@31bba1bf] from the invoker [com.atlassian.confluence.event.ConfluenceListenerHandlersConfiguration$TimingListenerHandler$1$1@7794c789]   -- referer: http://localhost:8090/dashboard.action | url: /rest/mywork/latest/status/notification/count | traceId: 2877b0225ae534da | userName: admin  java.lang.RuntimeException: service proxy has been destroyed. Listener: com.atlassian.mywork.host.service.ClientServiceImpl event: com.atlassian.mywork.host.event.BeforeCountNewNotificationsEvent  {code}    Eventually, it will timeout with the following:  {code}  2018-03-07 23:22:44,209 ERROR [http-nio-8090-exec-5] [[Standalone].[localhost].[/].[servlet-module-container-servlet]] log Servlet.service() for servlet [servlet-module-container-servlet] in context with path [] threw exception  java.lang.RuntimeException: java.util.concurrent.TimeoutException   at com.google.common.base.Throwables.propagate(Throwables.java:160)  {code}    The following appears in the log when seeing the System Error:    {noformat}  2018-03-08 18:43:05,452 ERROR [http-nio-8090-exec-6] [host.util.concurrent.LockedTaskExecutor] executeUnderLock Timed out waiting for lock before getting last modified date   -- referer: http://localhost:8090/dashboard.action | url: /plugins/servlet/notifications-miniview | traceId: 56ebeb370dca72ad | userName: admin  java.util.concurrent.TimeoutException   at com.atlassian.mywork.host.util.concurrent.LockedTaskExecutor.tryExecuteUnderLock(LockedTaskExecutor.java:66)   at com.atlassian.mywork.host.util.concurrent.LockedTaskExecutor.executeUnderLock(LockedTaskExecutor.java:116)   at com.atlassian.mywork.host.service.LocalRegistrationServiceImpl.getLastModified(LocalRegistrationServiceImpl.java:205)   at com.atlassian.mywork.host.service.LocalRegistrationServiceImpl.getCacheValue(LocalRegistrationServiceImpl.java:244)   at com.atlassian.mywork.host.servlet.ServletRenderer.renderWithAnchor(ServletRenderer.java:79)   at com.atlassian.mywork.host.servlet.ServletRenderer.renderWithAnchor(ServletRenderer.java:46)   at com.atlassian.mywork.host.servlet.NotificationsMiniviewServlet.doGet(NotificationsMiniviewServlet.java:23)  {noformat}     h3.Workaround  Refresh the page a couple of times    h3. Notes  The issue happens to every user, during the first time accessing Workbox Notification following a restart.    Other than restarting Confluence, this can be easily replicable by accessing Workbox Notification for the first time following *enabling a previously disabled* Workbox plugins::  # Workbox - Common Plugin  # Workbox - Confluence Provider Plugin  # Workbox - Host Plugin",5
"CONFSERVER-55142","03/09/2018 06:20:50","Images in Questions for Confluence don't work","h2. *Summary*    Images attached to initial Confluence Questions are not displayed _in another Browser session_.       h2. *Testing Environment*    Confluence 6.6.1 with Confluence Question plugin v2.5.5    (Also tested this Confluence v6.3.1 and 6.7.2)   (Also tested this with Collaborative Editing disabled which does not help)      h2. *Steps to Reproduce*   # Create a new Question by clicking on ""*Ask question*""   # Attach an image to the question.   # Add topic and Save.    # Open the question in a fresh browser, like Safari's _Private Window._   # Open the question again, the image will not be displayed.       h2. *Expected Result*    The image show up correctly as the user uploaded.    !image attached.png|thumbnail!       h2. *Actual Result*    The image doesn't appear and the browser shows a resource not found error.    !image bug.png|thumbnail!      h2. *Resolution:*    Upgrade to Confluence Questions 2.6.6 or newer  h2. *Diagnosis 1*:    1. When clicking on ""Ask Question"", a row in CONTENT is inserted immediately with the following content (e.g. CONTENTID 3407882)  {code:java}  contentid hibernateversion contenttype title                 lowertitle            version creator                          creationdate          --------- ---------------- ----------- --------------------- --------------------- ------- -------------------------------- -------------------   3407882   2                CUSTOM      ignorable draft title ignorable draft title 1       2c96b0bc61791f10016179204cb80000 2018-03-12 14:56:06   {code}  2. Once the attachment is uploaded into the Question and the Question is Saved, the above row is eventually updated and deleted and a new row in CONTENT is created with a *brand new contentid* (e.g. 3407884)  {code:java}  contentid hibernateversion contenttype title                lowertitle           version   --------- ---------------- ----------- -------------------- -------------------- -------   3407885   1                ATTACHMENT  jstack_analysis3.png jstack_analysis3.png 1         3407884   2                CUSTOM      3407882              3407882              1         {code}  3. However, in BODYCONTENT, the image attachment in the body is still pointing to the very original *PAGE ID 3407882* instead of the new PAGE ID (i.e. 3407884):  {code:java}  bodycontentid body                                                                                                                                                                            ------------- -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------   3440649       <p>3407882<img src=""http://localhost:6670/c670/download/attachments/3407882/myimage.png?version=1&amp;modificationDate=1520826995407&amp;api=v2"" height=""250"" /></p>   {code}  h2. *Diagnosis 2*:    1. Check the URL for the Confluence Question, e.g.:  {code:java}  http://localhost:8090/questions/3407895/how-do-i-reset-the-wifi  {code}  2. Right click on the broken image of the initial Confluence Question post and the ID after the attachments does not match to the above Question URL, e.g. image is linking to *3407893* and not the above *3407895*:  {code:java}  http://localhost:8090/download/attachments/3407893/jstack_analysis2.png?version=1&modificationDate=1520827628523&api=v2  {code}  h2. *Workaround 1 - for New Questions*    The following procedure is not a scalable workaround, but works.   # Create a new question and save it _without_ any images in it.   # Browse to that question again and *edit* it.   # Upload the images required in the question and *save* it.    h2. *Workaround 2 - for Existing Questions*   # Open the _faulty_ Question.   # *Right Click* on the broken image of the Question and *Open Image in a New Tab*.   !right-click.png|thumbnail!   # Match the URL of the _Question_ and the _New Tab_. Update the *number* after attachments in the _New Tab_ to be the same as the the number after _questions_ and press Enter.   !match URL.png|thumbnail!   # The Image will be displayed.   # Download this image.   # *Edit* the faulty Question and re-attach the image.",5
"CONFSERVER-55157","03/13/2018 01:24:31","Images in Team Calendar notification e-mails not rendering in Outlook and Gmail Clients","h3. Summary  The new SVG images used in Confluence 6.7.x are not rendered by Gmail nor Outlook, which results in the Team Calendars notifications having unrendered images.    h3. Environment  * Running Confluence 6.7.x  * Using:  ** Gmail  ** Outlook  ** Microsoft Exchange Online    h3. Steps to Reproduce  # Configure Confluence with E-mail notifications  # Have a user account watch a calendar  # Take an action on the calendar that would update the user via email    h3. Expected Results  The e-mail renders without issue    h3. Actual Results  The e-mail doesn't render the images properly    *Gmail*  !confluence_670_gmail.png|thumbnail!      *Microsoft Outlook 2010*  !confluence_670_outlook_2010.png|thumbnail!     *Microsoft Exchange Online*  !confluence_671_microsoft_exchange_online.png|thumbnail!    h3. Notes  * [Gmail Restrictions|https://developers.google.com/gmail/add-ons/guides/restrictions]    h3.Workaround  Use a supported e-mail client. Issue does not occur in Apple Mail nor Office365  ",5
"CONFSERVER-55165","03/13/2018 14:39:49","Can't edit recurring events on Team Calendars","h3. Summary    You can't edit events in case they are recurring events.    h3. Environment    * Confluence 6.7.2   * Team Calendars 5.5.4    h3. Steps to Reproduce    # Install Team Calendars.  # Create an event.  # Select ""All day event"".  # On the repeat field, choose ""Monthly"" and then ""Same date"".  # Edit the event's title or date     h3. Expected Results    The event's settings will be changed    h3. Actual Results  Nothing happens    h3.Workaround  No workarounds so far  ",3
"CONFSERVER-55227","03/22/2018 00:40:53","Many translations to Chinese are garbled","h2. Summary of Issue    Many translations in the latest language pack for Chinese are garbled.  h2. Environment    Confluence 6.8.0 with User Profile language set to Chinese.  h2. How to reproduce (and actual results)    Please note these are just four reported examples:   # Install Confluence 6.8.0   # Login to the Confluence   # Change the language setting to non-english. (In this example, to Chinese)   ** (1) Edit a page, click on emoticon and bottom tip text is garbled   ** (2) Insert the ""page index"" macro and the total number of pages is garbled   ** (3) Edit the page, click on the Invite user to edit, the post hover box text is garbled   ** (4) Edit the page, click on the Invite user to edit, the email notification title is garbled   ** (5) When a user attempts to edit a page they do not have access to, they click on the *Request Access* link   *** The page owner is then sent an Email to approve the access   *** If the page owner's profile then clicks on the email, they are taken to the Confluence page and the tooltip under the Page Permissions page is garbled    !Emoticon_translation_issue.png|thumbnail!    !Page_index.png|thumbnail!    !Invite_user_to_page.png|thumbnail!    !Authorise_user.png|thumbnail!  h2. Expected Result    The text should be properly translated and not appear as garbled text.  h2. Notes   * This can potentially affect JIRA Core, Stash, Bitbucket as well since some translations are shared.",3
"CONFSERVER-55237","03/23/2018 06:40:03","The bundled Atlassian Universal Plugin Manager plugin had a XSS issue - CVE-2018-5229","The version of the bundled Atlassian Universal Plugin Manager plugin had a cross site scripting vulnerability (XSS). See https://ecosystem.atlassian.net/browse/UPM-5871 for more details.",1
"CONFSERVER-55261","03/27/2018 08:39:39","Livesearch macro encodes some special characters in search results preview","h5. Environment:  Confluence 6.7.0, PostgreSQL 9.5, Google Chrome  h5. Bug description  Livesearch macro certain characters in search previews  {code:title=Characters}  ""  '  &  <  >  {code}  {code:title=Livesearch preview results for each, respectively}  &quot;  &#39;  &amp;  &lt;  &gt;  {code}    in search results preview  h5. Steps to replicate  * Create new page with & character in page title for example ""test & test""   !Screenshot_20180327_093436.png|thumbnail!   * Go to different page, add livesearch macro, save the page.   * Search for page with & character in pagename    h5. Expected results   Search results correctly encode & character in results preview      h5. Actual results  & is encoded as   {noformat}  &amp;   {noformat}   !Screenshot_20180327_093414.png|thumbnail!   h5. Notes:  Issue is not visible when using main searchbox      ",2
"CONFSERVER-55267","03/27/2018 21:57:32","Links to internal pages and attachments are changed to a self-referential link after changing the context path or protocol (http/https) in the base URL","This ticket is related to CONFSERVER-52060, but tracks a different set of symptoms.    * CONFSERVER-52060 tracks broken images, user mentions, and attachment macros. This set of symptoms have been fixed in Confluence 6.8.0  * CONFSERVER-55267 (this ticket) tracks broken *internal page links* and *attachment links* that specifically use the ""shown as links"" option. This set of symptoms are not yet fixed in Confluence 6.8.0.  * CONFSERVER-52441 tracks broken *emoticons*, which describes editing pages changes macro into hard links.     In local testing, this requires Collaborative Editing to be *enabled* to reproduce.    h2. Steps to reproduce  # Install Confluence without any context path. Version 6.8.0 was used in this test. Make sure Collaborative Editing is enabled.  # Create a couple of test pages  # On one of the pages, create a link to another page.  # Drag an example attachment such as a zip file into the editor. Click it and choose to ""Show as link""  # Save the page  {code:title=Your page storage format should end up with something similar to:}  <p><ac:link><ri:page ri:content-title=""another page"" /></ac:link></p>  <p><ac:link><ri:attachment ri:filename=""myfile.zip"" /></ac:link></p>  {code}  # Shut down Confluence  # Edit <confluence_install>/conf/server.xml and modify the context path, e.g. add ""/confluence""  # Start Confluence back up  # Go to Confluence Admin > General Configurations, and update the base URL to reflect the new ""/confluence"" context path  # Edit the page containing the link. (The editor might not load at first; try exiting the editor, refreshing the page, and edit again)  # Without changing anything, save the page    h2. Expected behavior  Nothing on the page changes    h2. Actual behavior  The links to both the internal page and the attachment are now pointing to the edited page itself. The storage format for the link now looks like:  {code}  <p><ac:link /></p>  <p><ac:link /></p>  {code}    h2. Additional notes  Customers have also reported that this can occur when changing Base URL protocol rather than context path, for example http to https.",5
"CONFSERVER-55278","03/28/2018 00:20:20","private url for ical does not work properly on new subscribe dialog","Private url does not show properly on new subscribe dialog    *The fix will be released in TC 6.0.0*      ",3
"CONFSERVER-55274","03/28/2018 19:18:23","OAuth - Service Provider - Session Remover Job is broken","(!) This issue does not affect Data Center users. Confluence Data Center is currently able to run the clean-up job without problems.    h2. Issue Description  There's a scheduled job executed by Confluence job handler called {{Service Provider Session Remover}} accountable for removing expired OAuth tokens from {{BANDANA}} table. This job is not working properly, and expired tokens are not being cleared as expected. With enough expired tokens in the database, this can eventually lead to an {color:#ff0000}application crash{color} as the logic to handle tokens is negatively impacted by the number of expired and useless entries stored in the database.    h2. Steps to Reproduce  # Set up JIRA + Confluence applinked together through an OAuth relationship  # Add Confluence gadget feed to JIRA  # Create new JIRA Dashboard and add Confluence Page Gadget, do *not* ""Login and Approve""  # Every time the Dashboard/Gadget is loaded, observe that a new {{com.atlassian.oauth.serviceprovider.ServiceProviderTokenStore.token.<somestring>}} row gets added in BANDANA table in Confluence, e.g.:  {code:title=bandanakey}  com.atlassian.oauth.serviceprovider.ServiceProviderTokenStore.token.5IWZaCCOpzibZTUboRNaJU5WmddxePSe  {code}  {code:title=bandanavalue}   <properties>     <property name=""token"" value=""dqgAd6Oc9JU2G4ZuM6ec0PLmkIMf670w""/>      <property name=""creationTime"" value=""1521048328968""/>      <property name=""tokenSecret"" value=""ZAN3c7Yu6zEP8pUQVWB25e5odUrsRNbi""/>        <property name=""authorization"" value=""NONE""/>      <property name=""version"" value=""V_1_0_A""/>     <property name=""properties"" value=""      xoauth_app_url=http\://confluence.example.com/rest/gadgets/1.0/g/com.atlassian.confluence.plugins.gadgets\:confluence-page-gadget/gadgets/confluence-page-gadget.xml   ""/>      <property name=""type"" value=""REQUEST""/>        <property name=""callback"" value=""http://jira.example.com/plugins/servlet/gadgets/oauth-callback""/>      <property name=""consumerKey"" value=""jira:2f5ae229-2135-43a8-bfd4-77f1cd14b3cc""/>       <property name=""timeToLive"" value=""600000""/>     </properties>  {code}  # Load the JIRA Dashboard and Gadget several times and observe there are now several such entries in the BANDANA table.  # Leave Confluence running for 8 hours or more to ensure {{Service Provider Session Remover}} runs. It will not and you will be able to see evidence on logs that it has failed to execute. You should have an entry like the one below:  {code}  runJob Scheduled job CompatibilityPluginScheduler.JobRunnerKey.Service Provider Session Remover#CompatibilityPluginScheduler.JobId.Service Provider Session Remover completed unsuccessfully with response JobRunnerResponse[runOutcome=ABORTED,message='Job has unexpected run mode RUN_LOCALLY'].  {code}    h2. Expected Behavior  The {{Service Provider Session Remover}} runs every 8 hours and clears out the OAuth tokens from BANDANA    h2. Actual Behavior  The {{Service Provider Session Remover}} attempts to run every 8 hours but is aborted. The {{scheduler_run_details}} table shows:  {code}     id    |                               job_id                                |       start_time        | duration | outcome |                 message                   ---------+---------------------------------------------------------------------+-------------------------+----------+---------+-----------------------------------------    428282 | CompatibilityPluginScheduler.JobId.Service Provider Session Remover | 2018-03-27 02:56:11.413 |        6 | A       | Job has unexpected run mode RUN_LOCALLY  {code}    h2. Technical details  The above means that if the dashboard is loaded 1000 times, there will be 1000 such entries in the database. These tokens are supposed to be cleared from {{BANDANA}} via the scheduled job {{Service Provider Session Remover}} which runs every 8 hours, however the job is currently broken.    As expired/unused tokens are not removed, instances will eventually hold a huge number of tokens in their database. Due to the logic used in the [OAuth Plugin|https://bitbucket.org/atlassian/atlassian-oauth] and documented in [OAUTH-321|https://ecosystem.atlassian.net/browse/OAUTH-321], as the number of tokens in the database grows, so does the complexity of the problem it needs to resolve. This is because when inserting a new token to the database, it will iterate through a list of existing tokens to validate each one of them before inserting a new one.    The intent of this logic is to validate duplicated entries as well as keep the list of usable tokens up to date, however, as the set of data ( n ) that the algorithm needs to resolve gets bigger, so does the complexity of the problem, which demands more computational resources to get resolved, making the algorithm an O (n²) [complexity class|http://bigocheatsheet.com/] one, leading to eventual outages depending on the instance usage and available resources.    h2. Symptoms  The Confluence instances that run into the performance/stability problems due to high number of stored OAuth tokens will observe one or more of the following symptoms:   * High CPU Usage.   * High Memory Usage.   * A huge number of entries in {{BANDANA}} table related to {{Service Provider}} tokens. This can be confirmed by running below query:  {code:sql}   select count (bandanaid) from bandana where BANDANAKEY like '%com.atlassian.oauth.serviceprovider.ServiceProviderTokenStore.token%';{code}   * Reports of long-running/stuck threads in Tomcat and Confluence logs for /plugins/servlet/oauth/request-token, e.g.:  {code}  14-Mar-2018 00:40:18.482 WARNING [ContainerBackgroundProcessor[StandardEngine[Standalone]]] org.apache.catalina.valves.StuckThreadDetectionValve.notifyStuckThreadDetected Thread ""http-nio-8101-exec-12"" (id=232) has been active for 69,763 milliseconds (since 3/14/18 12:39 AM) to serve the same request for https://confluence.example.com/plugins/servlet/oauth/request-token and may be stuck (configured threshold for this StuckThreadDetectionValve is 60 seconds). There is/are 9 thread(s) in total that are monitored by this Valve and may be stuck.  {code}   * Long-running/stuck threads in thread dumps that mention {{com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore.put}} in the stack trace. Examples:  {code:java}  ""http-nio-8443-exec-52"" #320 daemon prio=5 os_prio=0 tid=0x00007f027c12a800 nid=0x14f9 runnable [0x00007f0235fb5000]     java.lang.Thread.State: RUNNABLE   at org.hibernate.bytecode.internal.javassist.BulkAccessor.getPropertyValues(BulkAccessor.java:58)   at org.hibernate.bytecode.internal.javassist.AccessOptimizerAdapter.getPropertyValues(AccessOptimizerAdapter.java:55)   at org.hibernate.tuple.entity.PojoEntityTuplizer.getPropertyValuesWithOptimizer(PojoEntityTuplizer.java:234)   at org.hibernate.tuple.entity.PojoEntityTuplizer.getPropertyValues(PojoEntityTuplizer.java:212)  ...   at com.atlassian.confluence.setup.bandana.ConfluenceCachingBandanaPersister.retrieve(ConfluenceCachingBandanaPersister.java:78)   at com.atlassian.confluence.setup.bandana.ConfluenceCachingBandanaPersister.retrieve(ConfluenceCachingBandanaPersister.java:71)   at com.atlassian.bandana.DefaultBandanaManager.getValue(DefaultBandanaManager.java:32)   at com.atlassian.bandana.DefaultBandanaManager.getValue(DefaultBandanaManager.java:24)  ...   at com.atlassian.sal.confluence.pluginsettings.ConfluencePluginSettings.get(ConfluencePluginSettings.java:67)   at com.atlassian.oauth.shared.sal.HashingLongPropertyKeysPluginSettings.get(HashingLongPropertyKeysPluginSettings.java:25)   at com.atlassian.oauth.shared.sal.PrefixingPluginSettings.get(PrefixingPluginSettings.java:17)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore$Settings$IsValidTokenReference.apply(PluginSettingsServiceProviderTokenStore.java:417)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore$Settings$IsValidTokenReference.apply(PluginSettingsServiceProviderTokenStore.java:409)  ...   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore$Settings.getTokenKeySet(PluginSettingsServiceProviderTokenStore.java:383)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore$Settings.getTokenKeys(PluginSettingsServiceProviderTokenStore.java:320)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore$Settings.addTokenKey(PluginSettingsServiceProviderTokenStore.java:328)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore$Settings.put(PluginSettingsServiceProviderTokenStore.java:292)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore.put(PluginSettingsServiceProviderTokenStore.java:139)  ...   at com.atlassian.oauth.serviceprovider.internal.DelegatingTokenStoreImpl.put(DelegatingTokenStoreImpl.java:31)   at com.atlassian.oauth.serviceprovider.internal.servlet.RequestTokenServlet.doPostInTransaction(RequestTokenServlet.java:109)   at com.atlassian.oauth.serviceprovider.internal.servlet.TransactionalServlet$2.serve(TransactionalServlet.java:48)   at com.atlassian.oauth.serviceprovider.internal.servlet.TransactionalServlet$3.doInTransaction(TransactionalServlet.java:57)   at com.atlassian.oauth.serviceprovider.internal.servlet.TransactionalServlet$3.doInTransaction(TransactionalServlet.java:54)  ...  {code}  {code:java}  ""http-nio-8101-exec-297"" #9009 daemon prio=5 os_prio=0 tid=0x00007fb9e851a000 nid=0x8f1c runnable [0x00007fb9dc3bb000]     java.lang.Thread.State: RUNNABLE   at java.net.SocketInputStream.socketRead0(Native Method)   at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)   at java.net.SocketInputStream.read(SocketInputStream.java:170)   at java.net.SocketInputStream.read(SocketInputStream.java:141)   at oracle.net.ns.Packet.receive(Packet.java:311)   at oracle.net.ns.DataPacket.receive(DataPacket.java:105)   at oracle.net.ns.NetInputStream.getNextPacket(NetInputStream.java:305)   at oracle.net.ns.NetInputStream.read(NetInputStream.java:249)   at oracle.net.ns.NetInputStream.read(NetInputStream.java:171)   at oracle.net.ns.NetInputStream.read(NetInputStream.java:89)   at oracle.jdbc.driver.T4CSocketInputStreamWrapper.readNextPacket(T4CSocketInputStreamWrapper.java:123)   at oracle.jdbc.driver.T4CSocketInputStreamWrapper.read(T4CSocketInputStreamWrapper.java:79)   at oracle.jdbc.driver.T4CMAREngineStream.unmarshalUB1(T4CMAREngineStream.java:429)  ...   - locked <0x000000067f800000> (a oracle.jdbc.driver.T4CConnection)   at oracle.jdbc.driver.OraclePreparedStatementWrapper.executeUpdate(OraclePreparedStatementWrapper.java:1361)  ...   at com.atlassian.confluence.setup.bandana.ConfluenceCachingBandanaPersister.lambda$retrieve$0(ConfluenceCachingBandanaPersister.java:80)   at com.atlassian.confluence.setup.bandana.ConfluenceCachingBandanaPersister$$Lambda$354/101785611.get(Unknown Source)  ...   at com.atlassian.sal.confluence.pluginsettings.ConfluencePluginSettings.get(ConfluencePluginSettings.java:67)   at com.atlassian.oauth.shared.sal.HashingLongPropertyKeysPluginSettings.get(HashingLongPropertyKeysPluginSettings.java:25)   at com.atlassian.oauth.shared.sal.PrefixingPluginSettings.get(PrefixingPluginSettings.java:17)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore$Settings.getTokenKeySet(PluginSettingsServiceProviderTokenStore.java:368)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore$Settings.getConsumerTokens(PluginSettingsServiceProviderTokenStore.java:352)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore$Settings.addConsumerToken(PluginSettingsServiceProviderTokenStore.java:360)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore$Settings.put(PluginSettingsServiceProviderTokenStore.java:293)   at com.atlassian.oauth.serviceprovider.sal.PluginSettingsServiceProviderTokenStore.put(PluginSettingsServiceProviderTokenStore.java:139)  ...  {code}    h2. Workaround  As a workaround, we need to clear tokens stored in {{BANDANA}} table manually, since the Scheduled Job is not doing it for us. To do that:   # Shutdown Confluence.   # Connect to your database client.   # {color:#FF0000}Take a backup{color} from your Confluence database in case we may need to revert it to its pre-delete statement state.   # Execute below query:  {code:sql}  delete from BANDANA where BANDANAKEY like 'com.atlassian.oauth.serviceprovider.ServiceProviderTokenStore.token%' and bandanavalue like '%value=""REQUEST""%'  {code}   # Restart the application.    After this is done, you should no longer observe the symptoms caused by this issue, however, users may be prompted to re-authenticate against applications that were relying on the OAuth tokens previously stored in the database once the clean-up is completed.    It is important to highlight that this workaround may need to be repeated from time to time until this bug is solved if symptoms re-occur. Instance administrators may want to setup a trigger in their database clients to execute this routine automatically based upon certain circumstances, like for example, {{BANDANA}} table going full of records if they intend to automate this task.",5
"CONFSERVER-55287","03/30/2018 00:59:24","Unable to Edit Single Event Instance in Repeating Events","h3. Summary    Users are unable to save their changes to a Single Occurrence of a Repeating Event they've edited within Team Calendars. The page refreshes and the change is reverted back to its original configuration. This only appears to affect Events which are repeating; single, non-repeating events can be edited.  h3. Environment   * Confluence Server 6.4.1   * Team Calendars 5.5.4    h3. Steps to Reproduce   # On a Team Calendar, Create an event which has a repeat   # Save Event   # Edit one of the Events (either change it's title, date/time, Who, etc); ensure ""Edit this instance only"" is checked   # Save Changes to event    h3. Expected Results    The Single Event is updated with the new information  h3. Actual Results    Calendar refreshes and change does not exist:  Confluence Logs:  {noformat}  2018-04-05 17:59:03,066 WARN [http-nio-8090-exec-15] [extra.calendar3.util.TimeZoneUtil] tryParseDateTimeStringForEventEdit Unable to parse date null   -- referer: https://localhost:8090/display/~XXXX.XXXX/calendars | url: /rest/calendar-services/1.0/calendar/events.json | traceId: 7a550765b4b9cc40 | userName: XXXX.XXX  {noformat}  {noformat}  java.lang.NullPointerException   at com.atlassian.confluence.extra.calendar3.rest.statemachine.statehandlers.UpdateRescheduleEventStateHandler.onState(UpdateRescheduleEventStateHandler.java:41)   at com.atlassian.confluence.extra.calendar3.rest.statemachine.statehandlers.UpdateRescheduleEventStateHandler.onState(UpdateRescheduleEventStateHandler.java:16)   at com.atlassian.confluence.extra.calendar3.rest.statemachine.EventUpdateStateMachine.triggerOnState(EventUpdateStateMachine.java:111)  {noformat}  h3. Resolution    Upgrade to Team Calendars -version 6.0.12 or above-, which contains a fix for this issue.    (i) Some customers report the issue persists even after upgrading to the fixed version (such as 6.0.17). Please watch this ticket to receive the latest updates.    h3. Notes    Appears to be related to: CONFCLOUD-55639    h3. Workaround    1. Delete the Individual Calendar Event that needs to be Edited and create a new Event with the intended changes.  2. Exporting the .ical and import it back to Confluence did the trick ",3
"CONFSERVER-55328","04/09/2018 05:07:03","The bundled atlassian-http library had a content spoofing issue - CVE-2017-18103","The version of the bundled atlassian-http library was vulnerable to content-spoofing. See https://jira.atlassian.com/browse/HTTP-3 for more details.",3
"CONFSERVER-55355","04/13/2018 16:04:16","""Child pages"" option translation","h3. Problem    Polish translation of ""Child Pages"" has been translated into: ""Strony dla dzieci"" - that literally means ""Pages for children"".    See the screenshot below:    !image-2018-04-13-17-05-37-165.png|width=214,height=329!  h3. Current value    ""Strony dla dzieci""  h3. Expected value    ""Podstrony""?  h3. Steps to reproduce   * Set language to polish   * Go to space > any page   * Click ""Konfiguracja sidebar"" (Configure sidebar)    h3. Workarounds    Not found.",1
"CONFSERVER-55422","04/25/2018 13:50:49","Date selection arrows not visible with Team Calendars 6.0.0","h3. Summary    With the latest update 6.0.0. of Team Calendar, arrows for changing the date disappeared.  h3. Environment    Team Calendar 6.0.0.   Confluence 6.3.4 or 6.6.4  h3. Steps to Reproduce   # Install Team Calendar 6.0.0   # Open Calendar page    h3. Expected Results    Arrows (left and right) for changing date/month will be visible.  h3. Actual Results    Arrows will be gone.   !image_arrows.png|thumbnail!  h3. Resolution    Upgrade to Team Calendars 6.0.12 or newer, which contains a fix for this issue.  h3. Notes    Latest Confluence 6.8.1 is not affected.  h3. Workaround    If possible upgrade to latest version of Confluence.",3
"CONFSERVER-55506","05/09/2018 07:31:01","Deleting repeating Events in Team Calendar causes duplicates in database and java.lang.OutOfMemoryError","h3. Summary    Deleting Events in Team Calendar that are part of a repeating Event cause duplicates in the database, which causes performance issues and {{java.lang.OutOfMemoryError}} when viewing Team Calendars as the duplicates are loaded back into memory when re-loading the Calendar.    !outofmemory.png|thumbnail!  h3. Environment   * Confluence 6.9.0   * Team Calendar 6.0.0 or 5.5.4    h3. Steps to Reproduce    This is quite tricky to reproduce with clear, concise steps. It may differ but in general   # In Team Calendars, create an all day Event that repeats every day and never ends   # Delete one event, at least a week after the first one   # Check the Team Calendar Exclusion table for duplicates (this is for Postgres, adjust as necessary)  {code:sql}  select ""EXCLUSION"", count(*) from ""AO_950DC3_TC_EVENTS_EXCL"" group by ""EXCLUSION"";  {code}  There should be one event listed, the deleted one     # Click on a date before the deleted event, and select *All Future Events*   # Check the Team Calendar Exclusion table for all duplicates (this is for Postgres, adjust as necessary)  {code:sql}  select ""EXCLUSION"", count(*) from ""AO_950DC3_TC_EVENTS_EXCL"" group by ""EXCLUSION"";  {code}  The Events are not removed.    h3. Diagnosis  Run the following query to see if you may be affected by this issue (this is for Postgres, adjust as necessary):  {code}select ""ALL_DAY"", ""EVENT_ID"", ""EXCLUSION"", count(*) from ""AO_950DC3_TC_EVENTS_EXCL"" group by ""ALL_DAY"", ""EVENT_ID"", ""EXCLUSION"" having count(*) > 1;{code}  If there are rows returned, it's possible you are experiencing this issue, especially if the count for any row is high.    h3. Expected Results    There should be only be two rows in {{AO_950DC3_TC_EVENTS_EXCL}} and the Events should be removed.  h3. Actual Results    The below exception is thrown in the {{atlassian-confluence.log}} file:  {noformat:title=atlassian-confluence.log}  2018-05-09 16:55:31,339 ERROR [http-nio-8090-exec-7] [common.error.jersey.ThrowableExceptionMapper] toResponse Uncaught exception thrown by REST service: Java heap space   -- referer: http://confluence.mycompany.com:8090/calendar/mycalendar.action | url: /rest/calendar-services/1.0/calendar/events.json | traceId: b85eaf70252053ab | userName: admin  java.lang.OutOfMemoryError: Java heap space  {noformat}  h3. Resolution    Upgrade to Team Calendars 6.0.12 which contains a fix for this issue.  h3. Notes    Reviewing the heap dump from the {{java.lang.OutOfMemory}} error we can see that there are a few very large threads loaded with duplicates of the data, for example  ||object||cause||size||  |com.mysql.jdbc.JDBC42ResultSet|AO_950DC3_TC_EVENTS_EXCL|946M|  |http-nio-8090-exec-2|/rest/calendar-services/1.0/calendar/events.json|716M|    The {{com.mysql.jdbc.JDBC42ResultSet}} is pulling all the data from {{AO_950DC3_TC_EVENTS_EXCL}}. {{http-nio-8090-exec-2}} is the associated user thread.    The URL in the HAR fill shows it as   * [https://confluence.mycompany.com/rest/calendar-services/1.0/calendar/events.json?subCalendarId=02a75ad8-f7d5-4365-ba6d-02f437279e94&userTimeZoneId=Sydney%2FAustralia&start=2018-04-28T00%3A00%3A00Z&end=2018-08-08T00%3A00%3A00Z&_=1525628684224]    And this returns all the data, or generates the {{java.lang.OutOfMemoryError}}.    The error is caused by this code  {code:java|title=com.atlassian.confluence.extra.calendar3.DefaultCalendarManager#excludeEvent}              excludeRecurrence(                      baseEvent,                      !(baseEvent.getStartDate().getDate() instanceof net.fortuna.ical4j.model.DateTime || baseEvent.getEndDate().getDate() instanceof net.fortuna.ical4j.model.DateTime)                              ? excludeDate.withZoneRetainFields(DateTimeZone.forID(srcSubCalendar.getTimeZoneId()))                              : excludeDate.withZone(DateTimeZone.forID(srcSubCalendar.getTimeZoneId()))              );                calendarDataStore.updateEvent(srcSubCalendar, baseEvent);  {code}  h3. Workaround    The only option is to delete the duplicates in the {{AO_950DC3_TC_EVENTS_EXCL}} table and informing users to not delete *All Future Events*.  {panel:title=IMPORTANT|borderStyle=dashed|borderColor=#cccccc|titleBGColor=#f7d6c1|bgColor=#ffffce}  (!) Always back up your data before performing any modifications to the database. If possible, test any alter, insert, update, or delete SQL commands on a staging server first.  {panel}  h4. MySQL    You can remove the duplicates by adding then removing this index  {code:sql|title=MySQL 5.6 and below}  ALTER IGNORE TABLE AO_950DC3_TC_EVENTS_EXCL ADD UNIQUE INDEX AO_950DC3_TC_EVENTS_EXCL_TEMP_INDEX (ALL_DAY, EVENT_ID, EXCLUSION);  ALTER TABLE AO_950DC3_TC_EVENTS_EXCL DROP INDEX AO_950DC3_TC_EVENTS_EXCL_TEMP_INDEX;  {code}  {code:sql|title=MySQL 5.7 and above}  CREATE TABLE AO_950DC3_TC_EVENTS_EXCL_NEW LIKE AO_950DC3_TC_EVENTS_EXCL;  ALTER TABLE AO_950DC3_TC_EVENTS_EXCL_NEW ADD UNIQUE INDEX (EVENT_ID);  INSERT IGNORE INTO AO_950DC3_TC_EVENTS_EXCL_NEW SELECT * FROM AO_950DC3_TC_EVENTS_EXCL;  DROP TABLE AO_950DC3_TC_EVENTS_EXCL;  RENAME TABLE AO_950DC3_TC_EVENTS_EXCL_NEW TO AO_950DC3_TC_EVENTS_EXCL;  {code}  h4. PostgreSQL    Delete the duplicates with (this may take some time)  {code:sql|title=PostgreSQL}  delete from ""AO_950DC3_TC_EVENTS_EXCL"" where ""ID"" in (select ""ID"" from (select ""ID"", row_number() over (partition BY ""EXCLUSION"" order by ""ID"") from ""AO_950DC3_TC_EVENTS_EXCL"") excl_table WHERE excl_table.row_number > 1);  {code}",5
"CONFSERVER-55571","05/17/2018 14:18:08","Context path does not work for Team calendar subscription (CALDAV)","h5.Steps to reproduce  # Install a new Confluence 6.8, with Team Calendar 6  # Configure Confluence with Context path (exp : http://localhost:6801/sixegg/)  # Create a new Calendar  # Subscribe the newly created Calendar with your phone by following this [document|https://confluence.atlassian.com/teamcal/subscribe-to-team-calendars-from-android-calendar-946631707.html] (CALDAV)      h5.Expected Results  We should be able to subcribe to our Team Calendar as per described in our document      h5.Actual Results  The context path is missing from the url:     !screenshot-1.png|thumbnail!       h5. Resolution    CalDav uses Confluence's root URL as it's well-known URL. If you've configured Confluence with a context path, for example www.yoursite.com/confluence, your calendar app will not be able to connect to your Team Calendars.     To resolve this, you will need to make some changes to your proxy configuration, to redirect the well-known URL to your URL (including the context path).  See [our documentation|https://confluence.atlassian.com/display/TEAMCAL/Subscribe+to+and+from+Team+Calendars#SubscribetoandfromTeamCalendars-contextpath] for more information.   ",1
"CONFSERVER-55592","05/18/2018 19:45:33","Deleting a calendar event triggers ORA-01795","h3. Summary  Creating an event and inviting over than 1000 users makes it impossible to remove the event    h3. Environment  Oracle Database    h3. Steps to reproduce  # Create an event  # Add more than 1000 invitees  # Save  # Try removing the event    h3. Expected results  The calendar event is removed    h3. Actual Restuls  The calendar event is not removed and Confluence throws an error.  {code}  2018-05-17 17:03:11,700 ERROR [http-nio-8090-exec-6] [calendar3.rest.ExceptionMappers.GeneralExceptionMapper] getResponseError General exception happen on calendar resources   -- referer: https://portal.onenetwork.com/display/OPS/Operations+Calendar | url: /rest/calendar-services/1.0/calendar/events.json | traceId: 79e6e3cdc6794786 | userName: dchisholm  com.atlassian.activeobjects.internal.ActiveObjectsSqlException: There was a SQL exception thrown by the Active Objects library:  Database:   - name:Oracle   - version:Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production   - minor version:2   - major version:12  Driver:   - name:Oracle JDBC driver   - version:12.2.0.1.0    java.sql.SQLSyntaxErrorException: ORA-01795: maximum number of expressions in a list is 1000  {code}    h3. Workaround  -",2
"CONFSERVER-55662","05/24/2018 17:26:47","Images broken on Questions for non admin users","h3. Environment  * Questions plugin version 2.6.6, 2.5.5, 2.5.4  h3. Steps to Reproduce  *Scenario 1*  # Create a question in space as Admin and add an image to it  # Access same question as an ordinary user who has permission to question and space, the image will be broken  (i) same contentID  * URL when admin create Question and add an image to it: display/TEST/questions/2654304/question-by-admin  * URL when user access question : display/TEST/questions/2654304/question-by-admin  * URL when you do right click on the broken image and open in a new tab: display/TEST/questions/2654304/question-by-admin    *Scenario 2*  # Create a question in space as an ordinary user and add an image to it  # Access this question using Admin account, the image will be broken  (i) notice at this scenario the id changes in URL and workaround 2 provided on this bug fixed the issue    h3. Expected Results    Image to be rendered correctly for all admin and users    h3. Actual Results  image broken:   * The request for the image without effect will return 404.  * The request for the image with effect will return 403.    h3. Workaround For Scenario 2 - for Existing Questions   # Open the _faulty_ Question.   # *Right Click* on the broken image of the Question and *Open Image in a New Tab*.   !right-click.png|thumbnail!   # Match the URL of the _Question_ and the _New Tab_. Update the *number* after attachments in the _New Tab_ to be the same as the the number after _questions_ and press Enter.   !match URL.png|thumbnail!   # The Image will be displayed.   # Download this image.   # *Edit* the faulty Question and re-attach the image.    h3. Notes  * These are two bug [CONFSERVER-55241|https://jira.atlassian.com/browse/CONFSERVER-55241] [CONFSERVER-55142|https://jira.atlassian.com/browse/CONFSERVER-55142] that related to broken images on questions but this is not exactly the same scenario as raised here.  ",3
"CONFSERVER-55745","05/28/2018 19:51:20","Collaborative Editing takes an unfeasible amount of time to enable if a high number of stale drafts exist on the DB","h3. Summary    Collaborative Editing takes an unfeasible amount of time to enable if the database holds a high number of *stale drafts*.    h3. Environment  * Confluence 6+   * DC or Standalone  * Reproduced with 20k stale drafts    h3. Steps to Reproduce  # Start Confluence  # Start Synchrony  # Go to the Collaborative Editing management page  # Attempt to enable CE    h3. Expected Results    Collaborative Editing is enabled in a few seconds.    h3. Actual Results    The *Change Mode* popup keeps spinning and the task is not completed:   !changemode.png|thumbnail!    Depending on the number of Stale Drafts, this task can take hours to complete or even fail.    h3. Notes    If you take thread dumps while CE is being enabled, we can see that the *Remove Stale Drafts* task is ongoing. This class can be spotted on the threads:    {code}  at com.atlassian.confluence.pages.DefaultPageManager.removeStaleSharedDrafts(DefaultPageManager.java:775)  {code}    So, the problem is caused by the inefficiency of the *removeStaleSharedDrafts* task.    h3. Log Sample  {code:borderStyle=solid}  ERROR [Long running task: EnableTask] [springframework.transaction.support.TransactionTemplate] rollbackOnException Application exception overridden by rollback exception   -- url: /rest/synchrony-interop/enable | referer: https://confluence.example.com/admin/confluence-collaborative-editor-plugin/configure.action | traceId: 3764f927fd378bc8 | userName: admin  java.lang.IllegalStateException: Session/EntityManager is closed   ...   at com.atlassian.confluence.pages.DefaultPageManager.removeStaleSharedDrafts(DefaultPageManager.java:764)   ...   at com.sun.proxy.$Proxy2201.removeStaleSharedDrafts(Unknown Source)   at com.atlassian.confluence.plugins.synchrony.tasks.EnableTask.execute(EnableTask.java:53)   at com.atlassian.confluence.plugins.synchrony.tasks.AbstractConfigLongRunningTask.runInternal(AbstractConfigLongRunningTask.java:65)   at com.atlassian.confluence.util.longrunning.ConfluenceAbstractLongRunningTask.run(ConfluenceAbstractLongRunningTask.java:26)   at com.atlassian.confluence.util.longrunning.ManagedTask.run(ManagedTask.java:52)  {code}    h3.Workaround    Follow the KB below in order to manually remove the staled drafts:    * [How to manually remove Stale Drafts from Confluence Database|https://confluence.atlassian.com/display/CONFKB/How+to+manually+remove+Stale+Drafts+from+Confluence+Database]",5
"CONFSERVER-58898","05/29/2018 01:39:11","Users get US English if their language preference is en-AU,en-GB,en-US","This causes English users to get the wrong locale of English. In particular most US English users get UK English.",2
"CONFSERVER-55754","05/29/2018 08:17:10","Archived Space and page appears in quick nav","h4. Summary/Expected Result  According to [Archive a Space|https://confluence.atlassian.com/confcloud/archive-a-space-724764817.html], If a space is archived, that space and it's contents won't appear on any dropdown menus, including the *Confluence quick navigation*, which drops down when you enter text in the search box.    h4. Actual Result  Pages from an archived space still appear in quick nav     h4. Steps to replicate  # Create space A  # Create space B  # Create page 'ABC' in space A  # Create page 'DEF' in space B  # Archive space B  # Search for 'ABC'  #* ABC now appears in quick nav  # Search for DEF (with the ""Search archived spaces"" tag enabled)  #* DEF now appears in quick nav    h4. Note  This behavior is similar to [CONFSERVER-36344 - Archived Space and page appears in quick nav for members of the confluence-administrators group|https://jira.atlassian.com/browse/CONFSERVER-36344] but this also affects non-Confluence admin.",0
"CONFSERVER-55858","06/07/2018 05:56:02","Korean translation is garbled in the current page right at the top in JIRA links"," h4. Steps to reproduce  # Create JIRA Confluence application link  # Drag and drop at least 2 JIRA issues into a Confluence page  (i) translation is fine when there is only 1 JIRA issue link    h4. Observed behaviour  Korean translation is garbled in the current page right at the top in JIRA links  !JIRA issue links.png|thumbnail!    h4. Expected behaviour  JIRA 링크 ",1
"CONFSERVER-55918","06/14/2018 09:26:16","XSS in User Macros, Macro Title and Icon URL","h2. Summary    System Administrator is allowed to input JS/CSS in Macro Title and Icon URL in Macro Editor. The script input in the fields can be executed when user open ""Macro"" selection window.  h2. How to reproduce   # Go to ""Edit User Macro""  as Confluence Administrator.   !Screen Shot 2018-06-14 at 17.27.45.png|thumbnail!   # Input ""'""><img src=x onerror=alert(1)>"" in Macro Title field.   # Input ""http'""><img src=x onerror=alert(3)>"" in Icon URL field.   # Click save.   # Go to a certain page to edit.   # In edit UI, Select ""+"" then select ""... Other Macros"".   # Popups appear as alert(1) and alert(3) as set.   !Screen Shot 2018-06-14 at 17.31.31.png|thumbnail!    h2. Expected   * JS/CSS should not be allowed in Macro Title and Icon URL.     ",2
"CONFSERVER-55992","06/15/2018 01:54:00","Can't restart Confluence after installing using windows installer and bundled JRE","You can't start Confluence using {{start-confluence.bat}} if Java is not installed, and JAVA_HOME or JRE_HOME system environment variable is set correctly.     *Steps to reproduce:*    1. In Windows, check that Java is NOT installed, and that there's no env variable for either JAVA_HOME or JRE_HOME ({{echo %JAVA_HOME%}})  2. Install Confluence using the installer (don't install as a service)  3. Complete the setup wizard.   4. Stop Confluence.   5. Attempt to start confluence using {{start-confluence.bat}}    *Expected result:*    Confluence starts, using the bundled JRE.    *Actual result:*    Window closes immediatley, and Confluence does not start.    *Solution*    {panel}  Start Confluence using the options in Windows' Start menu, or run {{<install-directory>/startup-bundled-jre.bat}}.     The {{start-confluence.bat}} command is only used when you've installed Confluence manually, and are not using the bundled JRE{panel}  ",2
"CONFSERVER-55968","06/20/2018 23:19:52","Notifications icon is missing","h3. Summary  The Notifications/workbox icon is missing from fresh installs of Confluence 6.6.6    h3. Environment  * Confluence 6.6.6    h3. Steps to Reproduce  # Install Confluence 6.6    h3. Expected Results  The notification icon will be seen    h3. Actual Results  The notification icon is missing    !MissingIcon.png|thumbnail!     h3.Workaround     Add the following to the HEAD section in Custom HTML.    {code}  <script type=""text/javascript"">      $(function(){          $('#header .aui-iconfont-notification').addClass('aui-iconfont-workbox-empty');      });  </script>   {code}",2
"CONFSERVER-55981","06/22/2018 15:31:36","SSRF via REST API /plugins/servlet/gadgets/makeRequest","Confluence installations have permissive whitelist that allows to fetch any URL using confluence like as the proxy.    Use GET request {{GET /plugins/servlet/gadgets/makeRequest?url=}}    Example:   to get Yandex start page or any resource you want.  {code:java}  GET /plugins/servlet/gadgets/makeRequest?url=http://ya.ru HTTP/1.1  Host: xxxxxxxxxxxxxxxxxxxxxx  User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0  Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8  Accept-Language: en-US,en;q=0.5  Accept-Encoding: gzip, deflate  Cookie: s_cc=true; s_nr=1521467033623-New; s_vnum=1522558800623%26vn%3D1; s_sq=%5B%5BB%5D%5D  DNT: 1  X-Atlassian-Token: no-check  Connection: close  Upgrade-Insecure-Requests: 1  {code}       *Update*    This issue was fixed in Confluence version 4.2.14. If you are experiencing this issue in a newer version of Confluence then please check the configuration of the in product whitelist as per [https://confluence.atlassian.com/doc/configuring-the-whitelist-381255821.html].",2
"CONFSERVER-56017","06/28/2018 09:43:11","Regression - JIRA Issues Macro fetching unnecessary fields from JIRA","h2. Environment  * Confluence 6.6.x  * Jira 7.6.x    h2. Steps to Reproduce  # Create a Confluence page.  # Insert the Jira Issues macro.  # Insert a JQL filter and include *only specific custom fields* you require.  # Save the Confluence page.  # Reload the page.  # Review the Jira access log regarding the request called.    h2. Expected Behavior  Only specific custom fields as defined in the Jira issues macro will be searched.  {{field=allcustom}} parameter should be removed.    h2. Actual Behavior  All custom fields are being searched through and it causes the search to be extremely slow especially with instances comprised of large amount of custom fields. {{field=allcustom}} is apparent in the request URL e.g.  {code}  http://localhost:53922/jira763/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery=&field=summary&field=type&field=created&field=updated&field=due&field=assignee&field=allcustom&field=reporter&tempMax=1000  {code}    h2. Workaround  Exclude custom field as column to display under the _Display options_. Please find the differences in the search request URLs below using the same JQL query. Note the {{field=allcustom}} parameter is removed when custom field column is not configured in the display options.  h5. With Custom FIeld  {code}  127.0.0.1 672x266x1 admin [28/Jun/2018:11:12:40 +0200] ""GET /jira/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?tempMax=20&returnMax=true&jqlQuery=project+%3D+Scrum++&field=summary&field=type&field=created&field=updated&field=due&field=assignee&field=reporter&field=priority&field=status&field=resolution&field=allcustom&field=wonderful+choice&field=link HTTP/1.1"" 200 3106 1174 ""-"" ""Apache-HttpClient/4.5.5 (Java/1.8.0_131)"" ""q23bh4""  {code}  h5. Without Custom Field  {code}  127.0.0.1 674x272x1 admin [28/Jun/2018:11:14:05 +0200] ""GET /jira/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?tempMax=20&returnMax=true&jqlQuery=project+%3D+Scrum+++&field=summary&field=type&field=created&field=updated&field=due&field=assignee&field=reporter&field=priority&field=status&field=resolution&field=link HTTP/1.1"" 200 1735 71 ""-"" ""Apache-HttpClient/4.5.5 (Java/1.8.0_131)"" ""lw2vqt""  {code}",5
"CONFSERVER-56088","07/12/2018 03:17:05","JIRA Charts are not available for your version of JIRA. Upgrade to JIRA 6.1.1 or later to use this macro.","h3. Summary    The error message ""{{JIRA Charts are not available for your version of JIRA. Upgrade to JIRA 6.1.1 or later to use this macro}}"" can be presented to users already running versions of Jira higher than 6.1.1.    There appear to be multiple causes for this issue, but any connection failure to Jira appears to result in a value of {{-1}} being stored in cache for the remote Jira version number.    This causes the version check above to fail as {{-1}} is explicitly listed as an unsupported build version.  {code:java|title=DefaultJiraConnectionManager.getServerBuildNumber}  private long getServerBuildNumber(final ReadOnlyApplicationLink appLink) {      try {          ApplicationLinkRequest request = JiraConnectorUtils.getApplicationLinkRequest(appLink, com.atlassian.sal.api.net.Request.MethodType.GET, REST_URL_SERVER_INFO);          request.addHeader(""Content-Type"", MediaType.APPLICATION_JSON);          String responseString = request.execute();          ObjectMapper mapper = new ObjectMapper();          JsonNode rootNode = mapper.readTree(responseString);          return rootNode.path(JSON_PATH_BUILD_NUMBER).getLongValue();      } catch (ResponseStatusException e) // We could connect to Jira Server but the REST URL provided is version 4.x      {          return NOT_SUPPORTED_BUILD_NUMBER;      } catch (Exception e) // In other cases we assume that it is supported version      {          return Long.MAX_VALUE;      }  }  {code}  Additionally, the cache holds this value for 4 hours, so any subsequent requests for the next 4 hours will also fail with this error.  h3. Environment   * Confluence 6.3.2   * Jira 7.3.9    h3. Steps to Reproduce   # Create an AppLink between Confluence and Jira, both behind a Reverse Proxy   # Create a Jira Charts macro (JCM) in Confluence   # Shutdown Jira   # Restart Confluence (with Jira still down)   # Load the page with the JCM   # The Jira macro will fail to Preview   # Start Jira - other JIM macros will work except the Jira Chart will still fail    h3. Expected Results    The JCM should be displayed    h3. Actual Results    The below exception is thrown in the atlassian-confluence.log file:  {code:java|title=Log Output}  2018-06-26 10:22:18,062 WARN [http-nio2-8009-exec-83] [internal.integration.jira.DefaultJiraService] handle Could not parse JIRA server's information: No content to map to Object due to end of input   -- referer: -SNIP- | url: /rest/highlighting/1.0/panel-items | traceId: ac4298b9d4878381 | userName: -SNIP-  2018-06-26 10:22:18,062 WARN [http-nio2-8009-exec-83] [internal.integration.jira.DefaultJiraService] handle Could not parse JIRA server's information: No content to map to Object due to end of input   -- referer: -SNIP- | url: /rest/highlighting/1.0/panel-items | traceId: ac4298b9d4878381 | userName: -SNIP-  2018-06-26 11:43:47,764 ERROR [http-nio2-8009-exec-73] [confluence.plugins.jiracharts.JiraChartMacro] getImagePlaceholder error get image place holder   -- referer: -SNIP- | url: /rest/tinymce/1/content/196968597.json | traceId: 9da19db95d13b833 | userName: -SNIP-  com.atlassian.confluence.macro.MacroExecutionException: JIRA Charts are not available for your version of JIRA. Upgrade to JIRA 6.1.1 or later to use this macro.   at com.atlassian.confluence.plugins.jiracharts.DefaultJQLValidator.validateJiraSupportedVersion(DefaultJQLValidator.java:99)   at com.atlassian.confluence.plugins.jiracharts.DefaultJQLValidator.doValidate(DefaultJQLValidator.java:56)   at com.atlassian.confluence.plugins.jiracharts.JiraChartMacro.getImagePlaceholder(JiraChartMacro.java:127)   ...   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)   at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)   at java.lang.Thread.run(Thread.java:748)  {code}    h3. Validation    To inspect the *Jira build number* that Confluence has in it's cache, open up this URL to the Confluence Server:    * http://<confluence-base-url>/rest/jiraanywhere/1.0/servers    The JSON that returns will show the buildNumber for each of the Jira application link and the failing one should show -1 as the stored *buildNumber*. e.g.    {code}  [{""id"":""983172d9-18a4-3abf-acc9-0397663852e2"",""name"":""Your Company JIRA"",""selected"":true,""url"":""https://myjirasite1.com.au:7443/j723"",""buildNumber"":72005},  { ""id"":""380add4d-626e-369e-9b89-c2f07f7aad53"",""name"":""Your Company JIRA - 2"",""selected"":false,""url"":""https://myjirasite2.com.au:8443/j772"",""buildNumber"":-1}]""  {code}    h3. Notes    This issue often presents as a single occurrence that is resolved when the cache is cleared 4 hours later. In some cases, it can be persistent.  h3. Workaround    Re-indexing appears to correct this issue as in the process, the relevant cache is cleared in the process.    This may not be an acceptable workaround as if connectivity issues persist, the incorrect value will be stored in cache on the next version request.    Additionally, reindexing can be a time and resource expensive process that may rule this out as a fix in production.",3
"CONFSERVER-57788","07/16/2018 05:57:10","Anonymous user sees a broken image for user avatars. ","See screenshot    Need to check if we can replicate this. Avatar of licensed user becomes broken (default avatar + anonymous user avatars are fine).    !Screen Shot 2018-05-01 at 5.33.36 pm.png|width=481,height=212!",2
"CONFSERVER-56118","07/17/2018 20:31:09","NullPointerException when importing calendar from a different instance ","h2. Environment   - Team Calendars 6.0.x    h2. Steps to reproduce   # Create a calendar;   # Add an event with a participant (in the _Who_ field);   # Export the calendar to .ics;   # Import the .ics file in another instance.    h2. Expected behavior    The calendar is imported with no errors.  h2. Actual behavior    NullPointerException appears in the importing window. Confluence logs show the following:  {code:java}  2018-07-12 16:52:01,080 ERROR [http-nio-8090-exec-2] [extra.calendar3.xwork.ImportSubCalendarAction] execute Unable to import events of type other   -- referer: https://confluence.test.com/display/TEST/calendars | url: /plugins/calendar/importsubcalendar.action | traceId: 2902141a06b26b09 | userName: admin | action: importsubcalendar  java.lang.NullPointerException   at com.atlassian.confluence.extra.calendar3.DefaultActiveObjectsServiceWrapper.createInviteeEntity(DefaultActiveObjectsServiceWrapper.java:159)   at com.atlassian.confluence.extra.calendar3.calendarstore.AbstractCalendarDataStore.setSubCalendarContent(AbstractCalendarDataStore.java:1004)   at com.atlassian.confluence.extra.calendar3.calendarstore.AbstractPeopleHandlingSubCalendarDataStore.setSubCalendarContent(AbstractPeopleHandlingSubCalendarDataStore.java:111)  {code}  In spite of that, all the events are imported correctly with no participants - which is expected since the related user identifier (user_key) doesn't exist in the new instance.  ----  h2. Additional details    This bug seems to be caused by a user checker introduced in TC 6 to fix CONFSERVER-55887  h2. Workaround   # Uninstall Team Calendars 6.0.x in the Confluence instance   # Download Team Calendars version [5.3.20|https://marketplace.atlassian.com/download/apps/72307/version/2320]   # Navigate to the *Manage apps* Page   # Select *Upload Apps*   # Choose to upload the *team-calendars-5.3.20.obr* file that was just downloaded in step 2   # Create a new Team Calendar   # Import the ICS file into the newly created Team Calendar   # Once the import is successful, Update the Team calendar to TC 6.0.x (the latest version)",3
"CONFSERVER-56135","07/20/2018 15:21:59","Vimeo videos don't play using the Widget Connector macro","h3. Summary    Vimeo videos that are added with the Widget Connector macro do not play on any version of Confluence or in any platform or browser.  h3. Steps to Reproduce   # Create a page, add the Widget Connector Macro and insert a embed link to a Vimeo video.   # Save and update or publish the page    h3. Expected Results    The video should be embedded and display a thumbnail and the controls for the video.  h3. Actual Results    The screen remains blank.  h3. Notes    Looking at the browser console it's clear that the embed method used in the connector no longer works as the ([https://vimeo.com/moogaloop.swf]) file returns a 404.  h3. Workaround    _For Confluence 6.6+_, install Widget Connector 3.1.2: [^widgetconnector-3.1.2.jar]. {color:#FF0000}*This will not work in Confluence 6.5 and lower.*{color}    _For Confluence 6.5 and lower_:    There is no workaround in the macro itself, however a user macro can be created instead as an alternative using the below code which will use the iframe embed method instead.  {code:java}  ## Vimeo video macro  ## @param URL:title=Video URL|type=string|required=true|desc=Enter the full Vimeo URL (e.g. https://player.vimeo.com/video/223136582 )  ## @param Width:title=Width|type=int|required=true|default=640|desc=Player width in pixels (e.g. 640)  ## @param Height:title=Height|type=int|required=true|default=360|desc=Player height in pixels (e.g. 360)    <iframe src=""$paramURL"" width=""$paramWidth"" height=""$paramHeight"" frameborder=""0"" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>  {code}",2
"CONFSERVER-56148","07/23/2018 16:22:30","Intermittent NPE errors when using one or more Page Property Macro or any other macro","h3. Summary    Seeing intermittent NPE and System Errors on a Page Properties Report Macro page. The page doesn't load and redirects to a 500 error page.   (!) It is also possible to encounter this bug through a different macro that uses the same code path and throws the same underlying error.  h3. Steps to Reproduce   # Download and restore [^PPM1space.xml.zip] to a Confluence instance   ** This space XML provide 900 pages that contains Page Properties Macro with label ""discussions""   ** One of the page (titled ""1"") contains an image that will be fetched by the Page Properties Report Macro   # Download and restore [^PPM2space.xml.zip]   ** This space contains a page with Page Properties Report Macro that fetches all pages in this site, labeled ""decisions""   # Go to PPM2 > Page Properties Report Macro page    h3. Expected Results    All pages are fetched as expected  h3. Actual Results    Seeing Intermittent errors on this page, on each reload.    The errors initially doesn't give us more details as the JVM might me ommitting the stacktrace as part of  {code:java}  2019-01-03 14:45:24,397 ERROR [http-nio-8443-exec-2 url:/display/AAAAAA username:some-user url:/pages/viewpage.action username:some-user] [xhtml.view.macro.ViewMacroMarshaller] handleMacroExecutionException Error rendering macro: detailssummary   -- url: /display/AAAAAA | page: 420525059 | traceId: bfa1b75efe717c31 | userName: some-user | referer: https://confluence-base-url/display/AAAAAA | action: viewpage  java.lang.NullPointerException  {code}  In order to inspect the full stack trace, we need to disable the JVM optimization by adding the following JVM argument  {code:java}  -XX:-OmitStackTraceInFastThrow  {code}  The full stacktrace looks like this:  {code:java}  2019-01-15 14:50:05,276 ERROR [http-nio-8443-exec-4 url:/pages/viewpage.action username:some-user ] [xhtml.view.macro.ViewMacroMarshaller] handleMacroExecutionException Error rendering macro: detailssummary   -- url: /pages/viewpage.action | page: 374370875 | traceId: c285cc1c66d92529 | userName: some-user | referer: https://confluence-base-url/login.action?os_destination=%2Fpages%2Fviewpage.action%3FspaceKey%3DISAAAE%26title%3DAAAAA%2Bfollowup&permissionViolation=true | action: viewpage  java.lang.NullPointerException   at org.hibernate.event.internal.AbstractFlushingEventListener.prepareEntityFlushes(AbstractFlushingEventListener.java:138)   at org.hibernate.event.internal.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:74)   at org.hibernate.event.internal.DefaultAutoFlushEventListener.onAutoFlush(DefaultAutoFlushEventListener.java:44)   at org.hibernate.internal.SessionImpl.autoFlushIfRequired(SessionImpl.java:1389)   at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1474)   at org.hibernate.query.internal.AbstractProducedQuery.doList(AbstractProducedQuery.java:1441)   at org.hibernate.query.internal.AbstractProducedQuery.list(AbstractProducedQuery.java:1410)   at com.atlassian.confluence.spaces.persistence.dao.hibernate.HibernateSpaceDao.lambda$findSpaceKeysWithStatus$6(HibernateSpaceDao.java:335)   at org.springframework.orm.hibernate5.HibernateTemplate.doExecute(HibernateTemplate.java:359)   at org.springframework.orm.hibernate5.HibernateTemplate.execute(HibernateTemplate.java:313)   at com.atlassian.confluence.spaces.persistence.dao.hibernate.HibernateSpaceDao.findSpaceKeysWithStatus(HibernateSpaceDao.java:331)   at com.atlassian.confluence.spaces.DefaultSpaceManager.getAllSpaceKeys(DefaultSpaceManager.java:773)   at sun.reflect.GeneratedMethodAccessor1148.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:498)   at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:302)   at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)   at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99)   at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:281)   at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)   at com.atlassian.spring.interceptors.SpringProfilingInterceptor.invoke(SpringProfilingInterceptor.java:16)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)   at com.atlassian.confluence.util.profiling.ConfluenceMonitoringMethodInterceptor.invoke(ConfluenceMonitoringMethodInterceptor.java:34)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)   at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:208)   at com.sun.proxy.$Proxy92.getAllSpaceKeys(Unknown Source)   at com.atlassian.confluence.search.v2.lucene.mapper.ArchivedSpacesSearchFilterMapper.convertToLuceneSearchFilter(ArchivedSpacesSearchFilterMapper.java:17)   at com.atlassian.confluence.search.v2.lucene.mapper.ArchivedSpacesSearchFilterMapper.convertToLuceneSearchFilter(ArchivedSpacesSearchFilterMapper.java:12)   at com.atlassian.confluence.search.v2.lucene.DelegatingLuceneSearchMapper.convertToLuceneSearchFilter(DelegatingLuceneSearchMapper.java:68)   at com.atlassian.confluence.search.v2.lucene.mapper.BooleanSearchFilterMapper.lambda$convertToLuceneSearchFilter$0(BooleanSearchFilterMapper.java:18)   at java.util.HashMap$KeySpliterator.forEachRemaining(HashMap.java:1553)   at java.util.stream.ReferencePipeline$Head.forEach(ReferencePipeline.java:580)   at com.atlassian.confluence.search.v2.lucene.mapper.BooleanSearchFilterMapper.convertToLuceneSearchFilter(BooleanSearchFilterMapper.java:18)   at com.atlassian.confluence.search.v2.lucene.mapper.BooleanSearchFilterMapper.convertToLuceneSearchFilter(BooleanSearchFilterMapper.java:10)   at com.atlassian.confluence.search.v2.lucene.DelegatingLuceneSearchMapper.convertToLuceneSearchFilter(DelegatingLuceneSearchMapper.java:68)   at com.atlassian.confluence.search.v2.lucene.LuceneSearchManager.toLuceneFilter(LuceneSearchManager.java:244)   at com.atlassian.confluence.search.v2.lucene.LuceneSearchManager.search(LuceneSearchManager.java:146)   at sun.reflect.GeneratedMethodAccessor1018.invoke(Unknown Source)  ....  {code}  The same behavior could cause the following stacktrace as well:  {code:java}  Cause  java.lang.NullPointerException      at org.hibernate.engine.internal.StatefulPersistenceContext.clear(StatefulPersistenceContext.java:234)  {code}  or  {code:java}  Cause  org.springframework.orm.hibernate.HibernateSystemException: Found shared references to a collection: com.atlassian.confluence.spaces.Space.permissions; nested exception is net.sf.hibernate.HibernateException: Found shared references to a collection: com.atlassian.confluence.spaces.Space.permissions      at org.springframework.orm.hibernate.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:597)    caused by: net.sf.hibernate.HibernateException: Found shared references to a collection: com.atlassian.confluence.spaces.Space.permissions      at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:147)  {code}  or  {code:java}  Cause  org.springframework.orm.hibernate.HibernateSystemException: Found shared references to a collection: com.atlassian.confluence.core.ContentEntityObject.outgoingLinks; nested exception is net.sf.hibernate.HibernateException: Found shared references to a collection: com.atlassian.confluence.core.ContentEntityObject.outgoingLinks      at org.springframework.orm.hibernate.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:597)    caused by: net.sf.hibernate.HibernateException: Found shared references to a collection: com.atlassian.confluence.core.ContentEntityObject.outgoingLinks      at org.hibernate.internal.ExceptionConverterImpl.convert(ExceptionConverterImpl.java:147)  {code}  Watch the gif for more info:   * [^z0Qt3emhop.gif]    h3. Notes    The following points are observed:   # Issue is more pertinent when the PPRM filter is above 200   # Issue is *observed* when the PPRM is calling any sort of rich content (images, plugins, macros,etc)   # Issue is *not observed yet* with PPRM located in the same space as the pages with the PPM   # Issue is *not observed* when the image/rich content is removed   # Page Properties Report Caches are already on 50% utilization    h3. Cause    This issue is caused by a hibernate bug tracked here [https://hibernate.atlassian.net/browse/HHH-7867]. Some work has been done to alleviate and fix a part of this which can be found here [https://hibernate.atlassian.net/browse/HHH-10562].  h3. Workaround    There is nothing much we can do on our side until this bug is fixed on hibernate side. However, some users were able to avoid this by reducing the amount of Page Properties Macro fetched to 50 or below.",3
"CONFSERVER-56183","07/31/2018 04:53:31","Multiple collaborators shown even when collaborative editing is off","h2. Issue Summary    It is currently possible to get into a state where Collaborative Editing is off and the page history still shows multiple contributors.  h2. Steps to reproduce   # Turn off Collaborative Editing.   # Publish a new page (Page History will show it as V1 - Version 1).   # Edit this page as User A and User B at the same time.   # User A and User B commit their changes to the page, creating two new versions.   # Page History shows a version (V3) *Changed By* both users:   !Screen Shot 2018-07-30 at 16.57.25.png|thumbnail!    h2. What happened?    The history shows that both User A and User B contributed to version 3.  h2. What should have happened?    Only one of the users should have contributed to version 2 and 3.  h2. Impact    It is not possible to know through the UI which changes have been introduced by User A and which changes have been introduced by User B.  h2. Workaround    Login as a system administrator, go to the dark features page at <your Confluence url>/admin/darkfeatures.action and add the following dark feature: *collaborative-audit-log.disable*    Page history will now only show the user that published the page in the history.",2
"CONFSERVER-56186","07/31/2018 06:59:54","Confluence doesn't get installed as a service even when the installer is run as root in Ubuntu","h2. *Summary*    According to the [guide|https://confluence.atlassian.com/doc/installing-confluence-on-linux-143556824.html] of installing Confluence on Linux Server, if the installer is run as root, Confluence will be installed as a service. Although, it doesn't get installed as a service on Ubuntu.  h2. *Testing Environment*    Ubuntu 18.04 LTS   Confluence installer 6.10.1  h2. *Steps to reproduce*   # Download installer of Confluence.   # Add the execute flag to the installer.   # Run the installer as root.    h2. *Expected Results*    Confluence should be installed as a service.  h2. *Actual Result*    Confluence doesn't get installed as a service.  h2. *Workaround*    Installer does create the {{/etc/init.d/confluence}} file, though it doesn't have the run levels in it.  So, if we will directly _enable_ the service, Ubuntu throws an error.  {code}  update-rc.d: error: confluence Default-Start contains no runlevels, aborting.  {code}  We need to add the following lines on the top of {{/etc/init.d/confluence}} file, but after the shebang.  {code:java}  ### BEGIN INIT INFO  # Required-Start:    $all  # Required-Stop:  # Default-Start:     2 3 4 5  # Default-Stop:  ### END INIT INFO  {code}  After the above change, run the following command again to install Confluence as a service.  {code:java}  systemctl enable confluence  {code}    h2. *Diagnosis*    This issue does not happen in CentOS, which means it might be an issue with {{update-rc.d}} scripts in Ubuntu.      ",3
"CONFSERVER-56238","08/07/2018 05:20:34","The bundled Atlassian Universal Plugin Manager plugin had a XXE issue - CVE-2018-20233","The version of the bundled Atlassian Universal Plugin Manager plugin had a XML External Entity vulnerability that allowed remote attackers with system administrator privileges to read files, make network requests and perform a denial of service attack via an XML External Entity vulnerability in the parsing of atlassian plugin xml files in an uploaded JAR. See https://ecosystem.atlassian.net/browse/UPM-5964 for more details.",2
"CONFSERVER-56354","08/07/2018 15:22:51","User's username remains indexed in search after GDPR steps","*Description:*    After running GDPR scripts and following listed GDPR steps (including flushing index queue), user's username remains indexed from previous mentions tag when doing a full site search.     *This affects all versions of Confluence.*    *Steps:*   # Mention user on a page and publish it.   # Disable user   # Run scripts   # Clear cache   # Flush queue    # Do a full search for user's username   # Observe username is visible     *Expected:*    No results are returned    *Actual:*    **Search results are returned that have the user's username visible.     !image-2018-08-08-00-20-27-501.png|width=496,height=239!    Clicking on the link shows unknown user   !image-2018-08-08-00-22-32-591.png|width=744,height=56!",5
"CONFSERVER-56252","08/09/2018 03:02:59","Drafts can't save attachments via insert option, with Collaborative Editing Off","h3. *Summary*    With Collaborative Editing *Off* the following situation exists:  * New drafts can't save attachments via upload attachment option.  * Drafts of existing pages can save attachments, as usual.    h3. *Steps to Reproduce*    # Ensure Collaborative Editing is Off.  # Create a new page, give it a title and a few line.  # Select *Close*.  # From the profile picture navigate to Drafts.  # Open the draft for editing again.  # Upload attachment via *Insert files and images* option.    h3. *Expected Results*    The attachment should upload to the draft.    h3. *Actual Results*    The attachment pop-up never gives the option to *Insert*. The only option is to *Close*.    h3. *Workaround*  Try one of the following two:  # Drag and Drop the attachment on to the editor.  # Enable Collaborative Editing.    h3. *Diagnosis*    Confluence returns a 400 bad request to the request from the browser.  {code}          ""request"": {            ""method"": ""GET"",            ""url"": ""http://localhost:26101/c6101/rest/api/content/1376273/child/attachment?expand=version,container,space&_=1533779492837"",  .  .    ""text"": ""{\""statusCode\"":400,\""data\"":{\""authorized\"":false,\""valid\"":true,\""allowedInReadOnlyMode\"":true,\""errors\"":[],\""successful\"":false},\""message\"":\""The entity Draft = { id: 1376273, type: page, title: saving a second draft, pageId: 0, pageVersion: 0} is not ContentConvertible or API available\"",\""reason\"":\""Bad Request\""}""  {code}    The symptoms are similar to CONFSERVER-38719.    If we try an upload again, we see the following error.   !server_ unavailable.png|thumbnail!     In application logs, we see something like following.   {code}  2018-08-09 12:32:55,098 WARN [http-nio-26101-exec-1] [confluence.impl.hibernate.ConfluenceHibernateTransactionManager] doRollback Performing rollback. Transactions:    ->[com.atlassian.confluence.api.impl.service.content.AttachmentServiceImpl$AttachmentFinderImpl.fetchMany]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT,readOnly (Session #564908989)   -- referer: http://localhost:26101/c6101/pages/createpage.action?useDraft=true&spaceKey=~admin&draftId=1376296& | url: /c6101/rest/api/content/1376296/child/attachment | traceId: 9bae05c239ca5de7 | userName: admin  {code}  h3. *Additional Notes*    Upon testing this in Confluence v6.6.7, this issue doesn't happen. This version actually uses a different request method to upload attachments.  {code}          ""request"": {            ""method"": ""GET"",            ""url"": ""http://localhost:2667/c667/rest/prototype/1/content/1146888/attachments.json?_=1533780994036"",  {code}",2
"CONFSERVER-56263","08/13/2018 05:24:40","Attachments don't load in Confluence Questions in certain cases","Tested with: Confluence 6.9.0 + Confluence Questions 2.6.11   Anonymous accessible space + anonymous accessible questions  h3. *Admin user testing*  ||Number||Test Case||Posting user can see image||Another admin in another browser can see it||Non-admin can see it||Anonymous user can see it||  |1|*Admin posted picture into Question*|(/)|(/)|(/)|(/)|  |2|*Admin posted picture into Answer*|(/)|(/)|(x) |(x) |  |3|*Admin edited Answer and re-upload image*|(/)|(/)|(/)|(/)|  |4|*Admin posted image with no text into answer, error returned and then attempt to append text and and save*|(/)|(/)|(/)|(x) |  |5|*Admin posted image with no label into question, error returned and then attempt to append text and and save*|(/)|(/)|(/)|(/)|  |6|*Admin posted picture into Comment under question*|(/)|(/)|(/)|(x)|  |7|*Admin posted picture into Comment under answer*|(/)|(/)|(/)|(x)|  |8|*Admin edited Comment under Qn and re-upload image*|(/)|(/)|(/)|(x) |  |9|*Admin edited Comment under Ans and re-upload image*|(/)|(/)|(/)|(x) |  |10|*Admin posted picture with no text, error returned and then append text into Comment*|(/)|(/)|(/)|(x) |  |11|*Admin posted picture into Answer and 'convert to Comment' off Question*|(/)|(/)|(x)|(x) |  |12|*Admin posted picture into Answer and 'convert to Comment' off Answer*|(/)|(/)|(x)|(x)|  |13|*Admin posted picture into Comment off Answer and 'convert to Answer'*|(/)|(/)|(/)|(x)|  |14|*Admin posted picture into Comment off Question and 'convert to Answer'*|(/)|(/)|(/)|(x) |  h3. *NonAdmin user testing*  ||Number||Test Case||Posting user can see image||Another admin in another browser can see it||Non-admin can see it||Anonymous user can see it||  |1|*Non-Admin posted picture into Question*|(/)|(/)|(/)|(/)|  |2|*Non-Admin posted picture into Answer*|(x) |(/)|(x)|(x) |  |3|*Non-Admin edited Answer and re-upload image*|(/)|(/)|(/)|(/)|  |4|*Non-Admin posted image with no text into answer, error returned and then attempt to append text and and save*|(/)|(/)|(/)|(x) |  |5|*Non-Admin posted image with no label into question, error returned and then attempt to append text and and save*|(/)|(/)|(/)|(/)|  |6|*Non-Admin posted picture into Comment under question*|(/)|(/)|(/)|(x) |  |7|*Non-Admin posted picture into Comment under answer*|(/)|(/)|(/)|(x)|  |8|*Non-Admin edited Comment under Qn and re-upload image*|(/)|(/)|(/)|(x) |  |9|*Non-Admin edited Comment under Ans and re-upload image*|(/)|(/)|(/)|(x) |  |10|*Non-Admin posted picture with no text, error returned and then append text into Comment*|(/)|(/)|(/)|(x)|  |11|*Non-Admin posted picture into Answer and 'convert to Comment' off Question*|(x)|(/)|(x)|(x) |  |12|*Non-Admin posted picture into Answer and 'convert to Comment' off Answer*|(x)|(/)|(x)|(x)|  |13|*Non-Admin posted picture into Comment off Answer and 'convert to Answer'*|(/)|(/)|(/)|(x) |  |14|*Non-Admin posted picture into Comment off Question and 'convert to Answer'*|(/)|(/)|(/)|(x) |    I can confirm that the above failed test cases under *Non-admin can see it* still fails under Confluence 6.10.2 / CQ 2.6.11   I can confirm all other above failed test cases is still failing under Confluence 6.10.2 / CQ 2.6.11  h3. *Viewing by Anonymous User - end user experience*    !NoImages-Qns.png|width=154,height=333!",5
"CONFSERVER-56307","08/20/2018 09:16:03","Companion app's ""Launch on startup"" does not work if Windows user has username with spaces","The Atlassian Companion app has an option to ""Launch on startup"", which creates a registry entry in Windows, for just that.   There is an issue with Windows however, where sometimes, it's unable to launch a program if there's space in between a user name.    For example,   *Does not work:* C:\Users\user name\AppData\Local\atlassian-desktop-companion\Atlassian Companion.exe --was-opened-at-login   *Works:* C:\Users\username\AppData\Local\atlassian-desktop-companion\Atlassian Companion.exe --was-opened-at-login    This seems to be a Windows issue, since it should be able to launch the app, even if the path has spaces in it, but it just does not work on certain Windows install for some reason.   [https://answers.microsoft.com/en-us/windows/forum/all/on-startup-windows-tries-to-open-a-file-but-cant/420aae7f-be93-4f6b-9bc5-b75d01c0fca0]   [https://stackoverflow.com/questions/2919286/getting-the-username-from-the-hkey-users-values]   [https://superuser.com/questions/479105/how-can-i-format-this-path-to-work-as-registry-key-value]   [https://answers.microsoft.com/en-us/windows/forum/windows_10-other_settings/windows-10-upgrade-issue-with-space-in-username/3ea1a411-2c59-4d2a-bda1-d48b9793231f]    *Workaround:*   We can workaround the issue by editing the registry entry, and add quotes around the whole path.   *HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\com.squirrel.atlassian-desktop-companion.AtlassianCompanion*""C:\Users\user name\AppData\Local\atlassian-desktop-companion\Atlassian Companion.exe --was-opened-at-login"".    This works, but once the App starts, it updates the path again, and removed the quotes, and so we have to do this again before restart, after the app starts.    *Suggestion:*   We should add quotes around the path as a preventative measure, so that users with this issue are able to have the app launch on startup.",2
"CONFSERVER-56309","08/20/2018 16:04:21","Macros nested inside other macros are corrupted if original macro is disabled or not installed","Confluence will corrupt nested macros inside a unknown macro, leading to data loss in the page storage. The bug lies in the XhtmlContent's implementation and what the class does when a macro definition does not exists or it's not available.    When the xhtmlContent.handleMacroDefinitions method is called with a block of xhtml content which contains a reference to a macro module that has been disabled it will return invalid data - such that it ignores the macros that the disabled macro contains and will conflate the parameters of those macros into the disable MacroDefinition.    xhtmlContent.handleMacroDefinitions will generates invalid data leading to data loss.    In the page we will see this image:   !image1.png|thumbnail!   And if we edit the page, nothing will appear inside the macro:   !image2.png|thumbnail!     The storage format shows that the data exist in the page and the following error appears in the logs:  {code}  handleMacroExecutionException Exception executing macro: jira-form-wrapper, with message: Unable to locate projectKey input, use the blueprint to generate a new form and copy/paste the macro back in to the form.  {code}    h4. Replicating the issue  {code}  <ac:structured-macro ac:name=""unknown-macro"" ac:schema-version=""1"" ac:macro-id=""dcbc25a6-6b81-40bf-9ef8-7a687af59538"">   <ac:rich-text-body>   <ac:structured-macro ac:name=""simple-macro"" ac:schema-version=""1"" ac:macro-id=""dcbc25a6-6b81-40bf-9ef8-7a687af59538"">   <ac:parameter ac:name=""simple-macro-param"">aaa</ac:parameter>   <ac:parameter ac:name=""atlassian-macro-output-type"">INLINE</ac:parameter>   <ac:rich-text-body>   <p class=""auto-cursor-target""><br/></p>   <ac:structured-macro ac:name=""info"" ac:schema-version=""1"" ac:macro-id=""3caf2e75-1b55-48cf-9810-fa3884dd8f94"">   <ac:parameter ac:name=""info-macro-param"">bbb</ac:parameter>   <ac:parameter ac:name=""icon"">false</ac:parameter>   <ac:parameter ac:name=""title"">title</ac:parameter>   <ac:rich-text-body>   <p>this is some content</p></ac:rich-text-body>   </ac:structured-macro>   <p class=""auto-cursor-target""><br/></p>   </ac:rich-text-body>   </ac:structured-macro>   </ac:rich-text-body>  </ac:structured-macro>  {code}  The ""info"" above is the standard info macro and simple macro was a test macro created to just return the body.    When this situation arises, a call to xhtmlContent.handleMacroDefinitions will result in the first MacroDefinition passed to the MacroDefinitionHandler.handle method being corrupted - the MacroDefinition will have no body, and all of the parameters of the child macros will be conflated into the corrupt definition.    On the event, this bug caused the F4C (Forms for Confluence) migrator to attempt to migrate the content based on invalid data, and thus corrupted the pages.    In the test, if we used the following storage format:  {code}  <ac:structured-macro ac:name=""simple-macro"" ac:schema-version=""1"" ac:macro-id=""dcbc25a6-6b81-40bf-9ef8-7a687af59538"">      <ac:parameter ac:name=""simplemacroarg"">arg</ac:parameter>      <ac:rich-text-body>          <p class=""auto-cursor-target""><br/></p>          <ac:structured-macro ac:name=""other-macro"" ac:schema-version=""1"" ac:macro-id=""3caf2e75-1b55-48cf-9810-fa3884dd8f94"">              <ac:parameter ac:name=""othermacroarg"">arg</ac:parameter>              <ac:rich-text-body>                  <ac:structured-macro ac:name=""warn"" ac:schema-version=""1"" ac:macro-id=""3caf2e75-1b55-48cf-9810-fa3884dd8f94"">                      <ac:parameter ac:name=""icon"">false</ac:parameter>                      <ac:parameter ac:name=""title"">title</ac:parameter>                      <ac:rich-text-body>                          <p>this is some content</p></ac:rich-text-body>                  </ac:structured-macro>              </ac:rich-text-body>          </ac:structured-macro>          <p class=""auto-cursor-target""><br/></p>          <ac:structured-macro ac:name=""info"" ac:schema-version=""1"" ac:macro-id=""3caf2e75-1b55-48cf-9810-fa3884dd8f94"">              <ac:parameter ac:name=""icon"">false</ac:parameter>              <ac:parameter ac:name=""title"">title</ac:parameter>              <ac:rich-text-body>                  <p>this is some content</p></ac:rich-text-body>          </ac:structured-macro>          <p class=""auto-cursor-target""><br/></p>      </ac:rich-text-body>  </ac:structured-macro>  {code}  With both ""Simple-macro"" and ""other-macro"" enabled, we get these results from the test plugin (which iterates across the macro definitions found by XhtmlContent and outputs the parameters and values)    {code}  [INFO] [talledLocalContainer] ----------------------------------  [INFO] [talledLocalContainer] All macros enabled  [INFO] [talledLocalContainer]  [INFO] [talledLocalContainer] warn  [INFO] [talledLocalContainer]     icon = false  [INFO] [talledLocalContainer]     title = title  [INFO] [talledLocalContainer]  [INFO] [talledLocalContainer] other-macro  [INFO] [talledLocalContainer]     othermacroarg = arg  [INFO] [talledLocalContainer]  [INFO] [talledLocalContainer] info  [INFO] [talledLocalContainer]     icon = false  [INFO] [talledLocalContainer]     title = title  [INFO] [talledLocalContainer]  [INFO] [talledLocalContainer] simple-macro  [INFO] [talledLocalContainer]     simplemacroarg = arg  [INFO] [talledLocalContainer]  {code}    However, if the ""other-macro"" have it's module disabled, we see that the ""warn"" macro content disappears and the arguments are conflated ito the ""other-macro"" definition.  {code}  [INFO] [talledLocalContainer] ----------------------------------  [INFO] [talledLocalContainer] With other-macro disabled  [INFO] [talledLocalContainer]  [INFO] [talledLocalContainer] other-macro  [INFO] [talledLocalContainer]     icon = false  [INFO] [talledLocalContainer]     othermacroarg = arg  [INFO] [talledLocalContainer]     title = title  [INFO] [talledLocalContainer]  [INFO] [talledLocalContainer] info  [INFO] [talledLocalContainer]     icon = false  [INFO] [talledLocalContainer]     title = title  [INFO] [talledLocalContainer]  [INFO] [talledLocalContainer] simple-macro  [INFO] [talledLocalContainer]     simplemacroarg = arg  [INFO] [talledLocalContainer]  {code}  This will cause data loss on all pages that uses the disabled macro and a separate macro migration tries to use the XhtmlContent to convert markup to MacroDefinition objects so that they can be adjusted and then reformatted out to migrate the content to the new format.    h4. Workaround    Reverting to the page last version fixes the problem, however not all pages have a previous version so it might require a manual intervention to restore an old backup into a staging instance and manually restore lost page contents to production.",3
"CONFSERVER-56316","08/22/2018 10:18:10","Add back the ""Edit in Office"" option for the  Attachments macro","In Confluence 6.11, the *Attachments* macro is missing the *Edit in Office* button.   !Capture2.PNG|thumbnail!    This is probably because the option has been depreciated from the *View File* macros, with the addition of the *Confluence Companion App*.   CONFSERVER-56315    There is no mention that this function would be removed from the *Attachments* macro, and so, the option should be there, and be able to work with the *Confluence Companion App* instead.    The current process to edit is to first preview the file, and then use the *Edit with* option.   It would be better if we can have the *Edit with* option without the need to first preview the file.         {panel:title=Atlassian update - 17 June 2019|borderStyle=none|borderColor=#6554c0|titleBGColor=#eae6ff|bgColor=#eae6ff}    We've heard your feedback about the Edit in Office feature and the Companion App, and made some changes to better meet your needs. Read our Community post for all the details:   [Changes to the Companion App in Confluence 6.15.5 and 6.13.6|[https://community.atlassian.com/t5/Confluence-articles/Changes-to-the-Companion-App-in-Confluence-6-15-5-and-6-13-6/ba-p/1108896]]    Thanks    Makisa | Senior Product Manager, Confluence Server    {panel}",2
"CONFSERVER-56317","08/22/2018 10:29:08","Direct link to ""edit with"" for attachments without going through preview","Starting Confluence 6.11, the *View File* macros, which were depreciated since [2015|https://confluence.atlassian.com/conf69/end-of-support-announcements-for-confluence-950285781.html#EndofSupportAnnouncementsforConfluence-DeprecatedmacrosforConfluence(13November2015)], have lost the the *Edit Document* link.   !Capture.PNG|thumbnail!     Since this macro is depreciated, the current supported method of adding files is using the *Insert > Files and Images* option.    To edit the file using the OS's editor, we will first have to preview the file, and trigger the *Edit with* option of the Companion app.    It would be great if we can have a link to directly edit the file, without going through the preview, like we were able to using the *View File* macros before.",5
"CONFSERVER-56353","08/30/2018 00:40:16","Attachments don't load in comments in Confluence Questions","Steps to reproduce:    - Create new question   - Don't refresh page and also create new comment under that question with attachment  - Don't refresh page and create an answer with an attachment    Expecting  An Attachment in comment will be show     Actual  There is unknown attachment place holder instead of attachment image",3
"CONFSERVER-56414","09/13/2018 11:55:19","Valid drafts are being removed as a stale draft when we restart Collaborative Editing","h3. Summary  Based on the [removeStaleSharedDrafts class|https://docs.atlassian.com/atlassian-confluence/6.2.0/com/atlassian/confluence/pages/PageManager.html#removeStaleSharedDrafts--], a stale draft is defined as:  {quote}Pages with a {{content_status}} '*draft*' and which have a last modified date that is earlier than or equal to the last modified date on the published page.{quote}  However, it is possible that a draft is marked as stale only by definition but in theory, it is still a valid draft. Refer to the 'Steps to reproduce' section for more information.    h3. Steps to reproduce  # Create a new page and insert a task to the page.  # Publish the page.  # Edit the page again to add some text, then close the editor while opting to save it as a draft.  # Run the query in [How to manually remove Stale Drafts from Confluence Database|https://confluence.atlassian.com/confkb/how-to-manually-remove-stale-drafts-from-confluence-database-951392345.html] to confirm that a stale draft doesn't exist yet in the DB.   {code}SELECT d.contentid, d.title, d.prevver, d.lastmoddate, c.lastmoddate  FROM CONTENT d  JOIN CONTENT c    ON d.prevver = c.contentid  WHERE d.content_status = 'draft'    AND d.prevver IS NOT NULL    AND c.lastmoddate > d.lastmoddate;{code}  # On the page in 'View' mode, mark the task as completed. This creates a new version of the page without the draft being published.  # Run the query in step #4 again and we will see that there is one stale draft.  # Set Collaborative Editing to 'Off' or 'Limited' and then to 'On' to trigger the stale draft removal process.    h3. Expected results  The draft should not be removed despite it fitting the definition/criteria of a stale draft.    h3. Actual results  The draft is removed because the draft's {{lastmoddate}} is earlier than the page's {{lastmoddate}}, which fits the definition of a stale draft.    h3. Workaround  Before turning Collaborative Editing ON you can retrieve information from possibly affected pages by running the query below.  With that information, Confluence administrators will be able to share the draft content if a user asks for it.    This query will list the following attributes:   * Draft ID   * Draft last modify date   * Draft storage format   * Current version pageID   * Link to the current page   * Creator username   * Last modifier username   * Last modify date    {code:language=SQL}  SELECT  DISTINCT(d.contentid) AS DRAFT_ID, d.lastmoddate AS DRAFT_LAST_MOD_DATE, bd.body AS DRAFT_STORAGE_FORMAT, c.contentid AS CURRENT_VERSION_ID, '<Confluence Base URL>/viewpage.action?pageId='||c.contentid AS CURRENT_VERSION_LINK, umc.lower_username AS CURRENT_VERSION_CREATOR, umcm.lower_username AS CURRENT_VERSION_LAST_MODIFIER, c.lastmoddate AS CURRENT_VERSION_LASTMODDATE  FROM CONTENT d  JOIN CONTENT c ON d.prevver = c.contentid  JOIN ""AO_BAF3AA_AOINLINE_TASK"" i ON d.prevver = i.""CONTENT_ID""  JOIN BODYCONTENT bd ON bd.contentid = d.contentid  JOIN USER_MAPPING umc ON umc.user_key = c.creator  JOIN USER_MAPPING umcm ON umcm.user_key = c.lastmodifier  WHERE d.content_status = 'draft'    AND d.prevver IS NOT NULL    AND c.lastmoddate > d.lastmoddate    AND (i.""COMPLETE_DATE"" > d.lastmoddate OR i.""UPDATE_DATE"" > d.lastmoddate)  ;  {code}",5
"CONFSERVER-56444","09/20/2018 11:16:42","Edit in App does not work when Confluence is integrated with Crowd SSO","h2. *Summary*    When clicking on the *Edit with <App>* in the attachment preview page, the registered application (such as Word) will throw an error that downloaded file is corrupt.    h2. *Steps to reproduce*    # Install Confluence 6.11.0 + Companion App  # Attach a word document to a Confluence page  # Click on the word document to show in Preview  # Click on the *Edit with Word*  #* Word opens the document fine (/)  # Now, integrate Confluence with Crowd SSO  #* Repeat the above test by clicking on the *Edit with Word*  #* An error will be thrown back saying 'downloaded file is corrupt' (x)    h2. *Expected Result*    Clicking the *Edit with <App>* should work with Confluence regardless whether Confluence is integrated with Crowd SSO.    h2. *Cause*    When Confluence is integrated with Crowd SSO, the Companion App is unable to download the attachment for editing from Confluence. This results in a login HTML downloaded as the contents of the attachment download.    h2. *Validation*    Open up the Companion App Temp folder and open up the download file.    * *Windows*: C:\Users\username\.atlassian-companion\<hash>\file (Note: The user may need to ""Show hidden files and folders"" to view this folder)  * *Mac*: ~/.atlassian-companion/<hash>/file    The downloaded file contain HTML contents instead of the actual attachment contents. Renaming this file to .html and opening in a Browser will show that the downloaded contents is a Confluence login page.",3
"CONFSERVER-56469","09/25/2018 13:17:25","""Uploaded from Companion app"" not translated to other supported languages.","When a new version of an attachment is uploaded after being edited with a Companion App, a comment is added for that version of the attachment that says ""Uploaded from Companion app"".    If the user uses some other language from their Profile, the sentence above is not translated properly.    !Capture.PNG|width=420,height=186!    In the screenshot above, starting from the bottom, the user's language was set to first, English, then Russian, then Chinese, and the one on top is Spanish.",3
"CONFSERVER-56564","10/05/2018 22:50:48","Powerpoint macro still has a button for the deprecated ""Edit in office"" functionality","h3. Summary    The ""Edit in Office"" functionality [was replaced with the Companion App in Confluence 6.11|https://confluence.atlassian.com/doc/confluence-6-11-release-notes-953678666.html#Confluence6.11ReleaseNotes-Abetterwaytoeditfiles]. However, the Office Powerpoint macro still has a non-functional ""Edit in Office"" button.  h3. Steps to Reproduce   # Attach a powerpoint file to a page.   # Edit the page and add an Office Powerpoint macro to display the macro.   # Save the page.    h3. Expected Results    The macro will have a button that allows you to edit in Office, or no button at all.  h3. Actual Results    There is an edit button that says ""Edit in office"" when you hover over it, and clicking the button has no effect.    !edit_in_office_button.png|thumbnail!  h3. Workaround    Add a link to the file on the page to open the preview, then use the ""Edit with"" dropdown as described on [Edit Files|https://confluence.atlassian.com/doc/edit-files-170494553.html].",3
"CONFSERVER-57370","10/16/2018 14:43:44","Companion App creates "".tmp.node"" files in user's local appdata directory","The Atlassian Companion app creates temporary executable binaries (.tmp.node files) within the ""C:\Users\username\AppData\Local\Temp"" directory each time that it runs. These may be falsely flagged by anti-malware software as they are not signed.     These files should not be created, instead they should be executed from Companion's install directory. ",3
"CONFSERVER-57445","10/31/2018 15:26:03","Disable update check for Companion App MSI","The Page [Administering the Atlassian Companion App|https://confluence.atlassian.com/doc/administering-the-atlassian-companion-app-958456281.html] states that by using the MSI, the app won't automatically get the updates.  {quote}If you deploy using the Microsoft Installer, the Companion app won’t automatically get the latest updates, including security and bug fixes, so some maintenance is required.  {quote}  While this is true, the logs are flooded with update checks on every few minutes  {code:sql}  {""namespace"":""adc:auto-updater"",""date"":""2018-10-29T09:46:05.590Z"",""message"":[""update error"",{""message"":""Can not find Squirrel"",""stack"":""Error: Can not find Squirrel\n at AutoUpdater.emitError (C:  Program Files (x86)  Atlassian Companion\\resources\\electron.asar\\browser\\api\\auto-updater\\auto-updater-win.js:70:24)\n at AutoUpdater.checkForUpdates (C:  Program Files (x86)  Atlassian Companion\\resources\\electron.asar\\browser\\api\\auto-updater\\auto-updater-win.js:41:19)\n at Timeout.setTimeout [as _onTimeout] (C:  Program Files (x86)  Atlassian Companion\\resources\\app.asar\\src\\browser\\autoUpdater.ts:38:67)\n at ontimeout (timers.js:475:11)\n at tryOnTimeout (timers.js:310:5)\n at Timer.listOnTimeout (timers.js:270:5)""}]},  {""namespace"":""adc:auto-updater"",""date"":""2018-10-29T09:51:05.604Z"",""message"":[""update error"",{""message"":""Can not find Squirrel"",""stack"":""Error: Can not find Squirrel\n at AutoUpdater.emitError (C:  Program Files (x86)  Atlassian Companion\\resources\\electron.asar\\browser\\api\\auto-updater\\auto-updater-win.js:70:24)\n at AutoUpdater.checkForUpdates (C:  Program Files (x86)  Atlassian Companion\\resources\\electron.asar\\browser\\api\\auto-updater\\auto-updater-win.js:41:19)\n at Timeout.setTimeout [as _onTimeout] (C:  Program Files (x86)  Atlassian Companion\\resources\\app.asar\\src\\browser\\autoUpdater.ts:38:67)\n at ontimeout (timers.js:475:11)\n at tryOnTimeout (timers.js:310:5)\n at Timer.listOnTimeout (timers.js:270:5)""}]}  {code}    Please remove the update check for the MSI version of the App.",5
"CONFSERVER-57450","11/02/2018 21:25:04","Questions For Confluence - Compatibility With Confluence 6.12","Questions for Confluence is still not listed as compatible with the latest version of Confluence.   The add-on should be updated accordingly to match the latest version of Confluence",1
"CONFSERVER-57481","11/12/2018 03:24:10","Cannot comment on file when previewer is opened from the attachments page","Steps to reproduce:  # create a page with image attachment  # go to attachment and click the image to preview  # drag the comment pin to the image preview    Expected:  Should be able to comment    Actual:  There is nowhere to type comment (the comment box does not show up)  And the close button on top right corner stops working  ",1
"CONFSERVER-57525","11/16/2018 09:58:47","Ability to customize Atlassian Companion MSI","h3. Problem Definition  No current documented ability to customize the Atlassian Companion MSI    h3. Suggested Solution  Provide ability to customize Atlassian Companion MSI, for example to setup a trusted domain  ",5
"CONFSERVER-57574","11/19/2018 01:03:08","Team Calendars performs several unnecessary database queries due to lazy loading","A massive number of executions of trivial Team Calendars database queries (~94k per hour), these queries are shown below.        ||ID||Number of executions||Query||  |bxjvujt8jky01|35,801|SELECT ""LAST_MODIFIED"", ""ID"", ""DESCRIPTION"", ""USING_CUSTOM_EVENT_TYPE_ID"", ""STORE_KEY"", ""CREATED"", ""SUBSCRIPTION_ID"", ""SPACE_KEY"", ""NAME"", ""CREATOR"", ""TIME_ZONE_ID"", ""COLOUR"", ""PARENT_ID"" FROM ""AO_950DC3_TC_SUBCALS"" WHERE ""ID"" = :1|  |8ks5b97gwy741|94,606| SELECT ""NAME"" FROM ""AO_950DC3_TC_SUBCALS"" WHERE ""ID"" = :1|  |dw8ddwwn0ybns|94,606| SELECT ""PARENT_ID"" FROM ""AO_950DC3_TC_SUBCALS"" WHERE ""ID"" = :1|  |9nrktrtmzzw1v|94,605| SELECT ""SUBSCRIPTION_ID"" FROM ""AO_950DC3_TC_SUBCALS"" WHERE ""ID"" = :1|  |b55fvjnh7naf3|94,604 | SELECT ""USING_CUSTOM_EVENT_TYPE_ID"" FROM ""AO_950DC3_TC_SUBCALS"" WHERE ""ID"" = :1|  |4v0zrftdn7h32|94,603 | SELECT ""STORE_KEY"" FROM ""AO_950DC3_TC_SUBCALS"" WHERE ""ID"" = :1|  |6tsar6qtqrsjy|94,603 | select ""AO_950DC3_TC_EVENTS_INVITEES"".""ID"" from ""AO_950DC3_TC_EVENTS_INVITEES"" ""AO_950DC3_TC_EVENTS_INVITEES"" where ""AO_950DC3_TC_EVENTS_INVITEES"".""ID"" in (select min(""AO_950DC3_TC_EVENTS_INVITEES"".""ID"") from ""AO_950DC3_TC_EVENTS_INVITEES"" ""AO_950DC3_TC_EVENTS_INVITEES"" where ""AO_950DC3_TC_EVENTS_INVITEES"".""EVENT_ID"" = :1 group by ""AO_950DC3_TC_EVENTS_INVITEES"".""EVENT_ID"", ""AO_950DC3_TC_EVENTS_INVITEES"".""INVITEE_ID"") and ""AO_950DC3_TC_EVENTS_INVITEES"".""EVENT_ID"" = :2|  |fk68qh14pu2ur|94,602| SELECT ""TIME_ZONE_ID"" FROM ""AO_950DC3_TC_SUBCALS"" WHERE ""ID"" = :1|  |8sdkgurz66vz7|82,097| SELECT * FROM ( SELECT ""ID"", ""CONTENT"" FROM ""AO_21F425_MESSAGE_AO"" ) WHERE ROWNUM <= 1|  |b66t57uh2c2s7|60,502| SELECT ""INVITEE_ID"", ""ID"" FROM ""AO_950DC3_TC_EVENTS_INVITEES"" WHERE ""ID"" IN (:1 )|              These queries are coming from {{VEventMapper#toVEvent}} because {{eventEntity.subCalendar}} is lazy loaded.    Instead of retrieving each of the subcalendar attributes separately (which each have a database query), we can do one database query and then retrieve each of the values from it. This will result in having only a single database query instead of six, which will improve performance. ",3
"CONFSERVER-57541","11/20/2018 12:37:24","Companion App MSI should automatically startup on next login after install","h2. Problem Definition    Currently when the Companion App MSI file is deployed by admins wishing to roll out this feature to multiple Windows machines the app still needs to be manually started before it can make the system call to add it to launch at startup. Customers have run into this issue and see that only after running the app manually the registry entry is placed here: {{HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run}}    This differs from the normal installer behaviour (.exe) which does launch the Companion App after installing. However, MSIs are usually installed via an admin account, so having the executable launch automatically after installation will not solve the problem (as this will only add the registry entry for the admin user).   h3. Current scenario:    After user runs the App for the first time, the registry key will be added in the following path  {noformat}  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run{noformat}  h2. Workaround:    The registry key can be added to HKCU (for all users that should have Companion running) during the deployment to ensure that the app is started automatically without having the user to start it manually.    For 32-bit OS:  {code:java}  msiexec /qn /i ""Atlassian Companion.msi""  reg add ""HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run"" /v ""electron.app.Atlassian Companion"" /d ""C:\Program Files\Atlassian Companion\Atlassian Companion.exe --was-opened-at-login"" /f  {code}  For 64-bit OS:  {code:java}  msiexec /qn /i ""Atlassian Companion.msi""  reg add ""HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run"" /v ""electron.app.Atlassian Companion"" /d ""C:\Program Files (x86)\Atlassian Companion\Atlassian Companion.exe --was-opened-at-login"" /f  {code}       As of Companion 0.6.0, a registry key can alternatively be manually added to HKLM (instead of HKCU) with no side effects. This will allow Companion to automatically launch for all users on the machine. The process will be the same as above, but adding the registry key to HKLM:     {{HKEY_LOCAL_MACHINE\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Run}}     ",5
"CONFSERVER-57542","11/20/2018 15:46:27","The Space sidebar contains a Create Page link even for users without the Add Page permission","h3. Issue Summary  The Space sidebar contains a _Create page_ link even when the _current user_ doesn't have the _Add page_ permission.  If that user clicks on that link, then a _No Permission_ page is loaded with the wrong warning message.  Even if a mail server is configured, this page won't load the _Request Access_ button.      h3. Environment  Fresh install of Confluence *6.12.0*.  It was confirmed on *6.6.3* as well.    h3. Steps to Reproduce  Create a fresh install of Confluence Server and do the following as the _admin_:  # Add a new user (_user001_) to Confluence and make sure it is added only to the _confluence-users_ group.  # Create a new space named _Space A_.   #* Add the _View_ Space Permission and *remove* any other related to the _confluence-users_ group.    Access Confluence as _user001_:  # Access _Space A_ home page and you will see the _Create page_ link in the side bar.  # Click on the _Create page_ link and the _No Permission_ page is loaded with the wrong warning message.    h3. Expected Results  # If the user doesn't have the _Add page_ permission, the _Create page_ link doesn't appear in the sidebar.  # If the link must be there, then the _No permission_ page should give a meaningful message saying the user doesn't have permission to create pages on that Space and should render the _Request Access_ button if the mail server is enabled.    h3. Actual Results  # The user has access to a _Create page_ link even when the _Add page_ permission is not granted.   !new_img_001.png|thumbnail!   # Access the _createpage.action_ link to a Space on which the user doesn't have the _Add page_ permission shows a confusing message.   #* If the mail server is enabled, there's no _Request Access_ button.   !create_page_img001.png|thumbnail!      h3. Workaround  _None at this moment_",1
"CONFSERVER-57567","11/26/2018 06:14:13","When profile language is in German workbox notifications are undefined","Bug report  h3. Summary    When a Confluence user has German set as a profile language, notifications in the Workbox part are shown as *Undefined*      !123.jpeg|thumbnail!       h3. Environment    Confluence is set up with a working notifications are allowed by Confluence.  h3. Steps to Reproduce   # Set the Confluence user profile language to German   # Add comments or mentions to the users watched contents/page   # Subsequent notifications in the Confluence workbox will be missing the username/pagename it is instead shown as *Undefined*    h3. Expected Results    User name/Pagename is shown correctly. When the language in the user profile is English, all is as expected and user names are shown.  h3. Actual Results    *Undefined*  instead of usermentions/pagename  h3. Workaround    No known workaround",3
"CONFSERVER-57582","11/28/2018 11:28:11","Later version of Tomcat hit into ""Invalid character found in the request target"" when subscribing to RSS feeds","h3. Summary    Doing certain actions on newer versions of Confluence which contains newer versions of tomcat, will results with {{400 - Bad Request Invalid character found in the request target}} error message  h3. Steps to replicate #1 - Subscribing to RSS feeds   # On any space, go to Space Tools > Content Tools > RSS Feed   ** Alternatively, go to <base_URL>/spaces/listrssfeeds.action?key=<space_key>   # Click on any links: Pages, Blog, Mail, Comments, Attachments, All Content   # Expected Results: Prompts for RSS file    h3. Steps to replicate #2 - Clicking the ""Go to included page"" option in Excerpt Include macro when page contains square bracket   # Create page A which contains square brackets in the page title for example: ""Page with [square] brackets""   # Create page B.   # Add Excerpt Include macro and point it to the page A   # Save the Page B, Edit mode for page B   # Click on Excerpt macro and then navigate to ""Go to Included Page"" button   # Expected Results: Page A ""Page with [square] brackets"" will be opened    h3. Actual Results    Following error is returned in the UI:  {noformat}  HTTP Status 400 – Bad Request  Type Exception Report    Message Invalid character found in the request target. The valid characters are defined in RFC 7230 and RFC 3986    Description The server cannot or will not process the request due to something that is perceived to be a client error (e.g., malformed request syntax, invalid request message framing, or deceptive request routing).    Exception    java.lang.IllegalArgumentException: Invalid character found in the request target. The valid characters are defined in RFC 7230 and RFC 3986  org.apache.coyote.http11.Http11InputBuffer.parseRequestLine(Http11InputBuffer.java:467)  org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:294)  org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)  org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:770)  org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1415)  org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)  java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)  java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)  org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)  java.lang.Thread.run(Thread.java:748)  Note The full stack trace of the root cause is available in the server logs.  {noformat}  h3. Notes    The Apache Tomcat server, which is a web server used by Confluence, is filtering out requests that contain special characters. That’s because Tomcat is using a different encoding and URI standard than most browsers.    See also Apache [Tomcat 8.5|https://tomcat.apache.org/tomcat-8.5-doc/config/http.html] http docs for more details:  {quote}relaxedPathChars:    The [HTTP/1.1 specification|https://tools.ietf.org/rfc/rfc7230.txt] requires that certain characters are %nn encoded when used in URI paths. Unfortunately, many user agents including all the major browsers are not compliant with this specification and use these characters in unencoded form. To prevent Tomcat rejecting such requests, this attribute may be used to specify the additional characters to allow. If not specified, no additional characters will be allowed. The value may be any combination of the following characters:  {code:java}  "" < > [ \ ] ^ ` { | } {code}  . Any other characters present in the value will be ignored.  {quote}  h3. Workaround    Specify tomcat to allow the special characters. For the above issues, we only need to allow the comma "","" character.   # Go to <confluence_install>/conf, backup, and edit the server.xml file.   # Find all connectors your application is using. Just search for Connector in the file, or look at the example below. You're interested only in connectors whose protocol is set to HTTP and HTTPS (not AJP).   # Add {{relaxedQueryChars=""[,]""}} to the connector properties in server.xml. For example:  {code:java}          <Connector port=""26156"" connectionTimeout=""20000"" redirectPort=""8443""                     maxThreads=""48"" minSpareThreads=""10""                     enableLookups=""false"" acceptCount=""10"" debug=""0"" URIEncoding=""UTF-8""         relaxedQueryChars=""[,]""                     protocol=""org.apache.coyote.http11.Http11NioProtocol""/>  {code}  #* If the above workaround does not work, try specifying the other characters by adding the following in server.xml instead:  {code:java}  relaxedPathChars=""[]|""  relaxedQueryChars=""[]|{}^&#x5c;&#x60;&quot;&lt;&gt;""  {code}   # Restart Confluence",3
"CONFSERVER-57642","12/06/2018 06:13:41","Improving the performance on Adding Team Calendar Macro into Page","h3. Problem  Adding new Calendar in Page using Team Calendar Macro might fail if the user belongs to too many groups and the space has a lot of calendars within itself.  The macro will search for all group memberships and eventually hit the threshold that is set and the warning message below is thrown in the log:  {code}   [http-nio-8081-exec-4] [confluence.util.profiling.DefaultActivityMonitor] close Exceeded the threshold of 60000 ms   {code}  (i) This threshold is not able to be extended due to the block at CONFSERVER-36883     When creating a new calendar through the Team Calendar Macro, Confluence do a bunch of permission checks for each of the existing subcalendars within the space. The server returns a complete object with all of the sub calendars within the space which is necessary for processing on the front-end. This can be seen below (""AbstractSubCalendarResource#toExtendedSubCalendar), this is performed when the user clicks ""Add new Calendar""  {code:java}  private SubCalendarsResponseEntity.ExtendedSubCalendar toExtendedSubCalendar(PersistedSubCalendar subCalendar, ConfluenceUser forUser)   {   UtilTimerStack.push(""CalendarResource.toExtendedSubCalendar()"");   try   {   return new SubCalendarsResponseEntity.ExtendedSubCalendar(   subCalendar,   calendarPermissionManager.hasViewEventPrivilege(subCalendar, forUser),   calendarPermissionManager.hasReloadEventsPrivilege(subCalendar, forUser),   calendarPermissionManager.hasEditSubCalendarPrivilege(forUser),   calendarPermissionManager.hasEditEventPrivilege(subCalendar, forUser),   false,   false,   false,   calendarManager.isEventsOfSubCalendarHidden(subCalendar, forUser),   calendarPermissionManager.hasDeleteSubCalendarPrivilege(subCalendar, forUser),   calendarPermissionManager.hasAdminSubCalendarPrivilege(subCalendar, forUser),   new HashSet<SubCalendarsResponseEntity.ExtendedSubCalendar.PermittedUser>(   Collections2.transform(   calendarPermissionManager.getEventViewUserRestrictions(subCalendar),   new UserToPermittedUserTransformer(userAccessor, settingsManager)   )   ),   calendarPermissionManager.getEventViewGroupRestrictions(subCalendar),   new HashSet<SubCalendarsResponseEntity.ExtendedSubCalendar.PermittedUser>(   Collections2.transform(   calendarPermissionManager.getEventEditUserRestrictions(subCalendar),   new UserToPermittedUserTransformer(userAccessor, settingsManager)   )   ),   calendarPermissionManager.getEventEditGroupRestrictions(subCalendar),  // getSubCalendarWarnings(subCalendar),   new HashSet<String>(),   false //reminder   );   }  {code}    Within a few of these ""hasPrivilege"" methods, if the user is not the creator of the subcalendar, Confluence check Admin group membership for the user {{isUserMemberOfOneGroup(user, CONFLUENCE_ADMINISTRATORS_GROUP_NAMES)}} which gets all of the user's groups and checks if the Admin group is contained within that list. This uses the method    ""DefaultUserAccessor#getGroupNames"", which calls the following method to performs the permissions check:  {code:java}  public List<String> getGroupNamesForUserName(String userName) {   return (List)(userName == null ? Collections.emptyList() : ImmutableList.copyOf(this.crowdService.search(QueryBuilder.queryFor(String.class, EntityDescriptor.group()).parentsOf(EntityDescriptor.user()).withName(userName).returningAtMost(-1))));   }  {code}    So in summary, for every subcalendar, Confluence may have to retrieve all of the groups that the user belongs to *multiple times*.       h3. Suggestion  Since it will be retrieving the same groups every time, we should be able to improve the performance by adding some simple caching.     h3. Workaround  # Add a new Calendar from *My Calendar* View and link it to the desire space  #* This method can still allow user to create calendar without hitting the issue above  # Search and insert the calendar in a space that has no calendar (in order to avoid this issue) and examine the [Storage Format|https://confluence.atlassian.com/doc/confluence-storage-format-790796544.html] to get the calendar macro that look like below:  {code}   <ac:structured-macro ac:macro-id=""f1360258-9d29-4828-b510-ba63bdfc51e3"" ac:name=""calendar"" ac:schema-version=""1"">      <ac:parameter ac:name=""id"">859956f5-0eb8-4169-9c5b-24a034e40578</ac:parameter>    </ac:structured-macro>  {code}  # From the storage format above, either copy it and add it into the affected page using [Source Editor|https://marketplace.atlassian.com/apps/1210722/confluence-source-editor?hosting=server&tab=overview] or type the wiki markup like below to insert the calendar macro:  {code}  {calendar:id=859956f5-0eb8-4169-9c5b-24a034e40578}  {code}",3
"CONFSERVER-57648","12/07/2018 08:01:58","Disabling ""Edit With button"" module prevents preview from working on the Attachments page","h4. Summary  # In the Administrating Companion App document, we have a section that explain how to disable the Companion App if an admin choose to, which is to disable the *Edit With button* module, in the *Confluence Previews* add-on.  # This works fine, and when clicking on the file when attached on the page itself, the file previews, and the ""Edit with* button is no longer there as expected.  # But, if we were to click on the file from the page's Attachments page, the preview will not load.    h4. Steps to replicate  # Upload a simple PDF file onto a page.  # Disable the *Edit With button* module, in the *Confluence Previews* add-on.  # Click on the file on the page itself, and it should preview fine.  # Click on the file from the attachment page, the preview will not load.    h4. Current Behavior  # Preview on the attachments page does not work when *Edit With button* module is disabled in the *Confluence Previews* add-on.    h4. Expected behavior  # Preview should work on the attachments page does not work when *Edit With button* module is disabled in the *Confluence Previews* add-on.",3
"CONFSERVER-57705","12/25/2018 12:16:44","Subscribe Calendar button is missing if restriction is applied","h4. Problem Statement  If a calendar has edit restriction applied to it, an unrestricted user will not be able to see the ""Subscribe"" button.    h4. Steps to Replicate  # Create a test calendar with no restrictions  # Create two test user (user1, user2)  # Both users are able to see the ""Subscribe"" button on the top right-hand corner (next to the ""Add Event"" button)  # Apply edit restriction to only user1  # Log in as user2 and check if the button is still present    user1 will see:   !Screen Shot 2018-12-25 at 8.08.55 PM.png|thumbnail!     user2 will see:   !Screen Shot 2018-12-25 at 8.09.31 PM.png|thumbnail!     h4. Workaround  The 'subscribe' button can still be found in the options (...) drop-down list",2
"CONFSERVER-57715","12/28/2018 07:47:10","Race condition in atlassian-ical4j causes high CPU usage in Confluence","h3. Issue Summary  The latest version of _atlassian-ical4j_'s method {{getCachedOnset}} is susceptible to trigger race condition, in which may lead to high CPU usage in Confluence.    (i) Team Calendar make use of _atlassian-ical4j_ library to support the implementation of timezones in an iCalendar format.  In this case, the race condition was observed specifically when the library was trying to determine whether the retrieved Calendar events' time is in daylight savings time.     h3. Evidence in Thread Dumps  Example thread:  {code}  ""http-nio-18009-exec-62"" #736 daemon prio=5 os_prio=0 tid=0x00007f835806e000 nid=0x18a7 runnable [0x00007f81df9d0000]     java.lang.Thread.State: RUNNABLE   at net.fortuna.ical4j.model.component.Observance.getCachedOnset(Observance.java:308)   at net.fortuna.ical4j.model.component.Observance.getLatestOnset(Observance.java:192)   at net.fortuna.ical4j.model.component.VTimeZone.getApplicableObservance(VTimeZone.java:313)   at net.fortuna.ical4j.model.TimeZone.inDaylightTime(TimeZone.java:120)   at java.util.TimeZone.getOffset(TimeZone.java:209)   at java.util.GregorianCalendar.computeFields(GregorianCalendar.java:2342)   at java.util.GregorianCalendar.computeFields(GregorianCalendar.java:2312)   at java.util.Calendar.setTimeInMillis(Calendar.java:1804)   at java.util.Calendar$Builder.build(Calendar.java:1508)   at sun.util.locale.provider.CalendarProviderImpl.getInstance(CalendarProviderImpl.java:88)   at java.util.Calendar.createCalendar(Calendar.java:1666)   at java.util.Calendar.getInstance(Calendar.java:1627)   at net.fortuna.ical4j.model.CalendarDateFormatFactory$DateFormat.format(CalendarDateFormatFactory.java:298)   at java.text.DateFormat.format(DateFormat.java:345)   at net.fortuna.ical4j.model.Iso8601.toString(Iso8601.java:131)   at net.fortuna.ical4j.model.DateTime.toString(DateTime.java:433)   at net.fortuna.ical4j.util.Strings.valueOf(Strings.java:249)   at net.fortuna.ical4j.model.property.DateProperty.getValue(DateProperty.java:154)   at net.fortuna.ical4j.model.Property.toString(Property.java:419)   at net.fortuna.ical4j.model.PropertyList.toString(PropertyList.java:95)   at java.lang.String.valueOf(String.java:2994)   at java.lang.StringBuffer.append(StringBuffer.java:263)   - locked <0x00007f877ebcb5a8> (a java.lang.StringBuffer)   at net.fortuna.ical4j.model.component.VEvent.toString(VEvent.java:323)   at com.atlassian.confluence.extra.calendar3.DefaultCalendarManager.toSubCalendarEvent(DefaultCalendarManager.java:858)   at com.atlassian.confluence.extra.calendar3.ical4j.RecurrenceRuleProcessor.getRecurrenceEvents(RecurrenceRuleProcessor.java:115)   at com.atlassian.confluence.extra.calendar3.DefaultCalendarManager.getEvents(DefaultCalendarManager.java:717)  ...   at com.sun.proxy.$Proxy2672.getEvents(Unknown Source)   at com.atlassian.confluence.extra.calendar3.rest.resources.EventResource.getEvents(EventResource.java:430)  ...   at com.atlassian.plugins.rest.common.transaction.TransactionInterceptor$1.doInTransaction(TransactionInterceptor.java:27)   at com.atlassian.sal.core.transaction.HostContextTransactionTemplate$1.doInTransaction(HostContextTransactionTemplate.java:21)   at com.atlassian.sal.spring.component.SpringHostContextAccessor$1.doInTransaction(SpringHostContextAccessor.java:71)   at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:133)   at com.atlassian.sal.spring.component.SpringHostContextAccessor.doInTransaction(SpringHostContextAccessor.java:68)  ...   at com.atlassian.confluence.impl.vcache.VCacheRequestContextManager.doInRequestContextInternal(VCacheRequestContextManager.java:87)   at com.atlassian.confluence.impl.vcache.VCacheRequestContextManager.doInRequestContext(VCacheRequestContextManager.java:71)  ...   at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)   at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)   at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:770)   at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1415)   at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)   - locked <0x00007f877ebced70> (a org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)   at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)   at java.lang.Thread.run(Thread.java:745)  ...  {code}    h3. Workaround  None at the time being.",5
"CONFSERVER-57995","01/06/2019 23:29:49","Can't edit from Powerpoint Macro after editing from Preview","If the Previewer is used to invoke “Edit with app” on a Powerpoint attachment, and then you cancel the editing, go back to the main page view and use the “pencil” icon from a Office Powerpoint macro for the same attachment, it also results in the following JS error: ""TypeError: Cannot read property 'displayName' of undefined""",3
"CONFSERVER-57769","01/15/2019 13:05:38","Editing a document that has special characters in the document's name fails when using the Companion App.","h3. Issue Summary    In Windows, if a document's name do not contain spaces and has a ""&"" character and the user tries to use the Companion App to edit the document, the Companion App will return an error and will fail to launch. This has been tested on Word documents and documents with the .txt extension but we believe that the behavior is the same across all other document types.      h3. Environment  * Windows    h3. Steps to Reproduce  # Create a word document. Name it a&b.docx  # Upload it to Confluence  # Attempt to Edit the document.    h3. Expected Results  Companion App launches and the document can be edited using the related application.    h3. Actual Results  A ""Windows cannot find"" the document error is is returned. (see attachment)  In some cases, the companion app just hangs and does not return any error message.    h3. Tested Scenarios:  * a&b will fail  * a&bababa will fail  * a & b will work  * Financial Sample & (test) etc will work  * FinancialSample&(test)etc.xls will fail    h3. Workaround  Change the document's name by removing the ""&"" character.  ",3
"CONFSERVER-57790","01/22/2019 10:22:53","User Calendar is still appearing in the search results after the user is being deleted ","h3. Issue Summary    After deleting the user that previously had personal space and at least one personal calendar, the related calendar will still be shown in the search results upon searching the username.     Confluence Version: 6.6.9, 6.13     Team Calendar Version: 6.0.25  h3. Steps to Reproduce   # Create a test user   # Log in with that user   # Create a Personal Space   # Create a calendar in personal space   # Log out and log in with an admin account   # search the user by the name and you will get 4 results related to that user   # delete the user and the associated personal space   # search for the user by the name again    h3. Expected Results    No results should be shown  h3. Actual Results    User's Calendar is still appearing in the search results  h3. Workaround    Currently, there is no known workaround for this behavior. A workaround will be added here when available",1
"CONFSERVER-57796","01/23/2019 06:32:49","Web resource bundling in Confluence 6.14 version is breaking our Future macro in BobSwift Cache for Confluence Add-on","Hi Atlassian Team,    Looks like the web resource bundling is changed in Confluence 6.14 version. We are facing issues with our Future macro along with 'viewppt' and 'viewpdf' macros (or any other macros that has a dependency on an external web resource) for the 'Cache for Confluence' Bobswift add-on.    I have already created a DEVHELP ticket 2 days back, awaiting for a response.    Reference: [https://ecosystem.atlassian.net/servicedesk/customer/portal/14/DEVHELP-2164]    Could you please help me urgently on this issue.    Thanks,  Ram.",3
"CONFSERVER-57798","01/23/2019 13:56:13","Companion App throws System clock error if it starts up before the computer has synced with the NTP server","h3. Summary  # When connected to the internet, the Companion App checks and compares the computer's time with the NTP time.  # If the time is out of sync, it will throw the error saying ""System clock is incorrect""  # Sometimes the Companion App will start before the computer has time to sync with the NTP server, which will them prompt the error message as well.    h3. Steps to replicate  # Set the Companion App to auto start on OS boot.  # Start the computer in another location where the local time is different.  # If the computer boots up, but has not synced with the NTP server to update it's time, the Companion App will throw the ""System clock is incorrect"" error.    # The issue can also be reproducible by simply changing the local time of the machine, and then setting it to update using the NTP server.  # Start the Atlassian Companion app, and it will throw the error, since it takes some time for the computer to sync with the NTP server time.    h3. Expected behavior  # When starting up, the Companion app should wait awhile for the computer time to sync with the network time, to prevent the error message from appearing.  # Or, there should be an option to disable the checking.    h3. Current behavior   # Companion App throws ""System clock is incorrect"" error message, as the computer has have the time to sync with the network time.   # In some cases, the app will crash on boot, and but works fine if started manually after.",3
"CONFSERVER-57820","01/29/2019 15:52:41","Confluence Search return ""Something went wrong"" after session timed out instead of redirecting user to Login page.","h3. Issue Summary    Confluence Search return ""Something went wrong"" after session timed out instead of redirecting user to Login page.  h3. Environment    Confluence version 6.14.0  h3. Steps to Reproduce   # *Login* into Confluence.   # Open a *new browser tab* and access any Confluence page in the new tab.   # *Logout* from Confluence in the first browser tab (in *Step 1*).   # In the *new browser tab*, Click the search box and search for any keyword.    h3. Expected Results    Confluence will redirect user to a Login page since the session is terminated/expired when user logout in the other tab.  h3. Actual Results    Confluence does not redirect user to a Login page.    The following message return in the Search box when user tried to search after session timed out:  {noformat}  Something went wrong. Refresh the page, or contact your admin if this keeps happening.  {noformat}  h3. Notes    The issue can be replicated when the default session timed out (60 minutes) without manually Logout from Confluence in other tab.  h3. Workaround    Logout then re login into Confluence to perform the search",2
"CONFSERVER-57826","01/30/2019 00:44:38","Color Scheme Settings for Search Box in Confluence 6.14.0 does not take effect","h3. Summary  Color Scheme Settings for Search Box in Confluence 6.14.0 does not take effect    Confluence 6.14 introduced an [enhanced Confluence Search|https://confluence.atlassian.com/doc/confluence-6-14-release-notes-963655609.html#Confluence6.14ReleaseNotes-FindworkfasterwiththenewConfluencesearch] and this could be the reason behind the *Search Field Background* and *Search Field Text* from the [Color Scheme|https://confluence.atlassian.com/doc/customizing-color-schemes-135906.html] is not applied properly.    h3. Environment  Confluence 6.14.0      h3. Steps to Reproduce  # Go to the [Color Scheme|https://confluence.atlassian.com/doc/customizing-color-schemes-135906.html] admin configuration page  # Click *Edit* and change the color schemes below:  #* Search Field Background  #* Search Field Text    h3. Expected Results  Color schemes for the quick search box on the top right should be changed accordingly    h3. Actual Results  Color schemes that are modified don't take effect on the search box    h3. Information  * The color set in the *Search Field Text* only applies to the _magnifying glass logo_ instead of the _search_ text  * The same customization applied in Confluence 6.11.2 will take effect:   !confluence 6.11.2 search bar.png|thumbnail!       h3. Workaround  Third-party theme plugin",3
"CONFSERVER-57828","01/30/2019 14:31:36","Confluence Search keep loading when the user starts to search before the UI loaded completely","h3. Steps to replicate  # Login into Confluence.  # Type any keyword in the search box before the UI completely loaded.  # Remove the keyword and re-enter the keyword multiple time.    h3. Environment  Confluence version 6.14.0    h3. Expected Results  Search autocomplete/result will appear.    h3. Actual Results  Confluence Search keep loading even after navigating to another page.    h3. Workaround  Refresh the page/open a new tab and wait until Confluence UI completely loaded to perform the search.",1
"CONFSERVER-57842","02/01/2019 02:02:35","Allowing admin to pre-set Trusted Domain before distributing Companion App","h3. Problem Definition  Currently, there is no way to pre-set the *Trusted Domain* for the Companion App before distributing it out.      h3. Why this is important  In a large organization if the system administrator were to distribute the Companion App to all Confluence users, every users will need to click on ""Trust this Domain"" for the first time editing attachment in the Confluence.    Having an option to pre-set the Trusted Domain before distributing it out can cut down the hassle from the users to seek for clarification before _Trusting_ something in their computer.       !image-2019-02-01-10-01-19-961.png|thumbnail! ",0
"CONFSERVER-57883","02/11/2019 18:19:02","Companion app leaks memory if the process is started twice","h3. Summary    The Companion app leaks memory if the process is started twice.      {panel:title=Issue fixed on Atlassian Companion App version 0.6.0|borderStyle=dashed|borderColor=#cccccc|titleBGColor=#f7d6c1|bgColor=#ffffce}   # There will still be *two processes* running for the Companion app even on 0.6.0.   # But there should be only *one instance* of the app, which can be see with there being only one Companion App icon on the task-bar.{panel}  h3. Environment   * Only observed on Windows   * App installed with *.msi* file    h3. Steps to Reproduce   # Install the Companion app with the *.msi* file using the following script   ** For 32-bit OS:  {code:java}  msiexec /qn /i ""Atlassian Companion.msi""  reg add ""HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run"" /v ""electron.app.Atlassian Companion"" /d ""\""C:\Program Files\Atlassian Companion\Atlassian Companion.exe\"""" /f  {code}     ** For 64-bit OS:  {code:java}  msiexec /qn /i ""Atlassian Companion.msi""  reg add ""HKEY_LOCAL_MACHINE\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Run"" /v ""electron.app.Atlassian Companion"" /d ""\""C:\Program Files (x86)\Atlassian Companion\Atlassian Companion.exe\"""" /f  {code}     # Reboot the computer    h3. Expected Results    The app is started normally and no duplicate processes or memory issues are observed.  h3. Actual Results    Duplicate processes for the app are observed, as we can see here:    !task-manager-view.png|thumbnail!    One of the processes will *leak memory at a rate of around 20 bytes per second*. We have some cases where the memory usage reached more than 1GB before the app crashed after running in this situation for a few hours.  h3. Notes    The installation method that triggers this situation is a workaround for the following bugs:   # https://jira.atlassian.com/browse/CONFSERVER-57792   # https://jira.atlassian.com/browse/CONFSERVER-57541    After running this installation method and rebooting the computer, we end up having two entries on the registry that trigger the app startup, one under the key *HKEY_CURRENT_USER* and the other under *HKEY_LOCAL_MACHINE*.    Even though this is not triggered under normal circumstances, the idea of this bug is that one of the following situations must be avoided:   # The app should check if it is already running before starting a new process, or   # If the possibility of having two processes is expected, the secondary process should not leak memory    If the app has one of those protection mechanisms bundled, we exclude the possibility of compromising the end-user computer resources.  h3. Workaround 1    Remove one of the registry entries (either from HKLM or HKCU tree), which can be done by an administrator. Only one of the following entries must exist in the registry:  {code:java}  HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run  {code}  {code:java}  HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run  {code}  (!) For a 64 bit OS, the registry tree looks like this:  {code:java}  HKEY_LOCAL_MACHINE\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Run  {code}  h3. Workaround 2    Uncheck the *Launch at startup* box on the app itself, which can be done by the end user. This will effectively remove the registry entry from *HKEY_CURRENT_USER*, but the app will still start automatically on reboot due to the entry under *HKEY_LOCAL_MACHINE*.",3
"CONFSERVER-57919","02/18/2019 17:24:07","Search tips link is broken when using a different language than English (US/UK)","h3. Issue Summary    In Confluence 6.14.x, we added a new search window, on the right side of it, there's a Search tips link, clicking on it would lead you to our Search guide:   - [https://confluence.atlassian.com/doc/search-139528.html]    If we change the language at the user profile to something other than English (US) and (UK), the link is broken and, instead of redirecting to the correct page, we does a search at CAC (confluence.atlassian.com) for the word ""search"" in the language that was changed to, for example, if we change to Deutsch, it will search for ""suchen"".      h3. Environment    Confluence 6.14.x  h3. Steps to Reproduce   # Install Confluence 6.14.x   # Click on the search bar, on the new window, click on Search tips or on the language you've chosen that the link was translated to    h3. Expected Results    Will open a new tab showing our Search guide:   - [https://confluence.atlassian.com/doc/search-139528.html]    h3. Actual Results    Will open a new tab and will run a search for the word ""Search"" in the language chosen, for example:   - Deutsch, will redirect to: [https://confluence.atlassian.com/display/DOC/Suche]   - Eesti, will redirect to: [https://confluence.atlassian.com/display/DOC/Otsi]    h3. Workaround    Since changing the language to english just to have that link correctly won't be done, there are no workarounds.",2
"CONFSERVER-57934","02/21/2019 12:55:26","Adding panel,excerpt,warning,note,tip or info macro to the page in edit mode will trigger mixed content action in browser","h3. Issue Summary    Editing page with a panel, warning, note, tip or info macro over https in the browser will trigger mix content action, it will break the certificate trust on request of _plugins/servlet/confluence/placeholder/macro-heading?definition=e25vdGV9&locale=en_US&version=2_.  h3. Environment    Confluence 6.14.x  Confluence 6.15.x  Confluence 7.0.x    Connector with SSL  h3. Steps to Reproduce   # Create a page and add an excerpt, warning, note, tip or info macro   # Open inspect tools/network tab and edit the page once again.    h3. Expected Results    The certificate will stay trusted (green) and all request will be resolved over HTTPS  h3. Actual Results    At least one request is resolved over HTTP and certificate is not trusted because of mixed content.   [^localhost_6.14.1.har.zip]  h3. Notes    The issue does not exist in 6.13.x  h3. Workaround    Some users have found the below custom HTML resolves the issue in Chrome:    Copy text/code below into *BODY* section of *Configuration --> Custom HTML*       {code:java}  <script type=""text/javascript"">    function fixFrameContent(frameContent, broken_url_prefix) {      var replaced = false;      // Replace broken img src urls      frameContent.find(""img"").each(function(index) {        var srcUrl = AJS.$(this).attr(""src"");        if (srcUrl.toLowerCase().startsWith(broken_url_prefix)) {          var srcNewUrl = srcUrl.substring(broken_url_prefix.length);          AJS.$(this).attr(""src"", srcNewUrl);          replaced=true;        };      });  // each img             // Replace broken tables for macro - background img url is broken      // Iterate over all relevant tables to check background-image URL      frameContent.find(""table.wysiwyg-macro"").each(function(index) {        AJS.log(AJS.$(this));        var bgiRaw = AJS.$(this).css(""background-image"");        if (!bgiRaw) return true;  // nothing to do, continue with next element        // remove 'url(...)' around the content        var bgiUrlMatch = bgiRaw.match(/url\([""']?(.*)[""']?\)/);        if (!bgiUrlMatch) return true;  // nothing to do, continue with next element        var bgiUrl = bgiUrlMatch[1];        if (bgiUrl.toLowerCase().startsWith(broken_url_prefix)) {          // Remove broken URL, use relative path!          var bgiNewUrl = bgiUrl.substring(broken_url_prefix.length);          AJS.$(this).css(""background-image"", ""url('""+bgiNewUrl+""')"");        }        replaced = true;      }); // each macro in iframe       };       AJS.toInit(function() {      if (navigator.userAgent.indexOf(""Trident/"")>-1) {        AJS.log(""Fixing broken macro title - Internet Explorer - fix not required"");        return;      }      // Get Base URL      var broken_url_prefix = Confluence.getBaseUrl().toLowerCase();      // Replace https with http      if (!broken_url_prefix.startsWith(""https"")) {        AJS.log(""Fixing broken macro title - no https base URL ""+broken_url_prefix);        return;      }      // Remove https and add http      broken_url_prefix = ""http"" + broken_url_prefix.substring(5);      AJS.log(""Fixing broken macro title - fixing URL prefix ""+broken_url_prefix);         // Bind to rich text editor event, triggered when edit button is pressed      AJS.bind(""init.rte"", function() {           AJS.$(document).bind('postPaste', function(e, pl, o) {          // iframe is not filled when postPaste occurs, so wait and retry a few times          var copyPasteRetry = 5;          var pasteRetryHandle = setInterval(function() {            copyPasteRetry--;            if(copyPasteRetry<=0) {              clearInterval(pasteRetryHandle);              return;                      };            // Find out what is being pasted            var $pasted = $(o.node);            // Get iframe containing the editor HTML, including the relevant macro tables            var frameContent = AJS.$(""#wysiwygTextarea_ifr"").contents();            // Search editor content for broken links            replaced = fixFrameContent(frameContent, broken_url_prefix);            // Stop polling in after a complete next iteration if at least one macro was fixed            if (replaced && copyPasteRetry>2) copyPasteRetry=2;          }, 500); // retry interval 500ms        }); // bind postPaste                   var counter = 10;        var replaced = false;           // iframe is not filled when RTE event occurs        // (Re-)start polling, found no event to wait until editor iframe is filled        // and onLoad does not work.        var timerHandle = setInterval(function() {          // Stop polling when counter reaches zero          counter--;          if (counter<=0) {            clearInterval(timerHandle);            return;          }          // Get iframe containing the editor HTML, including the relevant macro tables          var frameContent = AJS.$(""#wysiwygTextarea_ifr"").contents();          replaced = fixFrameContent(frameContent, broken_url_prefix);          // Stop polling in after a complete next iteration if at least one macro was replaced          if (replaced && counter>2) counter=2;        }, 1000); // every 1000ms      });    }); // toInit  </script>  {code}",3
"CONFSERVER-57943","02/22/2019 19:32:25","Unable to create spaces in 6.11.x to 6.15.2 when a space blueprint plugin has been removed","h3. Summary    A bug in 6.11.0 to 6.15.2 leads to the Create Space dialog not loading, and giving an  ""unknown server error"" in the UI after clicking on the Create Space button.    A pre-exiting KB has almost 100% effectiveness with some exceptions that are environmental, not the application. Here's the KB:   - [https://confluence.atlassian.com/confkb/creating-new-page-or-space-loads-forever-744329880.html]    This was caused by the space blueprints table AO_54C900_SPACE_BLUEPRINT_AO containing a reference to a blueprint that was no longer available.  E.g. the plugin that included the blueprint has been uninstalled.    Another situation is where the blueprint was partially enabled.    This bug is fixed in 6.13.5 and 6.15.3.      h3. Logs    This is the logging by default that is used to identify the problem:  {code:java}  2019-01-23 15:19:28,291 WARN [http-nio-8090-exec-4] [confluence.impl.hibernate.ConfluenceHibernateTransactionManager] doRollback Performing rollback. Transactions:    ->[PluginReadWriteTx]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT (Session #1723296075)   -- referer: https://mywiki.com/admin/viewlog4j.action | url: /rest/create-dialog/1.0/space-blueprint/dialog/web-items | traceId: 6b739b69b3cbee0b | userName: supertest@test.com  {code}  Logs with debug on for AO:  {code:java}  2019-01-23 15:19:28,266 DEBUG [http-nio-8090-exec-4] [net.java.ao.sql] onSql SELECT ""NAME"",""PROMOTED_BPS"",""PLUGIN_CLONE"",""CATEGORY"",""ID"",""UUID"",""PLUGIN_MODULE_KEY"" FROM ""AO_54C900_SPACE_BLUEPRINT_AO""  2019-01-23 15:19:28,268 DEBUG [http-nio-8090-exec-2] [net.java.ao.sql] onSql SELECT ""ID"",""CONTENT"" FROM ""AO_21F425_MESSAGE_AO"" LIMIT 1  2019-01-23 15:19:28,274 DEBUG [http-nio-8090-exec-4] [net.java.ao.sql] onSql SELECT ""HOME_PAGE_ID"" FROM ""AO_54C900_SPACE_BLUEPRINT_AO"" WHERE ""ID"" = ?  2019-01-23 15:19:28,276 DEBUG [http-nio-8090-exec-2] [net.java.ao.sql] onSql SELECT ""ID"",""CONTENT"" FROM ""AO_21F425_MESSAGE_AO"" LIMIT 1  2019-01-23 15:19:28,277 DEBUG [http-nio-8090-exec-4] [net.java.ao.sql] onSql SELECT ""HOME_PAGE_ID"" FROM ""AO_54C900_SPACE_BLUEPRINT_AO"" WHERE ""ID"" = ?  2019-01-23 15:19:28,281 DEBUG [http-nio-8090-exec-4] [net.java.ao.sql] onSql SELECT ""HOME_PAGE_ID"" FROM ""AO_54C900_SPACE_BLUEPRINT_AO"" WHERE ""ID"" = ?  2019-01-23 15:19:28,286 DEBUG [http-nio-8090-exec-4] [net.java.ao.sql] onSql SELECT ""UUID"" FROM ""AO_54C900_C_TEMPLATE_REF"" WHERE ""ID"" = ?  2019-01-23 15:19:28,291 WARN [http-nio-8090-exec-4] [confluence.impl.hibernate.ConfluenceHibernateTransactionManager] doRollback Performing rollback. Transactions:    ->[PluginReadWriteTx]: PROPAGATION_REQUIRED,ISOLATION_DEFAULT (Session #1723296075)   -- referer: https://mywiki.com/admin/viewlog4j.action | url: /rest/create-dialog/1.0/space-blueprint/dialog/web-items | traceId: 6b739b69b3cbee0b | userName: supertest@test.com  {code}  It happens on UPGRADES from 6.x to 6.11.x or later versions and it happens with all databases, no common plugin used, dropping/truncating the tables always resolve the problem, with just one exception.    h3. Steps to reproduce    There are a few ways to reproduce it.  The most common and dangerous is:   * Create a space using the a space blueprint   * Disable the plugin module that provides that space blueprint   * Upgrade to 6.11.x or above   * Try to create a space    The ""it happens on upgrade"" is because the bug was introduced there, and in previous versions it was fine to disable the space blueprint of a plugin module.   * When using 6.11.x or above   * Create a space using the a space blueprint   * Disable the plugin module that provides that space blueprint   * Try to create a space    Another way is to just disable a space blueprint plugin module without disabling the space blueprint item module, e.g.   * When using 6.11.x or above   * Go to Manage apps   * Turn off the team-space-blueprint module   * Try to create a space    h3. Workarounds    * Upgrade to 6.15.3 or 6.13.5  * Create spaces using the old UI.  You don't get to choose a space type, but you can still create spaces.  Start at http://<baseurl>/<contextpath>/spaces/createspace-start.action  * If you have disabled or uninstalled any space blueprint plugins or plugin modules you used to use, then re-enable them  * If those aren't enough, follow this KB to delete old space blueprint use from the database [https://confluence.atlassian.com/confkb/creating-new-page-or-space-loads-forever-744329880.html]",3
"CONFSERVER-57951","02/26/2019 12:12:18","Disabling ""Events"" event type breaks CalDAV synchronisation to mobile and the calendar on TC","h3. Issue Summary  Disabling ""Events"" event type on Team Calendars will   * Prevent event creation from mobile CalDAV connection   * Corrupt calendar ""Events"" event type   * Create duplicate ""Events"" event types and actual Events for every attempt to create an event from the mobile   * Prevent events from getting created using ""Events"" event type even after re-enabling the type.    h3. Environment   * Android Mobile with CalDAV two way sync to Team Calendars   * Confluence Team Calendars 6.0.27    h3. Steps to Reproduce   # Create a Calendar in TC   # Create a _test_ event using built-in *Events* event type   # Add calendar to an android mobile device using CalDAV as outlined in [Subscribe to Team Calendars from Android Calendar|https://confluence.atlassian.com/teamcal/subscribe-to-team-calendars-from-android-calendar-946631707.html] instructions   # Synchronize and confirm that you can see new test event in mobile calendars   # On team calendars disable ""Events"" event type, _test_ event will disappear as expected.   # Synchronize CalDAV on mobile, _test_ event will disappear on *TC* and *Mobile*   # Attempt to create a new event on *Mobile*    h3. Expected Results  The event is created on Mobile Calendar and then syncronised to Confluence Team Calendars    h3. Actual Results   * Test event is created on mobile, but disappears after refresh and never appears on TC   * Re-enabling disabled *Events* event type will result in duplicate *Events* event types and events, one for each ""failed"" mobile event creation attempt   !multiple event types.png|thumbnail!   * From calendars event type we do not see any custom event types   !no custom event type.png|thumbnail!   * Attempting to create an event with default *Events* event type will result in {{java.lang.NullPointerException}} in WebUI and {{atlassian-confluence.log}}:  {code:java}  2019-02-26 12:18:47,364 ERROR [http-nio-26132-exec-9] [calendar3.rest.ExceptionMappers.GeneralExceptionMapper] getResponseError General exception happen on calendar resources   -- referer: http://confluence.com/calendar/mycalendar.action | url: /rest/calendar-services/1.0/calendar/events.json | traceId: 6954e3dc5f83cea0 | userName: admin  java.lang.NullPointerException   at com.atlassian.confluence.extra.calendar3.DefaultCalendarManager.addEvent(DefaultCalendarManager.java:981)   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:498)   at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)   at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)   at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)   at com.atlassian.plugins.spring.interceptor.plugin.ExportableInterceptorAdapter$WrappedMethodInvocation.proceed(ExportableInterceptorAdapter.java:53)   at com.atlassian.plugins.spring.interceptor.spi.SpringInterceptorAdapter$SpringMethodInvocationAdapter.proceed(SpringInterceptorAdapter.java:50)   at com.atlassian.spring.interceptors.SpringProfilingInterceptor.invoke(SpringProfilingInterceptor.java:16)   at com.atlassian.plugins.spring.interceptor.spi.SpringInterceptorAdapter.invoke(SpringInterceptorAdapter.java:23)  {code}     * On mobile, none of the duplicates will be visible    h3. Workaround  Exporting calendar as an ical, deleting and re-importing it fixes duplicate event types and allows events creation again",3
"CONFSERVER-57974","02/28/2019 03:02:04","Remote code execution via Widget Connector macro - CVE-2019-3396","There was a server-side template injection vulnerability in Confluence Server and Data Center, in the Widget Connector. An attacker is able to exploit this issue to achieve path traversal and remote code execution on systems that run a vulnerable version of Confluence Server or Data Center.         *Affected versions:*    All versions of Confluence Server and Confluence Data Center before version 6.6.12, from version 6.7.0 before 6.12.3 (the fixed version for 6.12.x), from version 6.13.0 before 6.13.3 (the fixed version for 6.13.x) and from version 6.14.0 before 6.14.2 (the fixed version for 6.14.x).         *Fix:*   * Confluence Server version 6.15.1 is available for download from [https://www.atlassian.com/software/confluence/download].   * Confluence Server version 6.14.2 is available for download from [https://www.atlassian.com/software/confluence/download-archives].   * Confluence Server version 6.13.3 is available for download from [https://www.atlassian.com/software/confluence/download-archives].   * Confluence Server version 6.12.3 is available for download from [https://www.atlassian.com/software/confluence/download-archives].   * Confluence Server version 6.6.12 is available for download from [https://www.atlassian.com/software/confluence/download-archives].         For additional details, see the full advisory: [https://confluence.atlassian.com/display/DOC/Confluence+Security+Advisory+-+2019-03-20]     ",0
"CONFSERVER-58146","04/10/2019 21:28:19","Team Calendars won't load high volume of Jira Issues","h3. Summary      * In Team Calendars, if you try to create a JQL filter showing over 700 Jira Issues, they won't load in the calendar even though the response shows as *{""success"": true}*    h3. Environment   * Jira Project with over 700 issues    h3. Steps to Reproduce   # In Team Calendars, select *Add Event*  ## Select *Jira Issue Dates* in the *Event Type* field  ## Add a name to it  ## In the *Display* field, select the *JQL* option and add a filter that would return over 700 entries. In my local test instance, the filter was:  {code}  project = E84 and issuetype = Task  {code}  ## Check the *Issue Created Date* check box  ## Click on the *OK* button    h3. Expected Results      * The calendar will load the issues as events in the calendar    h3. Actual Results     * No issues are shown and, upon checking the console, we can see that the _events.json_ request will take a while to load and its response will be only *{""success"": true}*    h3. Notes     * This issue is very intermittent since I was able some times to display the required information.    h3. Workaround   N/A",3
"CONFSERVER-58185","04/23/2019 13:02:35","Disabling companion app plugin submodules causes corruption of   pdfview macro preview","h3. Issue Summary    Disabling companion app plugin submodules causes corruption of   pdfview macro preview  h3. Environment    Confluence 6.15.1, postgres 9.5, all supported browsers  h3. Steps to Reproduce   # Create new page   # Add pdf attachment and insert it into PDFview macro   # Go to Confluence administration -> manage apps. Search for Confluence plugin ""Confluence Previews""   Disable plugin submodules (according to official documentation [https://confluence.atlassian.com/doc/administering-the-atlassian-companion-app-958456281.html ):|https://confluence.atlassian.com/doc/administering-the-atlassian-companion-app-958456281.html):]   ## Edit With plugin for the Media Viewer (companion-plugin)   ## Embedded 'Edit With' button (embedded-edit)   # Go to previously created page    h3. Expected Results    Pdfview macro is rendered  h3. Actual Results    Pdfmacro preview is corrupted:    !Screenshot_20190423_135858.png|thumbnail!  h3. Workaround    Currently there is no known workaround for this behavior. A workaround will be added here when available",2
"CONFSERVER-58213","05/01/2019 02:59:41","Upgrade to jQuery 2","Presently Confluence 6.x uses jQuery 1.7.2.  Confluence 7.0 will upgrade to jQuery 2.2.4.",0
"CONFSERVER-58220","05/02/2019 20:14:44","Having Collaborative Editing disabled and HTTPS will cause macros' titles to not show up","h3. Summary      When editing a page that has a macro, its title won't show up if you have HTTPS enabled and Collaborative Editing disabled. Confluence will make incorrect requests to the HTTP URL instead of HTTPS URL, causing this behavior.    h3. Environment   * HTTPS enabled  * Collaborative Editing disabled    h3. Steps to Reproduce   # Enable Confluence to be running on HTTPS (Reverse proxy or at Tomcat)  # Disable Collaborative Editing  # Go to a Confluence page that has a *Panel* macro, for example  # Edit this page    h3. Expected Results      * The macros will show up its titles normally    h3. Actual Results     * The macro's won't show up its titles unless you edit them.    h3. Diagnosis    # Confirm that *Confluence Administration* » *General Configuration* » *Collaborative Editing* is currently disabled  #* This is identified in the Support Zip / application.xml:  {code}    <synchrony-configuration>      <synchrony-enabled>false</synchrony-enabled>  ...  {code}  # Capture a [HAR file|https://confluence.atlassian.com/kb/generating-har-files-and-analysing-web-requests-720420612.html] when refreshing the page whilst in Edit mode  # Most of the web requests will be against HTTPS base URL  #* e.g. https://www.mybaseurl.com/confluence/......  # However, the URL to generate the Macro Titles (plugins/servlet/confluence/placeholder/macro-heading) are incorrectly made against the HTTP base URL instead of the HTTP base URL  #* e.g. http://www.mybaseurl.com/confluence/plugins/servlet/confluence/placeholder/macro-heading?definition=e2NvbHVtbjp3aWR0aD0zMyV9&locale=en_US&version=2    h3. Workaround   * Enable Collaborative Editing",3
"CONFSERVER-58270","05/13/2019 14:56:08","Confluence might show blank content or an old version of a page when an user tries to edit a page with Collaborative Editing enabled","h3. Issue Summary  When Collaborative Editing is enabled in Confluence and users try to edit a page, they might hit a bug on which a blank page is shown in the editor.  Sometimes, it is not a blank page, but an old version of it.    h3. Environment  This bug was reproduced on *6.6*, *6.13* and *6.15.4*.  Although not tested, this should affected any version from 6.0 onward.    h3. Steps to Reproduce  Below are described two ways to hit this bug, but with different characteristics to user, although the bug trigger is the same.  Because of simplicity, the first option might be more common than the other, which is when the user sees a blank page when accessing the editor.    h4. Option 1  # Install a vanilla instance of Confluence.  # Publish a new page with no content.   #* If you check records related to this page in the {{CONTENT}} table you have 2 rows.   #* The row related to the draft has {{creationdate}} and {{lastmoddate}} equal to {{null}}.   !drafts_img008.png|thumbnail!   # Disable Collaborative Editing.  # Edit the same page, add new content to it and save it.   #* If you check records related to this page in the {{CONTENT}} table, you have 3 rows.  # Enable Collaborative Editing.   #* The draft record that was created a few steps ago won't be [removed as a stale draft|https://docs.atlassian.com/atlassian-confluence/6.2.0/com/atlassian/confluence/pages/PageManager.html#removeStaleSharedDrafts--] because its timestamps are null.  # Access the same page as before and click on _Edit_.    h5. Expected Results  Confluence shows in the editor the contents of the last published page.    h5. Actual Results  Confluence shows in the editor a blank page.    h4. Option 2  # Install a vanilla instance of Confluence.  # Disable Collaborative Editing.  # Create a page with a sample content.   !drafts_img003.png|thumbnail!    #* If you check records related to this page in the {{CONTENT}} table, you have just one row.   !drafts_img001.png|thumbnail!   # Enable Collaborative Editing.  # Access the page created a few steps before and click on _Edit_.  # *Without changing anything* on the contents, click on _Close_ to exit the editor.   #* If you check records related to this page in the {{CONTENT}} table, now you have 2 rows.   #* The new row added to the table is related to the draft record and has {{creationdate}} and {{lastmoddate}} equal to {{null}}.   !drafts_img002.png|thumbnail!   # Disable Collaborative Editing.  # Edit the same page again, add new content to it and save it.   !drafts_img004.png|thumbnail!    #* If you check records related to this page in the {{CONTENT}} table, you have 3 rows.   !drafts_img005.png|thumbnail!   # Enable Collaborative Editing.   #* The draft record that was created a few steps ago won't be [removed as a stale draft|https://docs.atlassian.com/atlassian-confluence/6.2.0/com/atlassian/confluence/pages/PageManager.html#removeStaleSharedDrafts--] because its timestamps are null.  # Access the same page as before and click on _Edit_.    h5. Expected Results  Confluence shows in the editor the contents of the last published page.   !drafts_img006.png|thumbnail!     h5. Actual Results  Confluence shows in the editor an old version of the page, which is related to the draft record created when Collaborative Editing was first enabled.     h3. Notes  This bug is related to [CONFSERVER-57458|https://jira.atlassian.com/browse/CONFSERVER-57458] in a way that it shows the same characteristics to the end user.  A bug new record was created because the trigger of is completely different.    h3. Workaround  _Currently there is no known workaround for this behavior. A workaround will be added here when available_",5
"CONFSERVER-58352","05/29/2019 07:20:20","Companion App certificate has expired","h3. Issue Summary    The certificate for the Companion App desktop applications has expired as of April 23rd 2019.   h3. Environment    N/A  h3. Steps to Reproduce    N/A  h3. Actual Results  h3. Notes    (Optional - If Necessary)  h3. Workaround    No workaround. ",3
"CONFSERVER-58376","06/04/2019 07:42:04","Companion embedded edit doesn't refresh the page correctly ","h3. Issue Summary  h3. Environment    N/A  h3. Steps to Reproduce   # Edit a file using the embedded edit button, make a change and save the change   # Press the upload button in the dialog    h3. Expected Results    New file should be uploaded and the page should refresh seamlessly in the background  h3. Actual Results    The web browser shows a prompt confirming that the user wants to navigate away from the page:   ""This page is asking you to confirm that you want to leave - data you have entered may not be saved.""    h3. Workaround   Currently there is no known workaround for this behavior. A workaround will be added here when available",2
"CONFSERVER-58425","06/13/2019 13:47:04","Companion App should provide a configuration option to prevent clearing files on startup","h3. Issue Summary    Currently, on startup the Companion App will remove all attachments from its temporary directory. This is to prevent temporary files building up and taking up too much space.     However, some users would prefer to have more control over when these files are deleted. We could provide a configuration option in the Companion menu such as ""Clear temporary files on startup"" that defaults to selected. If the user unticks this option then we would no longer perform the clear out of the temporary directory.   h3.      This suggestion is important in cases when the user did not upload changes, but it has saved them. And because of that, his changes will be gone, and we will not be able to recover them.",2
"CONFSERVER-58478","06/14/2019 21:35:32","Companion App does not work when Confluence has the Atlassian SAML SSO app configured","h3. Summary    When trying to edit an attachment with the Companion App (Confluence 6.11+) while Confluence is using SAML authentication, we receive an error message even though the file works fine in the appropriate editor.  h4. Steps to reproduce   # Install Confluence 6.11.1 + Companion App;   # Attach a Word document to a Confluence page;   # Click on the Excel document to show in Preview;   # Click on the *Edit with Word*;   ** Word opens the document fine (/)   # Now, integrate Confluence with an IdP (or Crowd SSO 2.0) using the [Atlassian SAML SSO app|https://marketplace.atlassian.com/apps/1216096/sso-for-atlassian-server-and-data-center?hosting=server&tab=overview];   ** Repeat the above test by clicking on the *Edit with Word;*    h3. Expected Result    Clicking the *Edit with <App>* should work with Confluence regardless whether Confluence is integrated with SSO.    h3. Actual Result    The system throws a popup message saying ""File is corrupted and cannot be opened"".     !screenshot-1.png|thumbnail!      h3. Workaround    Disable the SAML plugin or edit the file directly in Word (or the respective app).",3
"CONFSERVER-58490","06/19/2019 03:01:23","Emoticons with dashes are not correctly restored in 6.15.5","h3. Issue Summary  h3. Environment    Confluence 6.15.5, pages saved in earlier versions of Confluence with broken emoticons (""broken"" as per https://jira.atlassian.com/browse/CONFSERVER-52441)  h3. Steps to Reproduce   # Have a page with a ""broken"" emoticon (saved in storage format as an ""<img>"") which has a dash in the name (e.g. ""thumbs-up"", ""thumbs-down"", ""green-star"", ""red-star"", ""yellow-star"", ""blue-star"", ""light-off"", ""light-on"", ""broken-heart"")   # Upgrade to 6.15.5    h3. Expected Results    The emoticons are restored, can be viewed correctly on the view page and are correctly saved on next save.   h3. Actual Results    The emoticons are incorrectly converted to HipChat emoticons (which are ""unknown"").       h3. Workaround    Disable the ""Confluence HipChat Emoticons Plugin""   # Go to   !http://extranet.atlassian.com/download/thumbnails/4168188072/cog_icon.png?version=1&modificationDate=1560916171530&api=v2|width=16!  > *Manage apps*   # Search for *Confluence Hipchat Emoticons Plugin.* This is a bundled plugin, so make sure the *All apps* option is selected in dropdown.   # Click on the name of the plugin, then select *Disable*.    !manage-apps-disable-hipchat-emoticons.png|width=468,height=407!         Alternatively, the fixed version of the  ""Confluence HipChat Emoticons Plugin"" can be installed in your 6.15.5 instance   # Go to   !http://extranet.atlassian.com/download/thumbnails/4168188072/cog_icon.png?version=1&modificationDate=1560916171530&api=v2|width=16!  > *Manage apps*   # Press ""Upload app""   # Upload the fixed version of the plugin attached to this ticket [^confluence-hipchat-emoticons-plugin-3.1.3.obr]",2
"CONFSERVER-58527","06/28/2019 09:06:51","Store temporary files for Atlassian Companion App outside of the Roaming profile on Windows","h2. *Problem Description*    Editing files via the Atlassian Companion app in Microsoft Windows stores files in two locations:    1. Actual files downloaded and sent to the respective application:    * C:\Users\admin\.atlassian-companion    2. Temporary Cache files (including a CACHE copy of the downloaded file) is stored in:    * C:\Users\admin\AppData\Roaming\Atlassian Companion\Cache    Every time a file is edited, a copy is again put into the above Temporary Cache location inside the *Roaming* folder:    {code}  C:\Users\admin\AppData\Roaming\Atlassian Companion\Cache>dir   Volume in drive C has no label.   Volume Serial Number is DC2E-570C     Directory of C:\Users\admin\AppData\Roaming\Atlassian Companion\Cache    27/06/2019  09:52 PM    <DIR>          .  27/06/2019  09:52 PM    <DIR>          ..  27/06/2019  10:35 PM            45,056 data_0  27/06/2019  10:35 PM           270,336 data_1  25/06/2019  09:29 AM             8,192 data_2  25/06/2019  11:45 AM         4,202,496 data_3  27/06/2019  09:22 PM           305,213 f_00000a  27/06/2019  09:40 PM         4,305,498 f_00000b  27/06/2019  09:41 PM         4,305,498 f_00000c  27/06/2019  09:45 PM         4,305,498 f_00000d  27/06/2019  09:45 PM         4,305,498 f_00000e  27/06/2019  09:46 PM         4,305,498 f_00000f  27/06/2019  09:46 PM         4,305,498 f_000010  27/06/2019  09:46 PM         4,305,498 f_000011  27/06/2019  09:50 PM         4,305,498 f_000012  27/06/2019  09:50 PM         4,305,498 f_000013  27/06/2019  09:51 PM         4,305,498 f_000014  27/06/2019  09:51 PM         4,305,498 f_000015  27/06/2019  09:51 PM         4,305,498 f_000016  27/06/2019  09:51 PM         4,305,498 f_000017  27/06/2019  09:52 PM         4,305,498 f_000018  27/06/2019  09:52 PM         4,305,498 f_000019  25/06/2019  09:29 AM           262,512 index                21 File(s)     69,676,275 bytes                 2 Dir(s)  14,553,374,720 bytes free  {code}    The *Cache folder* in the Roaming profile can therefore grow excessively large and hit size quotas on the Roaming profile folder.    h2. *Suggestion*    Provide a way to cap the upper limit on the Cache folder.    * [Chromium command-line params|https://github.com/electron/electron/blob/master/docs/api/chrome-command-line-switches.md] do support a maximum cache size:    {quote}  *{{--disk-cache-size=size}}*    Forces the maximum disk space to be used by the disk cache, in bytes.  {quote}  * Alternatively, this Cache folder should be written to {{C:\Users\admin\.atlassian-companion}}, outside of the Roaming folder    h2. *Work Around*    Atlassian Companion App uses the Electron framework which  generates/utilises these two folders:    * Cache  * GPUCache    Edited: It is safe to manually delete the folders - the entire AppData/Roaming/Atlassian Companion/Cache directory should be deleted rather than selectively removing files. If the folder is locked whilst Atlassian Companion App is running please exit the app, delete the folder and restart. This will reduce the disk space used in the Windows Roaming folder.",3
"CONFSERVER-58531","07/01/2019 06:27:00","Mobile web view watch button is not working","h3. Issue Summary    Mobile web watch button is calling a outdated action endpoint.   h3. Environment    (Optional - If Applicable)   *   *  h3. Steps to Reproduce   # Go to web mobile view   # Go to a page   # Click watch button   # Open DevTool network panel    h3. Expected Results    The request should succeed   h3. Actual Results  {noformat}  POST http://localhost:8080/confluence/users/addpagenotificationajax.action 403  (anonymous) @ VM16149:1  send @ jquery.js:9180  ajax @ jquery.js:8661  toggleWatch @ watch-model.js?locale=en-GB:9  toggleWatch @ watch-view.js?locale=en-GB:25  (anonymous) @ zepto.js:630  proxyfn @ zepto.js:549  Show 4 more frames  Notes{noformat}     {code:java}  POST http://localhost:8080/confluence/users/removepagenotificationajax.action 403 (anonymous) @ VM16149:1 send @ jquery.js:9180 ajax @ jquery.js:8661 toggleWatch @ watch-model.js?locale=en-GB:9 toggleWatch @ watch-view.js?locale=en-GB:25 (anonymous) @ zepto.js:630 proxyfn @ zepto.js:549 Show 4 more frames  {code}       (Optional - If Necessary)  h3. Workaround    Required, if there is no workaround please state:   Currently there is no known workaround for this behavior. A workaround will be added here when available",2
"CONFSERVER-58534","07/01/2019 17:20:21","SVGs inside tables cause PDF exports to fail","h5. Summary  An emoticon that is in the form of an image link (to the svg file) inside a table does not export to pdf.    h5. Steps to replicate  # Add emoticon as an SVG image link inside a table:  {code:java}  <ac:image ac:alt=""(thumbs up)"" ac:class=""emoticon emoticon-thumbs-up""> <ri:url ri:value=""https://extranet.atlassian.com/s/en_GB/7601/440fc7e33d392cae27e22f3a50d5dcc6a0775898/_/images/icons/emoticons/thumbs_up.svg""/> </ac:image>  {code}  The new input of the emoticon tag works fine  {code:java}  <ac:emoticon ac:name=""thumbs-up""/>  {code}  # Export to PDF    h5. Expected results  Successful export    h5. Actual results  *Stack trace when try to pdf export:*  {code:java}  com.atlassian.confluence.importexport.ImportExportException: Exception while rendering the PDF document /var/atlassian/application-data/confluence/temp/pdfexport-20180304-040318-0405-167/smadi-123123456-123123456-040318-0405-168.pdf      at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerXmlToPdfConverter.convertXhtmlToPdf(FlyingSaucerXmlToPdfConverter.java:95)    caused by: java.lang.RuntimeException: Failed to read image      at com.atlassian.confluence.extra.flyingpdf.LightITextFSImage.getImage(LightITextFSImage.java:247)    caused by: java.lang.RuntimeException: Failed to read image      at com.atlassian.confluence.extra.flyingpdf.LightITextFSImage.getImage(LightITextFSImage.java:240)    caused by: java.lang.IllegalArgumentException: 0.0 incompatible with org.apache.batik.transcoder.keys.LengthKey@33840d89      at org.apache.batik.transcoder.TranscodingHints.put(TranscodingHints.java:92)  {code}  *Stack trace:*  {code:java}  com.atlassian.confluence.importexport.ImportExportException: Exception while rendering the PDF document /var/atlassian/application-data/confluence/temp/pdfexport-20180304-040318-0405-167/smadi-123123456-123123456-040318-0405-168.pdf   at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerXmlToPdfConverter.convertXhtmlToPdf(FlyingSaucerXmlToPdfConverter.java:95)   at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerXmlToPdfConverter.convertXhtmlToPdf(FlyingSaucerXmlToPdfConverter.java:53)   at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerPdfExporterService.createPdfForPage(FlyingSaucerPdfExporterService.java:95)   at com.atlassian.confluence.extra.flyingpdf.ExportPageAsPdfAction.doExecute(ExportPageAsPdfAction.java:40)   at com.atlassian.confluence.extra.flyingpdf.ExportPageAsPdfAction.execute(ExportPageAsPdfAction.java:29)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:168)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.ConfluenceWorkflowInterceptor.intercept(ConfluenceWorkflowInterceptor.java:33)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.xwork.interceptors.XsrfTokenInterceptor.intercept(XsrfTokenInterceptor.java:100)   at com.atlassian.confluence.xwork.ConfluenceXsrfTokenInterceptor.intercept(ConfluenceXsrfTokenInterceptor.java:29)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.interceptors.CaptchaInterceptor.intercept(CaptchaInterceptor.java:42)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.ConfluenceLicenseInterceptor.intercept(ConfluenceLicenseInterceptor.java:66)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.validation.MessageHolderInterceptor.intercept(MessageHolderInterceptor.java:37)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.util.LoggingContextInterceptor.intercept(LoggingContextInterceptor.java:44)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.CancellingInterceptor.intercept(CancellingInterceptor.java:21)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.xwork.HttpMethodValidationInterceptor.intercept(HttpMethodValidationInterceptor.java:68)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.websudo.WebSudoInterceptor.intercept(WebSudoInterceptor.java:57)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.themes.ThemeContextInterceptor.intercept(ThemeContextInterceptor.java:42)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.actions.PermissionCheckInterceptor.intercept(PermissionCheckInterceptor.java:55)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.setup.webwork.BootstrapAwareInterceptor.intercept(BootstrapAwareInterceptor.java:21)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.user.actions.UserAwareInterceptor.intercept(UserAwareInterceptor.java:53)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.pages.actions.CommentAwareInterceptor.intercept(CommentAwareInterceptor.java:39)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.pages.actions.PageAwareInterceptor.intercept(PageAwareInterceptor.java:61)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.spaces.actions.SpaceAwareInterceptor.intercept(SpaceAwareInterceptor.java:71)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.interceptors.ConfluenceAccessInterceptor.intercept(ConfluenceAccessInterceptor.java:31)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.xwork.FlashScopeInterceptor.intercept(FlashScopeInterceptor.java:21)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.actions.LastModifiedInterceptor.intercept(LastModifiedInterceptor.java:27)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.core.ConfluenceAutowireInterceptor.intercept(ConfluenceAutowireInterceptor.java:44)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.xwork.interceptors.TransactionalInvocation.invokeAndHandleExceptions(TransactionalInvocation.java:71)   at com.atlassian.xwork.interceptors.TransactionalInvocation.invokeInTransaction(TransactionalInvocation.java:57)   at com.atlassian.xwork.interceptors.XWorkTransactionInterceptor.intercept(XWorkTransactionInterceptor.java:56)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.xwork.SetupIncompleteInterceptor.intercept(SetupIncompleteInterceptor.java:43)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.atlassian.confluence.security.interceptors.SecurityHeadersInterceptor.intercept(SecurityHeadersInterceptor.java:39)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.interceptor.AroundInterceptor.intercept(AroundInterceptor.java:35)   at com.opensymphony.xwork.DefaultActionInvocation.invoke(DefaultActionInvocation.java:165)   at com.opensymphony.xwork.DefaultActionProxy.execute(DefaultActionProxy.java:115)   at com.atlassian.confluence.servlet.ConfluenceServletDispatcher.serviceAction(ConfluenceServletDispatcher.java:56)   at com.opensymphony.webwork.dispatcher.ServletDispatcher.service(ServletDispatcher.java:199)   at javax.servlet.http.HttpServlet.service(HttpServlet.java:729)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:292)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:46)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:39)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.confluence.plugins.baseurl.IncludeResourcesFilter.doFilter(IncludeResourcesFilter.java:52)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.labs.botkiller.BotKillerFilter.doFilter(BotKillerFilter.java:36)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.confluence.extra.jira.filters.SingleJiraIssuesMapThreadLocalFilter.doFilter(SingleJiraIssuesMapThreadLocalFilter.java:42)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:24)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:24)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:24)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:24)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.applinks.core.rest.context.ContextFilter.doFilter(ContextFilter.java:24)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.analytics.client.filter.UniversalAnalyticsFilter.doFilter(UniversalAnalyticsFilter.java:92)   at com.atlassian.analytics.client.filter.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:39)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.mywork.client.filter.ServingRequestsFilter.doFilter(ServingRequestsFilter.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.confluence.efi.OnboardingFilter.doFilter(OnboardingFilter.java:61)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFixupFilter.doFilter(PrettyUrlsSiteMeshFixupFilter.java:36)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.prettyurls.filter.PrettyUrlsDispatcherFilter.doFilter(PrettyUrlsDispatcherFilter.java:60)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.prettyurls.filter.PrettyUrlsSiteMeshFilter.doFilter(PrettyUrlsSiteMeshFilter.java:92)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.prettyurls.filter.PrettyUrlsMatcherFilter.doFilter(PrettyUrlsMatcherFilter.java:56)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:70)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:58)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.util.message.MessagesDecoratorFilter.doFilter(MessagesDecoratorFilter.java:62)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.obtainContent(SiteMeshFilter.java:129)   at com.opensymphony.sitemesh.webapp.SiteMeshFilter.doFilter(SiteMeshFilter.java:77)   at com.atlassian.confluence.util.profiling.ProfilingSiteMeshFilter.doFilter(ProfilingSiteMeshFilter.java:50)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:39)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.plugin.connect.plugin.auth.scope.ApiScopingFilter.doFilter(ApiScopingFilter.java:89)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.confluence.util.profiling.ConfluenceActivityFilter.doFilter(ConfluenceActivityFilter.java:39)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:70)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:58)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.jmx.JmxFilter.doFilter(JmxFilter.java:98)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.cache.TransactionalCacheFactoryCleanupFilter.doFilter(TransactionalCacheFactoryCleanupFilter.java:22)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.core.filters.ServletContextThreadLocalFilter.doFilter(ServletContextThreadLocalFilter.java:21)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.util.UserLoggingContextFilter.doFilter(UserLoggingContextFilter.java:32)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.util.UserNameHeaderFilter.doFilter(UserNameHeaderFilter.java:25)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.web.filter.MauEventFilter.doFilter(MauEventFilter.java:39)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.util.UserThreadLocalFilter.doFilter(UserThreadLocalFilter.java:39)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.web.filter.ConfluenceTimeoutFilter.doFilter(ConfluenceTimeoutFilter.java:57)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.seraph.filter.SecurityFilter.doFilter(SecurityFilter.java:242)   at com.atlassian.confluence.web.filter.ConfluenceSecurityFilter.doFilter(ConfluenceSecurityFilter.java:25)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.web.filter.ThreadLocalCacheFilter.doFilter(ThreadLocalCacheFilter.java:25)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.security.auth.trustedapps.filter.TrustedApplicationsFilter.doFilter(TrustedApplicationsFilter.java:103)   at com.atlassian.confluence.util.AbstractBootstrapHotSwappingFilter.doFilter(AbstractBootstrapHotSwappingFilter.java:35)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.seraph.filter.BaseLoginFilter.doFilter(BaseLoginFilter.java:148)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:39)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.oauth.serviceprovider.internal.servlet.OAuthFilter.doFilter(OAuthFilter.java:67)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.core.filters.ServletContextThreadLocalFilter.doFilter(ServletContextThreadLocalFilter.java:21)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:70)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:58)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.util.ClusterHeaderFilter.doFilter(ClusterHeaderFilter.java:56)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at org.springframework.orm.hibernate.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:170)   at com.atlassian.confluence.web.filter.ConfluenceOpenSessionInViewFilter.doFilterInternal(ConfluenceOpenSessionInViewFilter.java:41)   at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.util.ConfluenceErrorFilter.doFilter(ConfluenceErrorFilter.java:24)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.util.profiling.filters.ProfilingFilter.doFilter(ProfilingFilter.java:99)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.core.datetime.RequestTimeThreadLocalFilter.doFilter(RequestTimeThreadLocalFilter.java:37)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.core.filters.cache.AbstractCachingFilter.doFilter(AbstractCachingFilter.java:33)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:39)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.plugin.connect.plugin.auth.user.ThreeLeggedAuthFilter.doFilter(ThreeLeggedAuthFilter.java:122)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.plugin.connect.plugin.auth.oauth.OAuth2LOFilter.doFilter(OAuth2LOFilter.java:82)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.analytics.client.filter.DefaultAnalyticsFilter.doFilter(DefaultAnalyticsFilter.java:38)   at com.atlassian.analytics.client.filter.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:39)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.jwt.internal.servlet.JwtAuthFilter.doFilter(JwtAuthFilter.java:31)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.confluence.web.filter.HttpRequestStatsFilter.doFilter(HttpRequestStatsFilter.java:47)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.gzipfilter.GzipFilter.doFilterInternal(GzipFilter.java:115)   at com.atlassian.gzipfilter.GzipFilter.doFilter(GzipFilter.java:92)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.confluence.web.filter.ConfluenceTimingFilter.doFilter(ConfluenceTimingFilter.java:46)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.prettyurls.filter.PrettyUrlsCombinedMatchDispatcherFilter.doFilter(PrettyUrlsCombinedMatchDispatcherFilter.java:61)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter$1.doFilter(DelegatingPluginFilter.java:58)   at com.atlassian.confluence.extra.webdav.servlet.filter.ReverseProxyFilter.doFilter(ReverseProxyFilter.java:409)   at com.atlassian.confluence.extra.webdav.servlet.filter.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:29)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:64)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:70)   at com.atlassian.plugin.servlet.filter.ServletFilterModuleContainerFilter.doFilter(ServletFilterModuleContainerFilter.java:58)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.util.MobileAppRequestFilter.doFilter(MobileAppRequestFilter.java:36)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.internal.web.filter.spring.IgnoreWebAsyncManagerFilter.doFilter(IgnoreWebAsyncManagerFilter.java:59)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.web.filter.validateparam.RequestParamValidationFilter.doFilter(RequestParamValidationFilter.java:51)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.web.filter.TranslationModeFilter.doFilter(TranslationModeFilter.java:39)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.plugin.servlet.filter.ActionContextCleanUp.doFilter(ActionContextCleanUp.java:72)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.web.filter.LanguageExtractionFilter.doFilter(LanguageExtractionFilter.java:49)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.impl.vcache.VCacheRequestContextFilter.lambda$doFilter$3(VCacheRequestContextFilter.java:44)   at com.atlassian.confluence.impl.vcache.VCacheRequestContextManager.doInRequestContextInternal(VCacheRequestContextManager.java:87)   at com.atlassian.confluence.impl.vcache.VCacheRequestContextManager.doInRequestContext(VCacheRequestContextManager.java:71)   at com.atlassian.confluence.impl.vcache.VCacheRequestContextFilter.doFilter(VCacheRequestContextFilter.java:43)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.util.LoggingContextFilter.doFilter(LoggingContextFilter.java:33)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.util.RequestCacheThreadLocalFilter.doFilter(RequestCacheThreadLocalFilter.java:65)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.github.kristofa.brave.servlet.BraveServletFilter.doFilter(BraveServletFilter.java:59)   at com.atlassian.confluence.web.filter.ZipkinTracingFilter.doFilter(ZipkinTracingFilter.java:52)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.web.filter.ResponseOutputStreamFilter.doFilter(ResponseOutputStreamFilter.java:25)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.johnson.filters.AbstractJohnsonFilter.doFilter(AbstractJohnsonFilter.java:59)   at com.atlassian.confluence.web.ConfluenceJohnsonFilter.doFilter(ConfluenceJohnsonFilter.java:32)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.core.filters.encoding.AbstractEncodingFilter.doFilter(AbstractEncodingFilter.java:41)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.impl.servlet.HoldingUntilStartedFilter.doFilter(HoldingUntilStartedFilter.java:88)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.core.filters.HeaderSanitisingFilter.doFilter(HeaderSanitisingFilter.java:44)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.servlet.FourOhFourErrorLoggingFilter.doFilter(FourOhFourErrorLoggingFilter.java:64)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at com.atlassian.confluence.web.filter.DebugFilter.doFilter(DebugFilter.java:46)   at com.atlassian.core.filters.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:31)   at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:240)   at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:207)   at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:212)   at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:94)   at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:616)   at org.apache.catalina.valves.StuckThreadDetectionValve.invoke(StuckThreadDetectionValve.java:206)   at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:141)   at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:79)   at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:88)   at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:502)   at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1132)   at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:684)   at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1539)   at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1495)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)   at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)   at java.lang.Thread.run(Thread.java:748)  Caused by: java.lang.RuntimeException: Failed to read image   at com.atlassian.confluence.extra.flyingpdf.LightITextFSImage.getImage(LightITextFSImage.java:247)   at org.xhtmlrenderer.pdf.ITextOutputDevice.drawImage(ITextOutputDevice.java:828)   at org.xhtmlrenderer.pdf.ITextImageElement.paint(ITextImageElement.java:72)   at org.xhtmlrenderer.pdf.ITextOutputDevice.paintReplacedElement(ITextOutputDevice.java:199)   at org.xhtmlrenderer.layout.Layer.paintReplacedElement(Layer.java:540)   at org.xhtmlrenderer.layout.Layer.paintReplacedElements(Layer.java:497)   at org.xhtmlrenderer.layout.Layer.paintAsLayer(Layer.java:471)   at org.xhtmlrenderer.render.BlockBox.paintInline(BlockBox.java:265)   at org.xhtmlrenderer.layout.Layer.paintInlineContent(Layer.java:274)   at org.xhtmlrenderer.layout.Layer.paint(Layer.java:332)   at org.xhtmlrenderer.pdf.ITextRenderer.paintPage(ITextRenderer.java:432)   at org.xhtmlrenderer.pdf.ITextRenderer.writePDF(ITextRenderer.java:380)   at org.xhtmlrenderer.pdf.ITextRenderer.createPDF(ITextRenderer.java:333)   at org.xhtmlrenderer.pdf.ITextRenderer.createPDF(ITextRenderer.java:265)   at com.atlassian.confluence.extra.flyingpdf.FlyingSaucerXmlToPdfConverter.convertXhtmlToPdf(FlyingSaucerXmlToPdfConverter.java:92)   ... 391 more  Caused by: java.lang.RuntimeException: Failed to read image   at com.atlassian.confluence.extra.flyingpdf.LightITextFSImage.getImage(LightITextFSImage.java:240)   ... 405 more  Caused by: java.lang.IllegalArgumentException: 0.0 incompatible with org.apache.batik.transcoder.keys.LengthKey@33840d89   at org.apache.batik.transcoder.TranscodingHints.put(TranscodingHints.java:92)   at org.apache.batik.transcoder.TranscoderSupport.addTranscodingHint(TranscoderSupport.java:58)   at com.atlassian.confluence.extra.flyingpdf.LightITextFSImage.getImage(LightITextFSImage.java:232)   ... 405 more{code}    h5. Workaround    There is no existing workaround. To fix the issue upgrade to Confluence 6.8+",2
"CONFSERVER-58549","07/05/2019 09:14:57","Deleting a field to display (clicking on the Bin icon) or reordering fields does nothing, when editing ""Filter Results"" macro","h3. Issue Summary    When editing the Jira *Filter Results* macro, the ""fields to display"" are unable to be edited. They are unable to be removed or sorted.  h3. Steps to Reproduce   # Use a Confluence instance with an application link to Jira.   # Create a new page and add the Jira *Filter Results* macro.   # Select the macro and click on Edit.   # In the preview pane, at the bottom of the list, click on the cogwheel icon and then Edit.   # Attempt to   ## Remove a field from the list of Fields to display, by clicking on the bin icon.   ## Reorder a field    h3. Expected Results    The field is removed / reordered from the list.  h3. Actual Results    Nothing happens, the field stays in the list.   Check the attached video [^DeleteField-FilterResultsMacro.mp4] for a recording of the issue's reproduction.  h3. Workaround    It is possible to remove and reorder fields using an additional plugin from Atlassian Marketplace called 'Source Editor'.   # In the Confluence user interface, select 'Confluence Administration' from the top right, then 'Manage Apps'   # Click 'Find new apps', and in the search box type in 'Source editor'.   # In the search results, find this one :   !source-editor-marketplace.png|thumbnail!    (You can also find it in the Atlassian Marketplace - [source editor|https://marketplace.atlassian.com/apps/1210722/confluence-source-editor?hosting=server&tab=overview])   Click 'install'   # Wait a few seconds and close the popup that says it's installed   # Load the Confluence page with the problematic macro on it   # Edit the page (but don't click 'edit' on the macro)   # In the top right corner, click on the '<>' icon (Mouseover will show 'Open in source editor')   # The example below shows the default columns, plus a new one that I added 'Created': Type, Key, Priority, Summary, Created.   # The macro block itself is within the <ac:structured-macro> tag:  {code:java}  <p>'Filter Results' macro added from Jira:</p>  <p>    <ac:structured-macro ac:macro-id=""7a4a1ab1-3113-432d-8158-904056e9d433"" ac:name=""gadget"" ac:schema-version=""1"">      <ac:parameter ac:name=""filterId"">filter-10002</ac:parameter>      <ac:parameter ac:name=""isConfigured"">true</ac:parameter>      <ac:parameter ac:name=""preferences"">filterId=filter-10002&amp;num=10&amp;columnNames=issuetype%7Cissuekey%7Cpriority%7Csummary%7Ccreated&amp;isConfigured=true&amp;refresh=false</ac:parameter>      <ac:parameter ac:name=""columnNames"">issuetype|issuekey|priority|summary|created</ac:parameter>      <ac:parameter ac:name=""num"">10</ac:parameter>      <ac:parameter ac:name=""refresh"">false</ac:parameter>      <ac:parameter ac:name=""url"">http:/testmachine.atlassian.com:8080/jira/rest/gadgets/1.0/g/com.atlassian.jira.gadgets:filter-results-gadget/gadgets/filter-results-gadget.xml</ac:parameter>    </ac:structured-macro>  </p>  {code}   # Using the source editor, remove or rearrange the fields/columns that you wish to remove or rearrange from the macro. For example, to remove the 'Created' field, we just need to change the two lines that reference it, changing:  {code:java}  <ac:parameter ac:name=""preferences"">filterId=filter-10002&amp;num=10&amp;columnNames=issuetype%7Cissuekey%7Cpriority%7Csummary%7Ccreated&amp;isConfigured=true&amp;refresh=false</ac:parameter>  <ac:parameter ac:name=""columnNames"">issuetype|issuekey|priority|summary|created</ac:parameter>  {code}  To:  {code:java}  <ac:parameter ac:name=""preferences"">filterId=filter-10002&amp;num=10&amp;columnNames=issuetype%7Cissuekey%7Cpriority%7Csummary&amp;isConfigured=true&amp;refresh=false</ac:parameter>  <ac:parameter ac:name=""columnNames"">issuetype|issuekey|priority|summary</ac:parameter>  {code}   # Click 'Apply' in the bottom-right corner of the source editor, then 'Update' to save the whole page.",3
"CONFSERVER-58642","07/30/2019 01:19:32","Subscribing to Team Calendars in Confluence with events from restricted or inexistent Jira projects might fail","h3. Issue Summary  Confluence users can subscribe to Team Calendars and get an updated list of events from Confluence in their preferred calendar _app_ as described in [Subscribe to and from Team Calendars|https://confluence.atlassian.com/teamcal/subscribe-to-and-from-team-calendars-273285883.html].  If users subscribe to a Calendar that has events from a restricted or an inexistent Jira project (see [Add Jira Events|https://confluence.atlassian.com/teamcal/add-jira-events-241566244.html] for further information), then Confluence will throw an error instead of gracefully bypassing events associated to that project.    h3. Steps to Reproduce  # Install a vanilla instance of Jira Software.   #* This was validated with Jira Software 7.9.2 but should not be tied to a specific Jira version.  # As the Jira administrator, create a sample project.   ## Go to *Projects* > *Create project* > *Create sample data*.   ## Select *Project management* and click on *Next*.   ## Use the following information to create the project: _Name_: {{Test Project}} ; _Key_: {{TSTPRJ}}; _Project Lead_: {{jira administrator}}  # Restrict the _Browse Projects_ permissions just to Jira administrators, removing the permission to any logged user.  # Create a regular Jira user, which is added just to the {{jira-software-users}} group.   #* _username_: {{user001}}  # Install a vanilla instance of Confluence.   #* This was validated with Confluence 6.13.3 but should not be tied to a specific Confluence version.  # [Install Team Calendars|https://confluence.atlassian.com/teamcal/install-team-calendars-241566248.html].   #* This was validated with Team Calendars 6.0.37.  # Create a regular Confluence user, which is added just to the {{confluence-users}} group.   #* _username_: {{user001}}  # Create an application link between Confluence and Jira.  # Create a blank space: _Space Name_: {{Test-Team-Calendars}}; _Space Key_: {{TTC}}  # Go to {{<Confluence Base URL>/display/TTC/calendars}} and add a new calendar.   #* _Name_: {{Test Calendar}}  # Within _Test Calendar_, click on *...* > *Add event*.   #* Select _Event Type_: {{Jira Issue Dates}}; _Name_: {{Test Project Calendar}}; _Display_: {{JQL (advanced)}}; _JQL_: {{project = ""Test Project""}}; _Show_: {{Issue Created Date}}   #* At this point the events are added and the administrator has visibility to the events in the calendar.   # As {{user001}} access {{<Confluence Base URL>/display/TTC/calendars}} and click on _Subscribe_.   #* Choose _Calendar_: {{Test Calendar}}; _Calendar app_: {{iCal}}  # Copy the _Team Calendars URL_ and paste it in the browser.    h3. Expected Results  A pop-up is given by the browser so the user can download an _.ics_ file.  Confluence gracefully handles the fact the Jira project is restricted and doesn't include events from this sub-calendar, but still shows events from other sub-calendars.    h3. Actual Results  Confluence answers with HTTP 500 status and with a {{java.lang.NullPointerException}} to the user.  An error similar to the below is logged in {{atlassian-confluence.log}}:  {code}  2019-07-29 20:00:19,388 ERROR [http-nio-26133-exec-5] [extra.calendar3.calendarstore.JiraCalendarDataStore] getSubCalendarContentInternal The JQL query for project = ""Change This"" didn't return any results. Try changing the query.   -- url: /c6133/rest/calendar-services/1.0/calendar/export/subcalendar/private/2e98b166a615cf7514ce8aed31452ebe922608bf.ics | traceId: ab23bcd31934a9b9 | userName: user001  2019-07-29 20:00:19,390 ERROR [http-nio-26133-exec-5] [extra.calendar3.calendarstore.CalendarDataStoreCachingDecorator] load Could not load calendar content from cache key   -- url: /c6133/rest/calendar-services/1.0/calendar/export/subcalendar/private/2e98b166a615cf7514ce8aed31452ebe922608bf.ics | traceId: ab23bcd31934a9b9 | userName: user001  com.atlassian.confluence.extra.calendar3.exception.CalendarException: calendar3.jira.error.jqlwrong.one   at com.atlassian.confluence.extra.calendar3.calendarstore.AbstractJiraSubCalendarDataStore.getSubCalendarContentInternal(AbstractJiraSubCalendarDataStore.java:498)   at com.atlassian.confluence.extra.calendar3.calendarstore.AbstractJiraSubCalendarDataStore.getSubCalendarContentInternal(AbstractJiraSubCalendarDataStore.java:80)   at com.atlassian.confluence.extra.calendar3.calendarstore.ExternalCalendarDataStore.getSubCalendarContent(ExternalCalendarDataStore.java:54)   at com.atlassian.confluence.extra.calendar3.calendarstore.CalendarDataStoreCachingDecorator.getSubCalendarContentFromCalendarDataStore(CalendarDataStoreCachingDecorator.java:274)   at com.atlassian.confluence.extra.calendar3.calendarstore.CalendarDataStoreCachingDecorator.access$200(CalendarDataStoreCachingDecorator.java:63)   at com.atlassian.confluence.extra.calendar3.calendarstore.CalendarDataStoreCachingDecorator$1.load(CalendarDataStoreCachingDecorator.java:93)   at com.atlassian.confluence.extra.calendar3.calendarstore.CalendarDataStoreCachingDecorator$1.load(CalendarDataStoreCachingDecorator.java:80)   at com.atlassian.cache.ehcache.LoadingCache.getFromLoader(LoadingCache.java:145)  {code}    The user is unable to subscribe to the Calendar.    h3. Notes  The same problem occurs if the target project is unrestricted in Jira, but had its name/key changed after the calendar was created in Confluence, invalidating the JQL query.    h3. Workaround  There's no straightforward workaround to the _subscribe use case_ and still keep the original data in Confluence.  The problematic JQL can be determined by the error in Confluence log.  One of the following options can be used with their possible consequences:   * If the Jira project was renamed, then search for the Calendars pointing to it and update the JQL filter.   * If the Jira project was removed, then search for the event pointing to it and remove it.   * If the Jira project is restricted to certain users, removing it from a _public_ calendar may be an option to certain use cases.    If applicable, exporting the calendar to an _.ics_ file as explained in [this KB|https://confluence.atlassian.com/teamcal/export-team-calendars-content-to-other-calendars-240913738.html] still works.  ",3
"CONFSERVER-58932","07/31/2019 08:22:12","In app notification setting is misaligned","h3. Issue Summary  h3. Environment    (Optional - If Applicable)   *   *  h3. Steps to Reproduce   * go to [~/plugins/servlet/myworkserviceselector.action|https://bulldogwiki.internal.atlassian.com/wiki/plugins/servlet/myworkserviceselector.action]    h3. Expected Results    Element should align  h3. Actual Results    !Screen Shot 2019-08-26 at 11.30.58.png|width=869,height=344!  h3. Notes    (Optional - If Necessary)  h3. Workaround    Required, if there is no workaround please state:   Currently there is no known workaround for this behavior. A workaround will be added here when available",1
"CONFSERVER-58840","07/31/2019 08:25:40","Global PDF style and layout page alignment","h3. Issue Summary  h3. Environment    (Optional - If Applicable)   *   *  h3. Steps to Reproduce   * go to either location   ** Global PDF sytle   ** Global PDF layout    h3. Expected Results    it should align       h3. Actual Results    !image2019-7-31_16-9-26.png|width=557,height=340!  h3. Notes    (Optional - If Necessary)  h3. Workaround    Required, if there is no workaround please state:   Currently there is no known workaround for this behavior. A workaround will be added here when available",1
"CONFSERVER-58831","07/31/2019 08:31:44","Space attachments table layout issue","h3. Issue Summary  h3. Environment    (Optional - If Applicable)   *   *  h3. Steps to Reproduce   * go to Space tool → content tool → attachments    h3. Expected Results    icons should show correctly  h3. Actual Results   * icon shows when not being hovered   * hovered arrow is misaligned     !image-2019-09-03-17-22-54-353.png|width=255,height=107!        * File name is wrapped to a new line    !image-2019-09-03-17-24-17-526.png|width=267,height=200!  h3. Notes    (Optional - If Necessary)  h3. Workaround    Required, if there is no workaround please state:   Currently there is no known workaround for this behavior. A workaround will be added here when available",1
"CONFSERVER-58839","07/31/2019 08:34:43","Space import misaligned checkboxes","h3. Issue Summary  h3. Environment    (Optional - If Applicable)   *   *  h3. Steps to Reproduce   * Space tool → content tool → import     h3. Expected Results    elements align  h3. Actual Results    !image2019-7-31_16-19-53.png!  h3. Notes    (Optional - If Necessary)  h3. Workaround    Required, if there is no workaround please state:   Currently there is no known workaround for this behavior. A workaround will be added here when available",1
"CONFSERVER-58834","07/31/2019 08:41:14","Spacetool Look and Feel layout copy letter case is not consistent","h3. Issue Summary  h3. Environment    (Optional - If Applicable)   *   *  h3. Steps to Reproduce   * Spacetool → Look and Feel → layout    h3. Expected Results    Should look consistent  h3. Actual Results    !image-2019-09-03-16-53-21-140.png|width=601,height=540!  h3. Notes    (Optional - If Necessary)  h3. Workaround    Required, if there is no workaround please state:   Currently there is no known workaround for this behavior. A workaround will be added here when available",1
"CONFSERVER-58836","08/01/2019 05:17:27","User profile macro - email is truncated","Create a page with the user profile macro for a user with a long enough email. An example is here https://bulldogwiki.internal.atlassian.com/wiki/pages/viewpage.action?pageId=44564533    Notice the email is truncated.",1
"CONFSERVER-58680","08/06/2019 10:36:34","Navigating through inline comments using the arrows breaks if navigation hits an inline comment on a text warn/info macro","h3. Issue Summary  Given a Confluence page with a lot of content and has inline comments, navigating between the inline comments will glitch, should the following conditions are met:  # The page contains a warn/info macro with inline comments.   # The above macro is located at the area of page that requires the user to scroll down to view it. (The issue does not happen if the macro is located at the top of the page)  When navigating through all the inline comments using the top and bottom arrows on the left side of the inline comment section, the navigation glitches when you hit the inline comment that is located in the warn/info macro.    In normal cases, when a user navigates through the inline comments the page will auto scroll to the text referred to by a specific inline comment. However, in the case of this bug, Confluence will not scroll to the text referred to by the inline comment in the warn/info macro. Instead Confluence, will auto scroll to the top of the page.       h3. Steps to Reproduce  # Create a page in Confluence with a lot of content. The content needs to be enough, so that you need to scroll down when viewing the page.   # At the bottom of the page, add an warning macro   # Add a text inside that macro and add some inline comments to the text.  # Add inline comments in the various areas of the page.   # Save the page.   # Click on any of the text with inline comment  # Navigate through the comments using the arrows on the top right side of the inline comment.  # Navigate until you reach the info/warn macro's inline comment.    h3. Expected Results  # The browser will auto scroll to where the info/warn macro is.  # The inline comment will be displayed at the same level where the info/warn macro is.    h3. Actual Results  # The browser will move to the top of the page.   # The inline comment will still be displayed at the same level where the info/warn macro is. This means that the user can scroll down until they find the inline comment box and continue navigating from there.       h3. Workaround  No known workaround at the moment.   ",2
"CONFSERVER-58748","08/22/2019 12:41:43","  Browser console  error: No confluence/form-state-control is triggered when opening Team Calendar","h3. Issue Summary    Browser console error: No confluence/form-state-control is triggered when opening Team Calendar  h3. Steps to Reproduce   # Install Team Calendars plugin   # Enable browser developer tools -> console   # Navigate to ""Calendars"" tab    h3. Actual Results    Following error is displayed it the browser console  {code:java}  batch.js?locale=en-US:641 [TEAMCAL]Fallback to no module confluence/form-state-control Error: No confluence/form-state-control      at r (batch.js?locale=en-US:50)      at i (batch.js?locale=en-US:53)      at batch.js?build-number=8100&healthcheck-resources=true&hostenabled=true&locale=en-US:14372      at s (batch.js?locale=en-US:52)      at r (batch.js?locale=en-US:50)      at i (batch.js?locale=en-US:53)      at batch.js?build-number=8100&healthcheck-resources=true&hostenabled=true&locale=en-US:39059      at batch.js?build-number=8100&healthcheck-resources=true&hostenabled=true&locale=en-US:39329  (anonymous) @ batch.js?locale=en-US:641  (anonymous) @ batch.js?build-number=8100&healthcheck-resources=true&hostenabled=true&locale=en-US:14374  s @ batch.js?locale=en-US:52  r @ batch.js?locale=en-US:50  i @ batch.js?locale=en-US:53  (anonymous) @ batch.js?build-number=8100&healthcheck-resources=true&hostenabled=true&locale=en-US:39059  (anonymous) @ batch.js?build-number=8100&healthcheck-resources=true&hostenabled=true&locale=en-US:39329  batch.js?locale=en-US:641 TC detected the width. Will go ahead !!!  {code}  h3. Workaround    Currently there is no known workaround for this behavior. A workaround will be added here when available",1
"CONFSERVER-58751","08/23/2019 06:36:40","User Loses all Local Group Memberships If LDAP Sync is Unable to find the User, but the User appears again in subsequent syncs","h3. Summary    When users are filtered out/synchronized out from Confluence and re-synchronized back into Confluence, they will lose their Local Group Membership.   This is a regression from CONFSERVER-28621  h3. Environment  * Confluence 6.15x  * Cannot replicate this issue on 6.14.0. Expired users are shown as ""Disabled""   * Unable to replicate on Confluence 7.0.1-beta1    h3. Steps to Reproduce   # Add a connection to LDAP in {{Confluence Admin >> User Directories}} with the *Read Only, with Local Groups* option   # Sync the directory and make sure that LDAP users are returned   # Add 1 LDAP user to a local group (membership)   # Change the User Object Filter in the directory's configuration in {{Confluence Admin >> User Directories}} to a dummy filter, such as the following:  {code:java}  (&(objectclass=inetorgperson)(cn=dummynonexistentuser))  {code}     # Sync the directory again (Notice that the LDAP users are missing)   # Revert the User Object Filter to the previous working filter   # Sync the directory again (notice that the LDAP users are back, but their local group memberships are gone)    h3. Notes    This issue could happen if expired users get filtered out from Confluence due to the ""Filter out expired users"" settings, and re-synchronized back into Confluence after their expiry has been refreshed  h3. Workaround   # Restore the instance's database backup to a new database (i.e. not production) prior to the point where memberships were lost.   # Follow the instructions in step 1 of [Migrating Local Group Memberships Between Directories|https://confluence.atlassian.com/display/CONFKB/Migrate+Local+Group+Memberships+Between+Directories] to generate a CSV file of users and their memberships.   # Run through the rest of the instructions in that KB article to populate the production instance's group memberships.",8
"CONFSERVER-58762","08/27/2019 04:37:05","Setting Calendar restriction makes creator of calendar unable to access to some sub-calendars","h3. Issue Summary  Setting Calendar restriction makes creator of calendar unable to access to sub-calendars that is created by other users.      h3. Environment  Team Calendar    h3. Steps to Reproduce   # Create user1 and user2   # Log in as user1    # Create calendar with name ""user1calendar""   # Create an event for sub-calendar ""Event""   # Login as user2   # Add ""user1calendar""   # Create an event for sub-calendar ""Travel""   # Login as user1 again.   # Set calendar restriction of ""user1calendar"" to restrict viewing privilege only to user2    h3. Expected Results  user1 is able to see events on all sub-calendars i.e. ""Event"" and ""Travel"" because they are creator of calendar.   Otherwise, user1 shouldn't be able to see any sub-calendars because the calendar is restricted to user2.    h3. Actual Results  user1 can see ""Event"" but cannot see ""Travel"".  And user1 keeps seeing Warning on their dashboard and top of calendar.  {quote}  Warning(s) occurred.  Unable to load events of user1calendar. You are not permitted to view its events. For access you may want to contact your administrator.  {quote}   !Screen Shot 2019-08-27 at 11.59.15.png|thumbnail!    !Screen Shot 2019-08-27 at 12.26.50.png|thumbnail!     h3. Note  * Due to CONFSERVER-51216, it's not easy to know who created the calendar. Just respecting calendar restriction even to creator as described in the second option of ""Expected Results"" would be straightforward.    * In the example above the user1 sees ""Unable to load *user1calendar* "". And this message is *same even after ""user1calendar"" is renamed*. It makes hard to track which calendar is causing the warning.     h3. Workaround  Explicitly add viewing permission to user1 on the user1calendar on the calendar restriction setting. ",2
"CONFSERVER-58833","08/27/2019 05:41:22","Hipchat integration plugin wizard second step is not responsive due to js console error","h3. Issue Summary  h3. Environment    (Optional - If Applicable)   *   *  h3. Steps to Reproduce   # go to admin configurations   # go to Hipchat integration `~/plugins/servlet/hipchat/configure`   # connect to coconut   # install confluence add-on   # select a room    h3. Expected Results    should be able to proceed  h3. Actual Results    there is no interactive element to let the user to proceed and there are console errors  {noformat}  Failed to run init function: Cannot read property 'context' of undefined ƒ ($) {          var space = null;          var form = $('#confluence-space-to-room-mapping-form');          var notificationTypes = form.data('notification-types');        if (AJS.Meta.get('space-key')… TypeError: Cannot read property 'context' of undefined      at confluence-hipchat-space-to-room-internal-ui.js:171      at aui.chunk.a8f44844d33c3398dce1--219db96b99bd1d106253.js:1 TypeError: Cannot read property 'context' of undefined      at http://localhost:8080/confluence/s/e868a6d1aa69ba6b5c181bd82c66de9f-CDN/j2llnw/8202/NOCACHE/8.4.2-SNAPSHOT/_/download/resources/com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:hipchat-js-resources/confluence-hipchat-space-to-room-internal-ui.js?locale=en-GB:171:30      at http://localhost:8080/confluence/s/e868a6d1aa69ba6b5c181bd82c66de9f-CDN/j2llnw/8202/NOCACHE/8.3.4/_/download/resources/com.atlassian.auiplugin:split_aui.side-effects/aui.chunk.a8f44844d33c3398dce1--219db96b99bd1d106253.js?locale=en-GB:1:488  (anonymous) @ aui.chunk.ddc0d6f2ec80346db1b3--7f2bcdeaa157db28d10b.js:1  confluence-hipchat-space-to-room-internal-ui.js:229 Uncaught TypeError: Cannot read property 'auiSelect2' of undefined      at getSelectedSpace (confluence-hipchat-space-to-room-internal-ui.js:229)      at HTMLInputElement.<anonymous> (confluence-hipchat-space-to-room-internal-ui.js:162)      at HTMLInputElement.dispatch (jquery.js:4742)      at HTMLInputElement.elemData.handle (jquery.js:4554)      at Object.trigger (jquery.js:7812)      at Object.jQuery.event.trigger (jquery-migrate.js:596)      at HTMLInputElement.<anonymous> (jquery.js:7880)      at Function.each (jquery.js:370)      at jQuery.fn.init.each (jquery.js:138)      at jQuery.fn.init.trigger (jquery.js:7879)  {noformat}  h3. !Screen Shot 2019-08-27 at 14.28.57.png|width=606,height=210!!Screen Shot 2019-08-27 at 14.23.46.png|width=507,height=179!  h3. Notes    This only happens once for a new instance.   h3. Workaround    Refresh the page and the errors will be gone.",1
"CONFSERVER-58835","09/05/2019 01:45:41","Share Link dialog has misaligned button depending on language","h3. Issue Summary  h3. Steps to Reproduce   # switch the language from english (e.g. to german)   # Go to a page   # Click the ""share"" button    h3. Expected Results    aligned copy link button  h3. Actual Results    Spinner is misaligned. Button in dialog is misaligned.    !image-2019-08-12-16-02-15-497.png|width=297,height=375!      (flag)    !Screen Shot 2019-09-05 at 10.50.33 am.png|width=333,height=205,thumbnail!       h3. Workaround    Required, if there is no workaround please state:   Currently there is no known workaround for this behavior. A workaround will be added here when available",1
"CONFSERVER-58868","09/13/2019 04:53:14","Share dialog UI elements are misaligned in US English","h3. Steps   # Set browser default language to English (United States) or set Confluence profile language to the same   # Goto a page   # Click on the share dialog    *What happened...*    Copy link button is misaligned from URL box    *What should have happened...*    UI should look nice and tidy    Note this does not happen when the language is set to English (United Kingdom)    *Workaround*    Set your browser language or language in your Confluence profile to English (United Kingdom)",1
"CONFSERVER-58896","09/19/2019 15:37:44","Team Calendars time picker uses incorrect time format","h3. Issue Summary    When using any version of Team Calendars in Confluence version 7.0.x the time picker in displays times in 12h (AM/PM) by default and does not follow the settings in Team Calendar. In other versions of Confluence it works as expected.  h3. Environment    Confluence 7.0.x    Tested with:   Team Calendars 6.0.42   Team Calendars 6.0.37   Team Calendars 6.0.32       h3. Steps to Reproduce   # Install Team Calendars in Confluence 7.0.x   # When creating a new event the time format is in 12h (AM/PM)    h3. Expected Results    It is in 24h format, or follows the configuration settings  h3. Actual Results    It is always set to 12h (AM/PM)  h3. Workaround    No workaround is known at the moment",3
"CONFSERVER-58917","09/25/2019 06:16:12","Inconsistent status macro colours","h3. Issue Summary    Status macro uses different background colours in the editor and when viewing the page after. The same in comments.  See attached screenshot.    h3. Steps to Reproduce   # Create page with status macro in it   # Save the page   # Observe status macro look differently than in the editor    h3. Expected Results    Same colours.    h3. Actual Results     !Screen Shot 2019-09-25 at 15.07.31.png!     h3. Workaround     Currently there is no known workaround for this behavior. A workaround will be added here when available",2
"CONFSERVER-58948","10/02/2019 22:49:40","Popular Calendars dialog shows list of calendars sorted ascendingly by the Subscribers column","h3. Issue Summary  When clicking on ""Add existing calendar"" option on Team Calendars screen, the list of existing calendars is shown ordered by Subscribers in an ascending manner. This results in UI showing the least popular calendars first - in order to see the more popular calendars it's necessary to scroll to the bottom of the list.    h3. Steps to Reproduce   # Add three users in Confluence (user1, user2, user3)   # Create three calendars in Team Calendars (Calendar1, Calendar2, Calendar3)   # Make user1 watch Calendar1   # Make user2 watch Calendar1 and Calendar2   # Make user3 watch all three calendars   # Go to ellipsis and click on ""Add existing calendar""    h3. Expected Results  A list of existing calendars is shown ordered by ""Subscribers"" in a *descending* manner.   !Screen Shot 2019-10-02 at 6.37.45 PM.png|thumbnail!     h3. Actual Results  A list of existing calendars is shown ordered by ""Subscribers"" in an *ascending* manner.   !Screen Shot 2019-10-02 at 6.36.31 PM.png|thumbnail!     h3. Notes  The bug does not manifest itself on older TC versions like 6.0.25.    h3. Workaround    Currently, there is no known workaround for this behavior other than using an older version of Team Calendars. A workaround will be added here when available.",1
"CONFSERVER-59396","10/03/2019 02:58:00","ApplicationDirectoryOrderUpdatedEvent is not taken into account by Gatekeeper","h3. Issue Summary    When the order of directories is changed, Gatekeeper is not aware of it and does not update its user cache.  h3. Environment    N/A  h3. Steps to Reproduce   # Configure two directories with a user which exists in both directories   # Change the order of directories    h3. Expected Results    User cache must contain the user from the directory with the highest priority  h3. Actual Results    User is not updated in user cache  h3. Notes   # ApplicationDirectoryOrderUpdatedEvent is sent when the position of a directory is changed.   # We receive the only one event. For example, we have two directories and moved one of them. Even though positions of both directories are changed, we will get one event only.    h3. Workaround    The system administrator can disable and then enable the plugin to make it refresh the user cache.",3
"CONFSERVER-58957","10/04/2019 06:56:49","Preview macros for PDF and PowerPoint stops working after sometime","h3. Issue Summary    Previewing PDF or Office files via Office macros like PDF macro stops working after sometime  h3. Environment    7.0.1 and above  h3. Steps to Reproduce   # Add an Office (or PDF) attachment to a page   # Use Powerpoint (ppt) macro to preview the attachment   # The attachment will work   # Wait overnight   # Open the page with another browser or open with private browsing mode (not to use browser cache)    h3. Expected Results    Browser displays image of the office file   !Screen Shot 2019-10-04 at 14.37.20.png|thumbnail!  h3. Actual Results    The preview image is broken.   !Screen Shot 2019-10-04 at 14.37.00.png|thumbnail!  h3. Notes    The preview image is stored under {{<confluence-home>/viewfile/temp}} directory, and apparently {{scheduledjob.desc.cleanupTrigger}} job is clearing up the temp directory. This is a scheduled job that runs at 2 AM automatically.  h3. Workaround    Disabling the [Scheduled Job|https://confluence.atlassian.com/doc/scheduled-jobs-96567525.html] scheduledjob.desc.cleanupTrigger may *not* stop the job from running. This is due to a new bug that disabling a system scheduled job (e.g. cleanupTrigger) continues to run post restart of Confluence:   - CONFSERVER-59501 - Disabling a system scheduled job continues to run post restart of Confluence    In order to properly disable it, we need to *disable* the *Office Connector* module related to the {{cleanupTrigger}} job.   # Navigate to Manage Apps in Confluence (requires Confluence admin permission)   # Filter it by *System* apps and search for *_Office Connector Plugin_*. Click on it to expand.   # Click on *Modules* to expand the list and look for {{File Cache Cleanup (cleanupTrigger)}}.   # Leave the mouse cursor on it and the *Disable* button will show up. Click on it.   (!) For broken files, it's necessary to reupload in order to recreate them.    Or, utilize the thumbnail feature of [Display Files and Images|https://confluence.atlassian.com/doc/display-files-and-images-245827130.html] instead of Office macro.",3
"CONFSERVER-58983","10/11/2019 09:26:40","Widget Connector should support youtube URLs from youtube-nocookie.com domain","Widget Connector should support youtube URLs from *youtube-nocookie.com* domain    According to European Data Protection Laws Youtube Videos have to be embedded using the www.youtube-nocookie.com URL.   Widget Connector does not work when using a youtube-nocookie domain.    +*Current Behaviour*+   Widget Connector currently accepts youtube links like the following format:   [https://www.youtube.com/watch?t=15&v=LhHKkodOPFo]    +*Suggested feature*+    Should also be compatible with youtube links from youtube-nocookie domain like the following:   [https://www.youtube-nocookie.com/embed/LhHKkodOPFo]",2
"CONFSERVER-59051","10/25/2019 05:19:16","Upgrade Confluence from 6.15 to 7.0 Webdav is broken","h3. Issue Summary  Upgrade Confluence from 6.15.9 to 7.0.2 won't be able to use WebDav.    h3. Steps to Reproduce   # Start up Confluence 6.15 instance (any version before 7.0)    # Go to admin page general configuration -> webdav configuration   # Save on configuration.    # Setup Webdav client following this doc.     # Upgrade Confluence to 7.0 (any version of 7.0)   # Go to admin page general configuration -> webdav configuration      h3. Expected Results  WebDav Client is functional   webdav configuration is accessible    h3. Actual Results  WebDav client shows empty folder    !image-2019-10-25-15-16-59-313.png|thumbnail!   Webdav configuration isn't accessible, showing error below      !image-2019-10-25-15-16-03-650.png|thumbnail!       The below exception is thrown in the atlassian-confluence.log file:  {noformat}  java.lang.ClassCastException: java.lang.String cannot be cast to com.atlassian.confluence.extra.webdav.WebdavSettings   at com.atlassian.confluence.extra.webdav.BandanaWebdavSettingsManager.getWebdavSettings(BandanaWebdavSettingsManager.java:39)   at com.atlassian.confluence.extra.webdav.BandanaWebdavSettingsManager.getWriteBlacklistClients(BandanaWebdavSettingsManager.java:58)   at com.atlassian.confluence.extra.webdav.BandanaWebdavSettingsManager.isClientInWriteBlacklist(BandanaWebdavSettingsManager.java:48)   at com.atlassian.confluence.extra.webdav.servlet.filter.ClientWriteDenyFilter.isWebdavClientDenied(ClientWriteDenyFilter.java:27)   at com.atlassian.confluence.extra.webdav.servlet.filter.ClientWriteDenyFilter.doFilter(ClientWriteDenyFilter.java:31)   at com.atlassian.confluence.extra.webdav.servlet.filter.AbstractHttpFilter.doFilter(AbstractHttpFilter.java:29)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.doFilter(DelegatingPluginFilter.java:62)   at com.atlassian.plugin.servlet.filter.IteratingFilterChain.doFilter(IteratingFilterChain.java:37)   at com.atlassian.plugin.servlet.filter.DelegatingPluginFilter.lambda$doFilter$0(DelegatingPluginFilter.java:57)  {noformat}    h3. Workaround  {code}  select * from bandana where bandanavalue like '%webdav%';  delete from BANDANA where BANDANAID=<id_from_the_previous_query>;  {code}  ",2
"CONFSERVER-59096","11/08/2019 18:09:27","When using widget connector to embed tweet, the macro loads first time and fails subsequently","h3. Issue Summary    When using widget connector to embed tweet, the macro loads first time and fails subsequently    Flushing the _Widget Connector - Single Tweets_ cache allows the widget to load successfully again but fails subsequently.    This does not occur in Confluence 6.15.9  h3. Steps to Reproduce   # Insert Widget Connector in a test page   # Load a tweet. Ex: [https://twitter.com/Atlassian/status/1192840265402396674]   # Publish page. Macro loads successfully.   # Reload page.    h3. Expected Results    Macro loads and displays tweet  h3. Actual Results    Macro fails to load.   !broken_widget.png|width=525,height=148!    The below exception is thrown in the atlassian-confluence.log file:  {code:none}  2019-11-08 11:58:05,771 ERROR [http-nio-6704-exec-7] [xhtml.view.macro.ViewMacroMarshaller] handleMacroExecutionException Error rendering macro: widget   -- url: /c704/display/TEST/Widget | page: 884738 | traceId: ef0966adfb81750b | userName: admin | referer: http://localhost:6704/c704/ | action: viewpage  java.util.concurrent.CompletionException: com.atlassian.vcache.ExternalCacheException: Failed due to UNCLASSIFIED_FAILURE   at java.util.concurrent.CompletableFuture.reportJoin(CompletableFuture.java:375)   at java.util.concurrent.CompletableFuture.join(CompletableFuture.java:1934)   at com.atlassian.vcache.VCacheUtils.unsafeJoin(VCacheUtils.java:44)   at com.atlassian.confluence.extra.widgetconnector.chatter.TwitterRenderer.getTweetRetrievalResultFromCache(TwitterRenderer.java:126)   at com.atlassian.confluence.extra.widgetconnector.chatter.TwitterRenderer.getTweetHtml(TwitterRenderer.java:99)   at com.atlassian.confluence.extra.widgetconnector.chatter.TwitterRenderer.getParameters(TwitterRenderer.java:78)   at com.atlassian.confluence.extra.widgetconnector.chatter.TwitterRenderer.getEmbeddedHtml(TwitterRenderer.java:192)   at sun.reflect.GeneratedMethodAccessor1461.invoke(Unknown Source)   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)   at java.lang.reflect.Method.invoke(Method.java:498)  ...  Caused by: com.atlassian.vcache.ExternalCacheException: Failed due to UNCLASSIFIED_FAILURE  ...  Caused by: java.util.concurrent.CompletionException: com.atlassian.vcache.ExternalCacheException: Failed due to MARSHALLER_FAILURE   at java.util.concurrent.CompletableFuture.reportJoin(CompletableFuture.java:375)   at java.util.concurrent.CompletableFuture.join(CompletableFuture.java:1934)   at com.atlassian.vcache.VCacheUtils.unsafeJoin(VCacheUtils.java:44)   at com.atlassian.vcache.internal.core.service.AbstractStableReadExternalCache.lambda$null$3(AbstractStableReadExternalCache.java:112)  ...  Caused by: com.atlassian.vcache.ExternalCacheException: Failed due to MARSHALLER_FAILURE   at com.atlassian.vcache.internal.core.cas.IdentifiedUtils.unmarshall(IdentifiedUtils.java:51)   at com.atlassian.vcache.internal.legacy.LegacyStableReadExternalCache.directGet(LegacyStableReadExternalCache.java:130)   at com.atlassian.vcache.internal.core.service.AbstractStableReadExternalCache.lambda$null$0(AbstractStableReadExternalCache.java:95)   at java.util.Optional.orElseGet(Optional.java:267)  ...  Caused by: com.atlassian.marshalling.api.MarshallingException: Legacy unmarshall() failed   at com.atlassian.vcache.Marshaller.unmarshallFrom(Marshaller.java:73)   at com.atlassian.vcache.internal.core.metrics.TimedUnmarshaller.unmarshallFrom(TimedUnmarshaller.java:34)   at com.atlassian.vcache.internal.core.cas.IdentifiedUtils.unmarshall(IdentifiedUtils.java:48)   ... 615 more  Caused by: com.atlassian.vcache.MarshallerException: Unable to unmarshall   at com.atlassian.vcache.marshallers.JavaSerializationMarshaller.unmarshall(JavaSerializationMarshaller.java:71)   at com.atlassian.vcache.marshallers.JavaSerializationMarshaller.unmarshall(JavaSerializationMarshaller.java:27)   at com.atlassian.vcache.Marshaller.unmarshallFrom(Marshaller.java:71)   ... 617 more  Caused by: java.lang.ClassNotFoundException: com.atlassian.confluence.extra.widgetconnector.chatter.TwitterRenderer$TweetRetrievalResult   at org.apache.catalina.loader.WebappClassLoaderBase.loadClass(WebappClassLoaderBase.java:1365)   at org.apache.catalina.loader.WebappClassLoaderBase.loadClass(WebappClassLoaderBase.java:1188)   at java.lang.Class.forName0(Native Method)   at java.lang.Class.forName(Class.java:348)   at java.io.ObjectInputStream.resolveClass(ObjectInputStream.java:686)   at java.io.ObjectInputStream.readNonProxyDesc(ObjectInputStream.java:1868)   at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1751)   at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:2042)   at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1573)   at java.io.ObjectInputStream.readObject(ObjectInputStream.java:431)   at com.atlassian.vcache.marshallers.JavaSerializationMarshaller.unmarshall(JavaSerializationMarshaller.java:69)   ... 619 more  {code}  h3. Workaround    A workaround for this is to enable the HTML Macro, and then use [https://publish.twitter.com/] to generate the embed code.",2
"CONFSERVER-59098","11/11/2019 08:14:17","Not able to publish draft when there's a former user mentioned","h3. Issue Summary  Having a draft to a page where there's a specific user mentioned, if this user is deleted, it will not be possible to publish the draft.    h3. Steps to Reproduce  # Mention a specific user on a page and publish it  # Edit the page and close it without publishing  # Delete that specific user  # Try to publish that draft    h3. Expected Results  The draft should be published    h3. Actual Results  The draft is not published, the message ""There was an error processing the request."" is shown on the page and on the browser's console:  |  !Screen Shot 2019-04-10 at 16.59.31.png|thumbnail!  |  {code}jquery-min.js:1 PUT https://<instance>.atlassian.net/wiki/rest/api/content/789545067?status=draft 400{code}  Errors on internal log:  {code:none}Uncaught exception thrown by REST service: Could not unmarshal a link in the editor. {code}    h3. Notes  This is noticed on the legacy editor only.    h3. Workaround  Remove the former user's mention, refresh the page a couple of times and try to publish it again.",3
"CONFSERVER-59134","11/20/2019 01:19:51","Companion App stops opening the long file name document","h3. Issue Summary  How many characters are allowed in a file which you want to edit via Companion App?    h3. Test Environment  * Confluence Server latest version   * Compaion-app latest version    h3. Steps to Reproduce  # Create a test page then upload attached csv file to the page  [^invitations_successful_emailaddresses051119_99999999999999999999999999999999dijwsoijdiowsejoijodjeojfdoijfdwejfdjweofjowejfoijwejfoiwejfojwejfhwehfiowehfoihweifohweofhwefhwfoihwefohweoh.csv]   # Navigate to the page > ... > Attachments   # Select the file then click *Edit* > Edit with Excel    h3. Expected Results  The file should be able to open in the Excel    h3. Actual Results  We can see the message *This file is open in Excel* but nothing really happening    h3. Workaround  Currently there is no known workaround for this behavior. A workaround will be added here when available    h3. Note  * We are able to directly open the csv in Excel  * Shorter filename works as expected",2
"CONFSERVER-59164","11/25/2019 22:07:45","Latest Team Calendars source code not available on my.atlassian.com","h3. Issue Summary    Latest Team Calendars source code not available on my.atlassian.com  h3. Steps to Reproduce   # Check latest version on https://my.atlassian.com/download/source/confluence-team-calendar   # Go to https://my.atlassian.com/download/source/confluence-team-calendar    h3. Expected Results    Versions should match up and be available for download  h3. Actual Results    Currently, only Team Calendars 6.0.12 is available  h3. Workaround    Reach out to our support teams for them to provide access",3
"CONFSERVER-59182","11/28/2019 13:04:57","Edit Keyboard Shortcut 'E' does not work or works irregularly in some newer versions of Firefox","h3. Issue Summary    Edit Shortcut 'E' does not work or works irregularly in some newer versions of Firefox. Confirmed in Firefox 70.0.  h3. Steps to Reproduce   # Use Firefox version 70.0 and Confluence 7.0.1 and higher.   # View a page with a link to another page. Click on the link to open the other page on new tab.   # Try to use the edit keyboard shortcut 'E' to edit a page on new tabs (Any shortcuts won't work on new tab).    h3. Expected Results    The shortcut opens the editor as expected.  h3. Actual Results    Some users are reporting that it works inconsistently. Others report that it doesn't work at all. In my own tests, with Firefox 65.0 it works without issue, in Firefox 70.0 it doesn't work at all.    h3. Workaround  Refreshing the page seems to resolve the issue, but not consistently.  This workaround below from [~simon.tost] works on Confluence 7.3.1 and Firefox 72.  * Add the following into the *Custom HTML* at the *At end of the HEAD*   ** {code:java}  <script>    if(AJS.$.browser.mozilla) {      AJS.toInit(function() {        setTimeout(function() {          if (AJS.PageGadget || (window.parent.AJS && window.parent.AJS.PageGadget)) { return  }          if (typeof AJS.contextPath() !== 'undefined') {            AJS.trigger('initialize.keyboardshortcuts');          }        }, 2000);      });    }  </script>{code}",3
"CONFSERVER-59360","12/20/2019 03:48:09","Companion should deregister custom protocol on uninstall","Currently, the custom protocol `atlassian-companion` will remain registered even after Companion is uninstalled. ",2
"CONFSERVER-59334","01/09/2020 02:18:07","PDF macro doesn't load PDF content and returns an NPE on readTrailer15 method","h3. Issue Summary    When users insert PDF macro in a page, the macro does not show the content of the PDF. Instead a following error is returned:  {quote}There was a problem converting this attachment  {quote}    This issue seems to be a regression of the following closed bug report that was fixed in 6.14: CONFSERVER-20223    h3. Steps to Reproduce   # Head over to a Confluence page.   # Add a PDF attachment to the page.   # In the Edit mode of the page, head over to the toolbar > Insert > Other Macros > PDF and Insert the macro to the page.    h3. Expected Results    The PDF macro will display the PDF in the page.    h3. Actual Results    An infinite spinning wheel will be displayed and the following error is returned:    The following stack trace appears in the logs:    {code}  Caused by: java.lang.NullPointerException   at com.sun.pdfview.PDFFile.readTrailer15(PDFFile.java:1167)  {code}    Example:  {code}  2020-01-06 11:44:41,971 ERROR [DefaultSlideCacheManager:thread-2] [com.benryan.conversion.AbstractSlideConversionTask] call problem while converting cofc80024577en.pdf   -- referer: http://localhost:6711/c711/display/TEST/PDF+MACRO+TEST | url: /c711/plugins/servlet/pptslide | traceId: 34f1bbccd1f06e6f | userName: admin  java.io.IOException: java.lang.NullPointerException   at com.benryan.conversion.PdfSlideConversionBatchTask.convertFile(PdfSlideConversionBatchTask.java:56)   at com.benryan.conversion.PdfSlideConversionBatchTask.convertFile(PdfSlideConversionBatchTask.java:23)   at com.benryan.conversion.AbstractSlideConversionTask.call(AbstractSlideConversionTask.java:40)   at java.util.concurrent.FutureTask.run(FutureTask.java:266)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)   at java.lang.Thread.run(Thread.java:748)  Caused by: java.lang.NullPointerException   at com.sun.pdfview.PDFFile.readTrailer15(PDFFile.java:1167)   at com.sun.pdfview.PDFFile.readTrailer(PDFFile.java:1002)   at com.sun.pdfview.PDFFile.parseFile(PDFFile.java:1378)   at com.sun.pdfview.PDFFile.<init>(PDFFile.java:126)   at com.sun.pdfview.PDFFile.<init>(PDFFile.java:102)   at com.atlassian.confluence.plugins.conversion.convert.image.PdfConverter.getInputPdfFile(PdfConverter.java:158)   at com.atlassian.confluence.plugins.conversion.convert.image.PdfConverter.convert(PdfConverter.java:65)   at com.benryan.conversion.PdfSlideConversionBatchTask.convertFile(PdfSlideConversionBatchTask.java:49)   ... 6 more  {code}    or    {code}  2019-12-09 22:14:21,855 ERROR [DefaultSlideCacheManager:thread-2] [com.benryan.conversion.AbstractSlideConversionTask] call problem while converting pdf-test.pdf   -- referer: http://localhost:8090/display/711/PDF | url: /plugins/servlet/pptslide | traceId: b98cab88e8ea4d24 | userName: admin  java.io.IOException: java.lang.NullPointerException   at com.benryan.conversion.PdfSlideConversionBatchTask.convertFile(PdfSlideConversionBatchTask.java:56)   at com.benryan.conversion.PdfSlideConversionBatchTask.convertFile(PdfSlideConversionBatchTask.java:23)   at com.benryan.conversion.AbstractSlideConversionTask.call(AbstractSlideConversionTask.java:40)   at java.util.concurrent.FutureTask.run(FutureTask.java:266)   at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)   at java.lang.Thread.run(Thread.java:748)  Caused by: java.lang.NullPointerException   at com.sun.pdfview.PDFFile.readTrailer15(PDFFile.java:1290)   at com.sun.pdfview.PDFFile.readTrailer(PDFFile.java:1105)   at com.sun.pdfview.PDFFile.parseFile(PDFFile.java:1378)   at com.sun.pdfview.PDFFile.<init>(PDFFile.java:126)   at com.sun.pdfview.PDFFile.<init>(PDFFile.java:102)   at com.atlassian.confluence.plugins.conversion.convert.image.PdfConverter.getInputPdfFile(PdfConverter.java:158)   at com.atlassian.confluence.plugins.conversion.convert.image.PdfConverter.convert(PdfConverter.java:65)   at com.benryan.conversion.PdfSlideConversionBatchTask.convertFile(PdfSlideConversionBatchTask.java:49)   ... 6 more  {code}    h5. Note  Sample attachments that are exhibiting this issue can be found in the Attachment section  ",3
"CONFSERVER-59464","02/11/2020 16:03:03","Creating a Share a link blueprint produces an error. ","h3. Issue Summary    Creating a *share a link* blueprint prompt an alert, *We can't create the blueprint right now*  h3. Steps to Reproduce   # Create a page using the ellipses.   # Select share a link   # Enter data in text field and enter.   !shareaLink.png|thumbnail!   h3. Expected Results    Confluence creates shared link page.  h3. Actual Results    Error prompts *We can't create the blueprint right now*   !sharedLinkError.png|thumbnail!     The below exception is thrown in the atlassian-confluence.log file:  {noformat}  020-02-11 09:41:56,437 ERROR [http-nio-8090-exec-7] [plugins.sharelinks.metaextractor.MasterLinkMetaDataExtractor] getHeadHtmlData Error with io exception:   -- referer: http://localhost:8090/display/SHAR/sharealink+Home | url: /rest/create-dialog/1.0/content-blueprint/create-content | traceId: 63b9778a899f5c9f | userName: admin  java.io.IOException: External connections have been disabled          at com.atlassian.confluence.util.http.httpclient.HttpClientHttpRetrievalService.newHttpClient(HttpClientHttpRetrievalService.java:166)          at com.atlassian.confluence.util.http.httpclient.HttpClientHttpRetrievalService.get(HttpClientHttpRetrievalService.java:49)          at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)          at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)          at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)          at java.lang.reflect.Method.invoke(Method.java:498)          at com.atlassian.plugin.util.ContextClassLoaderSettingInvocationHandler.invoke(ContextClassLoaderSettingInvocationHandler.java:26)          at com.sun.proxy.$Proxy429.get(Unknown Source)          at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)          at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)          at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)          at java.lang.reflect.Method.invoke(Method.java:498)          at com.atlassian.plugin.osgi.bridge.external.HostComponentFactoryBean$DynamicServiceInvocationHandler.invoke(HostComponentFactoryBean.java:136)  {noformat}    h3. Workaround    Check the *External connection enabled* CheckBox in General configuration.   !extConnConfig.png|thumbnail!     h3. Note    Documentation doesn't mention that *External connection enabled* needs to be checked. ",3
"CONFSERVER-59465","02/11/2020 20:02:37","Scrolling down on a long page has page headers overlap breadcrumb navigation","h3. Issue Summary  Headers overlap breadcrumb navigation on pages that are long enough to scroll down on.     h3. Steps to Reproduce  # Create a page that's long enough to scroll down on.  # Scroll down and watch the breadcrumb get overlapped by title header until you scroll past it.    h3. Expected Results  Breadcrumb navigation and headers shouldn't overlap.  h3. Actual Results  They overlap when scrolling down on a long page until the breadcrumb and header are off the screen. Scrolling up it works fine, This only happens when scrolling down on page in Chrome. Happens in incognito mode in chrome as well.  Could sticky navbar be missing for this Version of Chrome?    h3. Workaround  FireFox Works as intended  Safari: Works as intended  ",3
"CONFSERVER-59551","03/02/2020 19:29:11","  Trying to change more than one cell color at a time in page editor on internet explorer does not work.","h3. Issue Summary  6.15 confluence and above does not allow for changing more than one cell color when used in an IE browser. Other supported browsers allow this.    h3. Steps to Reproduce  Insert a table with any amount of rows on confluence instance 6.15 or higher in an IE browser try to change more than one cell color at the same time.    h3. Expected Results  You should be able to change more than one cell color at a time      h3. Actual Results    You can only change one cell color at time.     h3. Workaround    Use a different supported browser     ",2
"CONFSERVER-59568","03/05/2020 06:30:58","ApplicationDirectoryRemovedEvent is not taken into account by Gatekeeper","h3. Issue Summary    When an existing user directory is removed, Gatekeeper is not aware of it and does not update its user cache.    h3. Steps to Reproduce  # Configure an external user directory  # Synchronize the users and groups from there  # Go to Inspect Permissions  # You should see the list of new users there  # Now go back to User Directories  # Disable and Remove that directory    h3. Expected Results  Those users shouldn't show in the Inspect Users list      h3. Actual Results  Those users are still in that list    h3. Notes  ApplicationDirectoryRemovedEvent is sent when the user directory is removed    h3. Workaround  The system administrator can disable and then enable the plugin to force a refresh of the user cache",3
"CONFSERVER-59569","03/05/2020 06:43:07","Gatekeeper will still load users and groups from a user directory that is disabled","h3. Issue Summary    When you disable an external user directory, Gatekeeper should not show the users and groups coming from that user directory.    h3. Steps to Reproduce  # Configure an external user directory  # Synchronize the users and groups from there  # Go to Inspect Permissions  # You should see the list of new users and groups there (In the case of a delegated user directory, once a user logs in)  # Now go back to User Directories  # Disable that directory    h3. Expected Results  Those users and groups shouldn't show in the Inspect Users and Groups list    h3. Actual Results  Those users and groups are still in that list and Gatekeeper displays the following message _The explanation for this permission could not be found_   !gatekeeper-error.png|thumbnail!     h3. Workaround  The only workaround is to do the following:  # Remove the user directory  # Enable and Disable the Gatekeeper plugin",3
"CONFSERVER-59573","03/05/2020 22:59:03","Gatekeeper will ignore status updates (enabled/disabled) on newly added users from an external directory","h3. Issue Summary    When adding a new user from an external user directory (connector), any status updates to this user (enabled/disabled) will not be picked up by Gatekeeper. Confluence will show this user as disabled. In Inspect Permissions, when you check the checkbox ""Don't show disabled user accounts"" Gatekeeper still shows the disabled user.    h3. Steps to Reproduce  # Create a user in an LDAP/AD (Active Directory)  # Synchronize the Active Directory  # Make sure that this user is visible in Inspect Permissions  # Disable that user in LDAP/AD  # Synchronize the Active Directory  # In Confluence, this user will show as disabled  # Go to Inspect Permissions, check the checkbox ""Don't show disabled user accounts""    h3. Expected Results  The disabled users won't appear in the list    h3. Actual Results  Users are still loaded in that list even though they are disabled    h3. Workaround  Disable the Gatekeeper plugin and enable it again for this to work and any subsequent status updates",3
"CONFSERVER-59575","03/06/2020 03:19:05","GroupUpdatedEvent is not taken into account by Gatekeeper","h3. Issue Summary    When running a full or incremental remote directory synchronization, the changes pulled in from that remote directory are not reflected in Gatekeeper.    h3. Steps to Reproduce  # Configure an external user directory  # Synchronize the users and groups from there  # Go to Inspect Permissions  # Set some permissions for a group (i.e. *_groupA_*)  # Make some changes in the remote directory (such as update the group name to *_groupA1_*)  # Now go back to User Directories  # Disable that directory, click Synchronize (this will force a full sync when we enable it again)  # Enable it again and click Synchronize    h3. Expected Results  The changes in the remote directory should be reflected in Confluence as well as in Gatekeeper. The group name should be updated and carry the permissions set on the old name      h3. Actual Results  New group with new no permissions set.  (!) If we rename this group to the same one as before, those permissions will appear again    h3. Workaround  The system administrator can disable and then enable the plugin to force a refresh of the user cache",3
"CONFSERVER-59692","04/08/2020 09:31:01","Page Title overlaps with Page Path on Chrome","h3. Issue Summary    Page Title overlaps with page path when clicking on spaces post opening a page in Confluence.  h3. Steps to Reproduce   # Open a page in Confluence   # Click on ""spaces""   # Page Title overlaps with page path as depicted in attached screenshot    h3. Expected Results    Page Title should not overlap with Page Path  h3. Actual Results    Page Title overlaps with page path when clicking on spaces post opening a page.  h3. Workaround    Currently there is no known workaround for this behaviour. A workaround will be added here when available",0
"CONFSERVER-59749","04/16/2020 02:26:26","Companion time since downloaded/saved/uploaded does not update once computer ""sleeps"" ","How to reproduce:    * Edit file with Companion, note the time (e.g. Downloaded a moment ago)   * Put computer to sleep, wait some time, wake computer   * Note that the time since download has not updated",2
"CONFSERVER-59775","04/29/2020 22:07:19","After upgrading to Confluence 7, Epic Status label is Unreadable With Jira Issues Macro","h3. Issue Summary  After upgrading to Confluence 7, Epic Status label is Unreadable With Jira Issues Macro    h3. Steps to Reproduce   # Link Confluence 7 with Jira   # Insert Jira Issues Macro and filter for an Epic.   # Under Display Options, add Epic Status    h3. Expected Results  Epic Status displays in readable color. Example from Confluence 6.15.10   !61510_good.png|thumbnail!     h3. Actual Results  Epic Status displays in unreadable color. Example from Confluence 7.0.5, 7.2.0, 7.4.0   !705_bad.png|thumbnail!    !720_bad.png|thumbnail!    !740_bad.png|thumbnail!     h3. Workaround  Add the following to the Space's stylesheet via *Space Tools > Look and Feel*    {code:none}  a.aui-lozenge.aui-lozenge-current, a.aui-lozenge.aui-lozenge-success, a.aui-lozenge.aui-lozenge-default { color: #fff; }  {code}",1
"CONFSERVER-59812","05/12/2020 05:01:41","An extra colon in edit in office toggle text","h3. Issue Summary  There is an extra colon in office toggle text    h3. Steps to Reproduce   # Go to edit in office settings    h3. Expected Results  No extra colon    h3. Actual Results  !image-2020-05-12-13-57-58-597.png|width=811,height=224!    h3. Workaround  Currently there is no known workaround for this behavior. A workaround will be added here when available",1
"CONFSERVER-59814","05/12/2020 05:43:23","Squirrel .exe installed Companion doesn't show 'all set up' welcome screen for new user","h3. Issue Summary  Squirrel .exe installed Companion doesn't show 'all set up' welcome screen for new user    h3. Steps to Reproduce   # Clean the companion folder with companion.log file   # Open companion.exe file to install and launch Companion    h3. Expected Results  The user should see 'all set up' welcome screen      h3. Actual Results  The user doesn't see 'all set up' welcome screen     h3. Workaround  Currently there is no known workaround for this behavior. A workaround will be added here when available",3
"CONFSERVER-59849","05/19/2020 06:15:58","Twitter feed Widget does not respect ""height"" parameter","h3. Issue Summary    Twitter feed Widget does not respect ""height"" parameter  h3. Steps to Reproduce   # Insert a Twitter feed widget (e.g. a timeline [https://twitter.com/TwitterDev)]   # Set the height parameter on the macro    h3. Expected Results    Height of macro is restricted to user setting.  h3. Actual Results    Macro shows entire feed.   h3. Workaround    Currently there is no known workaround for this behavior. A workaround will be added here when available",2
"CONFSERVER-59904","06/04/2020 08:56:55","The ""Upload"" button get pushed out when page title is too long","h3. Issue Summary  Tested with Atlassian Companion Version 1.1.0 for Mac. If the page title is too long (noticeable when it's 60 characters long), the upload button will get pushed out of the window:   !Screenshot 2020-06-04 at 3.34.03 PM.png|thumbnail!      !Screenshot 2020-06-04 at 3.47.15 PM.png|thumbnail!       h3. Steps to Reproduce  # Create a page with title ""longlonglonglonglonglonglonglonglonglnglonglonglonglongtitle""  # Add an office file in the page above  # Edit the attachment using Companion App    h3. Expected Results  The ""Upload"" button will stay intact.    h3. Actual Results  The ""Upload"" button is hidden out from Companion App pop up window.    h3. Workaround  Try keeping the page title under 60 characters long.",2
"CONFSERVER-59941","06/16/2020 01:20:33","Setting a reminder on a Jira Release event type fails when using an Oracle database","h3. Issue Summary    Attempting to set up a notification on a Jira Release Data event type in Team Calendars results in a SQL exception and fails.  h3. Steps to Reproduce   # Integrate Confluence & Team Calendars with a Jira instance (Bug report written with Confluence 7.4.0 -> Jira 8.5.4 -> Team Calendars )   # Create a Team Calendar in Confluence   # Create a few issues in Jira and also create a Release in Jira.   # Associate the issues with the Release and be sure to set a *date* on the Release Date. This date is what Team Calendars will display.   # From the Confluence calendar, create an Event and select Jira Release Dates and choose the project & it's release from the drop down. Secondlay, try to choose a reminder interval from the drop down menu.    h3. Expected Results    You will be able to set a reminder interval for a Jira Release event type.  h3. Actual Results    You'll receive the following SQL exception and setting up the reminder fails.  {code:java}  Unable to load events of Jira Named Release (xxxxx-xxxxx-xxxx): PreparedStatementCallback; SQL [INSERT INTO ""AO_950DC3_TC_JIRA_REMI_EVENTS"" (""KEY_ID"", ""SUB_CALENDAR_ID"", ""USER_ID"", ""JQL"", ""TICKET_ID"", ""ASSIGNEE"", ""STATUS"", ""TITLE"", ""DESCRIPTION"", ""EVENT_TYPE"", ""UTC_START"", ""UTC_END"", ""ALL_DAY"", ""ISSUE_LINK"", ""ISSUE_ICON_URL"") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]; ORA-01400: cannot insert NULL into (""CONF615U"".""AO_950DC3_TC_JIRA_REMI_EVENTS"".""TICKET_ID"") ; nested exception is java.sql.SQLIntegrityConstraintViolationException: ORA-01400: cannot insert NULL into (""CONF615U"".""AO_950DC3_TC_JIRA_REMI_EVENTS"".""TICKET_ID"")  {code}  h3. Workaround   * Don't set a reminder for a Jira release event and the date of the release will still display correctly.   * Mirror the release date to a custom field and use a different event type to display and notify on the custom date rather than the OOTB release date event type option.   * Issue is not reproduced on Postgres    h3. Notes    We need to validate this fix against all Oracle versions (12c and 19c) and above as supported in the upcoming releases of Confluence [Supported Platforms|https://confluence.atlassian.com/doc/supported-platforms-207488198.html]",3
"CONFSERVER-59942","06/16/2020 05:51:06","Companion triggers view on save after user clicks view","*Steps to reproduce*   # Edit a file with Companion, upload it, then click the view button   # Save the same file again    *Expected behaviour*    Companion transitions to file saved state.     *Actual behaviour*    Preview link is opened in browser, companion transitions to file saved state.     ",2
"CONFSERVER-59987","06/24/2020 18:25:30","Excel Macro edit button only available on the page excel file is attached to","h3. Problem    When using the Excel Macro, the *Edit* button is only available on the page that the excel sheet is attached to. Other pages using an Excel Macro that is attached to another page no longer include the *Edit* button above the macro.   h3. Environment    Confluence 7.5.0  h3. Steps to Reproduce    * Add an Excel file as an attachment to a page  * Add an Excel Macro to this page using the Excel file.  * Publish the page  * Create a new page   * Add an Excel macro with the *Page Name* set to the previously created page that we added the Excel file to, and set the File Name to the Excel file.  * Publish the page    h3. Expected Results    We expect that when published the Excel Macro on the second page will include an *Edit* button in the upper right corner.   h3. Actual Results    There is no *Edit* button on the second page. However, the *Edit* button can be seen when viewing the Excel Macro on the original page.   h3. Workaround    Enabling the Edit in Office dark feature will restore the missing *Edit* links to the page.   h3. Notes",2
"CONFSERVER-60061","07/07/2020 04:21:14","Widget connector can't load Google map on HTTPS server","h3. Issue Summary    Widget connector can't load Google map on HTTPS server  h3. Steps to Reproduce   # Go to Confluence HTTPS instance   # Open editor   # Paste a google map link, that contains HTTPS, into editor. It is auto converted into a widget connector macro   # Edit the macro   # Click Preview macro, see nothing   # Save the page, google map is not displayed on view page    h3. Expected Results    Display google map  h3. Actual Results    Empty  h3. Workaround    None",1
"CONFSERVER-60029","07/07/2020 07:46:20","Jira Macro doesn't display`Epic Name`, `Epic Colour` and `Epic Status` values","h3. Issue Summary    It seems a regression according to customer report. The epic name field only exists in epic type issues, which seems not handled well.  h3. Steps to Reproduce   # Insert a Jira macro on a page   # Enter JQL to get a list of Jira issues   # Click `Display options`   # Search and select `Epic Name` (don't select `Epic Link`)   # Save the macro   # Publish the page    h3. Expected Results    A list of issues on the page  h3. Actual Results    Jira macro throws a error on the screen  {noformat}  Data cannot be retrieved due to an unexpected error.  View these issues in Jira  {noformat}  In log (sensitive information removed)  {noformat}  2020-08-20 15:05:05,912 ERROR [JIM Marshaller:thread-7] [extra.jira.helper.JiraExceptionHelper] throwMacroExecutionException Macro execution exception:   -- url: /c741/display/PROJ/JIM+Here | page: 65609 | traceId: c76719074ee884db | userName: admin | referer: http://localhost:6741/c741/pages/resumedraft.action?draftId=65610&draftShareId=66387d08-a626-42fb-bad3-8a7e4764b824& | action: viewpage  java.lang.NullPointerException          at com.atlassian.confluence.extra.jira.JiraIssuesMacro.getEpicInformation(JiraIssuesMacro.java:839)          at com.atlassian.confluence.extra.jira.JiraIssuesMacro.populateTableEpicData(JiraIssuesMacro.java:708)          at com.atlassian.confluence.extra.jira.JiraIssuesMacro.populateContextMapForStaticTable(JiraIssuesMacro.java:977)          at com.atlassian.confluence.extra.jira.JiraIssuesMacro.createContextMapFromParams(JiraIssuesMacro.java:450)          at com.atlassian.confluence.extra.jira.JiraIssuesMacro.execute(JiraIssuesMacro.java:1238)          at com.atlassian.confluence.extra.jira.executor.StreamableMacroFutureTask.renderValue(StreamableMacroFutureTask.java:74)          at com.atlassian.confluence.extra.jira.services.DefaultAsyncJiraIssueBatchService.lambda$processRequestWithJql$2(DefaultAsyncJiraIssueBatchService.java:183)          at com.atlassian.sal.core.executor.ThreadLocalDelegateCallable.call(ThreadLocalDelegateCallable.java:38)          at com.atlassian.confluence.impl.vcache.VCacheRequestContextManager.doInRequestContextInternal(VCacheRequestContextManager.java:84)          at com.atlassian.confluence.impl.vcache.VCacheRequestContextManager.doInRequestContext(VCacheRequestContextManager.java:68)          at com.atlassian.confluence.vcache.VCacheRequestContextOperations.lambda$withRequestContext$1(VCacheRequestContextOperations.java:59)          at java.util.concurrent.FutureTask.run(FutureTask.java:266)          at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)          at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)          at java.lang.Thread.run(Thread.java:748)  {noformat}  h3. Workaround    Change `Epic Name` to `Epic Link`",3
"CONFSERVER-60143","08/04/2020 08:04:40","Jira Macro column values not appearing when Custom Field (Jira) name contains comma or semicolon","h3. Summary    When JIRA Custom Fields name contains comma (,) or (;) JIRA Macro identify the them as separators and does not include the field values in the JIRA Macro table generated in Confluence         Steps to Reproduce   # Create a custom field that include a comma or semicolon, add value.   # Create a JIRA Macro in a Confluence page   # Include the custom field that contains a comma or semicolon   # Publish page.          [^Screenshot from 2017-10-25 18.30.04.png] [^Screenshot from 2017-10-25 18.31.26.png]  h3. Expected Results    Values are shown in Custom field column  h3. Actual Results    _Empty values are shown and the header is separated where the commas or semicolons are positioned._  h3. Workaround      Remove commas from JIRA Custom Fields",3
"CONFSERVER-60157","08/10/2020 01:12:10","Cannot add custom field as columns in Jira Issue Macro (table view) due to case-sensitivity","h3. Problem    In a Confluence site version *7.4.x* or *7.6.x* connected to a Jira Software via an application link.    We cannot add 2 Jira *custom fields* as *columns* to display in a *Jira Issue Macro* (table view) due to case-sensitivity.  h3. Environment    Confluence version *7.4.x* or *7.6.x* connected to a Jira Software version *8.4.2* via an application link  h3. Steps to Reproduce   # Create 2 custom fields in Jira and configure them to be displayed on some default screens for the user to fill in. In our example, we called these fields *end date* and *End date* and they were date pickers.   # Create a new Jira Issue / Bug and assign a new value to these fields   # Go to Confluence and create a new Confluence page adding a *Jira Issue Macro*   # Customize the Jira Issue Macro and try to make the new custom fields displayed as a column in a Table view    h3. Expected Results    _The user can pick the 2 custom fields as *columns* to display in a *Jira Issue Macro*_  h3. Actual Results    _After picking the first custom field, the second one becomes unavailable for selection in the *Jira Issue Macro*_  h3. Workaround    _No Workaround at this stage except renaming fields on the Jira side that may not be convenient for the user needs._  h3. Notes    A video is attached with my steps to reproduce in Confluence",2
